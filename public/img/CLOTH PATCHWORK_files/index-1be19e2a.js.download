import{R as _x,E as ie,C as ka,a as Xa,P as B,M as Fc,A as Lc,b as m,B as _,S as oe,D as yt,c as P,H as Sx,d as Go,F as wx,e as bx,f as Cx,L as Ix,g as bn,N as Cn,G as Mx,O as Gc,h as br,i as Oy,j as Dp,k as Fy,l as xo,m as Ax,n as Px,U as qt,o as xc,p as ft,q as Vt,r as ea,s as vt,t as gt,u as Nx,X as Op,v as la,T as Xn,w as ve,x as Fp,y as Tx,z as Rx,I as Dx,J as Ox,K as Fx,Q as Lx,V as Gx,W as xx,Y as Ex,Z as Ux,_ as kx,$ as Wx,a0 as Vx,a1 as $x,a2 as Bx,a3 as Hx,a4 as Qx,a5 as jx,a6 as qx,a7 as zx,a8 as Kx,a9 as Gs,aa as Wm,ab as d,ac as N,ad as T,ae as y,af as Lp,ag as Vm,ah as Xx,ai as Cr,aj as Ir,ak as Mr,al as O,am as tr,an as Ar,ao as Pr,ap as Nr,aq as Tr,ar as hs,as as Rr,at as Eo,au as Dr,av as Or,aw as Ec,ax as Uc,ay as aa,az as Ly,aA as Xu,aB as Gy,aC as xy,aD as Ey,aE as Ju,aF as Yu,aG as Zu,aH as Uy,aI as ky,aJ as Wy,aK as ed,aL as td,aM as id,aN as Vy,aO as $y,aP as By,aQ as Hy,aR as Jx,aS as Qy,aT as jy,aU as qy,aV as zy,aW as Ky,aX as Xy,aY as Gp,aZ as Jy,a_ as Yx,a$ as Yy,b0 as Zy,b1 as sd,b2 as ad,b3 as ns,b4 as ev,b5 as tv,b6 as iv,b7 as sv,b8 as av,b9 as nv,ba as rv,bb as nd,bc as rd,bd as od,be as ov,bf as cv,bg as lv,bh as cd,bi as ld,bj as pd,bk as pv,bl as ud,bm as dd,bn as xp,bo as uv,bp as hd,bq as dv,br as hv,bs as Zx,bt as gv,bu as mv,bv as fv,bw as yv,bx as vv,by as _v,bz as Sv,bA as wv,bB as bv,bC as Cv,bD as Iv,bE as Mv,bF as Av,bG as Pv,bH as Nv,bI as Tv,bJ as Rv,bK as Dv,bL as Ov,bM as Fv,bN as Lv,bO as Gv,bP as xv,bQ as gd,bR as Ev,bS as Uv,bT as kv,bU as Wv,bV as Vv,bW as $v,bX as Bv,bY as Hv,bZ as Qv,b_ as jv,b$ as md,c0 as qv,c1 as zv,c2 as Kv,c3 as Xv,c4 as Jv,c5 as e4,c6 as Yv,c7 as fd,c8 as yd,c9 as vd,ca as _d,cb as Sd,cc as wd,cd as kc,ce as Zv,cf as e_,cg as t_,ch as i_,ci as s_,cj as a_,ck as n_,cl as r_,cm as o_,cn as c_,co as l_,cp as p_,cq as u_,cr as d_,cs as h_,ct as g_,cu as m_,cv as f_,cw as y_,cx as v_,cy as __,cz as S_,cA as w_,cB as b_,cC as C_,cD as I_,cE as M_,cF as A_,cG as P_,cH as N_,cI as T_,cJ as R_,cK as D_,cL as O_,cM as F_,cN as $m,cO as L_,cP as G_,cQ as x_,cR as E_,cS as U_,cT as k_,cU as W_,cV as V_,cW as $_,cX as B_,cY as t4,cZ as H_,c_ as Q_,c$ as j_,d0 as q_,d1 as z_,d2 as K_,d3 as X_,d4 as J_,d5 as Y_,d6 as Z_,d7 as i4,d8 as s4,d9 as a4,da as n4,db as r4,dc as o4,dd as c4,de as l4,df as p4,dg as u4,dh as d4,di as h4,dj as g4,dk as m4,dl as f4,dm as y4,dn as v4,dp as _4,dq as S4,dr as w4,ds as b4,dt as C4,du as I4,dv as M4,dw as A4,dx as P4,dy as N4,dz as T4,dA as R4,dB as D4,dC as O4,dD as F4,dE as L4,dF as G4,dG as x4,dH as E4,dI as U4,dJ as k4,dK as W4,dL as V4,dM as $4,dN as B4,dO as H4,dP as Q4,dQ as j4,dR as Ep,dS as q4,dT as z4,dU as K4,dV as X4,dW as J4,dX as Y4,dY as Z4,dZ as gp,d_ as Wa,d$ as Ot,e0 as Wc,e1 as eE,e2 as tE,e3 as iE,e4 as eS,e5 as Fr,e6 as sE,e7 as Uo,e8 as tS,e9 as rs,ea as D,eb as k,ec as E,ed as L,ee as bd,ef as h,eg as z,eh as Up,ei as $a,ej as pa,ek as Vi,el as Bt,em as St,en as ci,eo as iS,ep as q,eq as c,er as ko,es as aE,et as nE,eu as rE,ev as oE,ew as cE,ex as ir,ey as Ss,ez as Cd,eA as lE,eB as pE,eC as kp,eD as Qn,eE as Wp,eF as uE,eG as xs,eH as sS,eI as aS,eJ as dE,eK as Ja,eL as Bs,eM as Wt,eN as Te,eO as ee,eP as hE,eQ as Vc,eR as C,eS as gE,eT as mE,eU as fE,eV as yE,eW as vE,eX as _E,eY as SE,eZ as wE,e_ as bE,e$ as CE,f0 as IE,f1 as ME,f2 as AE,f3 as PE,f4 as nS,f5 as NE,f6 as rS,f7 as TE,f8 as RE,f9 as DE,fa as OE,fb as FE,fc as LE,fd as GE,fe as xE,ff as EE,fg as UE,fh as kE,fi as WE,fj as VE,fk as $E,fl as oS,fm as cS,fn as lS,fo as pS,fp as uS,fq as dS,fr as Bm,fs as BE,ft as HE,fu as Hm,fv as QE,fw as hS,fx as gS,fy as mS,fz as fS,fA as yS,fB as vS,fC as _S,fD as jE,fE as qE,fF as zE,fG as SS,fH as KE,fI as XE,fJ as JE,fK as YE,fL as wS,fM as bS,fN as ZE,fO as Rt,fP as e2,fQ as $c,fR as oi,fS as CS,fT as yi,fU as IS,fV as Ns,fW as Id,fX as Hs,fY as Fs,fZ as Mo,f_ as MS,f$ as Bc,g0 as AS,g1 as Qm,g2 as jm,g3 as t2,g4 as i2,g5 as qm,g6 as s2,g7 as PS,g8 as a2,g9 as n2,ga as r2,gb as zm,gc as Km,gd as Ds,ge as Xm,gf as o2,gg as c2,gh as fo,gi as l2,gj as Jm,gk as p2,gl as Ki,gm as A,gn as u2,go as d2,gp as NS,gq as h2,gr as g2,gs as m2,gt as f2,gu as Lr,gv as y2,gw as v2,gx as _2,gy as S2,gz as w2,gA as b2,gB as Ym}from"./upn-vendor-bf1ed58d.js";import{b as ba,e as TS,f as C2,V as K,d as I2,j as RS,c as Hc,C as j,r as U,g as DS,R as OS,m as We,t as M2,s as A2,k as P2,l as N2,n as T2,a as R2,o as D2}from"./vendor-ff46a377.js";function sie(){import("data:text/javascript,")}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}})();const O2="modulepreload",F2=function(i){return window.__publicPath+i},Zm={},G=function(e,t,s){if(!t||t.length===0)return e();const a=document.getElementsByTagName("link");return Promise.all(t.map(n=>{if(n=F2(n),n in Zm)return;Zm[n]=!0;const r=n.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(!!s)for(let v=a.length-1;v>=0;v--){const w=a[v];if(w.href===n&&(!r||w.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(n,'"]').concat(o)))return;const u=document.createElement("link");if(u.rel=r?"stylesheet":O2,r||(u.as="script",u.crossOrigin=""),u.href=n,document.head.appendChild(u),r)return new Promise((v,w)=>{u.addEventListener("load",v),u.addEventListener("error",()=>w(new Error("Unable to preload CSS for ".concat(n))))})})).then(()=>e()).catch(n=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=n,window.dispatchEvent(r),!r.defaultPrevented)throw n})};window.__esm_loader__=i=>{const e=new URL(i);return e.hostname.endsWith(".ubisoft.com")?G(()=>import(e.href),[]):Promise.reject("Can only load esm modules from approved domains.")};var _i=(i=>(i.htmlCreated="html-created",i.jsCreated="js-created",i.mainStart="main-start",i.mainEnd="main-end",i.mainError="main-error",i.beforeStart="before-start",i.appInitiation="app-initiation",i.vueConfigured="vue-configured",i.gotCacheConfiguration="got-cache-configuration",i.localizationLoaded="localization-loaded",i.mainViewMounted="main-view-mounted",i.shellInitialized="shell-initialized",i.shellInitializedWithError="shell-initialized-with-error",i.shellStartedWithMicroApp="shell-started-with-micro-app",i.shellInitializedWithSession="shell-initialized-with-session",i.polyfillsSetupDone="polyfills-setup-done",i.startupDone="startup-done",i.pluginsLoaded="plugins-loaded",i.builtinPluginsLoaded="builtin-plugins-loaded",i.serviceWorkerInitialized="service-worker-initialized",i.childInitialized="child-initialized",i.hostFeaturesInitialized="host-features-initialized",i.authenticationProcessed="authentication-processed",i.postAuthActionDone="post-auth-action-done",i.storeInitialized="store-initialized",i.invalidSession="invalid-session",i.deactiveUnmountAllMicroApps="deactivate-unmount-all-microapps",i.userLoggedIn="user-logged-in",i.userGameDataLoaded="user-game-data-loaded",i.spaceParamsConfigLoaded="space-params-config-loaded",i.playerNotificationsInitialized="player-notifications-initialized",i.desktopInitDone="desktop-init-done",i))(_i||{});var He;(function(i){i.P0="p0",i.P1="p1",i.P2="p2",i.P3="p3",i.P4="p4",i.Performance="performance"})(He||(He={}));const L2={version:1,category:He.P0,metricType:"counter",description:"Black screens of death counter"},G2={version:1,category:He.Performance,metricType:"histogram",description:"Tracks bundle load time for a microapp",boundaries:[0,250,500,750,1e3,1500,2e3,2500,3e3,4e3,5e3]},x2={version:1,category:He.Performance,metricType:"histogram",description:"Track cumulative layout shift for a microapp",boundaries:[0,100,250,500,750]},E2={version:1,category:He.Performance,metricType:"histogram",description:"Tracks the time until first contentful paint for a microapp",boundaries:[0,250,500,750,1e3,1500,2e3,2500,3e3,4e3,5e3]},U2={version:1,category:He.Performance,metricType:"histogram",description:"Tracks instantiation time for a microapp",boundaries:[0,250,500,750,1e3,1500,2e3,2500,3e3,4e3,5e3]},k2={version:1,category:He.Performance,metricType:"histogram",description:"Track interaction responsiveness for a microapp",boundaries:[0,200,500,750]},W2={version:1,category:He.Performance,metricType:"histogram",description:"Tracks duration of largest contentful paint for a microapp",boundaries:[0,250,500,750,1e3,1500,2e3,2500,3e3,4e3,5e3]},V2={version:1,category:He.P0,metricType:"counter",description:"Tracks attempts to fetch authentication microapp when failing to load initially"},$2={version:1,category:He.P0,metricType:"counter",description:"Tracks Shell initialization failure rate"},B2={version:1,category:He.P0,metricType:"counter",description:"Tracks Shell initialization success rate"},H2={version:1,category:He.P0,metricType:"counter",description:"Tracks attempts to fetch microapp configs when failing to load initially"},Q2={version:1,category:He.Performance,metricType:"histogram",description:"Tracks how long until a microapp is interactable by a user",boundaries:[0,250,500,750,1e3,1500,2e3,2500,3e3,4e3,5e3]},j2={version:1,category:He.P0,metricType:"counter",description:"Tracks fatal errors emitted by microapps to Shell"},q2={version:1,category:He.P1,metricType:"counter",description:"Tracks an attempt to initialize a micro app"},z2={version:1,category:He.P1,metricType:"counter",description:"Tracks an unsuccessful attempt to initialize a micro app"},K2={version:1,category:He.P1,metricType:"counter",description:"Tracks a successful attempt to initialize a micro app"};var Ae=(i=>(i.Bsod="bsod",i.BundleLoadTime="bundle_load_time",i.CumulativeLayoutShift="cumulative_layout_shift",i.FirstContentfulPaint="first_contentful_paint",i.InstantiationTime="instantiation_time",i.InteractionToNextPaint="interaction_to_next_paint",i.LargestContentfulPaint="largest_contentful_paint",i.ShellAuthenticationFetchRetry="shell_authentication_fetch_retry",i.ShellInitializationFailure="shell_initialization_failure",i.ShellInitializationSuccess="shell_initialization_success",i.ShellMicroappconfigFetchRetry="shell_microappconfig_fetch_retry",i.TimeToInteractive="time_to_interactive",i.UAppFatalError="uApp_fatal_error",i.UAppInitializationAttempt="uApp_initialization_attempt",i.UAppInitializationError="uApp_initialization_error",i.UAppInitializationSuccess="uApp_initialization_success",i))(Ae||{});const X2={bsod:L2,bundle_load_time:G2,cumulative_layout_shift:x2,first_contentful_paint:E2,instantiation_time:U2,interaction_to_next_paint:k2,largest_contentful_paint:W2,shell_authentication_fetch_retry:V2,shell_initialization_failure:$2,shell_initialization_success:B2,shell_microappconfig_fetch_retry:H2,time_to_interactive:Q2,uApp_fatal_error:j2,uApp_initialization_attempt:q2,uApp_initialization_error:z2,uApp_initialization_success:K2};class rie{constructor(e,t){this._metrics=e,this._defaultMeterName=t}getMetric(e,t){const s=X2[e],a=t!=null?t:this._defaultMeterName;switch(s.metricType){case"counter":return this._metrics.getMeter(a).useCounter(s.category,e,s.version,{description:s.description,unit:s==null?void 0:s.unit});case"upDownCounter":return this._metrics.getMeter(a).useUpDownCounter(s.category,e,s.version,{description:s.description,unit:s==null?void 0:s.unit});case"histogram":return this._metrics.getMeter(a).useHistogram(s.category,e,s.version,{description:s.description,unit:s==null?void 0:s.unit,advice:{explicitBucketBoundaries:s==null?void 0:s.boundaries}});default:throw new Error("Unsupported metric type")}}}const Sc=class Sc extends _x{constructor(e){super(),this._domain=e,this._token=/{domain}/gi}replaceTokens(e){return e.replace(this._token,this._domain)}};Sc.WW="ubi.com",Sc.CN="ubisoft.cn";let Jn=Sc;var os=(i=>(i.Uat="uat",i.Cert="cert2",i.Prod="prod",i))(os||{});const J2={[os.Uat]:"uat-",[os.Cert]:"cert2-",[os.Prod]:""};class FS{static replaceToken(e,t){return t.replace("{env}",J2[e])}}class LS{constructor(e,t,s,a,n,r){var v;this.applicationName="app-shell",this.anonymousTrackingSpaceId="ec66c7e2-7b44-471c-a3ab-9d1da48153c3",this._environmentToUbiservicesEnvironmentMap={[ie.Local]:os.Uat,[ie.Dev]:os.Uat,[ie.Uat]:os.Uat,[ie.Cert]:os.Cert,[ie.Prod]:os.Prod},this._environmentToConfigEnvironmentMap={[ie.Local]:ka.Dev,[ie.Dev]:ka.Dev,[ie.Uat]:ka.Uat,[ie.Cert]:ka.Cert,[ie.Prod]:ka.Prod},this._environmentToConnectEnvironmentMap={[ie.Local]:ie.Uat,[ie.Dev]:ie.Uat,[ie.Uat]:ie.Uat,[ie.Cert]:ie.Cert,[ie.Prod]:ie.Prod};const o=n?"client":"overlay",l=this.getConfigForContextOrFallbackToOverlay(e.ids[a],o,t);this.shellCrossPlatformSpaceId=l.shellCrossPlatformSpaceId,this.shellApplicationId=l==null?void 0:l.shellPlatformSpecificIds[t].applicationId,this.shellSpaceId=l==null?void 0:l.shellPlatformSpecificIds[t].spaceId,this.legacyClientSpaceId=e.ids[a].legacyClientSpaceId,this.isOnTest=new URL((v=window==null?void 0:window.location)==null?void 0:v.href).pathname.startsWith("/TEST"),this.loggerConfig=e.logger,this.statisticsConfig=e.statistics,this.ubiservicesEnvironment=this._environmentToUbiservicesEnvironmentMap[s],this.configServiceEnvironment=this._environmentToConfigEnvironmentMap[s],this.bundleOverrideEnvironment=this.getBundleOverrideEnvironment(s,this.isOnTest,r),this.connectEnvironment=this._environmentToConnectEnvironmentMap[s];const u=new Jn(a===Xa.China&&s===ie.Prod?Jn.CN:Jn.WW);this.ubiservicesApiBaseUrl=u.replaceTokens(FS.replaceToken(this.ubiservicesEnvironment,e.apiBaseUrl)),this.metricCategoriesSpaceId=e.metricCategoriesSpaceId,this.applicationIds=Object.values(l.shellPlatformSpecificIds).map(w=>w.applicationId)}getConfigForContextOrFallbackToOverlay(e,t,s){var a,n;return(n=(a=e[t])==null?void 0:a.shellPlatformSpecificIds)!=null&&n[s]?e[t]:e.overlay}getBundleOverrideEnvironment(e,t,s){return s?this._environmentToConfigEnvironmentMap[s]:t?ka.Test:this._environmentToConfigEnvironmentMap[e]}}var g=(i=>(i.ChildWindowCreateError="childWindowCreateError",i.LoadRuntimeParametersError="loadRuntimeParametersError",i.ApplicationStartFailed="applicationStartFailed",i.XboxInterfaceCompletionUrlError="xboxInterfaceCompletionUrlError",i.XboxInterfaceFirstPartyTokenCancelled="xboxInterfaceFirstPartyTokenCancelled",i.XboxInterfaceFirstPartyTokenError="xboxInterfaceFirstPartyTokenError",i.CacheExpirationWipeError="cacheExpirationWipeError",i.CacheExpirationTimestampError="cacheExpirationTimestampError",i.CacheExpirationRemoveEntryError="cacheExpirationRemoveEntryError",i.NavigationListenerExitExclusiveModeError="navigationListenerExitExclusiveModeError",i.NavigationListenerSwitchExclusiveModeError="navigationListenerSwitchExclusiveModeError",i.NavigationListenerSwitchExclusiveModeNotAuthenticatedError="navigationListenerSwitchExclusiveModeNotAuthenticatedError",i.PluginServiceMissingLifeguardFactory="pluginServiceMissingLifeguardFactory",i.ApiReportFatalError="apiReportFatalError",i.ApplicationResumeOverlayError="applicationResumeOverlayError",i.ConfigurationLoadGameSpecificNativeAppsError="configurationLoadGameSpecificNativeAppsError",i.ConfigurationLoadNativeMicroAppConfigurationsError="configurationLoadNativeMicroAppConfigurationsError",i.MicroAppsLoadAuthenticationMicroAppError="microAppsLoadAuthenticationMicroAppError",i.MicroAppsLoadAuthenticationMicroAppConfigError="microAppsLoadAuthenticationMicroAppConfigError",i.MicroAppsActivateAuthenticationMicroappError="microAppsActivateAuthenticationMicroappError",i.MicroAppsActivatingAuthenticationMicroappError="microAppsActivatingAuthenticationMicroappError",i.MicroAppsActivateMicroAppError="microAppsActivateMicroAppError",i.CacheAuthenticationMicroAppConfigError="cacheAuthenticationMicroAppConfigError",i.RuntimeContextExitExclusiveModeError="runtimeContextExitExclusiveModeError",i.RuntimeContextShellInitError="runtimeContextShellInitError",i.RuntimeContextSetHostGameFromLastPlayedError="runtimeContextSetHostGameFromLastPlayedError",i.AuthenticationTimeoutError="authenticationTimeoutError",i.TicketRefreshFailedError="ticketRefreshFailedError",i.WebsocketConnectionUpdateError="websocketConnectionUpdateError",i.WebsocketConnectionUpdateConnectionNotFoundError="websocketConnectionUpdateConnectionNotFoundError",i.WebsocketConnectionUpdateConnectionMultipleConnectionsError="websocketConnectionUpdateConnectionMultipleConnectionsError",i.GetLastUpdatedConfigMissingPlayerSessionError="getLastUpdatedConfigMissingPlayerSessionError",i.GetLastUpdatedConfigWithExpiredTicketError="getLastUpdatedConfigWithExpiredTicketError",i.GetLastUpdatedConfigFailed="getLastUpdatedConfigFailed",i.InvalidGameParameter="InvalidGameParameter",i.FailedNavigationForGameLaunchWarning="failedNavigationForGameLaunch",i.GameLunchWindowUnavailableWarning="gameLunchWindowUnavailable",i.FailedNavigationWarning="failedNavigationWarning",i.GameAlreadyRunningWarning="gameAlreadyRunningWarning",i.GameLaunchMissingProductIDWarning="gameLaunchMissingProductIDWarning",i.GameLaunchMissingEntitlementWarning="gameLaunchMissingEntitlementWarning",i.FailedToLoadGameForSpaceIDWarning="failedToLoadGameForSpaceIDWarning",i.FailedLoadOfMicroappsWarning="failedLoadOfMicroappsWarning",i.FailedAvailablityOfMicroappWarning="failedAvailablityOfMicroappWarning",i.ShellPluginFatalErrorWarning="shellPluginFatalErrorWarning",i.FailedToGetImageWarning="failedToGetImageWarning",i.FailedDeactivationOfMicroappWarning="failedDeactivationOfMicroappWarning",i.FailedActivationOfMicroappWarning="failedActivationOfMicroappWarning",i.FailedDNATrackingEventWarning="failedDNATrackingEventWarning",i.ClosingOverlayForUnsupportedPlatformWarning="ClosingOverlayForUnsupportedPlatformWarning",i.FailedRetrivingProfileDataWarning="FailedRetrivingProfileDataWarning",i.FailedQueryShellSpaceParametersWarning="FailedQueryShellSpaceParametersWarning",i.FailedDetermineBetaStatusWarning="failedDetermineBetaStatusWarning",i.FailedQueryLegacyClientFeatureParametersWarning="failedQueryLegacyClientFeatureParametersWarning",i.LegacyPCHostUnavailableWarning="legacyPCHostUnavailableWarning",i.FailedToHandleSessionTimeoutWarning="failedToHandleSessionTimeoutWarning",i.FailedAuthenticationUpdatedTicketWarning="failedAuthenticationUpdatedTicketWarning",i.MicroappsNotDefinedSpaceIDWarning="microappsNotDefinedSpaceIDWarning",i.MicroAppsNotLoadedAuthTimeout="microAppsNotLoadedAuthTimeout",i.FailedMicroappsConfigurationWarning="FailedMicroappsConfigurationWarning",i.FailedRetrieveEntitlementForProfileWarning="failedRetrieveEntitlementForProfileWarning",i.FailedSetShellErrorWarning="failedSetShellErrorWarning",i.FailedGetShellErrorWarning="failedGetShellErrorWarning",i.FailedClearShellErrorWarning="failedClearShellErrorWarning",i.FailedFeatureSupportRequestWarning="failedFeatureSupportRequestWarning",i.FailedLoadUserIdWarning="failedLoadUserIdWarning",i.FailedInteractionRegistrationWarning="failedInteractionRegistrationWarning",i.FailedInteractionClearingWarning="failedInteractionClearingWarning",i.MicroappNotActiveWarning="microappNotActiveWarning",i.FailedDeactivationMicroappWarning="failedDeactivationMicroappWarning",i.AuthenticationMicroappNotAvailableWarning="authenticationMicroappNotAvailableWarning",i.AuthenticationPluginNotAvailableWarning="authenticationPluginNotAvailableWarning",i.ActiveMicroappNotDefinedWarning="activeMicroappNotDefinedWarning",i.FailedHandlingLegacyClientNotificationWarning="failedHandlingLegacyClientNotificationWarning",i.UnsupportedLegacyClientNotificationWarning="unsupportedLegacyClientNotificationWarning",i.ReceivedInvalidPlayerNotificationWarning="receivedInvalidPlayerNotificationWarning",i.FailedOpeningPlayerNotificationWarning="failedOpeningPlayerNotificationWarning",i.FailedWebsocketNotificationsUrlConfigurationWarning="failedWebsocketNotificationsUrlConfigurationWarning",i.FailedClosingWebsocketWarning="failedClosingWebsocketWarning",i.FailedUpdatingPlayerNotificationConnectionWarning="failedUpdatingPlayerNotificationConnectionWarning",i.FailedCloseCallbackModalWarning="failedCloseCallbackModalWarning",i.InitialMicroappUnavailableWarning="InitialMicroappUnavailableWarning",i.ConfiguredPlacementUnavailableForMicroappWarning="ConfiguredPlacementUnavailableForMicroappWarning",i.UnavailableParentMicroappWarning="unavailableParentMicroappWarning",i.CannotNavigateOfflineModeWarning="cannotNavigateOfflineModeWarning",i.RequestedMicroappUnavailable="requestedMicroappUnavailable",i.MicroappSwitchUnavailableExclusiveModeWarning="microappSwitchUnavailableExclusiveModeWarning",i.InvalidSessionUpdateWarning="invalidSessionUpdateWarning",i.FailedFlushLogTrackingOnLogoutWarning="failedFlushLogTrackingOnLogoutWarning",i.FailedFlushLogTrackingOnHostShutdown="failedFlushLogTrackingOnHostShutdown",i.FailedFlushLogTrackingOnRefreshView="failedFlushLogTrackingOnRefreshView",i.FailedFetchLastPlayedDataWarning="failedFetchLastPlayedDataWarning",i.FailedLoadGameIconOrUserLevelOrAvatarWarning="failedLoadGameIconOrUserLevelOrAvatarWarning",i.FailedFetchShellSpaceConfigurationWarning="failedFetchShellSpaceConfigurationWarning",i.FailedNavigateDefaultMicroappOrOpenPNOTConnectionWarning="failedNavigateDefaultMicroappOrOpenPNOTConnectionWarning",i.FailedLoadPlayerEntitlementsUbisoftPlusStatusOrWalletStatusWarning="failedLoadPlayerEntitlementsUbisoftPlusStatusOrWalletStatusWarning",i.MicroappExclusiveModeAlreadyWarning="microappExclusiveModeAlreadyWarning",i.ExclusiveModeNotSupportedForPlatformWarning="exclusiveModeNotSupportedForPlatformWarning",i.MicroappNotInExclusiveModeWarning="microappNotInExclusiveModeWarning",i.FailedGetIpLocationWarning="failedGetIpLocationWarning",i.FailedLoadingManifestWarning="failedLoadingManifestWarning",i.ManifestIcorrectFormatWarning="manifestIncorrectFormatWarning",i.FailedNavigationToMicroappFromAccessbarWarning="failedNavigationToMicroappFromAccessbarWarning",i.FailedFocusUnregisteredPlacementContainerWarning="failedFocusUnregisteredPlacementContainerWarning",i.UnableToMoveFocusToContainerWarning="unableToMoveFocusToContainerWarning",i.FailedFocusMicroappInContainerWarning="failedFocusMicroappInContainerWarning",i.FailedFetchSubscriptionStatusWarning="failedFetchSubscriptionStatusWarning",i.FailedFetchWalletStatusWarning="failedFetchWalletStatusWarning",i.ServiceworkerFailedDefinitionIncorrectNotificationWarning="ServiceworkerFailedDefinitionIncorrectNotificationWarning",i.ServiceworkerFailedManifestIncorrectNotificationWarning="ServiceworkerFailedManifestIncorrectNotificationWarning",i.FailedNavigationIncorrectSpaceConfigurationWarning="failedNavigationIncorrectSpaceConfigurationWarning",i.FailedParentNavigationRuntimeContextIsNotSynced="failedParentNavigationRuntimeContextIsNotSyncedWarning",i.CannotNavigateToMicroappInExclusiveModeWarning="cannotNavigateToMicroappInExclusiveModeWarning",i.InvalidPlayerNotificationsConfigurationWarning="invalidPlayerNotificationsConfigurationWarning",i.RuntimeContextCallbackErrorForMicroappWarning="runtimeContextCallbackErrorForMicroappWarning",i.FailedToCreateMicroappMissingAppIDWarning="failedToCreateMicroappMissingAppIDWarning",i.FailedCallFromMicroappAfterAPIDisposedWarning="failedCallFromMicroappAfterAPIDisposedWarning",i.FailedCallFromMicroappAfterDeactivationWarning="failedCallFromMicroappAfterDeactivationWarning",i.FailedCallFromMicroappDuringNavigationWarning="failedCallFromMicroappDuringNavigationWarning",i.FailedCallFromMicroappNotAllowedOnHostPlatformWarning="failedCallFromMicroappNotAllowedOnHostPlatformWarning",i.CannotSetEmptySessionWarning="cannotSetEmptySessionWarning",i.FirstPartyAuthenticationTokenMissingWarning="firstPartyAuthenticationTokenMissingWarning",i.ErrorInRequestHandlerInPluginWarning="errorInRequestHandlerInPluginWarning",i.PlatformTypeNotSupportedWarning="platformTypeNotSupportedWarning",i.NoParentWindowWarning="noParentWindowWarning",i.FailedQueryConfigurationServiceWarning="failedQueryConfigurationServiceWarning",i.FailedLoadLocalizationWarning="failedLoadLocalizationWarning",i.MissingMicroappMountInDOMWarning="missingMicroappMountInDOMWarning",i.InvalidPlatformForMobileAuthenticationWarning="invalidPlatformForMobileAuthenticationWarning",i.FailedAuthenticationWithAuthenticationSDKWarning="failedAuthenticationWithAuthenticationSDKWarning",i.FailedTokenGenerationWarning="failedTokenGenerationWarning",i.FailedUserAuthenticationWarning="failedUserAuthenticationWarning",i.FailedUserCredentialsVerificationWarning="failedUserCredentialsVerificationWarning",i.UserSessionExpiredWarning="userSessionExpiredWarning",i.FetchTicketFromHostFailedWarning="fetchTicketFromHostFailedWarning",i.FailedRetrieveTokenWarning="failedRetrieveTokenWarning",i.FailedNavigationChildWindowWarning="failedNavigationChildWindowWarning",i.FailedChildWindowCreationWarning="failedChildWindowCreationWarning",i.FailedWebViewCommunicationSetupWarning="failedWebViewCommunicationSetupWarning",i.FailedCommunicationSetupWarning="failedCommunicationSetupWarning",i.FailedChildWindowCommunicationSetupWarning="failedChildWindowCommunicationSetupWarning",i.FailedChildWindowCommunicationWarning="failedChildWindowCommunicationWarning",i.FailedChildWindowCommunicationChildClosedWarning="failedChildWindowCommunicationChildClosedWarning",i.BaseLifeGuardWarning="baseLifeGuardWarning",i.FailedToActivateNativeMicroAppWarning="failedToActivateNativeMicroAppWarning",i.FailedToDeactivateNativeMicroAppWarning="failedToDeactivateNativeMicroAppWarning",i.FailedToShowNativeMicroappWarning="failedToShowNativeMicroappWarning",i.PlayerNotificationObserverCallbackWarning="playerNotificationObserverCallbackWarning",i.ServiceWorkerNotAvailableWarning="serviceWorkerNotAvailableWarning",i.ServiceWorkerDisabledWarning="serviceWorkerDisabledWarning",i.EnableServiceWorkerFailedWarning="enableServiceWorkerFailedWarning",i.ServiceWorkerIncorrectOriginWarning="serviceWorkerIncorrectOriginWarning",i.ServiceWorkerIncorrectMessageWarning="serviceWorkerIncorrectMessageWarning",i.ServiceWorkerErrorMessageWarning="serviceWorkerErrorMessageWarning",i.ServiceWorkerQuotaErrorWarning="serviceWorkerQuotaErrorWarning",i.ServiceWorkerOpaqueRequestWarning="serviceWorkerOpaqueRequestWarning",i.ServiceWorkerIncorrectManifestWarning="serviceWorkerIncorrectManifestWarning",i.ServiceWorkerIncorrectDataEntriesWarning="serviceWorkerIncorrectDataEntries",i.ServiceWorkerCantPreWarmWarning="serviceWorkerCantPreWarmWarning",i.ServiceWorkerCantIdentifyStrategyWarning="serviceWorkerCantIdentifyStrategyWarning",i.ServiceWorkerErrorProssingAuthTicketWarning="serviceWorkerErrorProssingAuthTicketWarning",i.ServiceWorkerQuotaLimitWarning="ServiceWorkerQuotaLimitWarning",i.ServiceWorkerIncorrectDefinitionWarning="ServiceWorkerIncorrectDefinitionWarning",i.ApolloCacheCreateFailedWarning="apolloCacheCreateFailedWarning",i.ApolloCacheUnsupportedRequestWarning="apolloCacheUnsupportedRequestWarning",i.CacheServiceUnsupportedRequestWarning="cacheServiceUnsupportedRequestWarning",i.FailedToTriggerDesktopNotification="failedToTriggerDesktopNotification",i.FeatureHandlerAlreadyRegisteredWarning="featureHandlerAlreadyRegisteredWarning",i.UnableToHandleFeaturedWarning="unableToHandleFeaturedWarning",i.UnableToAddHistoryRecordWarning="unableToAddHistoryRecordWarning",i.UnableToAddHistoryRecordMissingCfgWarning="unableToAddHistoryRecordMissingCfgWarning",i.UnableToNavigateToAppMissingCfgWarning="unableToNavigateToAppMissingCfgWarning",i.UnableToNavigateToAppNoSessionError="unableToNavigateToAppNoSessionError",i.UnableToDeepLinkNavigateToAppMissingCfgWarning="unableToDeepLinkNavigateToAppMissingCfgWarning",i.UnableToDeepLinkNavigateToAppNoSession="unableToDeepLinkNavigateToAppNoSession",i.UnableToNavigateToAppWarning="unableToNavigateToAppWarning",i.UnableToSwitchToExlusiveModeMissingCfgWarning="unableToSwitchToExlusiveModeMissingCfgWarning",i.UnableToUpdateSessionInvalidTicketWarning="unableToUpdateSessionInvalidTicketWarning",i.DisplayScalingServiceAlreadyInitializedWarning="displayScalingServiceAlreadyInitializedWarning",i.UnableToCloseWebsocketWarning="unableToCloseWebsocketWarning",i.UnableToGetWebsocketUrlMissingSessionWarning="unableToGetWebsocketUrlMissingSessionWarning",i.UnableToContructWebsocketUrlWarning="unableToContructWebsocketUrlWarning",i.MissingPluginLifeguardFactory="missingPluginLifeguardFactory",i.WebsocketErrorEventWarning="websocketErrorEventWarning",i.WebsocketClosedUnexpectedlyWarning="websocketClosedUnexpectedlyWarning",i.WebsocketMaxRetryAttemptsReachedWarning="websocketMaxRetryAttemptsReachedWarning",i.WebsocketUnableToInitializeConnectionWarning="websocketUnableToInitializeConnectionWarning",i.AegirTransportCannotProcessMessageWarning="aegirTransportCannotProcessMessageWarning",i.AegirTransportCannotSendMalformedMessageWarning="aegirTransportCannotSendMalformedMessageWarning",i.AegirTransportNotSupportedWarning="aegirTransportNotSupportedWarning",i.AegirTransportUnableToConvertMessageWarning="aegirTransportUnableToConvertMessageWarning",i.AegirTransportTransformationNotSetForNotificationWarning="aegirTransformationNotSetForNotificationeWarning",i.AegirTransportWindowMethodNotDefinedWarning="aegirWindowMethodNotDefined",i.AegirTransportInvalidMessageIdWarning="aegirTransportInvalidMessageId",i.AegirTransportMessageNotSetWarning="aegirTransportMessageNotSet",i.RemoteLogsQueueFailedToConfigureWarning="remoteLogsQueueFailedToConfigureWarning",i.RemoteLogsQueueFailedToConfigureMissingOutputParamsWarning="remoteLogsQueueFailedToConfigureMissingOutputParamsWarning",i.RemoteLogsQueueFailedToConfigureMissingOutputUrlWarning="remoteLogsQueueFailedToConfigureMissingOutputUrlWarning",i.PerformanceStartMarkMissingWarning="performanceStartMarkMissingWarning",i.PerformanceEndMarkMissingWarning="performanceEndMarkMissingWarning",i.PerformanceNegativeTimingWarning="performanceNegativeTimingWarning",i.PerformanceMeasurementAlreadyInProgressWarning="performanceMeasurementAlreadyInProgressWarning",i.PerformanceMeasurementNoActiveMeasurementWarning="performanceMeasurementNoActiveMeasurementWarning",i.PerformanceMeasurementAlreadyMeasuredWarning="performanceMeasurementAlreadyMeasuredWarning",i.PerformancePromisePolyfillMissingWarning="performancePromisePolyfillMissingWarning",i.PerformanceMarkOrderWrongWarning="performanceMarkOrderWrongWarning",i.PerformanceFailedToAddMarkWarning="performanceFailedToAddMarkWarning",i.PerformanceFailedToMeasureWarning="performanceFailedToMeasureWarning",i.GameInvitesEventCallbackErrorWarning="gameInvitesEventCallbackErrorWarning",i.GamepadManagerErrorWarning="gamepadManagerErrorWarning",i.GamepadEventErrorWarning="gamepadEventErrorWarning",i.InputDeviceBrandDeviceTypeNotFoundWarning="inputDeviceBrandDeviceTypeNotFoundWarning",i.InputDeviceTypeNotFoundWarning="inputDeviceTypeNotFoundWarning",i.InputDevicePlatformTypeDeviceTypeNotFoundWarning="inputDevicePlatformTypeDeviceTypeNotFoundWarning",i.NavigationMethodDefaultMethodNotFoundWarning="navigationMethodDefaultMethodNotFoundWarning",i.NavigationMethodInputEventMethodMapForPlatformNotFoundWarning="navigationMethodInputEventMethodMapForPlatformNotFoundWarning",i.NavigationMethodInputEventMethodMapNotFoundWarning="navigationMethodInputEventMethodMapNotFoundWarning",i.NavigationMethodDisplayModeUndefinedWarning="navigationMethodDisplayModeUndefinedWarning",i.NavigationMethodInputEventMethodMapForDisplayModeNotFoundWarning="navigationMethodInputEventMethodMapForDisplayModeNotFoundWarning",i.LocalizationProviderUnsupportedLanguageCodeWarning="localizationProviderUnsupportedLanguageCodeWarning",i.LocalizationProviderNoMessagesForLanguageWarning="localizationProviderNoMessagesForLanguageWarning",i.LocalizationProviderCantLoadMessagesForLanguageWarning="localizationProviderCantLoadMessagesForLanguageWarning",i.TeleportNoTargetWarning="teleportNoTargetWarning",i.WindowFrameUnableToGetStateWarning="windowFrameUnableToGetStateWarning",i.WindowFrameUnableToSetStateWarning="windowFrameUnableToSetStateWarning",i.FailedOpenExternalLinkWithWindowOpen="failedOpenExternalLinkWithWindowOpen",i.FailedOpenExternalLinkPlatformNotSupported="failedOpenExternalLinkPlatformNotSupported",i.FailedToUpdateApi="failedToUpdateApi",i.ConnectionStatusListenerExecutionFailureWarning="connectionStatusListenerExecutionFailureWarning",i.WebsocketConnectionUpdateMissingSessionWarning="websocketConnectionUpdateMissingSessionWarning",i.HttpClientNetworkError="httpClientNetworkError",i.MissingAuthenticationApiError="missingAuthenticationApiError",i.FailedToSetRemoteMetricFilterCategories="failedToSetRemoteMetricFilterCategories",i.FailedFetchAuthenticationError="failedFetchAuthenticationError",i.FailedFetchMicroAppConfigError="failedFetchMicroAppConfigError",i.FailedToStoreVisitorIdError="failedToStoreVisitorIdError",i.FailedFetchStreamingGuestsAvatarsError="failedFetchStreamingGuestsAvatarsError",i.Dolphin_0="dolphin-000",i.Dolphin_1="dolphin-001",i.Dolphin_2="dolphin-002",i.Dolphin_3="dolphin-003",i.Dolphin_4="dolphin-004",i.Dolphin_5="dolphin-005",i.Dolphin_6="dolphin-006",i.Dolphin_7="dolphin-007",i.Dolphin_8="dolphin-008",i.Dolphin_9="dolphin-009",i.Dolphin_10="dolphin-010",i.Dolphin_11="dolphin-011",i.Dolphin_12="dolphin-012",i.Dolphin_13="dolphin-013",i.Dolphin_14="dolphin-014",i.Dolphin_15="dolphin-015",i.Dolphin_16="dolphin-016",i.Dolphin_17="dolphin-017",i.Dolphin_18="dolphin-018",i.Dolphin_19="dolphin-019",i.Dolphin_20="dolphin-020",i.Dolphin_21="dolphin-021",i.Dolphin_22="dolphin-022",i.Dolphin_23="dolphin-023",i.Dolphin_24="dolphin-024",i.Dolphin_25="dolphin-025",i.Dolphin_26="dolphin-026",i.Dolphin_27="dolphin-027",i.Dolphin_28="dolphin-028",i.Dolphin_29="dolphin-029",i.Dolphin_30="dolphin-030",i.Dolphin_31="dolphin-031",i.Dolphin_32="dolphin-032",i.Dolphin_33="dolphin-033",i.Dolphin_34="dolphin-034",i.Dolphin_35="dolphin-035",i.Dolphin_36="dolphin-036",i.Dolphin_37="dolphin-037",i.Dolphin_38="dolphin-038",i.Jellyfish_001="Jellyfish_001",i.Jellyfish_002="Jellyfish_002",i.Jellyfish_003="Jellyfish_003",i.Jellyfish_004="Jellyfish_004",i.Jellyfish_005="Jellyfish_005",i.Jellyfish_033="Jellyfish_033",i))(g||{}),_t=(i=>(i.default="default",i.pcClient="pc-client",i.child="child",i))(_t||{});const Es={default:[B.main],"pc-client":[B.main,B.side,B.modal,B.accessEnd],child:[B.main]};var Bi=(i=>(i.LegacyCompanionApp="legacyCompanionApp",i.CompanionApp="companionApp",i))(Bi||{}),p=(i=>(i.PS4="ps4",i.PS4Aegir="ps4-aegir",i.PS4AegirNative="ps4-aegir-native",i.PS5="ps5",i.PS5Aegir="ps5-aegir",i.PS5AegirNative="ps5-aegir-native",i.PCWebOverlay="pc-web-overlay",i.PCLegacyOverlay="pc-legacy-overlay",i.PCElectronOverlay="pc-electron-overlay",i.PCLegacyClient="pc-legacy-client",i.PCElectronClient="pc-electron-client",i.PCWebClient="pc-web-client",i.Web="web",i.WebEmbedded="web-embedded",i.Mobile="mobile",i.Scarlett="scarlett",i.ScarlettAegir="scarlett-aegir",i.ScarlettAegirNative="scarlett-aegir-native",i.ScarlettUWP="scarlett-uwp",i.ScarlettUWPWebView2="scarlett-uwp-webview2",i.XONE="xone",i.XoneUWP="xone-uwp",i.XoneUWPWebView2="xone-uwp-webview2",i.XOneAegir="xone-aegir",i.XOneAegirNative="xone-aegir-native",i.IOS="ios",i.Android="android",i.Luna="luna",i.SteamOverlay="steam-overlay",i.SteamClient="steam-client",i.MacOS="macos",i.MacOSAegir="macos-aegir",i.MacOSAegirNative="macos-aegir-native",i.CompanionAppIOS="companion-app-ios",i.CompanionAppAndroid="companion-app-android",i.CompanionAppMobile="companion-app-mobile",i.Switch="switch",i))(p||{});function Y2(){return new URL(location.href).pathname}var Qs=(i=>(i.RegisterManifestNotification="Shell.RegisterManifestNotification",i.RegisterCacheDefinitionsNotification="Shell.RegisterCacheDefinitionsNotification",i.UnRegisterCacheDefinitionsNotification="Shell.UnRegisterCacheDefinitionsNotification",i.SkipWaitingNotification="Shell.SkipWaitingNotification",i.UpdateUserSessionDataNotification="Shell.UpdateUserSessionDataNotification",i.ResetDataNotification="Shell.ResetDataNotification",i.CacheOpaqueRequestsNotification="Shell.CacheOpaqueRequests",i.SetOffline="Shell.SetOffline",i))(Qs||{}),Md=(i=>(i.ControllerChange="ServiceWorker.ControllerChange",i.LogMessage="ServiceWorker.LogMessage",i.PrecacheProgressNotification="ServiceWorker.PrecacheProgress",i))(Md||{});class GS extends Fc(Md.ControllerChange){}var Z2=Object.defineProperty,eU=Object.getOwnPropertyDescriptor,Ad=(i,e,t,s)=>{for(var a=s>1?void 0:s?eU(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Z2(e,t,a),a},ht;const Qc=(ht=class extends Lc{constructor(e,t,s=navigator.serviceWorker){if(super(),this._logger=e,this._runtimeParameters=t,this._serviceWorkerContainer=s,ht.noServiceWorker=[m.XONE,m.Scarlett,m.PS4,m.PS5].includes(this._runtimeParameters.platformType)||this._runtimeParameters.noServiceWorker||!1,!ht.platformSupported()){this._logger.warn("Service worker is not available!",{errorCode:g.ServiceWorkerNotAvailableWarning}),ht.noServiceWorker=!0;return}ht.isAvailable()?(this._serviceWorkerContainer.addEventListener("message",this.onMessage),this._serviceWorkerContainer.addEventListener("controllerchange",this.onControllerChange),this._serviceWorkerContainer.addEventListener("messageerror",this.onError)):this._logger.warn("Service worker is disabled!",{errorCode:g.ServiceWorkerDisabledWarning}),ht.noServiceWorker?this.disableServiceWorker():this.enableServiceWorker()}async disableServiceWorker(){if(ht.platformSupported()){const e=await this._serviceWorkerContainer.getRegistrations();e.length>0&&(await Promise.all(e.map(s=>s.unregister())),new URL(this._runtimeParameters.fullUrl).searchParams.set("noServiceWorker","true"),this._logger.warn("Disabling service worker"))}}async enableServiceWorker(){const e=Y2();if(ht.platformSupported())try{await this._serviceWorkerContainer.register("".concat(e,"service-worker.js"))}catch(t){this._logger.warn("Fail to register service worker",{error:t,errorCode:g.EnableServiceWorkerFailedWarning})}}onControllerChange(e){this._logger.debug("Controller change event from service worker",{event:e}),this.onNotification(new GS)}onMessage(e){if(this._logger.debug("Event from service worker",{event:e}),!("origin"in e)||e.origin!==window.location.origin){this._logger.warn("Incorrect message origin",{errorCode:g.ServiceWorkerIncorrectOriginWarning});return}const t=e.data;if(!t||!t.hostNotificationName){this._logger.warn("Incorrect message from service worker",{event:e,errorCode:g.ServiceWorkerIncorrectMessageWarning});return}this.onNotification(t)}onError(e){this._logger.warn("Message error from service worker",{event:e,errorCode:g.ServiceWorkerErrorMessageWarning})}async sendNotification(e){var t;(t=this._serviceWorkerContainer.controller)==null||t.postMessage(e)}async sendRequest(e){throw new Error("Method not implemented.")}sendResponse(e,t){throw new Error("Method not implemented.")}cancelRequest(e){throw new Error("Method not implemented.")}static isAvailable(){return ht.noServiceWorker===!1&&ht.platformSupported()}static platformSupported(){return"serviceWorker"in navigator}canSendNotification(){return ht.isAvailable()}canSendRequest(){return!1}canSendResponse(){return!1}canCancelRequest(){return!1}},ht.noServiceWorker=!1,ht);Ad([_()],Qc.prototype,"onControllerChange",1);Ad([_()],Qc.prototype,"onMessage",1);Ad([_()],Qc.prototype,"onError",1);let Wo=Qc;const Gr=1e3,bi=20*Gr,Vp=Gr,Ht=60*Gr,Vo=30*Ht,Ls=3*Gr;var tU=Object.defineProperty,iU=Object.getOwnPropertyDescriptor,jc=(i,e,t,s)=>{for(var a=s>1?void 0:s?iU(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&tU(e,t,a),a};class S extends oe("RuntimeContextState"){constructor(e,t,s,a,n){super(),this._inputDeviceType=t,this._navigationMethod=s,this._subContexts=n,this._playerSession=void 0,this._initialSessionSet=!1,this._isOfflineSession=!1,this._isSynced=!1,this._focusedMicroApp=null,this._defaultMicroApp=null,this._authInProgress=!1,this._initialPostAuthIntentDeferred=new yt,this._initialLoadMicroAppConfigDeferred=new yt,this._readyToAcceptNavigationRequest=new yt,this._navigateToLoginWithRetryDeferred=new yt,this._authIsDoneDeferred=new yt,this._sdkVersion=e.sdkVersion,this._environment=e.environment,this._platformType=e.platformType,this._displayMode=e.displayMode,this._deviceType=e.deviceType,this._orientation=e.orientation,this._playerLocale=e.playerLocale,this._country=e.country,this._hostGame={applicationId:e.hostAppId,spaceId:e.hostSpaceId},this._ticket=e.ticket,this._theme=e.theme,this._activeGame={spaceId:e.activeGameSpaceId||e.hostSpaceId,applicationId:e.activeGameAppId||e.hostAppId},this._isStandalone=e.isStandalone,this._platformAttributes={isStandaloneUwp:e.isStandalone&&e.isUWP,isStandalone:e.isStandalone,isUwp:e.isUWP,isPs4Crossgen:e.isPs4Crossgen,xOneSdk:e.xOneSdkType,osVersion:e.osVersion},this._isUWP=e.isUWP,this._mobileCompanionAppType=e.mobileCompanionAppType,this._isChild=!!e.childId,this._childId=e.childId,this._region=e.region,this._isExclusiveMode=e.isExclusiveMode,this._isOnMobile=[m.Android,m.IOS,m.Mobile].includes(this._platformType),this._isOverlayVisible=!this._isOnMobile||e.mobileCompanionAppType!==Bi.LegacyCompanionApp,this._platformVariant=e.platformVariant,this._hostPlatformType=e.hostPlatformType,this._deviceId=e.deviceId,this._deviceName=e.deviceName,this._hostVersion=e.hostVersion,this._shellSpaceId=a.shellSpaceId,this._shellCrossPlatformSpaceId=a.shellCrossPlatformSpaceId,this._shellApplicationId=a.shellApplicationId,this._ownershipGroup=e.ownershipGroup,this._isOfflineSession=!!e.isOffline}get authInProgress(){return this._authInProgress}set authInProgress(e){this._authInProgress=e}get authIsDone(){return this._authIsDoneDeferred.promise}clearAuthIsDone(){this._authIsDoneDeferred.resolve(),this._authIsDoneDeferred=new yt}get region(){return this._region}get shouldRevertExitAndBackButton(){return[p.XONE,p.Scarlett].includes(this._hostPlatformType)}get childId(){return this._childId}get isUWP(){return this._isUWP}get mobileCompanionAppType(){return this._mobileCompanionAppType}get isChild(){return this._isChild}get isStandalone(){return this._isStandalone}get isExclusiveMode(){return this._isExclusiveMode}set isExclusiveMode(e){this._isExclusiveMode=e}get platformType(){return this._platformType}get layoutType(){return this._isChild?_t.child:this._isStandalone&&[m.PC,m.Steam].includes(this._platformType)?_t.pcClient:_t.default}get playerLocale(){return this._playerLocale}get sdkVersion(){return this._sdkVersion}get environment(){return this._environment}get displayMode(){return this._displayMode}get deviceType(){return this._deviceType}get isOnMobile(){return this._isOnMobile}get isMobileGameOverlay(){return this.isOnMobile&&!this.isStandalone}get isDesktopApp(){return[m.PC,m.Steam].includes(this.platformType)&&(this.isStandalone||!!window.native)}get country(){return this._country}set country(e){this._country=e}isHostGameSet(){return this._hostGame.spaceId.length>0&&this._hostGame.applicationId.length>0}get hostGame(){return this._hostGame}set hostGame(e){this._hostGame=e}get ticket(){return this._ticket}get orientation(){return this._orientation}set orientation(e){this._orientation=e}get activeGame(){return this._activeGame}set activeGame(e){this._activeGame=e}get focusedMicroApp(){return this._focusedMicroApp||void 0}set focusedMicroApp(e){this._focusedMicroApp=e||null}get defaultMicroApp(){return this._defaultMicroApp||void 0}set defaultMicroApp(e){this._defaultMicroApp=e||null}get deviceId(){return this._deviceId}set deviceId(e){this._deviceId=e}get deviceName(){return this._deviceName}set deviceName(e){this._deviceName=e}get hostVersion(){return this._hostVersion}set hostVersion(e){this._hostVersion=e}get playerSession(){return this._playerSession}wipeDefaultMicroapp(){this.defaultMicroApp=void 0}setPlayerSession(e){this._playerSession=e,e?this._authIsDoneDeferred.resolve():this.initialSessionSet&&(this._authIsDoneDeferred=new yt)}syncState(e){this._playerSession=e.playerSession,this._initialSessionSet=!0,this._authIsDoneDeferred.resolve(),this._readyToAcceptNavigationRequest.resolve(),this._ticket=e.ticket,this._activeGame||(this._activeGame=e.activeGame),(!this._hostGame||this._hostGame!==e.hostGame)&&(this._hostGame=e.hostGame),this._playerLocale!==e.playerLocale&&(this._playerLocale=e.playerLocale),this._country!==e.country&&(this._country=e.country),this._theme!==e.theme&&(this._theme=e.theme),this._inputDeviceType!==e.inputDeviceType&&(this._inputDeviceType=e.inputDeviceType),this._navigationMethod!==e.navigationMethod&&(this._navigationMethod=e.navigationMethod),this._isSynced||(this._sdkVersion=e.sdkVersion,this._environment=e.environment,this._platformType=e.platformType,this._platformVariant=e.platformVariant,this._displayMode=e.displayMode,this._deviceType=e.deviceType,this._isStandalone=e.platformAttributes.isStandalone,this._isOverlayVisible=e.isOverlayVisible,this._platformAttributes=e.platformAttributes,this._isUWP=e.platformAttributes.isUwp,this._isOfflineSession=e.isOfflineSession,this._shellApplicationId=e.shellApplicationId,this._shellCrossPlatformSpaceId=e.shellCrossPlatformSpaceId,this._shellApplicationId=e.shellApplicationId,this._ownershipGroup=e.ownershipGroup,this._isSynced=!0)}get initialSessionSet(){return this._initialSessionSet}set initialSessionSet(e){this._initialSessionSet=e}get playerSessionOrThrow(){if(!this._playerSession)throw new Error("Session is not set");return this._playerSession}get profileId(){var e;return(e=this._playerSession)==null?void 0:e.profileId}get theme(){return this._theme}set theme(e){this._theme=e}get isOverlayVisible(){return this._isOverlayVisible}set isOverlayVisible(e){this._isOverlayVisible=e}get inputDeviceType(){return this._inputDeviceType}set inputDeviceType(e){this._inputDeviceType=e}get navigationMethod(){return this._navigationMethod}set navigationMethod(e){this._navigationMethod=e}get xOneSdk(){return this._platformAttributes.xOneSdk}get platformVariant(){return this._platformVariant}get hostPlatformType(){return this._hostPlatformType}get runtimeContext(){let e;const t=this._focusedMicroApp||this._defaultMicroApp;return t&&(e={appName:t.appName,meta:t.meta}),{sdkVersion:this._sdkVersion,environment:this._environment,platformType:this._platformType,platformVariant:this._platformVariant,displayMode:this._displayMode,deviceType:this._deviceType,orientation:this._orientation,playerLocale:this._playerLocale,country:this._country,shellApplicationId:this._shellApplicationId,shellSpaceId:this._shellSpaceId,shellCrossPlatformSpaceId:this._shellCrossPlatformSpaceId,hostSpaceId:this._hostGame.spaceId,hostAppId:this._hostGame.applicationId,ticket:this._ticket,hostGame:this._hostGame,activeGame:this._activeGame,activeGameSpaceId:this._activeGame.spaceId,activeGameAppId:this._activeGame.applicationId,activeMicroApp:e,playerSession:this._playerSession,theme:this._theme,isOverlayVisible:this._isOverlayVisible,inputDeviceType:this._inputDeviceType,navigationMethod:this._navigationMethod,platformAttributes:this._platformAttributes,isNetworkConnected:this._subContexts.connectionStatusState.isNetworkConnected,isOnline:this.isOnline,isOfflineSession:this._isOfflineSession,region:this._region,playerNotificationsConnectionState:this._subContexts.connectionStatusState.playerNotificationsConnectionState,deviceId:this._deviceId,deviceName:this._deviceName,hostVersion:this._hostVersion,ownershipGroup:this._ownershipGroup}}get isOnline(){return!this._isOfflineSession&&this._subContexts.connectionStatusState.isNetworkConnected}get isOfflineSession(){return this._isOfflineSession}set isOfflineSession(e){this._isOfflineSession=e}get completelyOffline(){return!this.isOnline&&!Wo.isAvailable()}get shellSpaceId(){return this._shellSpaceId}set shellSpaceId(e){this._shellSpaceId=e}get shellApplicationId(){return this._shellApplicationId}set shellApplicationId(e){this._shellApplicationId=e}get shellCrossPlatformSpaceId(){return this._shellCrossPlatformSpaceId}set shellCrossPlatformSpaceId(e){this._shellCrossPlatformSpaceId=e}get isPlayerSessionValidAfterThirtyMinutes(){return this.playerSession?new Date(this.playerSession.expiration).valueOf()-Date.now()>Vo:!1}set ownershipGroup(e){this._ownershipGroup=e}get ownershipGroup(){return this._ownershipGroup}get initialPostAuthIntentDeferred(){return this._initialPostAuthIntentDeferred}get initialLoadMicroAppConfigDeferred(){return this._initialLoadMicroAppConfigDeferred}get readyToAcceptNavigationRequest(){return this._readyToAcceptNavigationRequest}setReadyToAcceptNavigationRequest(){this._readyToAcceptNavigationRequest.resolve()}get navigateToLoginWithRetryDeferred(){return this._navigateToLoginWithRetryDeferred}}jc([P],S.prototype,"clearAuthIsDone",1);jc([P],S.prototype,"wipeDefaultMicroapp",1);jc([P],S.prototype,"setPlayerSession",1);jc([P],S.prototype,"syncState",1);class xS extends Sx{constructor(e,t,s){super(),this._shellApplicationId=e,this._applicationId=t,this._ubiMockScenario=s}getDefaultHeaders(){var e;return new Headers(this.mergeHeaders(super.getDefaultHeaders(),{[Go.UbiAppId]:(e=this._applicationId)!=null?e:this._shellApplicationId,[Go.PlatformAppId]:this._shellApplicationId,...this._ubiMockScenario&&{"Ubi-Mock-Scenario":this._ubiMockScenario}}))}}class sU extends xS{constructor(e,t,s,a){super(t,s,a),this._store=e,this._shellApplicationId=t,this._applicationId=s,this._ubiMockScenario=a}getDefaultHeaders(){const s=this._store.get().getReadonlyState(S).playerSessionOrThrow;return new Headers(this.mergeHeaders(super.getDefaultHeaders(),{[Go.UbiSessionId]:s.sessionId,[Go.Authorization]:"ubi_v1 t=".concat(s.ticket)}))}}class aU{constructor(e,t,s){this._shellApplicationId=e,this._store=t,this._ubiMockScenario=s,this._httpClient=this.getUbiHttpClient(this._shellApplicationId),this._authenticatedHttpClient=this.getAuthenticatedUbiHttpClient(this._shellApplicationId)}setupErrorLogging(e){this._logger=e,this._httpClient=this.withErrorLogging(this._httpClient,e),this._authenticatedHttpClient=this.withErrorLogging(this._authenticatedHttpClient,e)}withErrorLogging(e,t){return e.addEventListener(wx.error,s=>{var n,r,o;const a="".concat(g.HttpClientNetworkError,": ").concat((n=s.options)==null?void 0:n.method," ").concat(s.url);t.error(a,{errorCode:a,error:s.error instanceof Error?s.error.message:s.error,moreInfo:{url:s.url,method:(r=s.options)==null?void 0:r.method,mode:(o=s.options)==null?void 0:o.mode,duration:s.duration}})}),e}getAuthenticatedUbiHttpClient(e){if(!e)return this._authenticatedHttpClient;const t=new sU(this._store,this._shellApplicationId,e,this._ubiMockScenario);return this._logger?this.withErrorLogging(t,this._logger):t}getBasicHttpClient(){const e=new bx;return this._logger?this.withErrorLogging(e,this._logger):e}getUbiHttpClient(e){if(!e)return this._httpClient;const t=new xS(this._shellApplicationId,e,this._ubiMockScenario);return this._logger?this.withErrorLogging(t,this._logger):t}}class nU{constructor(e){this._store=e}get(){return this._store||(this._store=new Cx),this._store}}const mp="shell-authentication-redirect-data",yo="shell-authentication-callback-parameter",vo="shell-authentication-multiple-callback-parameters";class Pd{constructor(e){this._localStorageService=e}saveAuthenticationData(e,t,s){this._localStorageService.setObjectSync(mp,e),t?(this._localStorageService.setValue(yo,t),this._localStorageService.deleteValue(vo)):s&&(this._localStorageService.setObjectSync(vo,s),this._localStorageService.deleteValue(yo))}retrieveAuthenticationRedirectData(){const e=this._localStorageService.getObject(mp);return e&&this._localStorageService.deleteValue(mp),e}peekCallbackParameterValue(e){return this.retrieveCallbackParameterValue(e,!0)}retrieveCallbackParameterValue(e,t=!1){const s=this._localStorageService.getValue(yo);if(s){t||this._localStorageService.deleteValue(yo);const n=new URL(e.href).searchParams.get(s);if(n)return n}}peekMultipleCallbackParametersValues(e){return this.retrieveMultipleCallbackParametersValues(e,!0)}retrieveMultipleCallbackParametersValues(e,t=!1){const s=this._localStorageService.getObject(vo);if(s){const a={},n=new URL(e.href);return s.forEach(r=>{const o=n.searchParams.get(r);o!=null&&(a[r]=o)}),t||this._localStorageService.deleteValue(vo),a}}}var ln=(i=>(i.Cross="cross",i.Circle="circle",i))(ln||{}),Si=(i=>(i.Close="Aegir.Close",i.GetFirstPartyBlockedPlayers="Aegir.GetFirstPartyBlockedPlayers",i.OverlayIsReady="Aegir.OverlayIsReady",i.Hide="Aegir.Hide",i.LoginResult="Aegir.LoginResult",i))(Si||{}),sr=(i=>(i.Close="Aegir.WebClose",i.Navigate="Aegir.Navigate",i))(sr||{});const rU=new Map([["1.0.0",{messagesToAegir:[Si.Close,Si.GetFirstPartyBlockedPlayers,Si.OverlayIsReady,Si.Hide,Si.LoginResult],messagesToWeb:[sr.Close,sr.Navigate]}]]);var $p=(i=>(i.Cancelled="cancelled",i.Finished="finished",i))($p||{}),Ce;let f=(Ce=class extends Ix{},Ce.api="api",Ce.microAppLifecycle="microAppLifecycle",Ce.playerNotification="playerNotification",Ce.shell="shell",Ce.webSocket="webSocket",Ce.configuration="configuration",Ce.authentication="authentication",Ce.performance="performance",Ce.shellPlugin="shellPlugin",Ce.initialization="initialization",Ce.navigation="navigation",Ce.navigationHistory="navigationHistory",Ce.hostCommunication="hostCommunication",Ce.kinderGarden="kinderGarden",Ce.serviceWorker="serviceWorker",Ce.input="input",Ce.focus="focus",Ce.unexpected="unexpected",Ce.apiValidation="apiValidation",Ce.streaming="streaming",Ce);class oU{constructor(){this._messageToNotificationMap=new Map,this._messageToRequestMap=new Map,this._messageToResponseMap=new Map,this.registerMessageToNotificationConverter(sr.Close,()=>new bn),this.registerMessageToRequestConverter(sr.Navigate,e=>new Cn(e)),this.registerMessageToResponseConverter(Si.GetFirstPartyBlockedPlayers,e=>new Mx("Response"in e?e.Response:e))}registerMessageToNotificationConverter(e,t){this._messageToNotificationMap.set(e,t)}registerMessageToRequestConverter(e,t){this._messageToRequestMap.set(e,t)}registerMessageToResponseConverter(e,t){this._messageToResponseMap.set(e,t)}messageToNotification(e,t){const s=this._messageToNotificationMap.get(e);return s&&s(t)}messageToRequest(e,t){const s=this._messageToRequestMap.get(e);return s&&s(t)}messageToResponse(e,t){const s=this._messageToResponseMap.get(e);return s&&s(t)}}class cU{constructor(){this._notificationToMessageMap=new Map,this._requestToMessageMap=new Map,this._responseToMessageMap=new Map,this.registerNotificationToMessageConverter(Gc,()=>({messageType:Si.Hide,payload:null})),this.registerNotificationToMessageConverter(br,()=>({messageType:Si.OverlayIsReady,payload:null})),this.registerNotificationToMessageConverter(Oy,e=>({messageType:Si.LoginResult,payload:{status:e.status===Dp.Finished?$p.Finished:$p.Cancelled,loginData:e.loginData}})),this.registerRequestToMessageConverter(Fy,()=>({messageType:Si.GetFirstPartyBlockedPlayers,payload:null})),this.registerResponseToMessageConverter(xo,e=>({isSuccessful:e.isSuccessful}))}registerNotificationToMessageConverter(e,t){this._notificationToMessageMap.set(e.type,t)}registerRequestToMessageConverter(e,t){this._requestToMessageMap.set(e.type,t)}registerResponseToMessageConverter(e,t){this._responseToMessageMap.set(e.type,t)}notificationToMessage(e){const t=this._notificationToMessageMap.get(e.shellNotificationName);return t&&t(e)}requestToMessage(e){const t=this._requestToMessageMap.get(e.shellRequestName);return t&&t(e)}responseToMessage(e){const t=this._responseToMessageMap.get(e.shellResponseName);return t&&t(e)}}const tt=globalThis,ef="";class lU extends Lc{constructor(e,t=new oU,s=new cU){super(),this._logger=e,this._aegirToShellMessageConverter=t,this._shellToAegirMessageConverter=s,this._requestIdToMessageTypeMap=new Map,this._logger=e.createChild("ShellToAegirTransportService"),this._logger.settings.logCategory=f.hostCommunication;const a=globalThis;a.SendNotificationToWeb=this.sendNotificationToWeb.bind(this),a.SendRequestToWeb=this.sendRequestToWeb.bind(this),a.SendResponseToWeb=this.sendResponseToWeb.bind(this)}async sendNotificationToWeb(e,t){if(this.notifyIncomingCommunicationSpies({message:"notification: ".concat(e),payload:t}),this.isAegirToWebMessageSupported(e)){const s=this._aegirToShellMessageConverter.messageToNotification(e,t);if(!s){this._logger.warn("Cannot process ".concat(e),{messageType:e,data:t,errorCode:g.AegirTransportCannotProcessMessageWarning});return}s instanceof Ax?await this.onNotification(s):this._logger.warn("Cannot send malformed notification: ".concat(JSON.stringify(s)," for message type: ").concat(e),{hostNotification:s,messageType:e,errorCode:g.AegirTransportCannotSendMalformedMessageWarning})}else this._logger.warn("Aegir to web message is not supported: ".concat(e),{messageType:e,data:t,errorCode:g.AegirTransportNotSupportedWarning})}sendRequestToWeb(e,t){if(this.notifyIncomingCommunicationSpies({message:"request: ".concat(e),payload:t}),this.isAegirToWebMessageSupported(e)){const s=this._aegirToShellMessageConverter.messageToRequest(e,t);if(s)if(s instanceof Px){const a=qt.newId();return this.onRequest(s,a),a}else this._logger.warn("Cannot send malformed request: ".concat(JSON.stringify(s)," for message type: ").concat(e),{hostRequest:s,messageType:e,errorCode:g.AegirTransportCannotSendMalformedMessageWarning});else this._logger.warn("Cannot process ".concat(e),{messageType:e,data:t,errorCode:g.AegirTransportCannotProcessMessageWarning})}else this._logger.warn("Aegir to web message is not supported: ".concat(e),{messageType:e,data:t,errorCode:g.AegirTransportNotSupportedWarning});return ef}sendResponseToWeb(e,t){const s=this._requestIdToMessageTypeMap.get(e);if(this.notifyIncomingCommunicationSpies({message:"responseId: ".concat(e),payload:t}),!s){this._logger.warn("Unable to convert incoming request id: ".concat(e," to message type"),{requestId:e,data:t,errorCode:g.AegirTransportUnableToConvertMessageWarning});return}if(this.isWebToAegirMessageSupported(s)){const a=this._aegirToShellMessageConverter.messageToResponse(s,t);a?a instanceof xc?this.onResponse(a,e):this._logger.warn("Cannot send malformed response: ".concat(JSON.stringify(a)," for request id: ").concat(e),{hostRequest:a,requestId:e,errorCode:g.AegirTransportCannotSendMalformedMessageWarning}):this._logger.warn("Cannot process ".concat(s),{data:t,requestId:e,errorCode:g.AegirTransportCannotProcessMessageWarning})}else this._logger.warn("Aegir to web message is not supported: ".concat(s),{data:t,requestId:e,errorCode:g.AegirTransportNotSupportedWarning})}canSendNotification(){return this.canGetAegirVersion&&ft(tt.SendNotificationToAegir)}canSendRequest(){return this.canGetAegirVersion&&ft(tt.SendRequestToAegir)}canSendResponse(){return this.canGetAegirVersion&&ft(tt.SendResponseToAegir)}canCancelRequest(){return!1}get canGetAegirVersion(){return ft(tt.GetAegirVersion)}async sendNotification(e){const t=this._shellToAegirMessageConverter.notificationToMessage(e);t?this.sendMessageToAegir(t):this._logger.warn("Transformation to aegir messages not set for ".concat(e.shellNotificationName),{notification:e,errorCode:g.AegirTransportTransformationNotSetForNotificationWarning})}sendMessageToAegir(e){var t;this.isWebToAegirMessageSupported(e.messageType)?ft(tt.SendNotificationToAegir)?(this.notifyOutgoingCommunicationSpies({message:"notification: ".concat(e.messageType),payload:(t=e.payload)!=null?t:void 0}),tt.SendNotificationToAegir(e.messageType,e.payload||{})):this._logger.warn("window.SendNotificationToAegir method is not defined",{errorCode:g.AegirTransportWindowMethodNotDefinedWarning}):this._logger.warn("Web to aegir message is not supported: ".concat(e.messageType),{message:e,errorCode:g.AegirTransportNotSupportedWarning})}async sendRequest(e){var s;const t=this._shellToAegirMessageConverter.requestToMessage(e);if(t)if(this.isWebToAegirMessageSupported(t.messageType))if(ft(tt.SendRequestToAegir)){this.notifyOutgoingCommunicationSpies({message:"request: ".concat(t.messageType),payload:(s=t.payload)!=null?s:void 0});const a=tt.SendRequestToAegir(t.messageType,t.payload||{});return a?this._requestIdToMessageTypeMap.set(a,t.messageType):this._logger.warn("An invalid id was received when trying to send message with type ".concat(t.messageType),{id:a,request:e,errorCode:g.AegirTransportInvalidMessageIdWarning}),a}else this._logger.warn("window.SendRequestToAegir method is not defined",{errorCode:g.AegirTransportWindowMethodNotDefinedWarning});else this._logger.warn("Web to aegir message is not supported: ".concat(t.messageType),{message:t,request:e,errorCode:g.AegirTransportNotSupportedWarning});else this._logger.warn("Transformation to aegir message not set for ".concat(e.shellRequestName),{errorCode:g.AegirTransportMessageNotSetWarning});return ef}async sendResponse(e,t){const s=this._shellToAegirMessageConverter.responseToMessage(e);s?ft(tt.SendResponseToAegir)?(this.notifyOutgoingCommunicationSpies({message:"responseId: ".concat(t),payload:{...e}}),tt.SendResponseToAegir(t,s)):this._logger.warn("window.SendResponseToAegir method is not defined",{errorCode:g.AegirTransportWindowMethodNotDefinedWarning}):this._logger.warn("Transformation to aegir message not set for ".concat(e.shellResponseName),{id:t,response:e,errorCode:g.AegirTransportTransformationNotSetForNotificationWarning})}async cancelRequest(){return Promise.resolve()}isWebToAegirMessageSupported(e){const t=this.getSupportedMessages();return!!(t!=null&&t.messagesToAegir.includes(e))}isAegirToWebMessageSupported(e){const t=this.getSupportedMessages();return!!(t!=null&&t.messagesToWeb.includes(e))}getSupportedMessages(){const e=ft(tt.GetAegirVersion)?tt.GetAegirVersion():void 0;return e&&rU.get(e)}}function pU(){throw new Error("THIS SHOULD NOT BE IN PROD BUILD")}class uU{}class xr extends uU{constructor(e,t,s,a=!1,n){super(),this._name=e,this._aliases=t,this._required=s,this._containsSensitiveData=a,this._defaultValue=n,this._allAliases=this.getAllAliases(this.nominalAliases)}get nominalAliases(){return[this._name,...this._aliases]}getAllAliases(e){const t=[];return e.forEach(s=>t.push(s,s.toLowerCase())),t}get name(){return this._name}get containsSensitiveData(){return this._containsSensitiveData}get message(){return this._name+(this._aliases.length>0?" / "+this._aliases.join(" / "):"")}get required(){return this._required}getValue(e){return this.getParameterValue(this._allAliases,e)}getParameterValue(e,t){const s=this.getParameterKey(e,t);return s?t.get(s):null}getKey(e){return this.getParameterKey(this._allAliases,e)}getParameterKey(e,t){return e.find(s=>t.has(s))}setMaskedParameter(e,t){const s=this.getKey(e);s&&(!this.containsSensitiveData||s.includes("dev-"))&&e.copyValue(t,s)}hasAlias(e){return this._allAliases.includes(e)}}class dU extends xr{constructor(){super("bundleOverrides",[],!1)}setValue(e,t){return e.bundleOverrides=[...t.searchParams].filter(([s])=>s.endsWith("-bundle-url")).map(([s,a])=>({appName:s.replace("-bundle-url",""),bundleUrl:a})),!0}}class vi extends xr{constructor(e,t,s,a,n=!1,r){super(e,t,s,n,r),this._enumVariable=a,this._objectMap=new Map,Object.values(this._enumVariable).forEach(o=>{o&&this._objectMap.set(o.toString().toLowerCase(),o)})}setValue(e,t,s=!1){const a=this.getValue(t);return a&&this.trySetValue(e,a)||s&&e[this._name]?!0:this._defaultValue?(e[this._name]=this._defaultValue,!0):!1}trySetValue(e,t){const s=this._objectMap.get(t.toLowerCase());return s?(e[this._name]=s,!0):!1}}class hU extends vi{constructor(){super("deviceType",[],!0,Vt)}setValue(e,t,s=!1){return super.setValue(e,t,s)||this.setDefaultDeviceType(e)}setDefaultDeviceType(e){switch(e.deviceType=Vt.Desktop,e.platformType){case m.PC:case m.Luna:case m.Steam:case m.Web:{e.deviceType=Vt.Desktop;break}case m.PS4:case m.PS5:case m.XONE:case m.Scarlett:case m.ScarlettUWP:{e.deviceType=Vt.TV;break}case m.Mobile:{e.deviceType=Vt.Phone;break}case m.IOS:{e.deviceType=Vt.Phone;break}case m.Android:{e.deviceType=Vt.Phone;break}}return!0}}class gU extends vi{constructor(){super("displayMode",[],!0,ea)}setValue(e,t,s=!1){return super.setValue(e,t,s)||this.setDefaultDisplayMode(e)}setDefaultDisplayMode(e){switch(e.displayMode=ea.Desktop,e.deviceType){case Vt.Desktop:e.displayMode=ea.Desktop;break;case Vt.TV:e.displayMode=ea.TV;break;case Vt.Phone:case Vt.Tablet:switch(e.orientation){case vt.LandscapePrimary:case vt.LandscapeSecondary:e.displayMode=ea.MobileLandscape;break;case vt.PortraitPrimary:case vt.PortraitSecondary:e.displayMode=ea.MobilePortrait;break}}return!0}}class mU extends vi{constructor(){super("environment",["env","apiEnvironment","apienv"],!0,ie)}setValue(e,t,s){if(super.setValue(e,t,s))return!0;const n=this.getValue(t);return(n==null?void 0:n.toLowerCase())==="cert2"?(e.environment=ie.Cert,!0):(this.applyEnvParameterFromHostName(e,t),!0)}applyEnvParameterFromHostName(e,t){let s=!1;const a=Object.values(this._enumVariable).map(n=>n.toString());return t.hostName.split(".").forEach(n=>{n.split("-").forEach(r=>{r=r.toLowerCase().replace("crt","cert").replace("cert2","cert").replace("prd","prod"),a.includes(r)&&(e[this._name]=r,s=!0)})}),s}}const fU=new Map([[{platform:m.Mobile,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0},p.CompanionAppMobile],[{platform:m.IOS,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0},p.CompanionAppIOS],[{platform:m.Android,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0},p.CompanionAppAndroid],[{platform:m.Android,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.Android],[{platform:m.IOS,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.IOS],[{platform:m.Luna,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.Luna],[{platform:m.Mobile,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.Mobile],[{platform:m.PC,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:!0,isStandAlone:!0,platformVariant:void 0},p.PCElectronClient],[{platform:m.PC,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:!0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0},p.PCLegacyClient],[{platform:m.PC,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0},p.PCWebClient],[{platform:m.PC,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:!0,isElectronClient:void 0,isStandAlone:!1,platformVariant:void 0},p.PCLegacyOverlay],[{platform:m.PC,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:!0,isStandAlone:!1,platformVariant:void 0},p.PCElectronOverlay],[{platform:m.PC,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!1,platformVariant:void 0},p.PCWebOverlay],[{platform:m.Steam,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!1,platformVariant:void 0},p.SteamOverlay],[{platform:m.Steam,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0},p.SteamClient],[{platform:m.PS4,isUwpXbox:void 0,isInIframe:void 0,isAegir:!0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:gt.Aegir},p.PS4AegirNative],[{platform:m.PS4,isUwpXbox:void 0,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:gt.Aegir},p.PS4Aegir],[{platform:m.PS4,isUwpXbox:void 0,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.PS4],[{platform:m.PS5,isUwpXbox:void 0,isInIframe:void 0,isAegir:!0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:gt.Aegir},p.PS5AegirNative],[{platform:m.PS5,isUwpXbox:void 0,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:gt.Aegir},p.PS5Aegir],[{platform:m.PS5,isUwpXbox:void 0,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.PS5],[{platform:m.ScarlettUWP,isUwpXbox:!0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.ScarlettUWP],[{platform:m.Scarlett,isUwpXbox:!0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.ScarlettUWP],[{platform:m.Scarlett,isUwpXbox:!1,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0,isWebView2:!0},p.ScarlettUWPWebView2],[{platform:m.Scarlett,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0,isWebView2:!0},p.ScarlettUWPWebView2],[{platform:m.Scarlett,isUwpXbox:!1,isInIframe:void 0,isAegir:!0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!1,platformVariant:gt.Aegir},p.ScarlettAegirNative],[{platform:m.Scarlett,isUwpXbox:!1,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!1,platformVariant:gt.Aegir},p.ScarlettAegir],[{platform:m.Scarlett,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.Scarlett],[{platform:m.ScarlettUWP,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.Scarlett],[{platform:m.XONE,isUwpXbox:!0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.XoneUWP],[{platform:m.XONE,isUwpXbox:!1,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0,isWebView2:!0},p.XoneUWPWebView2],[{platform:m.XONE,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:!0,platformVariant:void 0,isWebView2:!0},p.XoneUWPWebView2],[{platform:m.XONE,isUwpXbox:!1,isInIframe:void 0,isAegir:!0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:gt.Aegir},p.XOneAegirNative],[{platform:m.XONE,isUwpXbox:!1,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:gt.Aegir},p.XOneAegir],[{platform:m.XONE,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.XONE],[{platform:m.Web,isUwpXbox:void 0,isInIframe:!0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.WebEmbedded],[{platform:m.Web,isUwpXbox:void 0,isInIframe:void 0,isAegir:void 0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.Web],[{platform:m.MacOS,isUwpXbox:void 0,isInIframe:void 0,isAegir:!0,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:gt.Aegir},p.MacOSAegirNative],[{platform:m.MacOS,isUwpXbox:void 0,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:gt.Aegir},p.MacOSAegir],[{platform:m.MacOS,isUwpXbox:void 0,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.MacOS],[{platform:m.Switch,isUwpXbox:void 0,isInIframe:void 0,isAegir:!1,isLegacyClient:void 0,isElectronClient:void 0,isStandAlone:void 0,platformVariant:void 0},p.Switch]]);class Ts{static isLegacyPcClient(){return"umpUiMessage"in window||"uplayUiMessage"in window}static isElectronPcClient(){return"native"in window}static isUwpXbox(){return"Windows"in window}static isWebView2(){var e;return((e=window.chrome)==null?void 0:e.webview)!==void 0}static isAegir(){return ft(tt.GetAegirVersion)&&ft(tt.SendNotificationToAegir)&&ft(tt.SendRequestToAegir)&&ft(tt.SendResponseToAegir)}static isInIframe(){return window.parent!==window}static calculateHostPlatformType(e,t,s){const a=[void 0,Ts.isAegir()],n=[void 0,Ts.isElectronPcClient()],r=[void 0,Ts.isLegacyPcClient()],o=[void 0,Ts.isUwpXbox()],l=[void 0,Ts.isInIframe()],u=[void 0,t],v=[void 0,s],w=[void 0,Ts.isWebView2()];return Nx(Array.from(fU.entries()).map(([b,I])=>{if(b.platform===e&&o.includes(b.isUwpXbox)&&l.includes(b.isInIframe)&&a.includes(b.isAegir)&&r.includes(b.isLegacyClient)&&n.includes(b.isElectronClient)&&u.includes(b.isStandAlone)&&v.includes(b.platformVariant)&&w.includes(b.isWebView2))return I}))||p.Web}}class yU extends vi{constructor(){super("hostPlatformType",[],!1,p,!1)}setValue(e,t,s=!1){return super.setValue(e,t,s)||(e.hostPlatformType=Ts.calculateHostPlatformType(e.platformType,e.isStandalone,e.platformVariant)),!0}}class Nd extends vi{constructor(){super("platformType",["platform"],!0,m),this._knownSuffixes=new Map([["crossgen",e=>{e.platformType===m.PS4&&(e.isPs4Crossgen=!0)}],["xdk",e=>{e.platformType===m.XONE&&(e.xOneSdkType=Op.XDK)}],["gdk",e=>{e.platformType===m.XONE&&(e.xOneSdkType=Op.GDK)}]]),this._platformTypeOverrides=new Map([[m.PC,(e,t)=>{this.getOwnershipGroupValue(t)===la.Steam&&this.setPlatformType(e,m.Steam)}]])}setValue(e,t,s=!1){let a=super.setValue(e,t,s);return a||(a=this.calculateBasicPlatformType(e,this.getValue(t))||this.setPlatformType(e,m.PC)),this._platformTypeOverrides.forEach((n,r)=>{e.platformType===r&&n(e,t)}),a}calculateBasicPlatformType(e,t){if(t==="xbox")return this.setPlatformType(e,m.XONE);if(t==="equinox")return this.setPlatformType(e,m.Luna);if(t){const s=t.split("-");if(s.length>1&&super.trySetValue(e,s[0])){const a=this._knownSuffixes.get(s[1]);return a&&a(e),!0}}return!1}setPlatformType(e,t){return e.platformType=t,!0}getOwnershipGroupValue(e){const t=this.getAllAliases(["ownershipGroup"]);return this.getParameterValue(t,e)}}class re extends xr{constructor(e,t,s,a=!1,n,r){super(e,t,s,a,n),this._valueType=r}setValue(e,t,s=!1){var o;const a=this.getValue(t),n=[typeof e[this._name],typeof this._defaultValue,(o=this._valueType)==null?void 0:o.name].find(l=>l!=="undefined")||"undefined",r=this.convertType(a,n);return r!=null&&a!==""?(e[this._name]=r,!0):s&&e[this._name]?!0:this._defaultValue!==void 0?(e[this._name]=this._defaultValue,!0):!1}convertType(e,t){return e&&t.toLowerCase()==="boolean"?e.toLowerCase()==="true":e&&t.toLowerCase()==="number"?Number(e):e}}class ES extends re{constructor(){super("isStandalone",[],!1)}setValue(e,t,s=!1){let a=super.setValue(e,t,s);if(!a&&this.getIsOnMobileValue(t)){const n=this.getIsMobileCompanionAppValue(t);a=this.setIsStandalone(e,n!==!1)}return a||this.setIsStandalone(e,!1)}setIsStandalone(e,t){return e.isStandalone=t,!0}getIsOnMobileValue(e){const t=new Nd().getValue(e);return[m.Android,m.IOS,m.Mobile].includes(t)}getIsMobileCompanionAppValue(e){const t=this.getAllAliases(["isMobileCompanionApp"]),s=this.getParameterValue(t,e);return s===null?s:s.toLowerCase()==="true"}}class vU extends xr{constructor(){super("microAppParams",[],!1)}setValue(e,t,s=!1){const a=this.getValue(t);if(!a)return s&&!!e.microAppParams;const n=new URLSearchParams(a),r={};return Array.from(n.keys()).forEach(l=>{const u=n.get(l);u&&(r[l]=decodeURIComponent(u))}),e.microAppParams=r,!0}}class _U extends re{constructor(){super("mobileCompanionAppType",[],!1)}setValue(e,t,s=!1){let a=!1;if(this.getIsOnMobileValue(t)){const r=this.getIsStandaloneValue(t);if(r!==null)r&&(a=this.setMobileCompanionAppType(e,Bi.CompanionApp));else{const o=this.getIsMobileCompanionAppValue(t);o===null?a=this.setMobileCompanionAppType(e,Bi.LegacyCompanionApp):o&&(a=this.setMobileCompanionAppType(e,Bi.CompanionApp))}}const n=s?e.mobileCompanionAppType:void 0;return a||this.setMobileCompanionAppType(e,n)}setMobileCompanionAppType(e,t){return e.mobileCompanionAppType=t,!0}getIsStandaloneValue(e){const t=new ES().getValue(e);return this.convertRawValueToBooleanOrNull(t)}getIsOnMobileValue(e){const t=new Nd().getValue(e);return[m.Android,m.IOS,m.Mobile].includes(t)}getIsMobileCompanionAppValue(e){const t=this.getAllAliases(["isMobileCompanionApp"]),s=this.getParameterValue(t,e);return this.convertRawValueToBooleanOrNull(s)}convertRawValueToBooleanOrNull(e){return e===null?e:e.toLowerCase()==="true"}}class SU extends xr{constructor(){super("partnerPlatformAttributes",[],!1)}setValue(e,t,s=!1){const a=this.getValue(t);if(!a)return s&&!!e.partnerPlatformAttributes;const n=new URLSearchParams(a),r={};return Array.from(n.keys()).forEach(l=>{const u=n.get(l);u&&(r[l]=decodeURIComponent(u))}),e.partnerPlatformAttributes=r,!0}}const tf="en-US",wc=class wc extends re{constructor(){super("playerLocale",["locale"],!0)}setValue(e,t,s=!1){if(super.setValue(e,t,s))e.playerLocale=this.normalizeCasing(e.playerLocale),e.playerLocale=this.normalizeKorean(e.playerLocale);else if(wc.platformsWithBrowserLanguageFallback.includes(e.platformType)&&navigator.language){const[n,r]=navigator.language.split("-"),o=navigator.languages.find(l=>l.includes("".concat(n,"-")));n&&r?e.playerLocale=navigator.language:!r&&o?e.playerLocale=o:e.playerLocale=tf}else e.playerLocale=tf;return!0}normalizeCasing(e){let[t,s]=e.split("-");return t=t.toLowerCase(),s?"".concat(t,"-").concat(s.toUpperCase()):t}normalizeKorean(e){return e==="ko-KO"?"ko-KR":e}};wc.platformsWithBrowserLanguageFallback=[m.XONE,m.Scarlett,m.ScarlettUWP,m.PS4,m.PS5];let Bp=wc;class sf{constructor(e){this._urlParams=new URLSearchParams,e.searchParams.forEach((t,s)=>{this._urlParams.set(s,t)}),this._hashParams=new URLSearchParams(e.hash.substring(1,e.hash.length)),this._hostName=e.hostname}get hostName(){return this._hostName}has(e){return this._urlParams.has(e)||this._hashParams.has(e)}get(e){return this._hashParams.get(e)||this._urlParams.get(e)}set(e,t){this._urlParams.set(e,t)}setHash(e,t){this._hashParams.set(e,t)}get searchParams(){return this._urlParams}copyValue(e,t){const s=this._hashParams.get(t),a=this._urlParams.get(t);s!==null?e.setHash(t,s):a!==null&&e.set(t,a)}applyToUrl(e){this._urlParams.forEach((t,s)=>{e.searchParams.set(s,t)}),e.hash.length>1&&(e.hash+="&"),e.hash+=this._hashParams.toString()}forEach(e){this._urlParams.forEach(e),this._hashParams.forEach(e)}}const fp="shell-app-runtime-parameters",yp="shell-ticket",af="shell-visitor-id";function US(i){return i===Xa.China?Fp.UplayChina:Fp.Uplay}class wU{constructor(e){this._localStorageService=e,this._configuration=[new mU,new re("hostSpaceId",["spaceId"],!1),new re("hostAppId",["applicationId"],!1),new re("activeGameSpaceId",[],!1),new re("activeGameAppId",[],!1),new re("profileId",["roamingProfileId"],!1,!0),new vi("orientation",[],!1,vt,!1),new vi("theme",[],!0,Xn,!1,Xn.Dark),new re("isUWP",[],!1,!1),new re("nonRoamableId",["dev-nonRoamableId"],!1,!0),new ES,new _U,new Nd,new Bp,new re("sdkVersion",[],!1),new re("ticket",["ubiTicket","dev-ticket"],!1,!0),new re("token",["firstPartyToken","dev-firstPartyToken"],!0,!0,""),new re("country",[],!1),new re("debug",[],!1,!1),new re("debugTab",[],!1),new re("microApp",[],!1),new re("ownershipGroup",[],!1),new vU,new hU,new gU,new re("gameSessionId",["sessionId","playerSessionId","dev-gameSessionId"],!1,!0),new re("psEnterButton",[],!1,!1,ln.Cross),new re("osVersion",[],!1),new vi("bundleEnvironment",["cfgEnv","configEnvironment"],!1,ie),new re("noServiceWorker",[],!1,!1,void 0,Boolean),new re("wipeCacheData",[],!1,!1,void 0,Boolean),new re("cacheOpaqueRequests",[],!1,!1,void 0,Boolean),new re("childId",[],!1,!1,void 0),new vi("region",[""],!1,Xa,!1,Xa.WorldWide),new re("isExclusiveMode",[],!1,!1,!1,Boolean),new vi("platformVariant",[],!1,gt,!1,gt.Default),new yU,new vi("authFlow",[""],!1,ve,!1,ve.Default),new re("deviceId",[],!1),new re("deviceName",[],!1),new re("hostVersion",["mobileAppVersion"],!1),new re("configServiceToken",[],!1,!0),new re("embedderOrigin",[],!1),new dU,new re("partnerPlatform",[],!1),new SU,new re("decoratedConsoleLog",[],!1,!1,!1,Boolean),new re("isOffline",[],!1,!1,void 0,Boolean),new re("ubiMockScenario",[],!1)],this._validation=[t=>{if(!t.isUWP&&!t.hostAppId&&!this.shouldOverrideHostIds(t))return"hostAppId is required for platformType:".concat(t.platformType)},t=>{if(t.isUWP&&!(t.nonRoamableId||t.token))return"nonRoamableId or token is required for UWP"}],this._overrides=[t=>{if(this.shouldOverrideHostIds(t)){const s=new LS({local:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.ubi.com",logger:{logSource:"Uplay Next Shell",batchSize:1e3,timeInterval:{max:15e3,min:1e3}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}},dev:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.ubi.com",logger:{logSource:"Uplay Next Shell",batchSize:400,timeInterval:{max:3e5,min:6e4}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}},uat:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.ubi.com",logger:{logSource:"Uplay Next Shell",batchSize:400,timeInterval:{max:3e5,min:6e4}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}},cert:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.ubi.com",logger:{logSource:"Uplay Next Shell",batchSize:400,timeInterval:{max:3e5,min:6e4}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}},prod:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.{domain}",logger:{logSource:"Uplay Next Shell",batchSize:400,timeInterval:{max:3e5,min:6e4}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}}}[t.environment],t.platformType,t.environment,t.region,t.isStandalone,t.bundleEnvironment);this.overrideParameter("hostAppId",s.shellApplicationId,t),this.overrideParameter("hostSpaceId",s.shellSpaceId,t)}}],this._currentRuntimeParameters=this.getDefaultParameters()}shouldOverrideHostIds(e){return e.isStandalone&&(e.platformType===m.PC||e.platformType===m.Steam)}getDefaultParameters(){return{environment:ie.Prod,displayMode:ea.Desktop,playerLocale:"en-US",country:"",deviceType:Vt.Desktop,platformType:m.Web,ticket:"",theme:Xn.Dark,hostAppId:"",hostSpaceId:"",activeGameAppId:"",activeGameSpaceId:"",profileId:"",microApp:"",microAppParams:{},token:"",debug:!1,debugTab:"",isUWP:!1,nonRoamableId:"",isStandalone:!1,isExclusiveMode:!1,gameSessionId:"",isPs4Crossgen:!1,configurationCorrupted:!1,maskedUrl:"",fullUrl:"",psEnterButton:ln.Cross,region:Xa.WorldWide,platformVariant:gt.Default,hostPlatformType:p.Web,authFlow:ve.Default,embedderOrigin:"",decoratedConsoleLog:!1}}verifyRedirect(){const e=new Pd(this._localStorageService),t=e.peekMultipleCallbackParametersValues(window.location),s=e.peekCallbackParameterValue(window.location);return!t&&!s?"notRedirecting":!!t&&Object.keys(t).length>0||!!s?"redirectOk":"redirectNotOk"}get parameterConfig(){return this._configuration}getRuntimeParameters(){return this._currentRuntimeParameters}parseQueryParameters(e,t=!1){const s=[];this.verifyRedirect()==="redirectNotOk"&&(this._currentRuntimeParameters=this.getDefaultParameters(),t=!1);const n=this._currentRuntimeParameters;this._overrides.length&&this._overrides.forEach(v=>v(n));const r=new URL(e),o=new sf(r);this._configuration.forEach(v=>{!v.setValue(n,o,t)&&v.required&&s.push("Missed parameter ".concat(v.message))}),n.childId||this._validation.map(v=>v(n)).forEach(v=>{v&&s.push(v)}),this._overrides.length&&this._overrides.forEach(v=>v(n));const l=t&&n.maskedUrl?new URL(n.maskedUrl):new URL(r.origin+r.pathname),u=new sf(l);return this._currentRuntimeParameters=n,o.forEach((v,w)=>{const b=this._configuration.find(I=>I.hasAlias(w));b?b.setMaskedParameter(o,u):o.copyValue(u,w)}),u.applyToUrl(l),n.maskedUrl=l.href,n.fullUrl=e,s}overrideParameter(e,t,s=this._currentRuntimeParameters){s[e]=t}loadFromLocalStorage(){const e=this.loadStoredValue(fp),t=this._localStorageService.getValue(yp);return t&&!this._currentRuntimeParameters.ticket&&(this._currentRuntimeParameters.ticket=t),e}clearTicket(){this._localStorageService.deleteValue(yp)}saveToLocalStorage(){this._localStorageService.setObjectSync(fp,this._currentRuntimeParameters),this._localStorageService.setValue(yp,this._currentRuntimeParameters.ticket)}getChildKey(e){return"".concat(fp,"-child-").concat(e)}saveForChild(e){this._localStorageService.setObjectSync(this.getChildKey(e),{...this._currentRuntimeParameters,childId:e})}loadStoredValue(e){const t=this._localStorageService.getObject(e);return t?(this._currentRuntimeParameters=t,this._localStorageService.deleteValue(e),!0):!1}getForChild(e){return this.loadStoredValue(this.getChildKey(e))}loadRuntimeParameters(e=window.location.href){const t=this.loadFromLocalStorage(),s=this.parseQueryParameters(e,t);return this._currentRuntimeParameters.childId?(this.getForChild(this._currentRuntimeParameters.childId),{parameters:this._currentRuntimeParameters,errors:[]}):(s.length>0&&this.overrideParameter("configurationCorrupted",!0),{parameters:this._currentRuntimeParameters,errors:s})}async applyDevBuildLogic(e){[p.PS4Aegir,p.PS5Aegir,p.XOneAegir,p.ScarlettAegir,p.MacOSAegir].includes(this._currentRuntimeParameters.hostPlatformType)&&(pU(),this.parseQueryParameters(window.location.href,e)),[m.Luna,m.PC,m.Steam].includes(this._currentRuntimeParameters.platformType)&&((await (()=>G(()=>import("./FakePcClient-8ad30b84.js"),[]))()).initFakeShellToUpcBridge(),this.parseQueryParameters(window.location.href,e))}getVisitorId(e){let t=this._localStorageService.getValue(af);if(!t){t=qt.newId();try{this._localStorageService.setValue(af,t)}catch(s){e.error("Failed to store visitor id",{errorCode:g.FailedToStoreVisitorIdError,error:s})}}return t}}class bU{get(e,t,s){if(t in e)return e[t]}}class pe{static new(e){return Proxy.revocable(e,new bU)}}const CU="d75ffcb0-fdf8-4fba-b4a4-f2c3e7469058",Ba=[m.Luna,m.PC,m.Steam,m.MacOS];class IU{constructor(e,t,s){this._config=e,this._httpClientFactory=t,this._region=s,this._ubiServices=this.createServices(this._config)}get ubiServices(){return this._ubiServices}createServices(e){const t=this._region===Xa.China?CU:void 0,s=this._httpClientFactory.getAuthenticatedUbiHttpClient(e.applicationId);return{authenticationService:new Tx(e,this._httpClientFactory),avatarsService:new Rx(e,this._httpClientFactory),blocklistService:new Dx(e,this._httpClientFactory),connectionsService:new Ox(e,this._httpClientFactory),entitiesService:new Fx(e,this._httpClientFactory),eventsService:new Lx(e,this._httpClientFactory),friendsService:new Gx(e,this._httpClientFactory,t),gamesPlayedService:new xx(e,this._httpClientFactory),newsService:new Ex(e,this._httpClientFactory),ipLocationService:new Ux(e,this._httpClientFactory),parametersService:new kx(e,this._httpClientFactory),partyService:new Wx(e,this._httpClientFactory),playerReportsService:new Vx(e,this._httpClientFactory),populationsService:new $x(e,this._httpClientFactory),profilesService:new Bx(e,this._httpClientFactory),recommendationsService:new Hx(e,this._httpClientFactory),spacesService:new Qx(e,this._httpClientFactory),tokenService:new jx(e,this._httpClientFactory),usersService:new qx(e,this._httpClientFactory),secondaryStoreService:new zx(e,this._httpClientFactory),tradesService:new Kx(e,this._httpClientFactory),httpClient:s}}getRevocableUbiServices(e){if(!e)return pe.new(this._ubiServices);const t=this.createServices({applicationId:e,endpoint:this._config.endpoint});return pe.new(t)}}var wi=(i=>(i.NotAvailable="Service is not available",i.Sanitize="Not able to sanitize message",i.WindowClosed="The requested window is closed",i.Incorrect="Incorrect message from child window",i.NoParentWindow="Service is created with no window.opener available!",i.NotSupported="Called method is not supported",i.NotAbleToSetupCommunication="Not able to setup log communication for a child window",i))(wi||{}),Ha=(i=>(i.WindowNotCreated="Was not able to create a new window",i.NoChildData="Requested child data is missing",i.NoHostCommunicationService="No host communication service",i))(Ha||{});const MU="Failed to fetch",AU="Load failed";function Td(i){return i instanceof TypeError&&(i.message.includes(MU)||i.message.includes(AU))}function jn(i){let e;return i instanceof Error?e=i.message:e=String(i),e}const PU="SystemJS Error#3",NU="Unexpected end of input",TU="Unexpected template string",RU="Importing a module script failed";function DU(i){const e=jn(i);return[PU,NU,TU,RU].some(t=>t.includes(e))}async function kS(i,e){try{return await i()}catch(t){if(e.retries>0&&(!e.condition||e.condition(t)))return await Gs(e.delayMsBetweenRetries),await kS(i,{...e,retries:e.retries-1});throw t}}async function le(i,e={retries:1,delayMsBetweenRetries:100,condition:t=>Td(t)||DU(t)}){return await kS(i,e)}async function OU(i){if(i!=null&&i.telemetrySDK)try{return(await le(()=>G(()=>import("./MetricsStoreBundle-579bd044.js"),["assets/MetricsStoreBundle-579bd044.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/InMemoryExporter-27dc8dc0.js"]))).MetricsStoreBundle.create(i)}catch(e){i.logger.error("Non-critical subsystem unavailable, Telemetry. ".concat(e instanceof Error?e.message:""));return}}class FU{constructor(e,t){this._serviceConfig=e,this._httpClient=t}getMetaProgression(e){return this._httpClient.getJson("".concat(this._serviceConfig.endpoint,"/v1/profiles/").concat(e,"/global/ubiconnect/economy/api/metaprogression"))}}class LU{constructor(e,t){this.v1=new FU(e,t)}}const GU=50;class xU{constructor(e,t){this._serviceConfig=e,this._httpClient=t}getGameInformation(e,t){const s={headers:{[Wm.UbiLocaleCode]:t}};return this._httpClient.getJson("".concat(this._serviceConfig.endpoint,"/v1/spaces/").concat(e,"/global/ubiconnect/games/api"),s)}getGamesInformation(e,t){const s={headers:{[Wm.UbiLocaleCode]:t}};if(e.length>GU)throw new Error("Maximum number of spaceIds exceeded.");if(e.length<1)return Promise.resolve([]);const a=e.join(",");return this._httpClient.getJson("".concat(this._serviceConfig.endpoint,"/v1/spaces/global/ubiconnect/games/api?spaceIds=").concat(a),s).then(n=>n.games)}}class EU{constructor(e,t){this.v1=new xU(e,t)}}class UU{constructor(e,t){this._config=e,this._httpClient=t,this._connectServices=this.createServices(this._config,this._httpClient)}get connectServices(){return this._connectServices}createServices(e,t){return{economyService:new LU(e,t),gamesService:new EU(e,t)}}}var fa=(i=>(i.metrics="metrics",i.AnonymousTracking="anonymousTracking",i.Quicklaunch="quicklaunch",i.PCClientWebAuthentication="pcClientWebAuthentication",i.AchievementNotification="achievementNotification",i))(fa||{});const _o="ubiConnect-featureFlags";class kU{constructor(e,t,s){this._parametersService=e,this._spaceId=t,this._logger=s,this.isFeatureEnabled=(a,n)=>a[n]||!1}async getFeatures(e){var n,r;const t=Object.fromEntries(Object.values(e).map(o=>[o,!1]));if(Object.keys(t).length===0)return this._logger.warn("An empty enum was provided. No features to validate."),t;let s;try{if(s=await this._parametersService.v1.getSpaceParametersWithoutAuthentication(this._spaceId,[],[_o]),!((r=(n=s.parameters)==null?void 0:n[_o])!=null&&r.fields))throw new Error("Could not find a ".concat(_o," parameter group in the given space."))}catch(o){return this._logger.error("Failed to get features for the given spaceId: ".concat(this._spaceId),{error:o}),t}return this.spaceParametersConfigToFeatures(s.parameters[_o].fields,e,this._logger).forEach(o=>{o.enabled&&(t[o.name]=!0)}),t}spaceParametersConfigToFeatures(e,t,s){try{const a=[];return Object.entries(e).forEach(([n,r])=>{if(!this.isFeatureName(t,n))s.warn("Attempted to parse unknown feature flag: ".concat(n),{moreInfo:e});else{const o={name:n,enabled:r};a.push(o)}}),a}catch(a){throw s.error("Error while trying to parse space parameters response into valid features. ",{error:a}),a}}isFeatureName(e,t){return Object.values(e).includes(t)}}function qn(i,e){if(!i)throw new Error(e)}class Er extends d("[Shell] subscribe to runtime context updates"){constructor(e){super(),this.observer=e}}class WS extends d("[Shell] sync runtime context"){constructor(e){super(),this.context=e}}class Rd extends d("[Shell] remove subscriptions"){constructor(e){super(),this.observers=e}}class at extends d("[Shell] Update User Session"){constructor(e,t,s){super(),this.session=e,this.password=t,this.email=s}}class qc extends d("[Shell] Update Offline Session"){constructor(e,t,s){super(),this.session=e,this.password=t,this.email=s}}class Hp extends d("[Shell] Set Active Game"){constructor(e,t,s){super(),this.game=e,this.config=t,this.caller=s}}let oie=class extends d("[Shell] Update input device type"){constructor(e){super(),this.brand=e}},lie=class extends d("[Shell] Update navigation method"){constructor(e){super(),this.inputEventDeviceType=e}};class Qp extends d("[Shell] Update current orientation"){constructor(e){super(),this.orientation=e}}class Dd extends d("[Shell] Update common event data"){constructor(e){super(),this.session=e}}class VS extends d("[Shell] Set account linking in progress"){constructor(e){super(),this.isInProgress=e}}class jp extends d("[Shell] Set focused micro app"){constructor(e){super(),this.focusedMicroApp=e}}class Od extends d("[Shell] SendShellStartTrackingEvent"){}class ar extends d("[Shell] SendShellQuitTrackingEvent"){constructor(e){super(),this.closeReason=e}}class Fd extends d("[Shell] Switch To Exclusive Mode Intent"){constructor(e){super(),this.navigationContext=e}}class Ld extends d("[Shell] Exit Exclusive Mode Intent"){constructor(e=!0){super(),this.shouldReactivateDefaultHistory=e}}class nr extends d("[Shell] Set Country Code"){constructor(e){super(),this.country=e}}class Gd extends d("[Shell] Set Ownership Group"){constructor(e){super(),this.ownershipGroup=e}}class xd extends d("[Shell] Process Initial Authentication"){}class Ed extends d("[Shell] Initial Load MicroApp Configurations"){}class Ud extends d("[Shell] Navigate To Login With Retry"){constructor(e){super(),this.action=e}}var WU=Object.defineProperty,VU=Object.getOwnPropertyDescriptor,$U=(i,e,t,s)=>{for(var a=s>1?void 0:s?VU(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&WU(e,t,a),a};class $S{constructor(e,t,s){this._logger=e,this._store=t,this._runtimeParameters=s,qn(!!window,"Running without window context");const{orientation:a}=this._runtimeParameters;if(a){this._store.dispatchIntent(new Qp(a));return}this.updateOrientation(),this._runtimeParameters.hostPlatformType!==p.WebEmbedded&&window.addEventListener("resize",this.updateOrientation),window.addEventListener("orientationchange",this.updateOrientation)}updateOrientation(){const s=window.innerWidth/window.innerHeight>=.8?vt.LandscapePrimary:vt.PortraitPrimary;this._store.dispatchIntent(new Qp(s))}dispose(){this._runtimeParameters.hostPlatformType!==p.WebEmbedded&&window.removeEventListener("resize",this.updateOrientation),window.removeEventListener("orientationchange",this.updateOrientation)}}$U([_()],$S.prototype,"updateOrientation",1);class ki{constructor(e,t,s=24){this.width=e,this.height=t,this.diagonal=s}static fromSize(e,t,s=24){return new ki(e,t,s)}static fromDpi(e,t,s){const a=Math.sqrt(Math.pow(e,2)+Math.pow(t,2))/s;return new ki(e,t,a)}get largerSide(){return Math.max(this.width,this.height)}get smallerSide(){return Math.max(this.width,this.height)}get isZero(){return this.width!==0&&this.height!==0}get isPortrait(){return!this.isLandscape}get isLandscape(){return this.width>=this.height}get megapixels(){return this.width*this.height/1e6}isWiderThan(e){return this.width>e.width}isTallerThan(e){return this.height>e.height}get dpi(){return Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/this.diagonal}isEqual(e,t=!1){return t?this.largerSide===e.largerSide&&this.smallerSide===e.smallerSide:this.width===e.width&&this.height===e.height}asLandscape(){return new ki(this.largerSide,this.smallerSide,this.diagonal)}asPortrait(){return new ki(this.smallerSide,this.largerSide,this.diagonal)}asRotated(){return this.isLandscape?this.asPortrait():this.asLandscape()}toString(){return"[w: ".concat(this.width,", h: ").concat(this.height,"]")}}const nf=getComputedStyle(document.documentElement).fontSize;function et(i,e,t){(t||document.documentElement).style.setProperty(i,e)}function uie(i){return i*(nf?parseFloat(nf):1)}class De extends Error{constructor(e){super(e),this.name=this.constructor.name,this.getErrorStack(e)}getErrorStack(e){typeof Error.captureStackTrace=="function"?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack}}const Tt=class Tt{constructor(e){this._runtimeParameters=e,qn(!!window,"Running without window context");const t=Tt.getScalingStrategiesConfig(this._runtimeParameters.hostPlatformType);this._factor=this.getScalingFactor(t),this.shouldUseDisplayScaling()&&(window.addEventListener("resize",this.updateRootFontSize.bind(this)),this.updateRootFontSize())}static get currentScalingFactor(){var e;return qn(!!Tt.instance,"DisplayScalingService was not yet initialized"),(e=Tt.instance)==null?void 0:e._factor}static Initialize(e,t){if(Tt.instance){const s="DisplayScalingService is already initialized";throw e.warn(s,{errorCode:g.DisplayScalingServiceAlreadyInitializedWarning}),new De(s)}Tt.instance=new Tt(t)}get resolution(){return{viewport:new ki(window.innerWidth,window.innerHeight),display:new ki(window.screen.width,window.screen.height),desktop:new ki(window.screen.availWidth,window.screen.availHeight)}}shouldUseDisplayScaling(){return![p.PCWebClient,p.PCElectronClient,p.PCLegacyClient,p.SteamClient].includes(this._runtimeParameters.hostPlatformType)}updateRootFontSize(){const e=Tt.getScalingStrategiesConfig(this._runtimeParameters.hostPlatformType);this._factor=this.getScalingFactor(e);const t=Tt.baseFontSizeInPixels*this._factor;et("--root-font-size-in-pixels","".concat(t,"px"));const s=t/(Tt.baseFontSizeInPixels*Tt.pixelsToRemsRatio);et("--root-font-size-adjusted-for-rems","".concat(s,"px"))}getScalingFactor(e){return e.screenBreakpoints?this.getScalingFactorFromBreakpoints(e):e.defaultFactor}getScalingFactorFromBreakpoints(e){let t=e.defaultFactor;if(e.screenBreakpoints){const s=e.screenBreakpoints.map(o=>o).sort((o,l)=>o.screen.width-l.screen.width);let a=this.resolution.display.isZero?this.resolution.display:this.resolution.viewport;const n=this.getClosestListElements(s,o=>o.screen.largerSide<a.largerSide),r=this.getClosestBreakpoint(n.lower,n.higher,a.largerSide,o=>o.screen.largerSide,e.breakpointRounding);r&&(t=r.factor)}return t}getClosestListElements(e,t){const s=[],a=[];e.forEach(o=>{t(o)?s.unshift(o):a.push(o)});const n=s.length?s[0]:void 0,r=a.length?a[0]:void 0;return{lower:n,higher:r}}getClosestBreakpoint(e,t,s,a,n=1){if(qn(n>0&&n<1,"Rounding factor should be within [0, 1]"),e&&!t){const r=a(e);if(r>0){const o={...e};return o.factor=Math.round(e.factor*s/r*10)/10,o}return e}if(t&&!e)return t;if(e&&t){const r=a(e),o=a(t),l=(s-r)/(o-r);return qn(l>=0&&l<=1,"Interpolated value should be within [A, B] range. AB: [".concat(r,", ").concat(o,"], value: ").concat(s)),l<n?e:t}}static getScalingStrategiesConfig(e){switch(e){case p.PCWebOverlay:case p.PCLegacyOverlay:case p.PCLegacyClient:case p.PCElectronClient:case p.Luna:case p.SteamOverlay:case p.SteamClient:case p.PS4Aegir:case p.PS4AegirNative:case p.PS5Aegir:case p.PS5AegirNative:case p.XOneAegir:case p.XOneAegirNative:case p.ScarlettAegir:case p.ScarlettAegirNative:case p.MacOSAegir:case p.MacOSAegirNative:case p.MacOS:case p.Switch:return{defaultFactor:1,breakpointRounding:.9,screenBreakpoints:[{screen:new ki(1280,720),factor:.8},{screen:new ki(1920,1080),factor:1}]};case p.Scarlett:return{defaultFactor:.5};case p.XONE:return{defaultFactor:.4};default:return{defaultFactor:1}}}};Tt.baseFontSizeInPixels=14,Tt.pixelsToRemsRatio=1;let $o=Tt;class BU{constructor(e){this._runtimeParameters=e,this._platformFontSizeMap={[m.Mobile]:this.applyMobileFontSizes.bind(this),[m.Android]:this.applyMobileFontSizes.bind(this),[m.IOS]:this.applyMobileFontSizes.bind(this),[m.PC]:this.applyDefaultFontSizes.bind(this),[m.Luna]:this.applyDefaultFontSizes.bind(this),[m.Steam]:this.applyDefaultFontSizes.bind(this),[m.PS4]:this.applyConsoleFontSizes.bind(this),[m.PS5]:this.applyConsoleFontSizes.bind(this),[m.XONE]:this.applyConsoleFontSizes.bind(this),[m.Scarlett]:this.applyConsoleFontSizes.bind(this),[m.ScarlettUWP]:this.applyConsoleFontSizes.bind(this),[m.Web]:this.applyDefaultFontSizes.bind(this),[m.MacOS]:this.applyDefaultFontSizes.bind(this),[m.Switch]:this.applyConsoleFontSizes.bind(this)},this._platformFontSizeMap[this._runtimeParameters.platformType]()}applyConsoleFontSizes(){et("--font-size-x-small","18rem"),et("--font-size-small","21rem"),et("--font-size-medium","24rem")}applyMobileFontSizes(){et("--font-size-h3","28rem"),et("--font-size-h2","24rem"),et("--font-size-h1","30rem"),et("--font-size-display-heading","42rem")}applyDefaultFontSizes(){et("--font-size-display-heading","56rem"),et("--font-size-h1","40rem"),et("--font-size-h2","32rem"),et("--font-size-h3","24rem"),et("--font-size-x-small","12rem"),et("--font-size-small","14rem"),et("--font-size-medium","16rem")}}class HU{constructor(e,t,s){this._logger=e,this._runtimeParameters=t,this._store=s,$o.Initialize(this._logger,this._runtimeParameters),this._fontSizePerPlatformService=new BU(this._runtimeParameters),this._deviceOrientationService=new $S(this._logger,this._store,this._runtimeParameters)}}const BS=class extends y{constructor(i){super(i),this.myMessageName=BS.type}};let QU=BS;QU.type="MessageCheck2FAActivation";const HS=class extends y{constructor(){super(),this.myMessageName=HS.type}};let jU=HS;jU.type="MessageCheckSecurityStatus";const QS=class extends y{constructor(i){super(i),this.myMessageName=QS.type}};let qU=QS;qU.type="MessageSetSecurityHighlights";const jS=class extends N{constructor(){super(),this.myQueryName=jS.type,this.myResponseType=zS}};let zU=jS;zU.type="QueryGetSecurityHighlights";const qS=class extends T{constructor(i){super(i),this.myQueryResultName=qS.type}};let zS=qS;zS.type="QueryResultGetSecurityHighlights";const KS=class extends N{constructor(){super(),this.myQueryName=KS.type,this.myResponseType=kd}};let XS=KS;XS.type="QueryGetUbisoftTicket";const JS=class extends T{constructor(i){super(i),this.myQueryResultName=JS.type}};let kd=JS;kd.type="QueryResultGetUbisoftTicket";const YS=class extends y{constructor(){super(),this.myMessageName=YS.type}};let KU=YS;KU.type="MessageShowConfirmSwitchBeta";const ZS=class extends y{constructor(i){super(i),this.myMessageName=ZS.type}};let XU=ZS;XU.type="MessageSetConnectBetaEnabled";const ew=class extends y{constructor(i){super(i),this.myMessageName=ew.type}};let JU=ew;JU.type="MessageSetConnectUIEnabled";const tw=class extends y{constructor(i){super(i),this.myMessageName=tw.type}};let iw=tw;iw.type="MessageSetConnectRecoveryState";const sw=class extends y{constructor(i){super(i),this.myMessageName=sw.type}};let aw=sw;aw.type="MessageOpenConnectProductPageById";const nw=class extends y{constructor(){super(),this.myMessageName=nw.type}};let rw=nw;rw.type="MessageConnectPrepareRefreshConnectView";const ow=class extends y{constructor(i){super(i),this.myMessageName=ow.type}};let cw=ow;cw.type="MessageConnectRefreshConnectView";const lw=class extends y{constructor(){super(),this.myMessageName=lw.type}};let YU=lw;YU.type="MessageConnectBetaPromoBubbleDismiss";const pw=class extends y{constructor(){super(),this.myMessageName=pw.type}};let uw=pw;uw.type="MessageAppReload";const dw=class extends y{constructor(){super(),this.myMessageName=dw.type}};let hw=dw;hw.type="MessageConnectViewUIInitialized";const gw=class extends N{constructor(i){super(i),this.myQueryName=gw.type,this.myResponseType=Wd}};let mw=gw;mw.type="QueryCreateConnectBrowserView";const fw=class extends T{constructor(i){super(i),this.myQueryResultName=fw.type}};let Wd=fw;Wd.type="QueryResultCreateConnectBrowserView";const yw=class extends N{constructor(i){super(i),this.myQueryName=yw.type,this.myResponseType=Vd}};let vw=yw;vw.type="QueryAddCookiesConnectBrowserView";const _w=class extends T{constructor(i){super(i),this.myQueryResultName=_w.type}};let Vd=_w;Vd.type="QueryResultAddCookiesConnectBrowserView";const Sw=class extends y{constructor(i){super(i),this.myMessageName=Sw.type}};let ww=Sw;ww.type="MessageUpdateConnectBrowserViewRect";const bw=class extends N{constructor(i){super(i),this.myQueryName=bw.type,this.myResponseType=$d}};let Cw=bw;Cw.type="QueryShowConnectBrowserView";const Iw=class extends T{constructor(i){super(i),this.myQueryResultName=Iw.type}};let $d=Iw;$d.type="QueryResultShowConnectBrowserView";const Mw=class extends N{constructor(i){super(i),this.myQueryName=Mw.type,this.myResponseType=Bd}};let Aw=Mw;Aw.type="QueryHideConnectBrowserView";const Pw=class extends T{constructor(i){super(i),this.myQueryResultName=Pw.type}};let Bd=Pw;Bd.type="QueryResultHideConnectBrowserView";const Nw=class extends y{constructor(i){super(i),this.myMessageName=Nw.type}};let Tw=Nw;Tw.type="MessageDestroyConnectBrowserView";const Rw=class extends y{constructor(i){super(i),this.myMessageName=Rw.type}};let Dw=Rw;Dw.type="MessageSetConnectBrowserViewUrl";const Ow=class extends y{constructor(i){super(i),this.myMessageName=Ow.type}};let Fw=Ow;Fw.type="MessageOnConnectBrowserViewNavigate";const Lw=class extends N{constructor(i){super(i),this.myQueryName=Lw.type,this.myResponseType=Hd}};let Gw=Lw;Gw.type="QueryGetConnectBrowserViewUrl";const xw=class extends T{constructor(i){super(i),this.myQueryResultName=xw.type}};let Hd=xw;Hd.type="QueryResultGetConnectBrowserViewUrl";const Ew=class extends y{constructor(i){super(i),this.myMessageName=Ew.type}};let Uw=Ew;Uw.type="MessageToConnectBrowserView";const kw=class extends y{constructor(i){super(i),this.myMessageName=kw.type}};let Ww=kw;Ww.type="MessageFromConnectBrowserView";const Vw=class extends y{constructor(i){super(i),this.myMessageName=Vw.type}};let ZU=Vw;ZU.type="MessageFromConnectHostView";const $w=class extends y{constructor(i){super(i),this.myMessageName=$w.type}};let e3=$w;e3.type="MessageToConnectHostView";const Bw=class extends y{constructor(i){super(i),this.myMessageName=Bw.type}};let Hw=Bw;Hw.type="MessageOnConnectBrowserViewClosed";const Qw=class extends y{constructor(i){super(i),this.myMessageName=Qw.type}};let t3=Qw;t3.type="MessageConnectChildWindowConfiguration";const jw=class extends N{constructor(i){super(i),this.myQueryName=jw.type,this.myResponseType=Qd}};let qw=jw;qw.type="QueryWindowSetState";const zw=class extends T{constructor(i){super(i),this.myQueryResultName=zw.type}};let Qd=zw;Qd.type="QueryResultWindowSetState";const Kw=class extends N{constructor(){super(),this.myQueryName=Kw.type,this.myResponseType=jd}};let Xw=Kw;Xw.type="QueryWindowGetState";const Jw=class extends T{constructor(i){super(i),this.myQueryResultName=Jw.type}};let jd=Jw;jd.type="QueryResultWindowGetState";const Yw=class extends y{constructor(i){super(i),this.myMessageName=Yw.type}};let Zw=Yw;Zw.type="MessageWindowStateUpdated";const eb=class extends N{constructor(i){super(i),this.myQueryName=eb.type,this.myResponseType=qd}};let tb=eb;tb.type="QueryPassAuthenticate";const ib=class extends T{constructor(i){super(i),this.myQueryResultName=ib.type}};let qd=ib;qd.type="QueryResultPassAuthenticate";const sb=class extends N{constructor(i){super(i),this.myQueryName=sb.type,this.myResponseType=zd}};let ab=sb;ab.type="QueryOfflinePasswordVerification";const nb=class extends T{constructor(i){super(i),this.myQueryResultName=nb.type}};let zd=nb;zd.type="QueryResultOfflinePasswordVerification";const rb=class extends y{constructor(){super(),this.myMessageName=rb.type}};let ob=rb;ob.type="MessageUbiTicketRefreshRequest";const cb=class extends y{constructor(i){super(i),this.myMessageName=cb.type}};let lb=cb;lb.type="MessageUbiTicketRefreshResponse";const pb=class extends y{constructor(i){super(i),this.myMessageName=pb.type}};let ub=pb;ub.type="MessageConnectShutdownBegin";const db=class extends y{constructor(i){super(i),this.myMessageName=db.type}};let hb=db;hb.type="MessageConnectShutdownComplete";const gb=class extends y{constructor(i){super(i),this.myMessageName=gb.type}};let mb=gb;mb.type="MessagePassAuthenticateStats";const fb=class extends N{constructor(){super(),this.myQueryName=fb.type,this.myResponseType=Kd}};let yb=fb;yb.type="QueryGetClientInstallationType";const vb=class extends T{constructor(i){super(i),this.myQueryResultName=vb.type}};let Kd=vb;Kd.type="QueryResultGetClientInstallationType";const _b=class extends N{constructor(){super(),this.myQueryName=_b.type,this.myResponseType=Xd}};let Sb=_b;Sb.type="QueryGetPlatformAuthToken";const wb=class extends T{constructor(i){super(i),this.myQueryResultName=wb.type}};let Xd=wb;Xd.type="QueryResultGetPlatformAuthToken";const bb=class extends N{constructor(i){super(i),this.myQueryName=bb.type,this.myResponseType=Jd}};let Cb=bb;Cb.type="QuerySetSecureStorageItem";const Ib=class extends T{constructor(i){super(i),this.myQueryResultName=Ib.type}};let Jd=Ib;Jd.type="QueryResultSetSecureStorageItem";const Mb=class extends N{constructor(i){super(i),this.myQueryName=Mb.type,this.myResponseType=Yd}};let Ab=Mb;Ab.type="QueryGetSecureStorageItem";const Pb=class extends T{constructor(i){super(i),this.myQueryResultName=Pb.type}};let Yd=Pb;Yd.type="QueryResultGetSecureStorageItem";const Nb=class extends N{constructor(i){super(i),this.myQueryName=Nb.type,this.myResponseType=Zd}};let Tb=Nb;Tb.type="QueryDeleteSecureStorageItem";const Rb=class extends T{constructor(i){super(i),this.myQueryResultName=Rb.type}};let Zd=Rb;Zd.type="QueryResultDeleteSecureStorageItem";const Db=class extends y{constructor(i){super(i),this.myMessageName=Db.type}};let Ob=Db;Ob.type="MessageDeeplinkNavigation";const Fb=class extends y{constructor(i){super(i),this.myMessageName=Fb.type}};let Lb=Fb;Lb.type="MessageDownloadGame";const Gb=class extends y{constructor(i){super(i),this.myMessageName=Gb.type}};let xb=Gb;xb.type="MessageSetActiveDownload";const Eb=class extends y{constructor(i){super(i),this.myMessageName=Eb.type}};let Ub=Eb;Ub.type="MessageGameDownloadActiveChanged";const kb=class extends y{constructor(i){super(i),this.myMessageName=kb.type}};let Wb=kb;Wb.type="MessageGameDownloadAdded";const Vb=class extends y{constructor(i){super(i),this.myMessageName=Vb.type}};let i3=Vb;i3.type="MessageDownloadQueued";const $b=class extends y{constructor(i){super(i),this.myMessageName=$b.type}};let s3=$b;s3.type="MessageAdditionalDownloadAdded";const Bb=class extends N{constructor(){super(),this.myQueryName=Bb.type,this.myResponseType=eh}};let Hb=Bb;Hb.type="QueryGetDownloadQueue";const Qb=class extends T{constructor(i){super(i),this.myQueryResultName=Qb.type}};let eh=Qb;eh.type="QueryResultGetDownloadQueue";const jb=class extends N{constructor(){super(),this.myQueryName=jb.type,this.myResponseType=zb}};let a3=jb;a3.type="QueryGetRetailInstallSources";const qb=class extends T{constructor(i){super(i),this.myQueryResultName=qb.type}};let zb=qb;zb.type="QueryResultGetRetailInstallSources";const Kb=class extends y{constructor(i){super(i),this.myMessageName=Kb.type}};let n3=Kb;n3.type="MessageDownloadRemoved";const Xb=class extends y{constructor(i){super(i),this.myMessageName=Xb.type}};let Jb=Xb;Jb.type="MessageDownloadStateUpdated";const Yb=class extends y{constructor(i){super(i),this.myMessageName=Yb.type}};let Zb=Yb;Zb.type="MessageDownloadAllocatingDiskSpaceProgress";const eC=class extends y{constructor(i){super(i),this.myMessageName=eC.type}};let tC=eC;tC.type="MessageDownloadProgress";const iC=class extends y{constructor(i){super(i),this.myMessageName=iC.type}};let r3=iC;r3.type="MessageDownloadCompleted";const sC=class extends y{constructor(i){super(i),this.myMessageName=sC.type}};let o3=sC;o3.type="MessageDownloadMandatoryFilesCompleted";const aC=class extends y{constructor(i){super(i),this.myMessageName=aC.type}};let nC=aC;nC.type="MessageCancelDownload";const rC=class extends y{constructor(i){super(i),this.myMessageName=rC.type}};let c3=rC;c3.type="MessageCancelRetailInstall";const oC=class extends y{constructor(){super(),this.myMessageName=oC.type}};let cC=oC;cC.type="MessagePauseDownload";const lC=class extends y{constructor(){super(),this.myMessageName=lC.type}};let pC=lC;pC.type="MessageResumeDownload";const uC=class extends y{constructor(i){super(i),this.myMessageName=uC.type}};let dC=uC;dC.type="MessageSetDownloadPriorityOrder";const hC=class extends y{constructor(i){super(i),this.myMessageName=hC.type}};let gC=hC;gC.type="MessageDownloadQueueUpdated";const mC=class extends y{constructor(i){super(i),this.myMessageName=mC.type}};let l3=mC;l3.type="MessageDownloadCancelled";const fC=class extends y{constructor(){super(),this.myMessageName=fC.type}};let p3=fC;p3.type="MessageDownloadPaused";const yC=class extends y{constructor(){super(),this.myMessageName=yC.type}};let u3=yC;u3.type="MessageDownloadResumed";const vC=class extends y{constructor(i){super(i),this.myMessageName=vC.type}};let _C=vC;_C.type="MessageDownloadFailed";const SC=class extends y{constructor(i){super(i),this.myMessageName=SC.type}};let d3=SC;d3.type="MessageVerifyingInstaller";const wC=class extends y{constructor(i){super(i),this.myMessageName=wC.type}};let h3=wC;h3.type="MessageVerifyProgress";const bC=class extends y{constructor(i){super(i),this.myMessageName=bC.type}};let g3=bC;g3.type="MessageVerifyInstallerCancelled";const CC=class extends y{constructor(i){super(i),this.myMessageName=CC.type}};let m3=CC;m3.type="MessageVerifyCompleted";const IC=class extends y{constructor(i){super(i),this.myMessageName=IC.type}};let f3=IC;f3.type="MessageDownloadAdditionalContent";const MC=class extends y{constructor(i){super(i),this.myMessageName=MC.type}};let y3=MC;y3.type="MessageConfirmDeleteInstallers";const AC=class extends y{constructor(){super(),this.myMessageName=AC.type}};let v3=AC;v3.type="MessageDeleteInstallersConfirmed";const PC=class extends y{constructor(){super(),this.myMessageName=PC.type}};let _3=PC;_3.type="MessageCancelDeleteInstallers";const NC=class extends y{constructor(){super(),this.myMessageName=NC.type}};let S3=NC;S3.type="MessageDeleteInstallersFailedDueToActiveDownload";const TC=class extends y{constructor(){super(),this.myMessageName=TC.type}};let w3=TC;w3.type="MessageDeleteInstallers";const RC=class extends y{constructor(){super(),this.myMessageName=RC.type}};let DC=RC;DC.type="MessageConfirmedDeleteInstallers";const OC=class extends y{constructor(){super(),this.myMessageName=OC.type}};let b3=OC;b3.type="MessageInstallersDeleted";const FC=class extends y{constructor(){super(),this.myMessageName=FC.type}};let C3=FC;C3.type="MessageInstallersDeleteFailed";const LC=class extends y{constructor(i){super(i),this.myMessageName=LC.type}};let I3=LC;I3.type="MessageCreateGameFolderFailed";const GC=class extends y{constructor(i){super(i),this.myMessageName=GC.type}};let M3=GC;M3.type="MessageDownloadSetupFailed";const xC=class extends y{constructor(i){super(i),this.myMessageName=xC.type}};let A3=xC;A3.type="MessageDownloadSetupCompleted";const EC=class extends y{constructor(i){super(i),this.myMessageName=EC.type}};let P3=EC;P3.type="MessageDownloadSetupInstallDirRequired";const UC=class extends y{constructor(i){super(i),this.myMessageName=UC.type}};let N3=UC;N3.type="MessageDownloadSetupInstallDirSelected";const kC=class extends y{constructor(i){super(i),this.myMessageName=kC.type}};let T3=kC;T3.type="MessageSetupDownloadInstallationDirUpdated";const WC=class extends y{constructor(i){super(i),this.myMessageName=WC.type}};let R3=WC;R3.type="MessageDownloadSetupInstallDirSpaceUpdated";const VC=class extends y{constructor(i){super(i),this.myMessageName=VC.type}};let D3=VC;D3.type="MessageDownloadSetupLanguageRequired";const $C=class extends y{constructor(i){super(i),this.myMessageName=$C.type}};let O3=$C;O3.type="MessageDownloadSetupLanguageSelected";const BC=class extends y{constructor(i){super(i),this.myMessageName=BC.type}};let F3=BC;F3.type="MessageDownloadSetupGameComponentsRequired";const HC=class extends N{constructor(i){super(i),this.myQueryName=HC.type,this.myResponseType=jC}};let L3=HC;L3.type="QueryDownloadSetupDiskSizeGet";const QC=class extends T{constructor(i){super(i),this.myQueryResultName=QC.type}};let jC=QC;jC.type="QueryResultDownloadSetupDiskSizeGet";const qC=class extends y{constructor(i){super(i),this.myMessageName=qC.type}};let G3=qC;G3.type="MessageDownloadSetupGameComponentsSelected";const zC=class extends y{constructor(i){super(i),this.myMessageName=zC.type}};let x3=zC;x3.type="MessageDownloadSetupLicensesAcceptanceRequired";const KC=class extends y{constructor(i){super(i),this.myMessageName=KC.type}};let E3=KC;E3.type="MessageDownloadSetupLicensesAccepted";const XC=class extends y{constructor(i){super(i),this.myMessageName=XC.type}};let U3=XC;U3.type="MessageDownloadSetupWithdrawalAcceptanceRequired";const JC=class extends y{constructor(i){super(i),this.myMessageName=JC.type}};let k3=JC;k3.type="MessageDownloadSetupWithdrawalAccepted";const YC=class extends y{constructor(i){super(i),this.myMessageName=YC.type}};let W3=YC;W3.type="MessageDownloadSetupActivationRequired";const ZC=class extends y{constructor(i){super(i),this.myMessageName=ZC.type}};let V3=ZC;V3.type="MessageDownloadSetupActivationCompleted";const eI=class extends y{constructor(i){super(i),this.myMessageName=eI.type}};let $3=eI;$3.type="MessageRunningInstallScript";const tI=class extends y{constructor(i){super(i),this.myMessageName=tI.type}};let iI=tI;iI.type="MessageLocateGameInstall";const sI=class extends y{constructor(i){super(i),this.myMessageName=sI.type}};let B3=sI;B3.type="MessageCancelLocateGameInstall";const aI=class extends y{constructor(i){super(i),this.myMessageName=aI.type}};let H3=aI;H3.type="MessageLocateGameInstallStarted";const nI=class extends y{constructor(i){super(i),this.myMessageName=nI.type}};let Q3=nI;Q3.type="MessageLocateGameInstallProgress";const rI=class extends y{constructor(i){super(i),this.myMessageName=rI.type}};let j3=rI;j3.type="MessageLocateGameInstallCompleted";const oI=class extends y{constructor(i){super(i),this.myMessageName=oI.type}};let q3=oI;q3.type="MessageLocateGameInstallFailed";const cI=class extends y{constructor(i){super(i),this.myMessageName=cI.type}};let z3=cI;z3.type="MessageLocateGameInstallCancelled";const lI=class extends y{constructor(i){super(i),this.myMessageName=lI.type}};let pI=lI;pI.type="MessageVerifyGame";const uI=class extends y{constructor(i){super(i),this.myMessageName=uI.type}};let K3=uI;K3.type="MessageVerifyingGame";const dI=class extends y{constructor(i){super(i),this.myMessageName=dI.type}};let X3=dI;X3.type="MessageVerifyGameProgress";const hI=class extends y{constructor(i){super(i),this.myMessageName=hI.type}};let J3=hI;J3.type="MessageVerifyGameCompleted";const gI=class extends y{constructor(i){super(i),this.myMessageName=gI.type}};let Y3=gI;Y3.type="MessageVerifyGameFailed";const mI=class extends y{constructor(i){super(i),this.myMessageName=mI.type}};let Z3=mI;Z3.type="MessageCancelVerifyGame";const fI=class extends y{constructor(i){super(i),this.myMessageName=fI.type}};let e8=fI;e8.type="MessageVerifyGameCancelled";const yI=class extends y{constructor(i){super(i),this.myMessageName=yI.type}};let t8=yI;t8.type="MessageVerifyGameRepair";const vI=class extends y{constructor(i){super(i),this.myMessageName=vI.type}};let i8=vI;i8.type="MessageVerifyGameResolveProgress";const _I=class extends y{constructor(i){super(i),this.myMessageName=_I.type}};let s8=_I;s8.type="MessageVerifyGameResolveCompleted";const SI=class extends y{constructor(i){super(i),this.myMessageName=SI.type}};let a8=SI;a8.type="MessageVerifyInstaller";const wI=class extends y{constructor(i){super(i),this.myMessageName=wI.type}};let n8=wI;n8.type="MessageCancelVerifyInstaller";const bI=class extends y{constructor(i){super(i),this.myMessageName=bI.type}};let r8=bI;r8.type="MessageVerifyInstallerCompleted";const CI=class extends y{constructor(i){super(i),this.myMessageName=CI.type}};let o8=CI;o8.type="MessageRepairInstaller";const II=class extends y{constructor(i){super(i),this.myMessageName=II.type}};let c8=II;c8.type="MessageRepairInstallerCompleted";const MI=class extends y{constructor(i){super(i),this.myMessageName=MI.type}};let l8=MI;l8.type="MessageRepairInstallerFailed";const AI=class extends N{constructor(i){super(i),this.myQueryName=AI.type,this.myResponseType=th}};let PI=AI;PI.type="QueryDownloadProgress";const NI=class extends T{constructor(i){super(i),this.myQueryResultName=NI.type}};let th=NI;th.type="QueryResultDownloadProgress";const TI=class extends y{constructor(i){super(i),this.myMessageName=TI.type}};let RI=TI;RI.type="MessageDownloadLanguageUpdated";const DI=class extends y{constructor(i){super(i),this.myMessageName=DI.type}};let p8=DI;p8.type="MessageDownloadReadmesAndManualsUpdated";const OI=class extends y{constructor(i){super(i),this.myMessageName=OI.type}};let u8=OI;u8.type="MessageDownloadLanguageSelected";const FI=class extends N{constructor(i){super(i),this.myQueryName=FI.type,this.myResponseType=ih}};let LI=FI;LI.type="QueryDownloadGetLanguages";const GI=class extends T{constructor(i){super(i),this.myQueryResultName=GI.type}};let ih=GI;ih.type="QueryResultDownloadGetLanguages";const xI=class extends N{constructor(i){super(i),this.myQueryName=xI.type,this.myResponseType=sh}};let EI=xI;EI.type="QueryDownloadChangeLanguage";const UI=class extends T{constructor(i){super(i),this.myQueryResultName=UI.type}};let sh=UI;sh.type="QueryResultDownloadChangeLanguage";const kI=class extends N{constructor(i){super(i),this.myQueryName=kI.type,this.myResponseType=ah}};let WI=kI;WI.type="QueryInstallOptionalAddon";const VI=class extends T{constructor(i){super(i),this.myQueryResultName=VI.type}};let ah=VI;ah.type="QueryResultInstallOptionalAddon";const $I=class extends N{constructor(i){super(i),this.myQueryName=$I.type,this.myResponseType=nh}};let BI=$I;BI.type="QueryUninstallOptionalAddon";const HI=class extends T{constructor(i){super(i),this.myQueryResultName=HI.type}};let nh=HI;nh.type="QueryResultUninstallOptionalAddon";const QI=class extends y{constructor(i){super(i),this.myMessageName=QI.type}};let jI=QI;jI.type="MessageDownloadVerifyGameProgress";const qI=class extends y{constructor(i){super(i),this.myMessageName=qI.type}};let zI=qI;zI.type="MessageGamePatchInformationUpdated";const KI=class extends y{constructor(i){super(i),this.myMessageName=KI.type}};let d8=KI;d8.type="MessageNewerVersionPartiallyDownloaded";const XI=class extends y{constructor(i){super(i),this.myMessageName=XI.type}};let h8=XI;h8.type="MessageNewerVersionContinueInstall";const JI=class extends y{constructor(i){super(i),this.myMessageName=JI.type}};let g8=JI;g8.type="MessageNewerVersionContinueDownload";const YI=class extends y{constructor(i){super(i),this.myMessageName=YI.type}};let m8=YI;m8.type="MessageDownloadSetupInit";const ZI=class extends y{constructor(i){super(i),this.myMessageName=ZI.type}};let f8=ZI;f8.type="MessageDownloadSetupInitialized";const eM=class extends y{constructor(i){super(i),this.myMessageName=eM.type}};let y8=eM;y8.type="MessageDownloadSetupSwitchToOnlineRequired";const tM=class extends y{constructor(){super(),this.myMessageName=tM.type}};let v8=tM;v8.type="MessageDownloadQueueCompleted";const iM=class extends y{constructor(i){super(i),this.myMessageName=iM.type}};let _8=iM;_8.type="MessageChecking3PPlatform";const sM=class extends y{constructor(i){super(i),this.myMessageName=sM.type}};let S8=sM;S8.type="MessageDownloading3PPlatform";const aM=class extends y{constructor(i){super(i),this.myMessageName=aM.type}};let w8=aM;w8.type="Message3PPlatformDownloadFailed";const nM=class extends y{constructor(i){super(i),this.myMessageName=nM.type}};let b8=nM;b8.type="Message3PPlatformStartingInstaller";const rM=class extends y{constructor(i){super(i),this.myMessageName=rM.type}};let C8=rM;C8.type="Message3PPlatformInstallerFailed";const oM=class extends y{constructor(i){super(i),this.myMessageName=oM.type}};let I8=oM;I8.type="Message3PPDownloadProgress";const cM=class extends y{constructor(){super(),this.myMessageName=cM.type}};let lM=cM;lM.type="MessageDownloadServiceConnectionLost";const pM=class extends y{constructor(){super(),this.myMessageName=pM.type}};let uM=pM;uM.type="MessageDownloadServiceConnectionRestored";const dM=class extends N{constructor(){super(),this.myQueryName=dM.type,this.myResponseType=rh}};let hM=dM;hM.type="QueryGetGamesWithPendingPatches";const gM=class extends T{constructor(i){super(i),this.myQueryResultName=gM.type}};let rh=gM;rh.type="QueryResultGetGamesWithPendingPatches";const mM=class extends N{constructor(){super(),this.myQueryName=mM.type,this.myResponseType=oh}};let fM=mM;fM.type="QueryDownloadServiceConnectionStatus";const yM=class extends T{constructor(i){super(i),this.myQueryResultName=yM.type}};let oh=yM;oh.type="QueryResultDownloadServiceConnectionStatus";const vM=class extends N{constructor(i){super(i),this.myQueryName=vM.type,this.myResponseType=SM}};let M8=vM;M8.type="QueryGetFriends";const _M=class extends T{constructor(i){super(i),this.myQueryResultName=_M.type}};let SM=_M;SM.type="QueryResultGetFriends";const wM=class extends y{constructor(i){super(i),this.myMessageName=wM.type}};let A8=wM;A8.type="MessageRemoveFriendSuggestion";const bM=class extends y{constructor(i){super(i),this.myMessageName=bM.type}};let P8=bM;P8.type="MessageFriendSuggestionShown";const CM=class extends y{constructor(i){super(i),this.myMessageName=CM.type}};let N8=CM;N8.type="MessageFriendsAdded";const IM=class extends y{constructor(i){super(i),this.myMessageName=IM.type}};let T8=IM;T8.type="MessageFriendsUpdated";const MM=class extends y{constructor(i){super(i),this.myMessageName=MM.type}};let R8=MM;R8.type="MessageFriendsDeleted";const AM=class extends y{constructor(i){super(i),this.myMessageName=AM.type}};let D8=AM;D8.type="MessageFriendQuitGame";const PM=class extends N{constructor(){super(),this.myQueryName=PM.type,this.myResponseType=TM}};let O8=PM;O8.type="QueryGetUserInfo";const NM=class extends T{constructor(i){super(i),this.myQueryResultName=NM.type}};let TM=NM;TM.type="QueryResultGetUserInfo";const RM=class extends y{constructor(i){super(i),this.myMessageName=RM.type}};let F8=RM;F8.type="MessageUserUpdated";const DM=class extends N{constructor(){super(),this.myQueryName=DM.type,this.myResponseType=zc}};let ch=DM;ch.type="QueryGetUserActivity";const OM=class extends T{constructor(i){super(i),this.myQueryResultName=OM.type}};let zc=OM;zc.type="QueryResultGetUserActivity";const FM=class extends y{constructor(i){super(i),this.myMessageName=FM.type}};let Kc=FM;Kc.type="MessageUserActivityUpdated";const LM=class extends y{constructor(i){super(i),this.myMessageName=LM.type}};let L8=LM;L8.type="MessageDisplayNameUpdated";const GM=class extends N{constructor(i){super(i),this.myQueryName=GM.type,this.myResponseType=EM}};let G8=GM;G8.type="QueryRequestFriendship";const xM=class extends T{constructor(i){super(i),this.myQueryResultName=xM.type}};let EM=xM;EM.type="QueryResultRequestFriendship";const UM=class extends N{constructor(i){super(i),this.myQueryName=UM.type,this.myResponseType=WM}};let x8=UM;x8.type="QueryRemoveFriend";const kM=class extends T{constructor(i){super(i),this.myQueryResultName=kM.type}};let WM=kM;WM.type="QueryResultRemoveFriend";const VM=class extends N{constructor(i){super(i),this.myQueryName=VM.type,this.myResponseType=BM}};let E8=VM;E8.type="QueryAddToBlacklist";const $M=class extends T{constructor(i){super(i),this.myQueryResultName=$M.type}};let BM=$M;BM.type="QueryResultAddToBlacklist";const HM=class extends N{constructor(i){super(i),this.myQueryName=HM.type,this.myResponseType=jM}};let U8=HM;U8.type="QueryRemoveFromBlacklist";const QM=class extends T{constructor(i){super(i),this.myQueryResultName=QM.type}};let jM=QM;jM.type="QueryResultRemoveFromBlacklist";const qM=class extends N{constructor(i){super(i),this.myQueryName=qM.type,this.myResponseType=KM}};let k8=qM;k8.type="QueryInviteFriendToGame";const zM=class extends T{constructor(i){super(i),this.myQueryResultName=zM.type}};let KM=zM;KM.type="QueryResultInviteFriendToGame";const XM=class extends N{constructor(i){super(i),this.myQueryName=XM.type,this.myResponseType=YM}};let W8=XM;W8.type="QueryFriendSetNickname";const JM=class extends T{constructor(i){super(i),this.myQueryResultName=JM.type}};let YM=JM;YM.type="QueryResultFriendSetNickname";const ZM=class extends y{constructor(i){super(i),this.myMessageName=ZM.type}};let V8=ZM;V8.type="MessageJoinFriendGame";const eA=class extends N{constructor(i){super(i),this.myQueryName=eA.type,this.myResponseType=lh}};let tA=eA;tA.type="QueryActivateKey";const iA=class extends T{constructor(i){super(i),this.myQueryResultName=iA.type}};let lh=iA;lh.type="QueryResultActivateKey";const sA=class extends N{constructor(){super(),this.myQueryName=sA.type,this.myResponseType=nA}};let $8=sA;$8.type="QueryGetOwnedProductIds";const aA=class extends T{constructor(i){super(i),this.myQueryResultName=aA.type}};let nA=aA;nA.type="QueryResultGetOwnedProductIds";const rA=class extends N{constructor(i){super(i),this.myQueryName=rA.type,this.myResponseType=ph}};let oA=rA;oA.type="QueryActivateFreeGame";const cA=class extends T{constructor(i){super(i),this.myQueryResultName=cA.type}};let ph=cA;ph.type="QueryResultActivateFreeGame";const lA=class extends y{constructor(i){super(i),this.myMessageName=lA.type}};let B8=lA;B8.type="MessageStartActivateFreeGame";const pA=class extends y{constructor(i){super(i),this.myMessageName=pA.type}};let uA=pA;uA.type="MessageProductsAdded";const dA=class extends y{constructor(i){super(i),this.myMessageName=dA.type}};let H8=dA;H8.type="MessageProductRemoved";const hA=class extends y{constructor(i){super(i),this.myMessageName=hA.type}};let gA=hA;gA.type="MessageProductsUpdated";const mA=class extends y{constructor(i){super(i),this.myMessageName=mA.type}};let fA=mA;fA.type="MessageGameStateUpdated";const yA=class extends y{constructor(i){super(i),this.myMessageName=yA.type}};let Q8=yA;Q8.type="MessageSetDontUploadCrashReports";const vA=class extends y{constructor(i){super(i),this.myMessageName=vA.type}};let uh=vA;uh.type="MessageDontUploadCrashReportsUpdated";const _A=class extends N{constructor(i){super(i),this.myQueryName=_A.type,this.myResponseType=dh}};let SA=_A;SA.type="QuerySwitchBranch";const wA=class extends T{constructor(i){super(i),this.myQueryResultName=wA.type}};let dh=wA;dh.type="QueryResultSwitchBranch";const bA=class extends N{constructor(i){super(i),this.myQueryName=bA.type,this.myResponseType=hh}};let CA=bA;CA.type="QueryUnlockBranch";const IA=class extends T{constructor(i){super(i),this.myQueryResultName=IA.type}};let hh=IA;hh.type="QueryResultUnlockBranch";const MA=class extends N{constructor(i){super(i),this.myQueryName=MA.type,this.myResponseType=gh}};let AA=MA;AA.type="QueryGetBranches";const PA=class extends T{constructor(i){super(i),this.myQueryResultName=PA.type}};let gh=PA;gh.type="QueryResultGetBranches";const NA=class extends y{constructor(i){super(i),this.myMessageName=NA.type}};let TA=NA;TA.type="MessageAddOnStateUpdated";const RA=class extends y{constructor(i){super(i),this.myMessageName=RA.type}};let DA=RA;DA.type="MessageOpenGameInstallFolder";const OA=class extends y{constructor(i){super(i),this.myMessageName=OA.type}};let FA=OA;FA.type="MessageDisplayReadmeFile";const LA=class extends N{constructor(i){super(i),this.myQueryName=LA.type,this.myResponseType=mh}};let GA=LA;GA.type="QueryCreateGameShortcuts";const xA=class extends T{constructor(i){super(i),this.myQueryResultName=xA.type}};let mh=xA;mh.type="QueryResultCreateGameShortcuts";const EA=class extends y{constructor(i){super(i),this.myMessageName=EA.type}};let UA=EA;UA.type="MessageInstallGame";const kA=class extends y{constructor(i){super(i),this.myMessageName=kA.type}};let WA=kA;WA.type="MessageInstallInstalling";const VA=class extends y{constructor(i){super(i),this.myMessageName=VA.type}};let $A=VA;$A.type="MessageInstallCompleted";const BA=class extends y{constructor(i){super(i),this.myMessageName=BA.type}};let HA=BA;HA.type="MessageRetailInstallCompleted";const QA=class extends y{constructor(i){super(i),this.myMessageName=QA.type}};let jA=QA;jA.type="MessageInstallFailed";const qA=class extends y{constructor(i){super(i),this.myMessageName=qA.type}};let zA=qA;zA.type="MessageInstallCancelled";const KA=class extends y{constructor(i){super(i),this.myMessageName=KA.type}};let XA=KA;XA.type="MessageUninstallGame";const JA=class extends y{constructor(i){super(i),this.myMessageName=JA.type}};let j8=JA;j8.type="MessageConfirmUninstallGame";const YA=class extends y{constructor(i){super(i),this.myMessageName=YA.type}};let q8=YA;q8.type="MessageUninstallGameConfirmed";const ZA=class extends y{constructor(i){super(i),this.myMessageName=ZA.type}};let z8=ZA;z8.type="MessageUninstallGameDeclined";const eP=class extends y{constructor(i){super(i),this.myMessageName=eP.type}};let K8=eP;K8.type="MessageGameUninstalled";const tP=class extends y{constructor(i){super(i),this.myMessageName=tP.type}};let X8=tP;X8.type="MessageGameUninstallFailed";const iP=class extends y{constructor(){super(),this.myMessageName=iP.type}};let J8=iP;J8.type="MessageInstallEnabled";const sP=class extends y{constructor(){super(),this.myMessageName=sP.type}};let Y8=sP;Y8.type="MessageInstallDisabled";const aP=class extends y{constructor(i){super(i),this.myMessageName=aP.type}};let Z8=aP;Z8.type="MessageRestoreInstallation";const nP=class extends y{constructor(i){super(i),this.myMessageName=nP.type}};let ek=nP;ek.type="MessageRestoreInstallationWrongDisc";const rP=class extends y{constructor(i){super(i),this.myMessageName=rP.type}};let tk=rP;tk.type="MessageRestoreInstallationDiscReady";const oP=class extends y{constructor(){super(),this.myMessageName=oP.type}};let ik=oP;ik.type="MessageRestoreInstallationDiscCancel";const cP=class extends y{constructor(i){super(i),this.myMessageName=cP.type}};let sk=cP;sk.type="MessageRestoreInstallationSourceUpdated";const lP=class extends y{constructor(i){super(i),this.myMessageName=lP.type}};let ak=lP;ak.type="MessageUpdateInstallerCachePath";const pP=class extends y{constructor(i){super(i),this.myMessageName=pP.type}};let nk=pP;nk.type="MessageUpdateGameInstallationPath";const uP=class extends y{constructor(i){super(i),this.myMessageName=uP.type}};let rk=uP;rk.type="Message3PPlatformInstalled";const dP=class extends y{constructor(i){super(i),this.myMessageName=dP.type}};let ok=dP;ok.type="MessageRetry3PPlatformInstaller";const hP=class extends y{constructor(i){super(i),this.myMessageName=hP.type}};let gP=hP;gP.type="MessageLocateGameInstallSelectFolder";const mP=class extends y{constructor(i){super(i),this.myMessageName=mP.type}};let fP=mP;fP.type="MessageStartGameFailedLocateGameInstallSelectFolder";const yP=class extends y{constructor(){super(),this.myMessageName=yP.type}};let ck=yP;ck.type="MessageAccountUsernameUpdate";const vP=class extends y{constructor(){super(),this.myMessageName=vP.type}};let lk=vP;lk.type="MessageAccountMissingDateOfBirth";const _P=class extends y{constructor(){super(),this.myMessageName=_P.type}};let pk=_P;pk.type="MessageLoginLockedAccount";const SP=class extends y{constructor(i){super(i),this.myMessageName=SP.type}};let uk=SP;uk.type="MessageAccountShowPendingDeactivationPrompt";const wP=class extends y{constructor(){super(),this.myMessageName=wP.type}};let dk=wP;dk.type="MessageCancelAccountDeactivation";const bP=class extends y{constructor(){super(),this.myMessageName=bP.type}};let hk=bP;hk.type="MessageAccountPendingDeactivationPromptClose";const CP=class extends y{constructor(){super(),this.myMessageName=CP.type}};let gk=CP;gk.type="MessageAccountPendingDeactivationPromptEmailSent";const IP=class extends y{constructor(){super(),this.myMessageName=IP.type}};let mk=IP;mk.type="MessageAccountUsernameUpdated";const MP=class extends y{constructor(i){super(i),this.myMessageName=MP.type}};let fk=MP;fk.type="MessageAccountShowPhoneCollectionPrompt";const AP=class extends N{constructor(i){super(i),this.myQueryName=AP.type,this.myResponseType=NP}};let yk=AP;yk.type="QueryAccountStartPhoneActivation";const PP=class extends T{constructor(i){super(i),this.myQueryResultName=PP.type}};let NP=PP;NP.type="QueryResultAccountStartPhoneActivation";const TP=class extends N{constructor(i){super(i),this.myQueryName=TP.type,this.myResponseType=DP}};let vk=TP;vk.type="QueryAccountVerifyPhoneCode";const RP=class extends T{constructor(i){super(i),this.myQueryResultName=RP.type}};let DP=RP;DP.type="QueryResultAccountVerifyPhoneCode";const OP=class extends N{constructor(i){super(i),this.myQueryName=OP.type,this.myResponseType=LP}};let _k=OP;_k.type="QueryAccountResendPhoneActivationCode";const FP=class extends T{constructor(i){super(i),this.myQueryResultName=FP.type}};let LP=FP;LP.type="QueryResultAccountResendPhoneActivationCode";const GP=class extends y{constructor(){super(),this.myMessageName=GP.type}};let Sk=GP;Sk.type="MessageAccountPhoneCollectionClose";const xP=class extends y{constructor(i){super(i),this.myMessageName=xP.type}};let EP=xP;EP.type="MessageSetRemindMeOfSteamLinking";const UP=class extends y{constructor(i){super(i),this.myMessageName=UP.type}};let fh=UP;fh.type="MessageUpdatedRemindMeOfSteamLinking";const kP=class extends N{constructor(){super(),this.myQueryName=kP.type,this.myResponseType=yh}};let WP=kP;WP.type="QueryGetRemindMeOfSteamLinking";const VP=class extends T{constructor(i){super(i),this.myQueryResultName=VP.type}};let yh=VP;yh.type="QueryResultGetRemindMeOfSteamLinking";const $P=class extends y{constructor(i){super(i),this.myMessageName=$P.type}};let BP=$P;BP.type="MessageBackboneNetworkStatusChanged";const HP=class extends N{constructor(){super(),this.myQueryName=HP.type,this.myResponseType=vh}};let QP=HP;QP.type="QueryBackboneNetworkStatus";const jP=class extends T{constructor(i){super(i),this.myQueryResultName=jP.type}};let vh=jP;vh.type="QueryResultBackboneNetworkStatus";const qP=class extends N{constructor(){super(),this.myQueryName=qP.type,this.myResponseType=KP}};let wk=qP;wk.type="QueryNotificationsGet";const zP=class extends T{constructor(i){super(i),this.myQueryResultName=zP.type}};let KP=zP;KP.type="QueryResultNotificationsGet";const XP=class extends N{constructor(){super(),this.myQueryName=XP.type,this.myResponseType=YP}};let bk=XP;bk.type="QueryUnansweredUserEvents";const JP=class extends T{constructor(i){super(i),this.myQueryResultName=JP.type}};let YP=JP;YP.type="QueryResultUnansweredUserEvents";const ZP=class extends y{constructor(i){super(i),this.myMessageName=ZP.type}};let Xc=ZP;Xc.type="MessageNotificationAdded";const e1=class extends y{constructor(i){super(i),this.myMessageName=e1.type}};let Jc=e1;Jc.type="MessageNotificationStateUpdated";const t1=class extends y{constructor(i){super(i),this.myMessageName=t1.type}};let Ck=t1;Ck.type="MessageNotificationDismiss";const i1=class extends y{constructor(i){super(i),this.myMessageName=i1.type}};let Yc=i1;Yc.type="MessageNotificationDismissed";const s1=class extends y{constructor(){super(),this.myMessageName=s1.type}};let Ik=s1;Ik.type="MessageNotificationDismissAll";const a1=class extends y{constructor(){super(),this.myMessageName=a1.type}};let Mk=a1;Mk.type="MessageNotificationDismissedAll";const n1=class extends y{constructor(i){super(i),this.myMessageName=n1.type}};let Ak=n1;Ak.type="MessageNotificationUnreadCountUpdated";const r1=class extends y{constructor(i){super(i),this.myMessageName=r1.type}};let Pk=r1;Pk.type="MessageNotificationGroupInviteDenied";const o1=class extends y{constructor(i){super(i),this.myMessageName=o1.type}};let Nk=o1;Nk.type="MessageNotificationSeveralGroupInvitesDenied";const c1=class extends y{constructor(i){super(i),this.myMessageName=c1.type}};let Zc=c1;Zc.type="MessageFpsUpdate";const l1=class extends y{constructor(){super(),this.myMessageName=l1.type}};let p1=l1;p1.type="MessageClientPatchDownloaded";const u1=class extends N{constructor(){super(),this.myQueryName=u1.type,this.myResponseType=h1}};let Tk=u1;Tk.type="QueryIsClientPatchDownloaded";const d1=class extends T{constructor(i){super(i),this.myQueryResultName=d1.type}};let h1=d1;h1.type="QueryResultIsClientPatchDownloaded";const g1=class extends y{constructor(i){super(i),this.myMessageName=g1.type}};let m1=g1;m1.type="MessagePlayStart";const f1=class extends y{constructor(i){super(i),this.myMessageName=f1.type}};let y1=f1;y1.type="MessagePlayEnd";const v1=class extends y{constructor(i){super(i),this.myMessageName=v1.type}};let Rk=v1;Rk.type="MessagePlaySessionStarted";const _1=class extends y{constructor(i){super(i),this.myMessageName=_1.type}};let Dk=_1;Dk.type="MessagePlaySessionEnded";const S1=class extends N{constructor(){super(),this.myQueryName=S1.type,this.myResponseType=_h}};let w1=S1;w1.type="QueryIsPlaying";const b1=class extends T{constructor(i){super(i),this.myQueryResultName=b1.type}};let _h=b1;_h.type="QueryResultIsPlaying";const C1=class extends y{constructor(i){super(i),this.myMessageName=C1.type}};let Ok=C1;Ok.type="MessageGameInviteReceived";const I1=class extends y{constructor(i){super(i),this.myMessageName=I1.type}};let Fk=I1;Fk.type="MessageGameInviteRemoved";const M1=class extends N{constructor(i){super(i),this.myQueryName=M1.type,this.myResponseType=el}};let Sh=M1;Sh.type="QueryRespondToGameInvite";const A1=class extends T{constructor(i){super(i),this.myQueryResultName=A1.type}};let el=A1;el.type="QueryResultRespondToGameInvite";const P1=class extends y{constructor(i){super(i),this.myMessageName=P1.type}};let Lk=P1;Lk.type="MessageRespondedToGameInvite";const N1=class extends N{constructor(){super(),this.myQueryName=N1.type,this.myResponseType=R1}};let Gk=N1;Gk.type="QueryIsOverlayLoaded";const T1=class extends T{constructor(i){super(i),this.myQueryResultName=T1.type}};let R1=T1;R1.type="QueryResultIsOverlayLoaded";const D1=class extends y{constructor(i){super(i),this.myMessageName=D1.type}};let xk=D1;xk.type="MessageOverlayLoaded";const O1=class extends y{constructor(i){super(i),this.myMessageName=O1.type}};let F1=O1;F1.type="MessagePlayGame";const L1=class extends y{constructor(i){super(i),this.myMessageName=L1.type}};let G1=L1;G1.type="MessageGameStartArgumentsUpdated";const x1=class extends N{constructor(){super(),this.myQueryName=x1.type,this.myResponseType=wh}};let E1=x1;E1.type="QueryGetRunningProduct";const U1=class extends T{constructor(i){super(i),this.myQueryResultName=U1.type}};let wh=U1;wh.type="QueryResultGetRunningProduct";const k1=class extends y{constructor(i){super(i),this.myMessageName=k1.type}};let W1=k1;W1.type="MessageRunningProductUpdated";const V1=class extends N{constructor(){super(),this.myQueryName=V1.type,this.myResponseType=bh}};let $1=V1;$1.type="QueryGetProducts";const B1=class extends T{constructor(i){super(i),this.myQueryResultName=B1.type}};let bh=B1;bh.type="QueryResultGetProducts";const H1=class extends N{constructor(i){super(i),this.myQueryName=H1.type,this.myResponseType=Ch}};let Q1=H1;Q1.type="QueryGetProduct";const j1=class extends T{constructor(i){super(i),this.myQueryResultName=j1.type}};let Ch=j1;Ch.type="QueryResultGetProduct";const q1=class extends N{constructor(i){super(i),this.myQueryName=q1.type,this.myResponseType=Ih}};let z1=q1;z1.type="QueryGetConnectGameStateInfo";const K1=class extends T{constructor(i){super(i),this.myQueryResultName=K1.type}};let Ih=K1;Ih.type="QueryResultGetConnectGameStateInfo";const X1=class extends y{constructor(i){super(i),this.myMessageName=X1.type}};let J1=X1;J1.type="MessageApplySettings";const Y1=class extends y{constructor(i){super(i),this.myMessageName=Y1.type}};let tl=Y1;tl.type="MessageSettingsUpdated";const Z1=class extends N{constructor(i){super(i),this.myQueryName=Z1.type,this.myResponseType=Ah}};let Mh=Z1;Mh.type="QuerySelectPathDialog";const e0=class extends T{constructor(i){super(i),this.myQueryResultName=e0.type}};let Ah=e0;Ah.type="QueryResultSelectPathDialog";const t0=class extends y{constructor(){super(),this.myMessageName=t0.type}};let i0=t0;i0.type="MessageOpenProxySettingsDialog";const s0=class extends N{constructor(){super(),this.myQueryName=s0.type,this.myResponseType=il}};let Ph=s0;Ph.type="QueryGetSettings";const a0=class extends T{constructor(i){super(i),this.myQueryResultName=a0.type}};let il=a0;il.type="QueryResultGetSettings";const n0=class extends N{constructor(){super(),this.myQueryName=n0.type,this.myResponseType=sl}};let r0=n0;r0.type="QueryGetDefaultSettings";const o0=class extends T{constructor(i){super(i),this.myQueryResultName=o0.type}};let sl=o0;sl.type="QueryResultGetDefaultSettings";const c0=class extends N{constructor(){super(),this.myQueryName=c0.type,this.myResponseType=p0}};let Ek=c0;Ek.type="QueryFetchShellUrlFromBackend";const l0=class extends T{constructor(){super(),this.myQueryResultName=l0.type}};let p0=l0;p0.type="QueryResultFetchShellUrlFromBackend";const u0=class extends y{constructor(i){super(i),this.myMessageName=u0.type}};let d0=u0;d0.type="MessageEnableGameAutoPatching";const h0=class extends N{constructor(i){super(i),this.myQueryName=h0.type,this.myResponseType=m0}};let Uk=h0;Uk.type="QueryGetGameAutoPatchSettings";const g0=class extends T{constructor(i){super(i),this.myQueryResultName=g0.type}};let m0=g0;m0.type="QueryResultGetGameAutoPatchSettings";const f0=class extends y{constructor(i){super(i),this.myMessageName=f0.type}};let y0=f0;y0.type="MessageShutdown";const v0=class extends y{constructor(i){super(i),this.myMessageName=v0.type}};let _0=v0;_0.type="MessageShutdownChangeUser";const S0=class extends y{constructor(i){super(i),this.myMessageName=S0.type}};let w0=S0;w0.type="MessageShutdownSwitchToOnline";const b0=class extends y{constructor(){super(),this.myMessageName=b0.type}};let kk=b0;kk.type="MessagePromptAlwaysOfflineSetting";const C0=class extends y{constructor(i){super(i),this.myMessageName=C0.type}};let Wk=C0;Wk.type="MessageShutdownSwitchToOffline";const I0=class extends y{constructor(i){super(i),this.myMessageName=I0.type}};let Vk=I0;Vk.type="MessageShutdownFailedGameRunning";const M0=class extends y{constructor(){super(),this.myMessageName=M0.type}};let $k=M0;$k.type="MessageShutdownRestartOnPatch";const A0=class extends y{constructor(i){super(i),this.myMessageName=A0.type}};let P0=A0;P0.type="MessageRestartClient";const N0=class extends y{constructor(i){super(i),this.myMessageName=N0.type}};let Bk=N0;Bk.type="MessageShutdownRestartOnSteamPopAlreadyClaimed";const T0=class extends y{constructor(i){super(i),this.myMessageName=T0.type}};let Hk=T0;Hk.type="MessageEnableStore";const R0=class extends y{constructor(){super(),this.myMessageName=R0.type}};let Qk=R0;Qk.type="MessageStoreServicesConnected";const D0=class extends y{constructor(){super(),this.myMessageName=D0.type}};let jk=D0;jk.type="MessageStoreServicesDisconnected";const O0=class extends y{constructor(i){super(i),this.myMessageName=O0.type}};let qk=O0;qk.type="MessageWalletBalance";const F0=class extends y{constructor(i){super(i),this.myMessageName=F0.type}};let zk=F0;zk.type="MessageStoreGamesAdded";const L0=class extends y{constructor(i){super(i),this.myMessageName=L0.type}};let Kk=L0;Kk.type="MessageStoreGamesUpdated";const G0=class extends y{constructor(i){super(i),this.myMessageName=G0.type}};let Xk=G0;Xk.type="MessageStoreGamesRemoved";const x0=class extends y{constructor(i){super(i),this.myMessageName=x0.type}};let Jk=x0;Jk.type="MessageStoreMerchandiseAdded";const E0=class extends y{constructor(i){super(i),this.myMessageName=E0.type}};let Yk=E0;Yk.type="MessageStoreMerchandiseUpdated";const U0=class extends y{constructor(i){super(i),this.myMessageName=U0.type}};let Zk=U0;Zk.type="MessageStoreProductsAdded";const k0=class extends y{constructor(i){super(i),this.myMessageName=k0.type}};let e5=k0;e5.type="MessageStoreProductsUpdated";const W0=class extends y{constructor(i){super(i),this.myMessageName=W0.type}};let t5=W0;t5.type="MessageStoreProductsRemoved";const V0=class extends N{constructor(){super(),this.myQueryName=V0.type,this.myResponseType=B0}};let i5=V0;i5.type="QueryGetStoreEnabled";const $0=class extends T{constructor(i){super(i),this.myQueryResultName=$0.type}};let B0=$0;B0.type="QueryResultGetStoreEnabled";const H0=class extends N{constructor(i){super(i),this.myQueryName=H0.type,this.myResponseType=j0}};let s5=H0;s5.type="QueryGetStoreProductById";const Q0=class extends T{constructor(i){super(i),this.myQueryResultName=Q0.type}};let j0=Q0;j0.type="QueryResultGetStoreProductById";const q0=class extends N{constructor(i){super(i),this.myQueryName=q0.type,this.myResponseType=K0}};let a5=q0;a5.type="QueryGetStoreGames";const z0=class extends T{constructor(i){super(i),this.myQueryResultName=z0.type}};let K0=z0;K0.type="QueryResultGetStoreGames";const X0=class extends N{constructor(i){super(i),this.myQueryName=X0.type,this.myResponseType=Y0}};let n5=X0;n5.type="QueryGetStoreGameInfo";const J0=class extends T{constructor(i){super(i),this.myQueryResultName=J0.type}};let Y0=J0;Y0.type="QueryResultGetStoreGameInfo";const Z0=class extends N{constructor(i){super(i),this.myQueryName=Z0.type,this.myResponseType=tN}};let r5=Z0;r5.type="QueryStoreAddProductToCart";const eN=class extends T{constructor(i){super(i),this.myQueryResultName=eN.type}};let tN=eN;tN.type="QueryResultStoreAddProductToCart";const iN=class extends N{constructor(i){super(i),this.myQueryName=iN.type,this.myResponseType=aN}};let o5=iN;o5.type="QueryStoreAddMerchandiseProductToCart";const sN=class extends T{constructor(i){super(i),this.myQueryResultName=sN.type}};let aN=sN;aN.type="QueryResultStoreAddMerchandiseProductToCart";const nN=class extends y{constructor(){super(),this.myMessageName=nN.type}};let c5=nN;c5.type="MessageStoreAddProductToCartFailureNotification";const rN=class extends y{constructor(){super(),this.myMessageName=rN.type}};let l5=rN;l5.type="MessageShowStoreBillingInformation";const oN=class extends y{constructor(){super(),this.myMessageName=oN.type}};let p5=oN;p5.type="MessageShowStoreHelp";const cN=class extends y{constructor(){super(),this.myMessageName=cN.type}};let u5=cN;u5.type="MessageShowStoreOrderHistory";const lN=class extends y{constructor(){super(),this.myMessageName=lN.type}};let d5=lN;d5.type="MessageShowStoreSubscriptions";const pN=class extends y{constructor(){super(),this.myMessageName=pN.type}};let h5=pN;h5.type="MessageShowStoreSavedCards";const uN=class extends N{constructor(){super(),this.myQueryName=uN.type,this.myResponseType=Nh}};let dN=uN;dN.type="QueryGetPartnerInformationData";const hN=class extends T{constructor(i){super(i),this.myQueryResultName=hN.type}};let Nh=hN;Nh.type="QueryResultGetPartnerInformationData";const gN=class extends N{constructor(i){super(i),this.myQueryName=gN.type,this.myResponseType=Th}};let mN=gN;mN.type="QueryStreamingHostStart";const fN=class extends T{constructor(i){super(i),this.myQueryResultName=fN.type}};let Th=fN;Th.type="QueryResultStreamingHostStart";const yN=class extends y{constructor(i){super(i),this.myMessageName=yN.type}};let vN=yN;vN.type="MessageStreamingHostStatusUpdateData";const _N=class extends N{constructor(){super(),this.myQueryName=_N.type,this.myResponseType=Rh}};let SN=_N;SN.type="QueryStreamingHostStatusUpdateData";const wN=class extends T{constructor(i){super(i),this.myQueryResultName=wN.type}};let Rh=wN;Rh.type="QueryResultStreamingHostStatusUpdateData";const bN=class extends N{constructor(){super(),this.myQueryName=bN.type,this.myResponseType=Dh}};let CN=bN;CN.type="QueryStreamingHostStop";const IN=class extends T{constructor(i){super(i),this.myQueryResultName=IN.type}};let Dh=IN;Dh.type="QueryResultStreamingHostStop";const MN=class extends N{constructor(i){super(i),this.myQueryName=MN.type,this.myResponseType=Oh}};let AN=MN;AN.type="QueryStreamingHostKick";const PN=class extends T{constructor(i){super(i),this.myQueryResultName=PN.type}};let Oh=PN;Oh.type="QueryResultStreamingHostKick";const NN=class extends y{constructor(i){super(i),this.myMessageName=NN.type}};let TN=NN;TN.type="MessageStreamingHostGuestMetricsUpdate";const RN=class extends N{constructor(i){super(i),this.myQueryName=RN.type,this.myResponseType=Fh}};let DN=RN;DN.type="QueryStreamingHostSetSessionSettings";const ON=class extends T{constructor(i){super(i),this.myQueryResultName=ON.type}};let Fh=ON;Fh.type="QueryResultStreamingHostSetSessionSettings";const FN=class extends N{constructor(i){super(i),this.myQueryName=FN.type,this.myResponseType=Lh}};let LN=FN;LN.type="QueryStreamingHostSetGuestSettings";const GN=class extends T{constructor(i){super(i),this.myQueryResultName=GN.type}};let Lh=GN;Lh.type="QueryResultStreamingHostSetGuestSettings";const xN=class extends N{constructor(i){super(i),this.myQueryName=xN.type,this.myResponseType=Gh}};let EN=xN;EN.type="QueryStreamingHostCreateToken";const UN=class extends T{constructor(i){super(i),this.myQueryResultName=UN.type}};let Gh=UN;Gh.type="QueryResultStreamingHostCreateToken";const kN=class extends N{constructor(i){super(i),this.myQueryName=kN.type,this.myResponseType=xh}};let WN=kN;WN.type="QueryStreamingHostGenerateInviteLink";const VN=class extends T{constructor(i){super(i),this.myQueryResultName=VN.type}};let xh=VN;xh.type="QueryResultStreamingHostGenerateInviteLink";const $N=class extends N{constructor(i){super(i),this.myQueryName=$N.type,this.myResponseType=HN}};let g5=$N;g5.type="QueryStreamingHostRetrieveDataFromInviteLink";const BN=class extends T{constructor(i){super(i),this.myQueryResultName=BN.type}};let HN=BN;HN.type="QueryResultStreamingHostRetrieveDataFromInviteLink";const QN=class extends N{constructor(i){super(i),this.myQueryName=QN.type,this.myResponseType=Eh}};let jN=QN;jN.type="QueryStreamingGuestJoin";const qN=class extends T{constructor(i){super(i),this.myQueryResultName=qN.type}};let Eh=qN;Eh.type="QueryResultStreamingGuestJoin";const zN=class extends N{constructor(){super(),this.myQueryName=zN.type,this.myResponseType=Uh}};let KN=zN;KN.type="QueryTelemetryCategoryActive";const XN=class extends T{constructor(i){super(i),this.myQueryResultName=XN.type}};let Uh=XN;Uh.type="QueryResultTelemetryCategoryActive";const JN=class extends y{constructor(){super(),this.myMessageName=JN.type}};let kh=JN;kh.type="MessageAppReady";const YN=class extends y{constructor(){super(),this.myMessageName=YN.type}};let Wh=YN;Wh.type="MessageAppVisible";const ZN=class extends y{constructor(){super(),this.myMessageName=ZN.type}};let Vh=ZN;Vh.type="MessageAppHidden";const eT=class extends y{constructor(i){super(i),this.myMessageName=eT.type}};let tT=eT;tT.type="MessageAppInitialisationFailed";const iT=class extends y{constructor(){super(),this.myMessageName=iT.type}};let sT=iT;sT.type="MessageAppFocus";const aT=class extends y{constructor(i){super(i),this.myMessageName=aT.type}};let nT=aT;nT.type="MessageAppInfo";const rT=class extends N{constructor(){super(),this.myQueryName=rT.type,this.myResponseType=al}};let oT=rT;oT.type="QueryGameSessionGetUserSession";const cT=class extends T{constructor(i){super(i),this.myQueryResultName=cT.type}};let al=cT;al.type="QueryResultGameSessionGetUserSession";const lT=class extends y{constructor(i){super(i),this.myMessageName=lT.type}};let m5=lT;m5.type="MessageGameSessionUserSessionUpdated";const pT=class extends N{constructor(){super(),this.myQueryName=pT.type,this.myResponseType=nl}};let $h=pT;$h.type="QueryGameSessionGetInvites";const uT=class extends T{constructor(i){super(i),this.myQueryResultName=uT.type}};let nl=uT;nl.type="QueryResultGameSessionGetInvites";const dT=class extends y{constructor(i){super(i),this.myMessageName=dT.type}};let Bh=dT;Bh.type="MessageGameSessionInvite";const hT=class extends y{constructor(i){super(i),this.myMessageName=hT.type}};let rl=hT;rl.type="MessageGameSessionInviteUpdated";const gT=class extends y{constructor(i){super(i),this.myMessageName=gT.type}};let Hh=gT;Hh.type="MessageGameSessionInviteAccepted";const mT=class extends y{constructor(i){super(i),this.myMessageName=mT.type}};let Qh=mT;Qh.type="MessageGameSessionInviteDeclined";const fT=class extends y{constructor(i){super(i),this.myMessageName=fT.type}};let jh=fT;jh.type="MessageGameSessionJoin";const yT=class extends N{constructor(){super(),this.myQueryName=yT.type,this.myResponseType=_T}};let f5=yT;f5.type="QueryGameSessionOpenInviteView";const vT=class extends T{constructor(i){super(i),this.myQueryResultName=vT.type}};let _T=vT;_T.type="QueryResultGameSessionOpenInviteView";const ST=class extends N{constructor(i){super(i),this.myQueryName=ST.type,this.myResponseType=ol}};let qh=ST;qh.type="QueryGameSessionSendInvite";const wT=class extends T{constructor(i){super(i),this.myQueryResultName=wT.type}};let ol=wT;ol.type="QueryResultGameSessionSendInvite";const bT=class extends N{constructor(){super(),this.myQueryName=bT.type,this.myResponseType=IT}};let y5=bT;y5.type="QueryGetIngameStoreInfo";const CT=class extends T{constructor(i){super(i),this.myQueryResultName=CT.type}};let IT=CT;IT.type="QueryResultGetIngameStoreInfo";const MT=class extends y{constructor(i){super(i),this.myMessageName=MT.type}};let AT=MT;AT.type="MessageIngameStoreCheckoutStarted";const PT=class extends y{constructor(i){super(i),this.myMessageName=PT.type}};let NT=PT;NT.type="MessageIngameStoreCheckoutFinished";const TT=class extends y{constructor(){super(),this.myMessageName=TT.type}};let RT=TT;RT.type="MessageIngameStoreCheckoutCancel";const DT=class extends y{constructor(i){super(i),this.myMessageName=DT.type}};let cl=DT;cl.type="MessageShowOverlay";const OT=class extends y{constructor(){super(),this.myMessageName=OT.type}};let ll=OT;ll.type="MessageHideOverlay";const FT=class extends y{constructor(i){super(i),this.myMessageName=FT.type}};let pl=FT;pl.type="MessageUbisoftTicketUpdated";const LT=class extends y{constructor(){super(),this.myMessageName=LT.type}};let v5=LT;v5.type="MessageRefreshOverlay";const GT=class extends y{constructor(i){super(i),this.myMessageName=GT.type}};let xT=GT;xT.type="MessageOpenOverlayMicroApp";const ET=class extends y{constructor(i){super(i),this.myMessageName=ET.type}};let UT=ET;UT.type="MessageOpenOverlayMicroAppDeepLink";const kT=class extends y{constructor(i){super(i),this.myMessageName=kT.type}};let WT=kT;WT.type="MessageOpenOverlayMicroAppDeepLinkResult";const VT=class extends y{constructor(i){super(i),this.myMessageName=VT.type}};let $T=VT;$T.type="MessageOpenSteamOverlay";const BT=class extends y{constructor(i){super(i),this.myMessageName=BT.type}};let ul=BT;ul.type="MessageUPNSettingsUpdated";const HT=class extends N{constructor(){super(),this.myQueryName=HT.type,this.myResponseType=jT}};let _5=HT;_5.type="QueryUPNSettingsGet";const QT=class extends T{constructor(i){super(i),this.myQueryResultName=QT.type}};let jT=QT;jT.type="QueryResultUPNSettingsGet";const qT=class extends y{constructor(i){super(i),this.myMessageName=qT.type}};let S5=qT;S5.type="MessageUPNUpdateSettings";const zT=class extends y{constructor(i){super(i),this.myMessageName=zT.type}};let KT=zT;KT.type="MessageUPNUpdateUserSettings";const XT=class extends N{constructor(){super(),this.myQueryName=XT.type,this.myResponseType=zh}};let JT=XT;JT.type="QueryUPNUserSettingsGet";const YT=class extends T{constructor(i){super(i),this.myQueryResultName=YT.type}};let zh=YT;zh.type="QueryResultUPNUserSettingsGet";const ZT=class extends y{constructor(i){super(i),this.myMessageName=ZT.type}};let w5=ZT;w5.type="MessageUPNUserSettingsUpdated";const eR=class extends N{constructor(){super(),this.myQueryName=eR.type,this.myResponseType=iR}};let b5=eR;b5.type="QueryGetTextFromClipboard";const tR=class extends T{constructor(i){super(i),this.myQueryResultName=tR.type}};let iR=tR;iR.type="QueryResultGetTextFromClipboard";const sR=class extends y{constructor(){super(),this.myMessageName=sR.type}};let C5=sR;C5.type="MessageVisitShop";const aR=class extends y{constructor(){super(),this.myMessageName=aR.type}};let I5=aR;I5.type="MessageLeaveGroupConfirm";const nR=class extends y{constructor(){super(),this.myMessageName=nR.type}};let M5=nR;M5.type="MessageLeaveGroupConfirmConfirmed";const rR=class extends y{constructor(){super(),this.myMessageName=rR.type}};let A5=rR;A5.type="MessageActivateUIInitialized";const oR=class extends y{constructor(){super(),this.myMessageName=oR.type}};let P5=oR;P5.type="MessageActivateKeyCloseView";const cR=class extends y{constructor(){super(),this.myMessageName=cR.type}};let N5=cR;N5.type="MessageActivateKeyMinimizeView";const lR=class extends y{constructor(){super(),this.myMessageName=lR.type}};let T5=lR;T5.type="MessageActivateXboxUIInitialized";const pR=class extends y{constructor(){super(),this.myMessageName=pR.type}};let R5=pR;R5.type="MessageBattlePassModalCloseView";const uR=class extends y{constructor(){super(),this.myMessageName=uR.type}};let D5=uR;D5.type="MessageModalViewClosed";const dR=class extends y{constructor(i){super(i),this.myMessageName=dR.type}};let O5=dR;O5.type="MessageMainViewSectionChanged";const hR=class extends y{constructor(i){super(i),this.myMessageName=hR.type}};let F5=hR;F5.type="MessageViewMoved";const gR=class extends y{constructor(){super(),this.myMessageName=gR.type}};let L5=gR;L5.type="MessageShowDeluxeDestinationPath";const mR=class extends y{constructor(i){super(i),this.myMessageName=mR.type}};let G5=mR;G5.type="MessageDeluxeDestinationPathSelected";const fR=class extends y{constructor(){super(),this.myMessageName=fR.type}};let x5=fR;x5.type="MessageMainViewInit";const yR=class extends y{constructor(){super(),this.myMessageName=yR.type}};let E5=yR;E5.type="MessageHideSysTrayNotification";const vR=class extends y{constructor(){super(),this.myMessageName=vR.type}};let U5=vR;U5.type="MessageShowSysTrayNotification";const _R=class extends y{constructor(i){super(i),this.myMessageName=_R.type}};let k5=_R;k5.type="MessageCopyToClipboard";const SR=class extends y{constructor(){super(),this.myMessageName=SR.type}};let wR=SR;wR.type="MessageOpenScreenshotRootPath";const bR=class extends y{constructor(){super(),this.myMessageName=bR.type}};let W5=bR;W5.type="MessageResetDefaultGameInstallationPath";const CR=class extends y{constructor(i){super(i),this.myMessageName=CR.type}};let IR=CR;IR.type="MessageConfirmedResetDefaultGameInstallationPath";const MR=class extends y{constructor(){super(),this.myMessageName=MR.type}};let V5=MR;V5.type="MessageResetDefaultInstallerCachePath";const AR=class extends y{constructor(i){super(i),this.myMessageName=AR.type}};let PR=AR;PR.type="MessageConfirmedResetDefaultInstallerCachePath";var ya=(i=>(i[i.Normal=0]="Normal",i[i.Away=1]="Away",i[i.Busy=2]="Busy",i[i.Invisible=3]="Invisible",i))(ya||{}),rr=(i=>(i[i.NotificationState_Active=0]="NotificationState_Active",i[i.NotificationState_Expired=1]="NotificationState_Expired",i))(rr||{}),Kh=(i=>(i[i.Unknown=0]="Unknown",i[i.ChatMessage=1]="ChatMessage",i[i.DownloadCompleted=2]="DownloadCompleted",i[i.FriendInGame=3]="FriendInGame",i[i.FriendOnline=4]="FriendOnline",i[i.FriendRequest=5]="FriendRequest",i[i.GameInvite=6]="GameInvite",i[i.GamePatchAvailable=7]="GamePatchAvailable",i[i.PartyInvite=8]="PartyInvite",i[i.PlayAvailable=9]="PlayAvailable",i[i.InstallCompleted=10]="InstallCompleted",i[i.ProductAdded=11]="ProductAdded",i[i.GameCustom=12]="GameCustom",i[i.MultipleLogin=13]="MultipleLogin",i[i.UserBanned=14]="UserBanned",i[i.Achievement=15]="Achievement",i[i.ClubAction=16]="ClubAction",i[i.ClubActionOffline=17]="ClubActionOffline",i[i.OverlayStart=18]="OverlayStart",i[i.ScreenshotSaved=19]="ScreenshotSaved",i[i.ScreenshotFailed=20]="ScreenshotFailed",i[i.PartyChatMessage=21]="PartyChatMessage",i[i.OverlayOnboarding=22]="OverlayOnboarding",i[i.ChatOfflineMessage=23]="ChatOfflineMessage",i[i.GroupInvite=24]="GroupInvite",i[i.GroupSeveralInvites=25]="GroupSeveralInvites",i[i.GameTrialEnding=26]="GameTrialEnding",i[i.GroupInviteDenied=27]="GroupInviteDenied",i[i.GroupSeveralInvitesDenied=28]="GroupSeveralInvitesDenied",i[i.SharePlayInviteFailed=29]="SharePlayInviteFailed",i[i.SharePlayTimeOutSessionReminder=30]="SharePlayTimeOutSessionReminder",i[i.SharePlaySessionEnded=31]="SharePlaySessionEnded",i))(Kh||{}),Bo=(i=>(i[i.Added=0]="Added",i[i.Removed=1]="Removed",i))(Bo||{});function X(i,e,t,s){const a=Object.entries(i).find(l=>l[1]===t),n=a?a[0]:null;if(!n)throw new Error('Unable to convert enum, because source enum key cannot be retrieved for value "'.concat(t,'".'));const r=s?s(n):n,o=e[r];if(o===void 0)throw new Error('Unable to convert enum, because target enum value cannot be retrieved for source enum key "'.concat(n,'" and value "').concat(t,'".'));return o}var NR=(i=>(i[i.Success=0]="Success",i[i.KeyNotFound=1]="KeyNotFound",i[i.KeyUsedByOtherAccount=2]="KeyUsedByOtherAccount",i[i.KeyUsedByThisAccount=3]="KeyUsedByThisAccount",i[i.KeyNotAvailableYet=4]="KeyNotAvailableYet",i[i.KeyNotAvailableInRegion=5]="KeyNotAvailableInRegion",i[i.KeyNoLongerAvailable=6]="KeyNoLongerAvailable",i[i.BannedKey=7]="BannedKey",i[i.BannedUser=8]="BannedUser",i[i.ServiceUnavailable=9]="ServiceUnavailable",i))(NR||{}),Xh=(i=>(i.None="none",i.Downloadable="downloadable",i.Installable="installable",i.Playable="playable",i.Installed="installed",i))(Xh||{}),or=(i=>(i[i.Maximize=0]="Maximize",i[i.Minimize=1]="Minimize",i[i.Restore=2]="Restore",i))(or||{}),TR=(i=>(i[i.Failure=0]="Failure",i[i.MissingProfile=1]="MissingProfile",i[i.MissMatchCredential=2]="MissMatchCredential",i))(TR||{}),RR=(i=>(i[i.None=0]="None",i[i.Xbox=1]="Xbox",i))(RR||{}),DR=(i=>(i[i.Unknown=0]="Unknown",i[i.BrandedInstaller=1]="BrandedInstaller",i[i.LaunchProtocol=2]="LaunchProtocol",i[i.InstallProtocol=3]="InstallProtocol",i[i.InstallProtocolRetail=4]="InstallProtocolRetail",i[i.BetaClient=5]="BetaClient",i[i.XboxApp=6]="XboxApp",i))(DR||{}),Jh=(i=>(i[i.DownloadStatus_Init=0]="DownloadStatus_Init",i[i.DownloadStatus_ResumeFiles=1]="DownloadStatus_ResumeFiles",i[i.DownloadStatus_InProgress=2]="DownloadStatus_InProgress",i[i.DownloadStatus_Paused=3]="DownloadStatus_Paused",i[i.DownloadStatus_NetworkError=4]="DownloadStatus_NetworkError",i[i.DownloadStatus_Failure=5]="DownloadStatus_Failure",i[i.DownloadStatus_Cancelled=6]="DownloadStatus_Cancelled",i[i.DownloadStatus_Completed=7]="DownloadStatus_Completed",i[i.DownloadStatus_AllocatingDiskSpace=8]="DownloadStatus_AllocatingDiskSpace",i))(Jh||{}),OR=(i=>(i[i.DownloadErrorState_Generic=0]="DownloadErrorState_Generic",i[i.DownloadErrorState_Disk=1]="DownloadErrorState_Disk",i[i.DownloadErrorState_DiskFull=2]="DownloadErrorState_DiskFull",i[i.DownloadErrorState_DiskAccess=3]="DownloadErrorState_DiskAccess",i))(OR||{}),FR=(i=>(i[i.DownloadQueueUpdateType_DownloadAdded=0]="DownloadQueueUpdateType_DownloadAdded",i[i.DownloadQueueUpdateType_DownloadRemoved=1]="DownloadQueueUpdateType_DownloadRemoved",i[i.DownloadQueueUpdateType_DownloadPriorityUpdated=2]="DownloadQueueUpdateType_DownloadPriorityUpdated",i))(FR||{}),Yh=(i=>(i.Normal="normal",i.Steam="steam",i.Oculus="oculus",i.Nvidia="nvidia",i.Switch="switch",i.WeGame="wegame",i.Equinox="equinox",i))(Yh||{}),dl=(i=>(i[i.None=0]="None",i[i.Downloadable=1]="Downloadable",i[i.Installable=2]="Installable",i[i.Playable=3]="Playable",i))(dl||{}),LR=(i=>(i[i.Failure=0]="Failure",i[i.Success=1]="Success",i))(LR||{}),Zh=(i=>(i[i.Full=0]="Full",i[i.Trial=1]="Trial",i[i.Suspended=2]="Suspended",i))(Zh||{}),GR=(i=>(i[i.General=0]="General",i[i.Steam=1]="Steam",i[i.Equinox=2]="Equinox",i[i.EpicGames=3]="EpicGames",i[i.Microsoft=4]="Microsoft",i))(GR||{}),eg=(i=>(i[i.Unavailable=0]="Unavailable",i[i.PreReleased=1]="PreReleased",i[i.PreDownloadable=2]="PreDownloadable",i[i.Released=3]="Released",i[i.Expired=4]="Expired",i))(eg||{}),tg=(i=>(i.CloseBehavior_Undefined="CloseBehavior_Undefined",i.CloseBehavior_Close="CloseBehavior_Close",i.CloseBehavior_Minimize="CloseBehavior_Minimize",i))(tg||{}),ig=(i=>(i.LandingPageNews="LandingPageNews",i.LandingPageGames="LandingPageGames",i.LandingPageLastPlayedGame="LandingPageLastPlayedGame",i.LandingPageUplayPlus="LandingPageUplayPlus",i))(ig||{}),xR=(i=>(i[i.Desktop=0]="Desktop",i[i.StartMenu=1]="StartMenu",i))(xR||{});const vp={mySender:"MAIN"};function qp(i){var e,t,s,a,n,r;const o=i.user,l=i.overlay,u=i.notifications,v=i.misc,w=i.hotkeys_captureScreenshot,b=i.autoPatching,I=i.conversations,R=i.downloads,x=i.language,F=i.spotlight,V=i.remotePlay;return{user:{nonFriendGameInviteEnabled:o.non_friend_game_invite_enabled,closeBehavior:o.closebehavior?X(tg,Lp,o.closebehavior):Lp.CloseBehavior_Undefined,landingPage:o.landingpage?X(ig,Vm,o.landingpage):Vm.LandingPageNews,startOnWindowsStart:!!o.start_on_windows_start,syncSaveGamesEnabled:!!o.syncsavegames,offline:!!o.offline},overlay:{fpsEnabled:l.fps_enabled,enabled:!!l.enabled,warningEnabled:!!l.warning_enabled},notifications:{inGameEnabled:(e=u.inGameEnabled)!==null&&e!==void 0?e:!1,friendRequestEnabled:!!u.desktopFriendRequestEnabled,friendOnlineEnabled:!!u.desktopFriendOnlineEnabled,friendGameEnabled:!!u.desktopFriendGameEnabled,gameInviteEnabled:!!u.desktopGameInviteEnabled,downloadCompleteEnabled:!!u.desktopDownloadCompleteEnabled,gamePatchAvailableEnabled:!!u.desktopGamePatchAvailableEnabled,playAvailableEnabled:!!u.desktopPlayAvailableEnabled,screenshotsEnabled:!!u.desktopScreenshotsEnabled,groupInviteEnabled:!!u.desktopGroupInviteEnabled,chatEnabled:!!u.desktopChatEnabled,desktopAchievementsEnabled:!!u.desktopAchievementsEnabled,desktopClubActionsEnabled:!!u.desktopClubActionsEnabled,desktopPartyInviteEnabled:!!u.desktopPartyInviteEnabled,sysTrayEnabled:!!u.sysTrayEnabled},misc:{saveScreenshotUncompressedCopy:!!v.save_screenshot_uncompressed_copy,enableAutoWallPosts:!!v.enable_auto_wall_posts,enableScreenshotsOnAchievements:!!v.enable_screenshots_on_achievements,gameInstallationPath:(t=v.game_installation_path)!==null&&t!==void 0?t:"",installerCachePath:(s=v.installer_cache_path)!==null&&s!==void 0?s:"",screenshotRootPath:(a=v.screenshot_root_path)!==null&&a!==void 0?a:""},hotKeys:w,autopatching:{autopatchingEnabled:!!b.enabled},downloads:{downloadLimit:(n=R.limit)!==null&&n!==void 0?n:0,downloadLimitEnabled:!!R.limitEnabled,pauseOnGameLaunch:!!R.pauseOnGameLaunch},conversations:I,language:{languageCode:(r=x.code)!==null&&r!==void 0?r:""},spotlight:{spotlightEnabled:!!F.enabled},remotePlay:{allowed:V.allowed}}}function Ho(i){const e=i.user,t=i.overlay,s=i.notifications,a=i.misc,n=i.hotKeys,r=i.autopatching,o=i.conversations,l=i.downloads,u=i.language,v=i.spotlight,w=i.remotePlay,b={user:{non_friend_game_invite_enabled:e==null?void 0:e.nonFriendGameInviteEnabled,closebehavior:typeof(e==null?void 0:e.closeBehavior)<"u"?X(Lp,tg,e.closeBehavior):void 0,landingpage:ig.LandingPageNews,landingpage_set_by_user:!1,start_on_windows_start:e==null?void 0:e.startOnWindowsStart,syncsavegames:e==null?void 0:e.syncSaveGamesEnabled,offline:e==null?void 0:e.offline},overlay:{fps_enabled:t==null?void 0:t.fpsEnabled,enabled:t==null?void 0:t.enabled,warning_enabled:t==null?void 0:t.warningEnabled},notifications:{inGameEnabled:s==null?void 0:s.inGameEnabled,desktopFriendRequestEnabled:s==null?void 0:s.friendRequestEnabled,desktopFriendOnlineEnabled:s==null?void 0:s.friendOnlineEnabled,desktopFriendGameEnabled:s==null?void 0:s.friendGameEnabled,desktopGameInviteEnabled:s==null?void 0:s.gameInviteEnabled,desktopDownloadCompleteEnabled:s==null?void 0:s.downloadCompleteEnabled,desktopGamePatchAvailableEnabled:s==null?void 0:s.gamePatchAvailableEnabled,desktopPlayAvailableEnabled:s==null?void 0:s.playAvailableEnabled,desktopScreenshotsEnabled:s==null?void 0:s.screenshotsEnabled,desktopGroupInviteEnabled:s==null?void 0:s.groupInviteEnabled,desktopChatEnabled:s==null?void 0:s.chatEnabled,desktopAchievementsEnabled:s==null?void 0:s.desktopAchievementsEnabled,desktopClubActionsEnabled:s==null?void 0:s.desktopClubActionsEnabled,desktopPartyInviteEnabled:s==null?void 0:s.desktopPartyInviteEnabled,sysTrayEnabled:s==null?void 0:s.sysTrayEnabled},misc:{save_screenshot_uncompressed_copy:a==null?void 0:a.saveScreenshotUncompressedCopy,enable_auto_wall_posts:a==null?void 0:a.enableAutoWallPosts,enable_screenshots_on_achievements:a==null?void 0:a.enableScreenshotsOnAchievements,game_installation_path:a==null?void 0:a.gameInstallationPath,installer_cache_path:a==null?void 0:a.installerCachePath,screenshot_root_path:a==null?void 0:a.screenshotRootPath},hotkeys_captureScreenshot:{altState:n==null?void 0:n.altState,controlState:n==null?void 0:n.controlState,shiftState:n==null?void 0:n.shiftState,keyCode:n==null?void 0:n.keyCode},downloads:{limit:l==null?void 0:l.downloadLimit,limitEnabled:l==null?void 0:l.downloadLimitEnabled,pauseOnGameLaunch:l==null?void 0:l.pauseOnGameLaunch},autoPatching:{enabled:r==null?void 0:r.autopatchingEnabled},conversations:{taskbarTabsEnabled:o==null?void 0:o.taskbarTabsEnabled},language:{code:u==null?void 0:u.languageCode},spotlight:{enabled:v==null?void 0:v.spotlightEnabled},remotePlay:{allowed:w==null?void 0:w.allowed}};return Xx(b)}class hl{constructor(){this._notificationToMessageConverterMap=new Map,this.registerHostNotificationToMessageConverter(Cr,()=>new cl),this.registerHostNotificationToMessageConverter(bn,()=>new ll),this.registerHostNotificationToMessageConverter(Ir,e=>new pl({myTicket:e.ticket})),this.registerHostNotificationToMessageConverter(Mr,e=>{const t=e.uiNotification;return new Xc({myNotification:{myId:t.id,myIsPersistent:t.isPersistent,myType:X(O,Kh,t.type),myState:X(tr,rr,t.state,s=>"NotificationState_".concat(s)),myAccountId:t.accountId,myInviteId:t.inviteId,myTimestamp:t.timestamp,myJSON:t.json}})}),this.registerHostNotificationToMessageConverter(Ar,e=>new Jc({myId:e.id,myState:X(tr,rr,e.state,t=>"NotificationState_".concat(t))})),this.registerHostNotificationToMessageConverter(Pr,e=>new Yc({myId:e.id})),this.registerHostNotificationToMessageConverter(Nr,e=>new Zc({myProcessId:e.processId,myFpsUpdate:e.fpsUpdate})),this.registerHostNotificationToMessageConverter(Tr,e=>new Kc({myActivityStatus:X(hs,ya,e.userActivityStatus),myPrevActivityStatus:X(hs,ya,e.previousUserActivityStatus)})),this.registerHostNotificationToMessageConverter(Rr,e=>{const t=e.gameSession;return new rl({myInviterProfileId:e.inviterProfileId,myGameSession:{myUbiAppId:t.applicationId,myGameSpaceId:t.gameSpaceId,myGameSessionId:t.gameSessionId},myStatus:e.state===Eo.Pending?Bo.Added:Bo.Removed,myTtlMs:e.ttlMs,myCreationTimestampMs:e.creationTimestampMs})}),this.registerHostNotificationToMessageConverter(Dr,e=>{const t=e.settings.user,s=e.settings.overlay,a=e.settings.notifications,n=e.settings.misc,r=e.settings.hotKeys;return new ul({mySettings:{user:{non_friend_game_invite_enabled:t.nonFriendGameInviteEnabled},overlay:{fps_enabled:s.fpsEnabled},notifications:{inGameEnabled:a.inGameEnabled,desktopFriendRequestEnabled:!!a.friendRequestEnabled,desktopFriendOnlineEnabled:!!a.friendOnlineEnabled,desktopFriendGameEnabled:!!a.friendGameEnabled,desktopGameInviteEnabled:!!a.gameInviteEnabled,desktopDownloadCompleteEnabled:!!a.downloadCompleteEnabled,desktopGamePatchAvailableEnabled:!!a.gamePatchAvailableEnabled,desktopPlayAvailableEnabled:!!a.playAvailableEnabled,desktopScreenshotsEnabled:!!a.screenshotsEnabled,desktopGroupInviteEnabled:!!a.groupInviteEnabled,desktopChatEnabled:!!a.chatEnabled},misc:{save_screenshot_uncompressed_copy:n.saveScreenshotUncompressedCopy},hotkeys_captureScreenshot:r}})}),this.registerHostNotificationToMessageConverter(Or,e=>{const t=Ho(e.settings);return new tl({mySettings:t})}),this.registerHostNotificationToMessageConverter(Ec,e=>new uh({myDontUploadCrashReports:e.dontSendCrashReportsEnabled})),this.registerHostNotificationToMessageConverter(Uc,e=>new fh({myRemindMeOfSteamLinking:e.remindMeOfSteamLinking}))}registerHostNotificationToMessageConverter(e,t){this._notificationToMessageConverterMap.set(e.type,t)}hostNotificationToIncomingMessage(e){const t=this._notificationToMessageConverterMap.get(e.hostNotificationName);return t?t(e):this.convertUnknownHostNotificationToMessage(e)}convertUnknownHostNotificationToMessage(e){return Object.assign(Object.assign({},e),{myMessageName:e.hostNotificationName})}convertMessageToHostNotificationType(e){var t;const s=hl.messageToNotificationTypeMap[e];return(t=s==null?void 0:s.type)!==null&&t!==void 0?t:e}}hl.messageToNotificationTypeMap={[cl.type]:Cr,[ll.type]:bn,[pl.type]:Ir,[Xc.type]:Mr,[Jc.type]:Ar,[Yc.type]:Pr,[Zc.type]:Nr,[Kc.type]:Tr,[rl.type]:Rr,[ul.type]:Dr,[tl.type]:Or};const se=i=>{const e=Number(i);if(i==null||isNaN(e))throw new Error('Unable to convert "'.concat(String(i),'" to number.'));return e},$=i=>{if(typeof i!="number"||isNaN(i))throw new Error('Unable to convert "'.concat(String(i),'" to brand because it is not a number.'));return i.toString()};function zp(i){return{id:i.myId,gameId:$(i.myGameId),status:X(Jh,aa,i.myState),isActive:i.myIsActive}}function ER(i){return{id:$(i.myId),name:i.myName,gameId:$(i.myGameId),isOwned:i.myIsOwned,state:X(Xh,Ly,i.myState),isOptionalDefaultEnabled:i.myIsOptionalDefaultEnabled,isOptional:i.myIsOptional,isVisible:i.myIsVisible,isLocked:i.myIsLocked,gameKey:i.myCdKey}}function sg(i){return{id:typeof i.myIdStr>"u"?$(i.myId):i.myIdStr,gameId:$(i.myProductId),name:i.myName}}function Yn(i,e=!1){return i===""||i===0||typeof i>"u"?e?$(0):void 0:typeof i=="number"?$(i):i}function $5(i){return{id:$(i.myId),spaceId:i.myConfig.mySpaceId,applicationId:"",uplayId:$(i.myUplayId),state:X(dl,Xu,i.myState),platform:X(Yh,Gy,i.myPlatform),config:{name:i.myConfig.myName,spaceId:i.myConfig.mySpaceId,isChangeLanguageEnabled:i.myConfig.myIsChangeLanguageEnabled,isSharePlayEnabled:i.myConfig.myIsSharePlayEnabled,isRemotePlayEnabled:i.myConfig.myIsRemotePlayEnabled,isDevMode:!!i.myConfig.mySdkDevMode},isUninstallable:i.myIsUninstallable,isDownloadNeeded:i.myIsDownloadNeeded,addOns:i.myAddOns.map(ER),branches:i.myBranches.map(sg),currentBranch:Yn(i.myBranchIdStr||i.myBranchId,!0),useDefaultBranch:i.myUseDefaultBranch,releaseState:X(eg,xy,i.myReleaseState),ownershipState:X(Zh,Ey,i.myOwnershipState),executables:i.myConfig.myExecutableList.map(({myDescription:e,myIndex:t})=>({id:$(t),description:e})),isReadmeAvailable:i.myIsReadmeAvailable,gameKey:i.myKey}}function Ya(i){let e;return i.myGame&&(e=$5(i.myGame)),{id:$(i.myId),game:e}}class B5{constructor(){this._incomingMessageToHostNotificationConverterMap=new Map,this._incomingMessageToHostRequestConverterMap=new Map,this.registerMessageToHostNotificationConverter(cl,()=>new Cr),this.registerMessageToHostNotificationConverter(ll,()=>new bn),this.registerMessageToHostNotificationConverter(pl,e=>new Ir({ticket:e.myTicket})),this.registerMessageToHostNotificationConverter(Xc,e=>{const t=e.myNotification;return new Mr({uiNotification:{id:t.myId,isPersistent:t.myIsPersistent,type:X(Kh,O,t.myType),state:X(rr,tr,t.myState,s=>s.replace("NotificationState_","")),accountId:t.myAccountId,inviteId:t.myInviteId,timestamp:t.myTimestamp,json:t.myJSON}})}),this.registerMessageToHostNotificationConverter(Jc,e=>new Ar({id:e.myId,state:X(rr,tr,e.myState,t=>t.replace("NotificationState_",""))})),this.registerMessageToHostNotificationConverter(Yc,e=>new Pr({id:e.myId})),this.registerMessageToHostNotificationConverter(Zc,e=>new Nr({processId:e.myProcessId,fpsUpdate:e.myFpsUpdate})),this.registerMessageToHostNotificationConverter(Kc,e=>new Tr({userActivityStatus:X(ya,hs,e.myActivityStatus),previousUserActivityStatus:X(ya,hs,e.myPrevActivityStatus)})),this.registerMessageToHostNotificationConverter(rl,e=>{const t=e.myGameSession;return new Rr({inviterProfileId:e.myInviterProfileId,gameSession:{applicationId:t.myUbiAppId,gameSpaceId:t.myGameSpaceId,gameSessionId:t.myGameSessionId},state:e.myStatus===Bo.Added?Eo.Pending:Eo.Accepted,ttlMs:e.myTtlMs,creationTimestampMs:e.myCreationTimestampMs})}),this.registerMessageToHostRequestConverter(xT,e=>new Cn({navigationContext:{appName:e.microAppName,applicationData:e.microAppParams}})),this.registerMessageToHostRequestConverter(UT,e=>new Ju({navigationContext:{appName:e.microAppName,applicationData:e.microAppParams},requestId:e.requestId,senderId:e.senderId})),this.registerMessageToHostNotificationConverter(ul,e=>{var t;const s=e.mySettings.user,a=e.mySettings.overlay,n=e.mySettings.notifications,r=e.mySettings.misc,o=e.mySettings.hotkeys_captureScreenshot,l={user:{nonFriendGameInviteEnabled:s.non_friend_game_invite_enabled},overlay:{fpsEnabled:a.fps_enabled},notifications:{inGameEnabled:(t=n.inGameEnabled)!==null&&t!==void 0?t:!1,friendRequestEnabled:n.desktopFriendRequestEnabled,friendOnlineEnabled:n.desktopFriendOnlineEnabled,friendGameEnabled:n.desktopFriendGameEnabled,gameInviteEnabled:n.desktopGameInviteEnabled,downloadCompleteEnabled:n.desktopDownloadCompleteEnabled,gamePatchAvailableEnabled:n.desktopGamePatchAvailableEnabled,playAvailableEnabled:n.desktopPlayAvailableEnabled,screenshotsEnabled:n.desktopScreenshotsEnabled,groupInviteEnabled:n.desktopGroupInviteEnabled,chatEnabled:n.desktopChatEnabled},misc:{saveScreenshotUncompressedCopy:r.save_screenshot_uncompressed_copy},hotKeys:o};return new Dr({settings:l})}),this.registerMessageToHostNotificationConverter(tl,e=>{const t=qp(e.mySettings);return new Or({settings:t})}),this.registerMessageToHostNotificationConverter(vN,e=>new Yu({state:e.myState,guests:e.myGuests.map(t=>({guestId:t.myGuestId,profileId:t.myProfileId,connectedTimestamp:t.myConnectedTS,settings:{permissions:{gamepad:t.mySettings.myPermissions.myGamepad,keyboard:t.mySettings.myPermissions.myKeyboard,mouse:t.mySettings.myPermissions.myMouse,immersive:t.mySettings.myPermissions.myImmersive}}})),maxGuestsAllowed:e.myMaxGuestsAllowed,maxSessionDuration:e.myMaxSessionDuration,settings:{bitrateMbps:e.mySettings.myBitrateMbps,resolution:e.mySettings.myResolution,fps:e.mySettings.myFPS},error:e.myError&&{code:e.myError.myCode,source:e.myError.mySource},focus:e.myFocus})),this.registerMessageToHostNotificationConverter(TN,e=>new Zu({metrics:e.myGuests.map(t=>({bitrateMbps:t.myBitrateMbps,guestId:t.myGuestId,latencyMs:t.myLatencyMs,networkQuality:t.myNetworkQuality}))})),this.registerMessageToHostNotificationConverter(uh,e=>new Ec({dontSendCrashReportsEnabled:e.myDontUploadCrashReports})),this.registerMessageToHostNotificationConverter(fh,e=>new Uc({remindMeOfSteamLinking:e.myRemindMeOfSteamLinking})),this.registerMessageToHostNotificationConverter(fA,e=>{var t;return new Uy({uplayId:$(e.myUplayId),gameId:$(e.myGameId),state:X(dl,Xu,e.myState),isDownloadNeeded:e.myIsDownloadNeeded,isUninstallable:e.myIsUninstallable,installDir:(t=e.myInstallDir)!==null&&t!==void 0?t:""})}),this.registerMessageToHostNotificationConverter(zI,e=>new ky({gameId:$(e.myGameId),isPatchAvailable:e.myIsGamePatchAvailable})),this.registerMessageToHostNotificationConverter(TA,e=>new Wy({addOnId:$(e.myAddOnId),gameId:$(e.myGameId),state:X(Xh,Ly,e.myState)})),this.registerMessageToHostNotificationConverter(Fw,e=>new ed({browserId:$(e.myBrowserId),url:e.myNewUrl})),this.registerMessageToHostNotificationConverter(Hw,e=>new td({browserId:$(e.myBrowserId)})),this.registerMessageToHostNotificationConverter(Ww,e=>new id({browserId:$(e.myBrowserId),message:e.myPayload})),this.registerMessageToHostNotificationConverter(aw,e=>new Vy({productId:$(e.myProductId),spaceId:e.mySpaceId,applicationId:e.myUbiservicesAppId})),this.registerMessageToHostNotificationConverter(m1,e=>new $y({gameId:$(e.myGameId)})),this.registerMessageToHostNotificationConverter(y1,e=>new By({gameId:$(e.myGameId)})),this.registerMessageToHostNotificationConverter(_C,e=>new Hy({gameId:e.myId,error:X(OR,Jx,e.myError,t=>t.replace("DownloadErrorState_",""))})),this.registerMessageToHostNotificationConverter(tC,e=>new Qy({gameId:e.myId,progress:{bytesDownloaded:e.myProgress.myBytesDownloaded,bytesPerSecond:e.myProgress.myBytesPerSecond,bytesToDownload:e.myProgress.myBytesToDownload,etaInSeconds:e.myProgress.myEtaInSeconds,progress:e.myProgress.myProgress,maxBytesPerSecond:e.myProgress.myMaxBytesPerSecond,requiredBytesDownloaded:e.myProgress.myRequiredBytesDownloaded,requiredBytesToDownload:e.myProgress.myRequiredBytesToDownload,requiredEtaInSeconds:e.myProgress.myRequiredEtaInSecond}})),this.registerMessageToHostNotificationConverter(jI,e=>new jy({gameId:$(e.myGameId),progress:e.myProgress})),this.registerMessageToHostNotificationConverter(Zb,e=>new qy({gameId:e.myId,progress:e.myProgress})),this.registerMessageToHostNotificationConverter(Jb,e=>new zy({gameId:e.myId,state:X(Jh,aa,e.myState)})),this.registerMessageToHostNotificationConverter(Ub,e=>new Ky({gameId:e.myId})),this.registerMessageToHostNotificationConverter(Wb,e=>new Xy({download:e.myDownload?zp(e.myDownload):void 0})),this.registerMessageToHostNotificationConverter(lM,e=>new Gp({hasConnection:!1})),this.registerMessageToHostNotificationConverter(uM,e=>new Gp({hasConnection:!0})),this.registerMessageToHostNotificationConverter(gC,e=>{var t;const s=(t=e==null?void 0:e.myDownloads)===null||t===void 0?void 0:t.map(zp);return new Jy({downloads:s,updateType:X(FR,Yx,e.myUpdateType,a=>{const n=a.replace("DownloadQueueUpdateType_","");return n==="DownloadPriorityUpdate"?"DownloadPriorityUpdated":n})})}),this.registerMessageToHostNotificationConverter(RI,e=>new Yy({gameId:$(e.myGameId),selectedLanguage:e.mySelectedLanguage,languages:e.myLanguages})),this.registerMessageToHostNotificationConverter(iI,e=>new Zy({gameId:$(e.myGameId),installDir:e.myInstallDir})),this.registerMessageToHostNotificationConverter(p1,e=>new sd),this.registerMessageToHostNotificationConverter(Zw,e=>new ad({newState:X(or,ns,e.myNewState)})),this.registerMessageToHostNotificationConverter(uA,e=>{const t=e.myProducts.map(Ya);return new ev({products:t})}),this.registerMessageToHostNotificationConverter(gA,e=>{const t=e.myProducts.map(Ya);return new tv({products:t})}),this.registerMessageToHostNotificationConverter(WA,e=>new iv({productId:$(e.myGameId)})),this.registerMessageToHostNotificationConverter(jA,e=>new sv({productId:$(e.myGameId),name:e.myName})),this.registerMessageToHostNotificationConverter(zA,e=>new av({productId:$(e.myGameId)})),this.registerMessageToHostNotificationConverter($A,e=>new nv({productId:$(e.myGameId)})),this.registerMessageToHostNotificationConverter(HA,e=>new rv({productId:$(e.myGameId)})),this.registerMessageToHostNotificationConverter(ob,e=>new nd),this.registerMessageToHostRequestConverter(ub,e=>new rd),this.registerMessageToHostNotificationConverter(rw,e=>new od),this.registerMessageToHostNotificationConverter(RT,e=>new ov),this.registerMessageToHostNotificationConverter(Ob,e=>new cv({url:e.myUrl})),this.registerMessageToHostNotificationConverter(W1,e=>new lv({product:Ya(e.myProduct),addOnId:e.myAddonId?$(e.myAddonId):void 0})),this.registerMessageToHostNotificationConverter(BP,e=>new cd({isDegraded:!e.myIsConnected}))}registerMessageToHostNotificationConverter(e,t){this._incomingMessageToHostNotificationConverterMap.set(e.type,t)}registerMessageToHostRequestConverter(e,t){this._incomingMessageToHostRequestConverterMap.set(e.type,t)}incomingMessageToHostNotification(e,t){const s=this._incomingMessageToHostNotificationConverterMap.get(e.myMessageName),a=s?s(e):this.convertUnknownMessageToHostNotification(e);return a.contextId=t,a}convertUnknownMessageToHostNotification(e){return Object.assign(Object.assign({},e),{hostNotificationName:e.myMessageName})}incomingMessageToHostRequest(e,t){const s=this._incomingMessageToHostRequestConverterMap.get(e.myMessageName);if(s){const a=s(e);return a.contextId=t,a}}}class H5{constructor(){this._shellNotificationToOutgoingMessageConverterMap=new Map,this._shellResponseToOutgoingMessageConverterMap=new Map,this.registerShellNotificationConverter(ld,e=>{const t=e.gameSession;return new Bh({myProfileIdsToInvite:e.profileIdsToInvite,myGameSession:{myUbiAppId:t.applicationId,myGameSpaceId:t.gameSpaceId,myGameSessionId:t.gameSessionId}})}),this.registerShellNotificationConverter(pd,e=>{const t=e.gameSession;return new Hh({myInviterProfileId:e.inviterProfileId,myGameSession:{myUbiAppId:t.applicationId,myGameSpaceId:t.gameSpaceId,myGameSessionId:t.gameSessionId}})}),this.registerShellNotificationConverter(pv,e=>{const t=e;return new d0({myEnabled:t.enabled,myProductId:se(t.gameId)})}),this.registerShellNotificationConverter(ud,e=>{const t=e.gameSession;return new Qh({myInviterProfileId:e.inviterProfileId,myGameSession:{myUbiAppId:t.applicationId,myGameSpaceId:t.gameSpaceId,myGameSessionId:t.gameSessionId}})}),this.registerShellNotificationConverter(dd,e=>{const t=e.gameSession;return new jh({myProfileIdToJoin:e.profileIdToJoin,myGameSession:{myUbiAppId:t.applicationId,myGameSpaceId:t.gameSpaceId,myGameSessionId:t.gameSessionId}})}),this.registerShellResponseConverter(xp,e=>new WT({result:e.isSuccessful,requestId:e.requestId,senderId:e.senderId})),this.registerShellNotificationConverter(uv,()=>new hw),this.registerShellNotificationConverter(br,()=>new kh),this.registerShellNotificationConverter(hd,()=>new Wh),this.registerShellNotificationConverter(Gc,()=>new Vh),this.registerShellNotificationConverter(dv,()=>new uw),this.registerShellNotificationConverter(hv,e=>new Lb({myGameId:se(e.gameId),myDownloadTriggerInfo:{myBrandedInstallerInfo:{myId:e.initiator},myInitiator:X(Zx,DR,e.initiatedFrom)}})),this.registerShellNotificationConverter(gv,()=>new cC),this.registerShellNotificationConverter(mv,()=>new pC),this.registerShellNotificationConverter(fv,e=>new F1({myGameId:se(e.gameId),myExeIndex:e.exeId?se(e.exeId):0,myExeArguments:e.exeArguments,myLaunchSource:e.initiator,myProtocolSource:e.initiatedFrom.toUpperCase()})),this.registerShellNotificationConverter(yv,e=>new UA({myGameId:se(e.productId)})),this.registerShellNotificationConverter(vv,e=>new G1({myGameId:se(e.gameId),myArguments:e.launchArguments})),this.registerShellNotificationConverter(_v,e=>new nC({myId:e.gameId})),this.registerShellNotificationConverter(Sv,e=>new xb({myId:e.gameId})),this.registerShellNotificationConverter(wv,e=>new XA({myGameId:se(e.gameId),myUplayId:e.uplayId!==void 0?se(e.uplayId):void 0})),this.registerShellNotificationConverter(bv,e=>new pI({myGameId:se(e.gameId),myInstallDir:e.installDir})),this.registerShellNotificationConverter(Cv,e=>new FA({myGameId:se(e.gameId)})),this.registerShellNotificationConverter(Iv,e=>new DA({myGameId:se(e.gameId)})),this.registerShellNotificationConverter(Mv,e=>new gP({myGameId:se(e.gameId)})),this.registerShellNotificationConverter(Av,e=>new fP({myGameId:se(e.gameId)})),this.registerShellNotificationConverter(Pv,e=>new dC({myGameId:se(e.gameId),myPriorityOrder:e.priorityOrder})),this.registerShellNotificationConverter(Nv,()=>new DC),this.registerShellNotificationConverter(Tv,()=>new wR),this.registerShellNotificationConverter(Rv,()=>new IR(vp)),this.registerShellNotificationConverter(Dv,()=>new PR(vp)),this.registerShellNotificationConverter(Ov,e=>new P0({myForceQuit:e.forceQuit})),this.registerShellNotificationConverter(Fv,()=>new w0),this.registerShellNotificationConverter(Lv,()=>new i0),this.registerShellNotificationConverter(Gv,e=>{const t=Ho(e.settings);return new J1(Object.assign(Object.assign({},vp),{mySettings:t}))}),this.registerShellNotificationConverter(xv,e=>new _0({myForceQuit:!0})),this.registerShellNotificationConverter(gd,e=>new y0({myForceQuit:!0})),this.registerShellNotificationConverter(Ev,e=>new sT),this.registerShellNotificationConverter(Uv,e=>new KT({myDontSendCrashReports:e.dontSendCrashReportsEnabled})),this.registerShellNotificationConverter(kv,e=>new EP({myRemindMeOfSteamLinking:e.remindMeOfSteamLinking})),this.registerShellNotificationConverter(Wv,e=>new Tw({myBrowserId:se(e.browserId)})),this.registerShellNotificationConverter(Vv,e=>new ww({myBrowserId:se(e.browserId),myBrowserRect:{myX:e.rect.x,myY:e.rect.y,myWidth:e.rect.width,myHeight:e.rect.height}})),this.registerShellNotificationConverter($v,e=>new Dw({myBrowserId:se(e.browserId),myUrl:e.url})),this.registerShellNotificationConverter(Bv,e=>new Uw({myBrowserId:se(e.browserId),myPayload:e.message})),this.registerShellNotificationConverter(Hv,e=>new iw({myRecoveryPageActive:e.isRecoveryPageActive,myReason:e.reason})),this.registerShellNotificationConverter(Qv,e=>new cw({mySource:e.source,myReason:e.reason})),this.registerShellNotificationConverter(jv,e=>new $T({mySteamAppId:e.steamAppId!==void 0?se(e.steamAppId):void 0,myUrl:e.url})),this.registerShellNotificationConverter(md,e=>new lb({myUbiTicket:e.ubiTicket,mySpaceId:e.spaceId,mySessionId:e.sessionId,myProfileId:e.profileId,myExpiration:e.expiration})),this.registerShellResponseConverter(qv,e=>new hb({myIsCanceled:e.isCanceled})),this.registerShellNotificationConverter(zv,e=>new tT({myMessage:e.message,myErrorCode:e.errorCode,myError:e.error,myCustomData:e.customData?JSON.stringify(e.customData):void 0})),this.registerShellNotificationConverter(Kv,e=>new nT({myVersion:e.version})),this.registerShellNotificationConverter(Xv,e=>new AT({myProductId:se(e.productId)})),this.registerShellNotificationConverter(Jv,e=>new NT({myProductId:se(e.productId),myCheckoutResult:X(e4,LR,e.result)})),this.registerShellNotificationConverter(Yv,e=>new mb({myIsSuccess:e.isSuccess,myErrorCode:e.errorCode,myCustomData:JSON.stringify(e.customData)}))}registerShellNotificationConverter(e,t){this._shellNotificationToOutgoingMessageConverterMap.set(e.type,t)}shellNotificationToOutgoingMessage(e){const t=this._shellNotificationToOutgoingMessageConverterMap.get(e.shellNotificationName);return t?t(e):this.convertUnknownShellNotificationToOutgoingMessage(e)}convertUnknownShellNotificationToOutgoingMessage(e){return Object.assign(Object.assign({},e),{myMessageName:e.shellNotificationName})}registerShellResponseConverter(e,t){this._shellResponseToOutgoingMessageConverterMap.set(e.type,t)}shellResponseToOutgoingMessage(e){const t=this._shellResponseToOutgoingMessageConverterMap.get(e.shellResponseName);return t?t(e):void 0}}class Q5{constructor(){this._messageToNotificationConverterMap=new Map,this.registerMessageToShellNotificationConverter(Bh,e=>{const t=e.myGameSession;return new ld({profileIdsToInvite:e.myProfileIdsToInvite.map(s=>s),gameSession:{applicationId:t.myUbiAppId,gameSpaceId:t.myGameSpaceId,gameSessionId:t.myGameSessionId}})}),this.registerMessageToShellNotificationConverter(Hh,e=>{const t=e.myGameSession;return new pd({inviterProfileId:e.myInviterProfileId,gameSession:{applicationId:t.myUbiAppId,gameSpaceId:t.myGameSpaceId,gameSessionId:t.myGameSessionId}})}),this.registerMessageToShellNotificationConverter(Qh,e=>{const t=e.myGameSession;return new ud({inviterProfileId:e.myInviterProfileId,gameSession:{applicationId:t.myUbiAppId,gameSpaceId:t.myGameSpaceId,gameSessionId:t.myGameSessionId}})}),this.registerMessageToShellNotificationConverter(jh,e=>{const t=e.myGameSession;return new dd({profileIdToJoin:e.myProfileIdToJoin,gameSession:{applicationId:t.myUbiAppId,gameSpaceId:t.myGameSpaceId,gameSessionId:t.myGameSessionId}})}),this.registerMessageToShellNotificationConverter(kh,()=>new br),this.registerMessageToShellNotificationConverter(Wh,()=>new hd),this.registerMessageToShellNotificationConverter(Vh,()=>new Gc)}registerMessageToShellNotificationConverter(e,t){this._messageToNotificationConverterMap.set(e.type,t)}outgoingMessageToShellNotification(e){const t=this._messageToNotificationConverterMap.get(e.myMessageName);return t?t(e):this.convertUnknownMessageToShellNotification(e)}convertUnknownMessageToShellNotification(e){return Object.assign(Object.assign({},e),{shellNotificationName:e.myMessageName})}}class UR{constructor(e=new B5,t=new hl,s=new Q5,a=new H5){this._incomingMessageToModernTypeConverter=e,this._hostNotificationToIncomingMessageConverter=t,this._outgoingMessageToShellNotificationConverter=s,this._modernTypeToOutgoingMessageConverter=a}incomingMessageToHostNotification(e,t){return this._incomingMessageToModernTypeConverter.incomingMessageToHostNotification(e,t)}incomingMessageToHostRequest(e,t){return this._incomingMessageToModernTypeConverter.incomingMessageToHostRequest(e,t)}hostNotificationToIncomingMessage(e){return this._hostNotificationToIncomingMessageConverter.hostNotificationToIncomingMessage(e)}outgoingMessageToShellNotification(e){return this._outgoingMessageToShellNotificationConverter.outgoingMessageToShellNotification(e)}shellNotificationToOutgoingMessage(e){return this._modernTypeToOutgoingMessageConverter.shellNotificationToOutgoingMessage(e)}shellResponseToOutgoingMessage(e){return this._modernTypeToOutgoingMessageConverter.shellResponseToOutgoingMessage(e)}convertMessageToHostNotificationType(e){return this._hostNotificationToIncomingMessageConverter.convertMessageToHostNotificationType(e)}}class j5{hostRequestToIncomingQuery(e,t){return Object.assign(Object.assign({},e),{myQueryName:e.hostRequestName,myDispatchId:t,myResponseType:void 0})}}class q5{incomingQueryToHostRequest(e,t){return Object.assign(Object.assign({},e),{hostRequestName:e.myQueryName,contextId:t})}}class z5{constructor(){this._queryToShellRequestConverterMap=new Map,this.registerQueryToShellRequestConverter(qh,e=>new fd({channelId:e.myChannelId})),this.registerQueryToShellRequestConverter($h,()=>new yd),this.registerQueryToShellRequestConverter(Sh,e=>new vd({gameInviteId:e.myGameInviteId,response:e.myResponse,source:e.mySource})),this.registerQueryToShellRequestConverter(ch,()=>new _d),this.registerQueryToShellRequestConverter(Ph,()=>new Sd),this.registerQueryToShellRequestConverter(Mh,e=>new wd({initialPath:e.myInitialPath}))}registerQueryToShellRequestConverter(e,t){this._queryToShellRequestConverterMap.set(e.type,t)}outgoingQueryToShellRequest(e){const t=this._queryToShellRequestConverterMap.get(e.myQueryName);return t?t(e):this.convertUnknownQueryToShellRequest(e)}convertUnknownQueryToShellRequest(e){return Object.assign(Object.assign({},e),{shellRequestName:e.myQueryName})}}function rf(i){return{myDomain:i.domain,myName:i.name,myValue:i.value,mySecure:i.secure,myHttpOnly:i.httpOnly,myExpires:i.expires?Math.round(i.expires.getTime()/1e3):void 0}}class K5{constructor(){this._shellRequestToQueryConverterMap=new Map,this.registerShellRequestToQueryConverter(fd,e=>new qh({myChannelId:e.channelId})),this.registerShellRequestToQueryConverter(yd,()=>new $h),this.registerShellRequestToQueryConverter(vd,e=>new Sh({myGameInviteId:e.gameInviteId,myResponse:e.response,mySource:e.source})),this.registerShellRequestToQueryConverter(kc,()=>new XS),this.registerShellRequestToQueryConverter(_d,()=>new ch),this.registerShellRequestToQueryConverter(Zv,()=>new r0),this.registerShellRequestToQueryConverter(Sd,()=>new Ph),this.registerShellRequestToQueryConverter(e_,()=>new mN),this.registerShellRequestToQueryConverter(t_,()=>new CN),this.registerShellRequestToQueryConverter(i_,e=>new jN({myToken:e.inviteToken,myUseCaseContext:e.useCaseContext})),this.registerShellRequestToQueryConverter(s_,e=>new EN({myExpirationDuration:e.tokenSettings.tokenExpirationDuration,myMaxUsageCount:e.tokenSettings.tokenMaxUsageCount})),this.registerShellRequestToQueryConverter(a_,e=>new WN({myToken:e.token})),this.registerShellRequestToQueryConverter(n_,()=>new SN),this.registerShellRequestToQueryConverter(r_,e=>new AN({myGuestId:e.guestId})),this.registerShellRequestToQueryConverter(o_,e=>new LN({myGuestId:e.guestId,mySettings:{myPermissions:{myGamepad:e.settings.permissions.gamepad,myKeyboard:e.settings.permissions.keyboard,myMouse:e.settings.permissions.mouse,myImmersive:e.settings.permissions.immersive}}})),this.registerShellRequestToQueryConverter(c_,e=>new DN({mySettings:{myBitrateMbps:e.settings.bitrateMbps,myResolution:e.settings.resolution,myFPS:e.settings.fps}})),this.registerShellRequestToQueryConverter(l_,()=>new $1),this.registerShellRequestToQueryConverter(p_,e=>new Q1({myProductId:se(e.productId)})),this.registerShellRequestToQueryConverter(u_,e=>new mw({myUrl:e.url,myBrowserRect:{myX:e.rect.x,myY:e.rect.y,myWidth:e.rect.width,myHeight:e.rect.height},myCookies:e.cookies.map(rf)})),this.registerShellRequestToQueryConverter(d_,e=>new Gw({myBrowserId:se(e.browserId)})),this.registerShellRequestToQueryConverter(h_,e=>new Cw({myBrowserId:se(e.browserId)})),this.registerShellRequestToQueryConverter(g_,e=>new Aw({myBrowserId:se(e.browserId)})),this.registerShellRequestToQueryConverter(m_,e=>new vw({myBrowserId:se(e.browserId),myCookies:e.cookies.map(rf)})),this.registerShellRequestToQueryConverter(f_,()=>new w1),this.registerShellRequestToQueryConverter(y_,e=>new PI({myGameId:se(e.gameId)})),this.registerShellRequestToQueryConverter(v_,()=>new Hb),this.registerShellRequestToQueryConverter(__,()=>new fM),this.registerShellRequestToQueryConverter(S_,e=>new AA({myGameId:se(e.gameId)})),this.registerShellRequestToQueryConverter(w_,e=>{var t;return new SA({myGameId:se(e.gameId),myBranchIdStr:e.branchId,myBranchId:Number.isNaN(Number(e.branchId))?void 0:Number(e.branchId),myIsDefault:(t=e.isDefault)!==null&&t!==void 0?t:!1})}),this.registerShellRequestToQueryConverter(b_,e=>{var t;return new CA({myProductId:se(e.gameId),myPassword:(t=e.password)!==null&&t!==void 0?t:""})}),this.registerShellRequestToQueryConverter(C_,e=>new WI({myGameId:se(e.gameId),myOptionalAddonId:se(e.optionalAddOnId)})),this.registerShellRequestToQueryConverter(I_,e=>new BI({myGameId:se(e.gameId),myOptionalAddonId:se(e.optionalAddOnId)})),this.registerShellRequestToQueryConverter(M_,e=>new EI({myGameId:se(e.gameId),myNewLanguage:e.newLanguage})),this.registerShellRequestToQueryConverter(A_,e=>new LI({myGameId:se(e.gameId)})),this.registerShellRequestToQueryConverter(P_,()=>new hM),this.registerShellRequestToQueryConverter(N_,()=>new oT),this.registerShellRequestToQueryConverter(wd,e=>new Mh({myInitialPath:e.initialPath})),this.registerShellRequestToQueryConverter(T_,()=>new JT),this.registerShellRequestToQueryConverter(R_,()=>new WP),this.registerShellRequestToQueryConverter(D_,e=>{var t,s;return new oA({myGameId:se(e.gameId),myTag:(t=e.tag)!==null&&t!==void 0?t:"",myForceConfigRefresh:(s=e.forceConfigRefresh)!==null&&s!==void 0?s:!1})}),this.registerShellRequestToQueryConverter(O_,e=>{var t;return new tA({myKey:e.key,myTag:(t=e.tag)!==null&&t!==void 0?t:""})}),this.registerShellRequestToQueryConverter(F_,e=>{var t;return new GA({myGameId:se(e.gameId),myPathType:X($m,xR,(t=e.pathType)!==null&&t!==void 0?t:$m.Desktop)})}),this.registerShellRequestToQueryConverter(L_,e=>new qw({myState:X(ns,or,e.state)})),this.registerShellRequestToQueryConverter(G_,()=>new Xw),this.registerShellRequestToQueryConverter(x_,()=>new dN),this.registerShellRequestToQueryConverter(E_,e=>new Ab({myKey:e.key,myCallerSpaceId:e.callerSpaceId,myBucketSpaceId:e.bucketSpaceId})),this.registerShellRequestToQueryConverter(U_,e=>new Cb({myKey:e.key,myValue:e.value?JSON.stringify(e.value):"",myExpirationTimeOffset:e.expirationTime,myIsPrivate:e.isPrivate,myCallerSpaceId:e.callerSpaceId})),this.registerShellRequestToQueryConverter(k_,e=>new Tb({myKey:e.key,myCallerSpaceId:e.callerSpaceId})),this.registerShellRequestToQueryConverter(W_,e=>new tb({myUserId:e.loginData.userId,myUbiTicket:e.loginData.ticket,mySpaceId:e.loginData.spaceId,mySessionId:e.loginData.sessionId,myProfileId:e.loginData.profileId,myClientIp:e.loginData.clientIp,myServerTime:e.loginData.serverTime,myExpiration:e.loginData.expiration,myIsOfflineSession:e.isOfflineSession,myPassword:e.password,myEmail:e.email})),this.registerShellRequestToQueryConverter(V_,e=>new z1({myIds:e.ids})),this.registerShellRequestToQueryConverter($_,e=>new ab({myEmail:e.email,myPassword:e.password,myProfileId:e.profileId})),this.registerShellRequestToQueryConverter(B_,()=>new yb),this.registerShellRequestToQueryConverter(t4,()=>new KN),this.registerShellRequestToQueryConverter(H_,()=>new E1),this.registerShellRequestToQueryConverter(Q_,()=>new Sb),this.registerShellRequestToQueryConverter(j_,()=>new QP)}registerShellRequestToQueryConverter(e,t){this._shellRequestToQueryConverterMap.set(e.type,t)}shellRequestToOutgoingQuery(e,t){const s=this._shellRequestToQueryConverterMap.get(e.shellRequestName);if(s){const a=s(e);return a.myDispatchId=t,a}return this.convertUnknownShellRequestToQuery(e,t)}convertUnknownShellRequestToQuery(e,t){return Object.assign(Object.assign({},e),{myQueryName:e.shellRequestName,myDispatchId:t,myResponseType:void 0})}}class kR{constructor(e=new q5,t=new j5,s=new z5,a=new K5){this._incomingQueryToHostRequestConverter=e,this._hostRequestToIncomingQueryConverter=t,this._outgoingQueryToShellRequestConverter=s,this._shellRequestToOutgoingQueryConverter=a}incomingQueryToHostRequest(e,t){return this._incomingQueryToHostRequestConverter.incomingQueryToHostRequest(e,t)}hostRequestToIncomingQuery(e,t){return this._hostRequestToIncomingQueryConverter.hostRequestToIncomingQuery(e,t)}outgoingQueryToShellRequest(e){return this._outgoingQueryToShellRequestConverter.outgoingQueryToShellRequest(e)}shellRequestToOutgoingQuery(e,t){return this._shellRequestToOutgoingQueryConverter.shellRequestToOutgoingQuery(e,t)}}class X5{constructor(){this._hostResponseToIncomingQueryResultConverterMap=new Map,this.registerHostResponseToQueryResultConverter(q_,e=>new ol({mySuccess:e.isSuccessful})),this.registerHostResponseToQueryResultConverter(z_,e=>{var t;return new al({myGameSession:e.session?{myGameSpaceId:e.session.gameSpaceId,myUbiAppId:e.session.applicationId,myGameSessionId:e.session.gameSessionId}:void 0,myJoinability:((t=e.session)===null||t===void 0?void 0:t.joinability)!==void 0?e.session.joinability:void 0})}),this.registerHostResponseToQueryResultConverter(K_,e=>new nl({myInvites:e.invites.map(t=>({myProfileId:t.profileId,myGameSession:{myUbiAppId:t.gameId.applicationId,myGameSpaceId:t.gameId.spaceId,myGameSessionId:t.gameSessionReference}}))})),this.registerHostResponseToQueryResultConverter(X_,e=>new el({mySuccess:e.isSuccessful,mySource:e.source})),this.registerHostResponseToQueryResultConverter(J_,e=>new zc({myActivityStatus:X(hs,ya,e.userActivityStatus)})),this.registerHostResponseToQueryResultConverter(Y_,e=>{const t=Ho(e.myDefaultSettings);return new sl({myDefaultSettings:t})}),this.registerHostResponseToQueryResultConverter(Z_,e=>{const t=Ho(e.settings);return new il({mySettings:t})})}registerHostResponseToQueryResultConverter(e,t){this._hostResponseToIncomingQueryResultConverterMap.set(e.type,t)}hostResponseToIncomingQueryResult(e,t){const s=this._hostResponseToIncomingQueryResultConverterMap.get(e.hostResponseName);if(s){const a=s(e);return a.myDispatchId=t,a}return this.convertUnknownHostResponseToQueryResult(e,t)}convertUnknownHostResponseToQueryResult(e,t){return Object.assign(Object.assign({},e),{myQueryResultName:e.hostResponseName,myDispatchId:t})}}function J5(i){return{id:i.myId,name:i.myName,applicationId:i.myApplicationId,spaceId:i.mySpaceId,addOns:i.myAddOns.map(ER),platform:X(Yh,Gy,i.myPlatform),executables:i.myExecutableList.map(({myDescription:e,myIndex:t})=>({id:$(t),description:e})),currentBranch:Yn(i.myCurrentBranchStr||i.myCurrentBranch),branches:i.myBranches.map(sg),state:X(dl,Xu,i.myState),isUninstallable:i.myIsUninstallable,isDownloadNeeded:i.myIsDownloadNeeded,releaseState:X(eg,xy,i.myReleaseState),ownershipState:X(Zh,Ey,i.myOwnershipState),readmeFilePath:i.myReadmeFilePath,hasPendingPatch:i.myHasPendingPatch,isAutoPatchEnabled:i.myIsAutoPatchEnabled,installationPath:i.myInstallationFolder,selectedLanguage:i.mySelectedLanguage,availableLanguages:i.myAvailableLanguages,launchArguments:i.myLaunchArguments,isSharePlayEnabled:i.myIsSharePlayEnabled,isRemotePlayEnabled:i.myIsRemotePlayEnabled,isDevMode:i.myIsDevMode}}class Y5{constructor(){this._incomingQueryResultToHostResponseConverterMap=new Map,this.registerQueryResultToHostResponseConverter(ol,e=>new q_({isSuccessful:e.mySuccess})),this.registerQueryResultToHostResponseConverter(nl,e=>new K_({invites:e.myInvites.map(t=>{const s=t.myGameSession;return{profileId:t.myProfileId,gameId:{applicationId:s.myUbiAppId,spaceId:s.myGameSpaceId},state:Eo.Pending,gameSessionReference:s.myGameSessionId}})})),this.registerQueryResultToHostResponseConverter(el,e=>new X_({isSuccessful:e.mySuccess,source:e.mySource})),this.registerQueryResultToHostResponseConverter(Th,e=>new i4({isSuccessful:e.mySuccess,error:e.myError&&{code:e.myError.myCode,source:e.myError.mySource}})),this.registerQueryResultToHostResponseConverter(Dh,e=>new s4({isSuccessful:e.mySuccess,error:e.myError&&{code:e.myError.myCode,source:e.myError.mySource}})),this.registerQueryResultToHostResponseConverter(Eh,e=>new a4({isSuccessful:e.mySuccess,error:e.myError&&{code:e.myError.myCode,source:e.myError.mySource}})),this.registerQueryResultToHostResponseConverter(Gh,e=>new n4({token:e.myToken})),this.registerQueryResultToHostResponseConverter(xh,e=>new r4({link:e.myInviteLink})),this.registerQueryResultToHostResponseConverter(Rh,e=>new o4({state:e.myState,guests:e.myGuests.map(t=>({guestId:t.myGuestId,profileId:t.myProfileId,connectedTimestamp:t.myConnectedTS,settings:{permissions:{gamepad:t.mySettings.myPermissions.myGamepad,keyboard:t.mySettings.myPermissions.myKeyboard,mouse:t.mySettings.myPermissions.myMouse,immersive:t.mySettings.myPermissions.myImmersive}}})),settings:{bitrateMbps:e.mySettings.myBitrateMbps,resolution:e.mySettings.myResolution,fps:e.mySettings.myFPS},maxGuestsAllowed:e.myMaxGuestsAllowed,maxSessionDuration:e.myMaxSessionDuration,error:e.myError&&{code:e.myError.myCode,source:e.myError.mySource},focus:e.myFocus})),this.registerQueryResultToHostResponseConverter(Oh,e=>new c4({isSuccessful:e.mySuccess,error:e.myError&&{code:e.myError.myCode,source:e.myError.mySource}})),this.registerQueryResultToHostResponseConverter(zc,e=>new J_({userActivityStatus:X(ya,hs,e.myActivityStatus)})),this.registerQueryResultToHostResponseConverter(kd,e=>new l4({ticket:e.myTicket})),this.registerQueryResultToHostResponseConverter(sl,e=>{const t=this.parseSettings(e.myDefaultSettings),s=qp(t);return new Y_({myDefaultSettings:s})}),this.registerQueryResultToHostResponseConverter(il,e=>{const t=this.parseSettings(e.mySettings),s=qp(t);return new Z_({settings:s})}),this.registerQueryResultToHostResponseConverter(Lh,e=>new p4({isSuccessful:e.mySuccess,error:e.myError&&{code:e.myError.myCode,source:e.myError.mySource}})),this.registerQueryResultToHostResponseConverter(Fh,e=>new u4({isSuccessful:e.mySuccess,error:e.myError&&{code:e.myError.myCode,source:e.myError.mySource}})),this.registerQueryResultToHostResponseConverter(bh,e=>{const t=e.myProducts.map(Ya);return new d4({products:t})}),this.registerQueryResultToHostResponseConverter(Ch,e=>new h4({product:Ya(e.myProduct)})),this.registerQueryResultToHostResponseConverter(Wd,e=>new g4({browserId:$(e.myBrowserId)})),this.registerQueryResultToHostResponseConverter(Hd,e=>new m4({browserId:$(e.myBrowserId),url:e.myUrl})),this.registerQueryResultToHostResponseConverter($d,e=>new f4({browserId:$(e.myBrowserId),isVisible:e.myIsVisible})),this.registerQueryResultToHostResponseConverter(Bd,e=>new y4({browserId:$(e.myBrowserId),isVisible:e.myIsVisible})),this.registerQueryResultToHostResponseConverter(Vd,e=>new v4({browserId:$(e.myBrowserId)})),this.registerQueryResultToHostResponseConverter(_h,e=>new _4({gameId:e.myIsPlaying?$(e.myGameId):void 0})),this.registerQueryResultToHostResponseConverter(eh,e=>{var t;const s=(t=e==null?void 0:e.myDownloads)===null||t===void 0?void 0:t.map(zp);return new S4({downloads:s,isPaused:e.myIsPaused})}),this.registerQueryResultToHostResponseConverter(oh,e=>new w4({hasConnection:e.myIsConnected})),this.registerQueryResultToHostResponseConverter(th,e=>new b4({gameId:$(e.myGameId),chunk:e.myChunks?e.myChunks.map(t=>({id:t.myId,installedBytes:t.myInstalledBytes,isInstalled:t.myIsInstalled,sizeInBytes:t.mySizeInBytes})):[],isPaused:e.myIsPaused,progress:{bytesDownloaded:e.myProgress.myBytesDownloaded,bytesPerSecond:e.myProgress.myBytesPerSecond,bytesToDownload:e.myProgress.myBytesToDownload,etaInSeconds:e.myProgress.myEtaInSeconds,maxBytesPerSecond:e.myProgress.myMaxBytesPerSecond,requiredBytesDownloaded:e.myProgress.myRequiredBytesDownloaded,requiredBytesToDownload:e.myProgress.myRequiredBytesToDownload,requiredEtaInSeconds:e.myProgress.myRequiredEtaInSecond,progress:e.myProgress.myProgress}})),this.registerQueryResultToHostResponseConverter(gh,e=>new C4({gameId:$(e.myGameId),activeBranch:Yn(e.myActiveBranchStr||e.myActiveBranch,!0),branches:e.myBranches.map(sg)})),this.registerQueryResultToHostResponseConverter(dh,e=>new I4({gameId:$(e.myProductId),branchId:Yn(e.myBranchIdStr||e.myBranchId,!0),isDefault:e.myIsDefault,success:e.mySuccess})),this.registerQueryResultToHostResponseConverter(hh,e=>new M4({gameId:$(e.myProductId),success:e.mySuccess,errorText:e.myErrorText,unlockedBranches:e.myUnlockedBranches.map(t=>({id:Yn(t.myIdStr||t.myId,!0),gameId:$(t.myProductId),name:t.myName}))})),this.registerQueryResultToHostResponseConverter(ah,e=>new A4({gameId:$(e.myGameId),optionalAddOnId:$(e.myOptionalAddonId),isDownloadNeeded:e.myIsDownloadNeeded,success:e.myIsSuccess})),this.registerQueryResultToHostResponseConverter(nh,e=>new P4({gameId:$(e.myGameId),optionalAddOnId:$(e.myOptionalAddonId),success:e.myIsSuccess})),this.registerQueryResultToHostResponseConverter(sh,e=>new N4({gameId:$(e.myGameId),success:e.myIsSuccess})),this.registerQueryResultToHostResponseConverter(ih,e=>new T4({gameId:$(e.myGameId),selectedLanguage:e.mySelectedLanguage,languages:e.myLanguages})),this.registerQueryResultToHostResponseConverter(rh,e=>new R4({gameIds:e.myProductIds.map($)})),this.registerQueryResultToHostResponseConverter(al,e=>new z_({session:e.myGameSession?{gameSpaceId:e.myGameSession.myGameSpaceId,applicationId:e.myGameSession.myUbiAppId,gameSessionId:e.myGameSession.myGameSessionId,joinability:e.myJoinability}:void 0})),this.registerQueryResultToHostResponseConverter(Ah,e=>new D4({path:e.myPath,isOk:e.myIsOk})),this.registerQueryResultToHostResponseConverter(zh,e=>new O4({dontSendCrashReportsEnabled:e.myDontSendCrashReports})),this.registerQueryResultToHostResponseConverter(yh,e=>new F4({remindMeOfSteamLinking:e.myRemindMeOfSteamLinking})),this.registerQueryResultToHostResponseConverter(ph,e=>new L4({isActivated:e.myIsActivated,errorMessage:e.myErrorMessage,notAvailableInRegion:e.myNotAvailableInRegion,isAgeGateRestricted:e.myIsAgeGateRestricted})),this.registerQueryResultToHostResponseConverter(lh,e=>{var t,s;return new G4({isActivated:e.myIsActivated,resultType:e.myErrorType!=null?X(NR,x4,e.myErrorType):void 0,key:e.myKey,name:e.myName,errorMessage:e.myErrorMessage||void 0,bannedTime:(t=e.myBannedTime)!==null&&t!==void 0?t:void 0,packageId:(s=e.myPackageId)!==null&&s!==void 0?s:void 0})}),this.registerQueryResultToHostResponseConverter(mh,e=>new E4({gameId:$(e.myGameId),gameName:e.myGameName,success:e.mySuccess})),this.registerQueryResultToHostResponseConverter(Qd,e=>new U4({newState:X(or,ns,e.myNewState)})),this.registerQueryResultToHostResponseConverter(jd,e=>new k4({state:X(or,ns,e.myState)})),this.registerQueryResultToHostResponseConverter(Nh,e=>{var t;const s={platform:X(GR,W4,e.myPlatform)};return e.myPlatformAttributes&&(s.platformAttributes={profileId:(t=e.myPlatformAttributes)===null||t===void 0?void 0:t.myProfileId}),new V4(s)}),this.registerQueryResultToHostResponseConverter(Yd,e=>new $4({value:e.myValue?JSON.parse(e.myValue):""})),this.registerQueryResultToHostResponseConverter(Jd,e=>new B4({isSuccessful:e.myIsSucceeded})),this.registerQueryResultToHostResponseConverter(Zd,e=>new H4({isSuccessful:e.myIsSucceeded})),this.registerQueryResultToHostResponseConverter(qd,e=>new Q4({isSuccess:e.myIsSuccess,errorCode:e.myErrorCode,ownershipGroup:e.myOwnershipGroup})),this.registerQueryResultToHostResponseConverter(Ih,e=>{const t={};return Object.values(e.myGamesMap).forEach(s=>{const a=J5(s);t[a.id]=a}),new j4({games:t})}),this.registerQueryResultToHostResponseConverter(zd,e=>{const t=e.myIsSuccess?void 0:e.myErrorCode?X(TR,Ep,e.myErrorCode):Ep.Failure;return new q4({isSuccess:e.myIsSuccess,errorCode:t})}),this.registerQueryResultToHostResponseConverter(Kd,e=>new z4({clientInstallationType:e.myClientInstallationType,brandedInstallerId:e.myBrandedInstallerId})),this.registerQueryResultToHostResponseConverter(Uh,e=>new K4({categoriesAvailable:e.myDataAvailable,categories:e.myCategories})),this.registerQueryResultToHostResponseConverter(wh,e=>new X4({product:e.myProduct?Ya(e.myProduct):void 0,addOnId:e.myAddonId?$(e.myAddonId):void 0})),this.registerQueryResultToHostResponseConverter(Xd,e=>{const t=s=>({None:"Uplay",Xbox:"XboxLive"})[s];return new J4({platformToken:e.myPlatformToken,platformType:X(RR,Y4,e.myPlatformType,t)})}),this.registerQueryResultToHostResponseConverter(vh,e=>new Z4({isDegraded:!e.myIsConnected}))}registerQueryResultToHostResponseConverter(e,t){this._incomingQueryResultToHostResponseConverterMap.set(e.type,t)}incomingQueryResultToHostResponse(e,t){const s=this._incomingQueryResultToHostResponseConverterMap.get(e.myQueryResultName),a=s?s(e):this.convertUnknownQueryResultToHostResponse(e);return a.contextId=t,a}convertUnknownQueryResultToHostResponse(e){return Object.assign(Object.assign({},e),{hostResponseName:e.myQueryResultName})}parseSettings(e){const t=s=>"Settings received from Game is of a wrong type. Expected string of object, received '".concat(s,"'");switch(typeof e){case"string":gp(e!=="",t("empty string"));try{return JSON.parse(e)}catch(s){let a="";throw s instanceof Error?a=Object.prototype.toString.call(s):typeof s=="string"&&(a=s),new Error("Error parsing Game Settings json:"+a)}case"object":return gp(e!==null,t("null")),gp(!Array.isArray(e),t("array")),e;default:throw new Error("Settings received from Game is of unsupported type:"+typeof e)}}}class Z5{outgoingQueryResultToShellResponse(e,t){return Object.assign(Object.assign({},e),{shellResponseName:e.myQueryResultName,contextId:t})}}class e6{shellResponseToOutgoingQueryResult(e,t){return Object.assign(Object.assign({},e),{myQueryResultName:e.shellResponseName,myDispatchId:t})}}class WR{constructor(e=new Y5,t=new X5,s=new Z5,a=new e6){this._incomingQueryResultToHostResponseConverter=e,this._hostResponseToIncomingQueryResultConverter=t,this._outgoingQueryResultToShellResponseConverter=s,this._shellResponseToOutgoingQueryResultConverter=a}incomingQueryResultToHostResponse(e,t){return this._incomingQueryResultToHostResponseConverter.incomingQueryResultToHostResponse(e,t)}hostResponseToIncomingQueryResult(e,t){return this._hostResponseToIncomingQueryResultConverter.hostResponseToIncomingQueryResult(e,t)}outgoingQueryResultToShellResponse(e,t){return this._outgoingQueryResultToShellResponseConverter.outgoingQueryResultToShellResponse(e,t)}shellResponseToOutgoingQueryResult(e,t){return this._shellResponseToOutgoingQueryResultConverter.shellResponseToOutgoingQueryResult(e,t)}}var Zn;(function(i){i[i.Message=-1]="Message",i[i.Query=1]="Query"})(Zn||(Zn={}));class Qa extends Lc{static isAvailable(){return typeof(window==null?void 0:window.umpUiMessage)=="function"}constructor(e,t=new UR,s=new kR,a=new WR){super(),this._logger=e,this._messageConverter=t,this._queryConverter=s,this._queryResultConverter=a,this._dispatchCounter=1,window.uplayMessage=this.onIncomingCommunication.bind(this),window.umpMessage=this.onIncomingCommunication.bind(this)}onIncomingCommunication(e,t,s){switch(this._logger.debug("Incoming communication",{type:e,payload:Wa(t),contextId:s}),this.notifyIncomingCommunicationSpies({message:"message: ".concat(e),payload:t}),!0){case/^QueryResult/.test(e):this.onIncomingQueryResult(e,t,s);return;case/^Query(?!Result)/.test(e):this.onIncomingQuery(e,t,s);return;case/^Message/.test(e):this.onIncomingMessage(e,t,s);return;default:this.onIncomingUnknownMessageType(e,t,s)}}onIncomingQueryResult(e,t,s){return Ot(this,void 0,void 0,function*(){t.myQueryResultName||(t.myQueryResultName=e);try{const a=this._queryResultConverter.incomingQueryResultToHostResponse(t,s);return this.onResponse(a,t.myDispatchId)}catch(a){const n="An error occurred while trying to process query result with type ".concat(e,".");return this._logger.warn(n,{error:a,payload:Wa(t)}),Promise.reject(n)}})}onIncomingQuery(e,t,s){return Ot(this,void 0,void 0,function*(){t.myQueryName||(t.myQueryName=e);try{const a=this._queryConverter.incomingQueryToHostRequest(t,s);return this.onRequest(a,t.myDispatchId)}catch(a){this._logger.warn("An error occurred while trying to process query",{error:a,payload:Wa(t)})}})}onIncomingMessage(e,t,s){return Ot(this,void 0,void 0,function*(){t.myMessageName||(t.myMessageName=e);try{const a=this._messageConverter.incomingMessageToHostRequest(t,s);if(a)return this.onRequest(a,qt.newId());const n=this._messageConverter.incomingMessageToHostNotification(t,s);return this.onNotification(n)}catch(a){this._logger.warn("An error occurred while trying to process message",{error:a,message:Wa(t)})}})}onIncomingUnknownMessageType(e,t,s){this._logger.warn("Received unknown message type. Type should start with 'Message', 'Query' or 'QueryResult'",{type:e,payload:Wa(t),contextId:s})}sendNotification(e){return Ot(this,void 0,void 0,function*(){const t=this._messageConverter.shellNotificationToOutgoingMessage(e);return this.sendOutgoingCommunication(t.myMessageName,t,Zn.Message)})}sendRequest(e){return Ot(this,void 0,void 0,function*(){const t=this._dispatchCounter++,s=this._queryConverter.shellRequestToOutgoingQuery(e,t);return yield this.sendOutgoingCommunication(s.myQueryName,s,Zn.Query),t})}sendResponse(e,t){return Ot(this,void 0,void 0,function*(){if(e instanceof Error){this._logger.warn("An error was received as Shell response. It will not be forwarded to the legacy PC Client",{response:e,id:t});return}const s=this._messageConverter.shellResponseToOutgoingMessage(e);if(s)return this.sendOutgoingCommunication(s.myMessageName,s,Zn.Message);const a=this._queryResultConverter.shellResponseToOutgoingQueryResult(e,t);return this.sendOutgoingCommunication(a.myQueryResultName,a,e.contextId)})}sendOutgoingCommunication(e,t,s){this._logger.debug("Outgoing communication",{type:e,payload:Wa(t),contextId:s}),this.notifyOutgoingCommunicationSpies({message:"message: ".concat(e),payload:t});const a=JSON.stringify(t);s!==void 0?window.umpUiMessage(e,a,s):window.umpUiMessage(e,a)}cancelRequest(){return Ot(this,void 0,void 0,function*(){return Promise.resolve()})}canSendNotification(){return Qa.isAvailable()}canSendRequest(){return Qa.isAvailable()}canSendResponse(){return Qa.isAvailable()}canCancelRequest(){return Qa.isAvailable()}}class t6 extends Wc{constructor(e,t,s=new UR,a=new kR,n=new WR){super(e,t),this._messageConverter=s,this._queryConverter=a,this._queryResultConverter=n,this._notificationListenersTransformMap=new Map,this._requestHandlersTransformMap=new Map}registerMessageListener(e,t){let s=this._notificationListenersTransformMap.get(t);s||(s=n=>{const r=this._messageConverter.hostNotificationToIncomingMessage(n);t(r)},this._notificationListenersTransformMap.set(t,s));const a=this._messageConverter.convertMessageToHostNotificationType(e.type);return this.registerListenerForNotificationType(a,s)}unregisterMessageListener(e,t){const s=this._notificationListenersTransformMap.get(t);if(!s)return!1;const a=this._messageConverter.convertMessageToHostNotificationType(e.type);return this.unregisterListenerForNotificationType(a,s)}registerQueryHandler(e,t){let s=this._requestHandlersTransformMap.get(t);return s||(s=(a,n)=>Ot(this,void 0,void 0,function*(){const r=this._queryConverter.hostRequestToIncomingQuery(a,n),o=yield t(r);return o&&this._queryResultConverter.outgoingQueryResultToShellResponse(o,a.contextId)}),this._requestHandlersTransformMap.set(t,s)),this.registerHandlerForRequestType(e.type,s)}unregisterQueryHandler(e,t){const s=this._requestHandlersTransformMap.get(t);return s?this.unregisterHandlerForRequestType(e.type,s):!1}sendQueryToClient(e,t){return Ot(this,void 0,void 0,function*(){try{const s=this._queryConverter.outgoingQueryToShellRequest(e),a=yield this.sendRequest(s,t);return a?this._queryResultConverter.hostResponseToIncomingQueryResult(a.response,a.id):Promise.reject("Client communication service not initialized. Attempting to query client with ".concat(e.myQueryName,"."))}catch(s){const a="An error occurred while trying to send query with type ".concat(e.myQueryName,".");return this._logger.warn(a,{error:s,query:e}),Promise.reject(a)}})}sendMessageToClient(e){return Ot(this,void 0,void 0,function*(){try{const t=this._messageConverter.outgoingMessageToShellNotification(e);yield this.sendNotification(t)}catch(t){this._logger.warn("An error occurred while trying to send message",{error:t,message:e})}})}}class i6{constructor(e){this._communicationService=e,this._messageListeners=new Map,this._queryHandlers=new Map,this._notificationListeners=new Map,this._requestHandlers=new Map}registerMessageListener(e,t){const s=this._communicationService.registerMessageListener(e,t);if(s){const a=this._messageListeners.get(e)||[];a.push(t),this._messageListeners.set(e,a)}return s}registerNotificationListener(e,t){const s=this._communicationService.registerNotificationListener(e,t);if(s){const a=this._notificationListeners.get(e)||[];a.push(t),this._notificationListeners.set(e,a)}return s}unregisterMessageListener(e,t){const s=this._communicationService.unregisterMessageListener(e,t);if(s){const a=this._messageListeners.get(e)||[];a.splice(a.indexOf(t),1),this._messageListeners.set(e,a)}return s}unregisterNotificationListener(e,t){const s=this._communicationService.unregisterNotificationListener(e,t);if(s){const a=this._notificationListeners.get(e)||[];a.splice(a.indexOf(t),1),this._notificationListeners.set(e,a)}return s}unregisterAllListeners(){this.unregisterAllMessageListeners(),this.unregisterAllNotificationListeners()}unregisterAllMessageListeners(){for(const[e,t]of this._messageListeners.entries())for(const s of t)this._communicationService.unregisterMessageListener(e,s)}unregisterAllNotificationListeners(){for(const[e,t]of this._notificationListeners.entries())for(const s of t)this._communicationService.unregisterNotificationListener(e,s)}registerQueryHandler(e,t){const s=this._communicationService.registerQueryHandler(e,t);return s&&this._queryHandlers.set(e,t),s}registerRequestHandler(e,t){const s=this._communicationService.registerRequestHandler(e,t);return s&&this._requestHandlers.set(e,t),s}unregisterQueryHandler(e,t){const s=this._communicationService.unregisterQueryHandler(e,t);return s&&this._queryHandlers.delete(e),s}unregisterRequestHandler(e,t){const s=this._communicationService.unregisterRequestHandler(e,t);return s&&this._requestHandlers.delete(e),s}unregisterAllHandlers(){this.unregisterAllQueryHandlers(),this.unregisterAllRequestHandlers()}unregisterAllQueryHandlers(){for(const[e,t]of this._queryHandlers.entries())this._communicationService.unregisterQueryHandler(e,t)}unregisterAllRequestHandlers(){for(const[e,t]of this._requestHandlers.entries())this._communicationService.unregisterRequestHandler(e,t)}clear(){this.unregisterAllHandlers(),this.unregisterAllListeners()}sendMessageToClient(e){this._communicationService.sendMessageToClient(e)}sendNotification(e){return Ot(this,void 0,void 0,function*(){return this._communicationService.sendNotification(e)})}sendQueryToClient(e,t){return Ot(this,void 0,void 0,function*(){return this._communicationService.sendQueryToClient(e,t)})}sendRequest(e,t){return Ot(this,void 0,void 0,function*(){return this._communicationService.sendRequest(e,t)})}cancelRequest(e){return Ot(this,void 0,void 0,function*(){return this._communicationService.cancelRequest(e)})}}var pn=(i=>(i.IncomingCommunication="IncomingCommunication",i.OutgoingCommunication="OutgoingCommunication",i.FeatureDispatched="FeatureDispatched",i.FeatureListener="FeatureListener",i))(pn||{});class s6 extends Error{constructor(e,t){super(e),this.errorCode=t}}function Ao(i,e,t){const s=g.Dolphin_38;let a="Critical subsystem unavailable: ".concat(t," ");return e instanceof Error&&(a+=e.message),i.error(a,{errorCode:s,logCategory:f.initialization}),new s6(a,s)}class a6{constructor(e,t,s){this._logger=e,this._hostCommunicationLogger=t,this._runtimeParameters=s,this._hostToTransport={[p.PCLegacyClient]:()=>this.getPcClientTransportService(),[p.PCLegacyOverlay]:()=>this.getPcClientTransportService(),[p.SteamClient]:()=>this.getPcClientTransportService(),[p.SteamOverlay]:()=>this.getPcClientTransportService(),[p.Luna]:()=>this.getPcClientTransportService(),[p.XOneAegir]:()=>this.getAegirTransportService(),[p.XOneAegirNative]:()=>this.getAegirTransportService(),[p.PS4Aegir]:()=>this.getAegirTransportService(),[p.PS4AegirNative]:()=>this.getAegirTransportService(),[p.PS5Aegir]:()=>this.getAegirTransportService(),[p.PS5AegirNative]:()=>this.getAegirTransportService(),[p.ScarlettAegir]:()=>this.getAegirTransportService(),[p.ScarlettAegirNative]:()=>this.getAegirTransportService(),[p.MacOSAegir]:()=>this.getAegirTransportService(),[p.MacOSAegirNative]:()=>this.getAegirTransportService(),[p.WebEmbedded]:()=>this.getWebEmbedderTransportService(),[p.PCElectronClient]:()=>this.getDesktopTransportService(),[p.CompanionAppAndroid]:()=>this.getMobileTransportService(),[p.CompanionAppIOS]:()=>this.getMobileTransportService(),[p.CompanionAppMobile]:()=>this.getMobileTransportService(),[p.Android]:()=>this.getMobileTransportService(),[p.IOS]:()=>this.getMobileTransportService(),[p.Mobile]:()=>this.getMobileTransportService(),[p.XoneUWPWebView2]:()=>this.getWebView2TransportService(),[p.ScarlettUWPWebView2]:()=>this.getWebView2TransportService(),[p.PCWebClient]:()=>{},[p.PCWebOverlay]:()=>{},[p.PS4]:()=>{},[p.XONE]:()=>{},[p.PS5]:()=>{},[p.Scarlett]:()=>{},[p.ScarlettUWP]:()=>{},[p.XoneUWP]:()=>{},[p.Web]:()=>{},[p.MacOS]:()=>{},[p.PCElectronOverlay]:()=>{},[p.Switch]:()=>{}}}async getTransportService(){return this._hostToTransport[this._runtimeParameters.hostPlatformType]()}async getPcClientTransportService(){return this._logger.debug("Host transport service: LegacyPcClientTransportService",{debugFields:{hostTransportService:"LegacyPcClientTransportService"},logCategory:f.hostCommunication}),new Qa(this._hostCommunicationLogger)}async getWebEmbedderTransportService(){if(this._runtimeParameters.embedderOrigin)return new eE(this._runtimeParameters.embedderOrigin,this._hostCommunicationLogger)}async getMobileTransportService(){if(this._runtimeParameters.mobileCompanionAppType){if(this._runtimeParameters.mobileCompanionAppType===Bi.CompanionApp)return this._logger.debug("Host transport service: ShellToHostTransportService",{debugFields:{hostTransportService:"ShellToHostTransportService"},logCategory:f.hostCommunication}),new tE;this._logger.debug("Host transport service: LegacyCompanionAppTransportService",{debugFields:{hostTransportService:"LegacyCompanionAppTransportService"},logCategory:f.hostCommunication});try{return await this.loadLegacyCompanionAppTransportServiceModule()}catch(e){throw Ao(this._logger,e,"Companion app communication")}}}async loadLegacyCompanionAppTransportServiceModule(){return new(await le(()=>G(()=>import("./index.es-64f322cb.js"),["assets/index.es-64f322cb.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))).LegacyCompanionAppTransportService(this._hostCommunicationLogger)}async getDesktopTransportService(){this._logger.debug("Host transport service: ShellToDesktopAppTransportService",{debugFields:{hostTransportService:"ShellToDesktopAppTransportService"},logCategory:f.hostCommunication});try{return await this.loadDesktopTransportServiceModule()}catch(e){throw Ao(this._logger,e,"Desktop app communication")}}async loadDesktopTransportServiceModule(){return new(await le(()=>G(()=>import("./ShellToDesktopAppTransportService-d18870bc.js"),["assets/ShellToDesktopAppTransportService-d18870bc.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))).ShellToDesktopAppTransportService}async getWebView2TransportService(){this._logger.debug("Host transport service: WebView2TransportService",{debugFields:{hostTransportService:"WebView2TransportService"},logCategory:f.hostCommunication});try{return await this.loadWebView2TransportServiceModule()}catch(e){throw Ao(this._logger,e,"WebView2 communication")}}async loadWebView2TransportServiceModule(){return new(await le(()=>G(()=>import("./WebView2TransportService-5d1e0ecf.js"),["assets/WebView2TransportService-5d1e0ecf.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))).WebView2TransportService(this._logger)}async getAegirTransportService(){return this._logger.debug("Host transport service: ShellToAegirTransportService",{debugFields:{hostTransportService:"ShellToAegirTransportService"},logCategory:f.hostCommunication}),new lU(this._logger)}}class n6{async create(e,t,s){const a=e.createChild("HostCommunication");a.settings.logCategory=f.hostCommunication,s!=null||(s=new a6(e,a,t));const n=await s.getTransportService();if(!n){e.debug("Host communication service unset",{debugFields:{hostCommunicationService:"none"},logCategory:f.hostCommunication});return}return this.attachLogging(n,e),this.getHostCommunicationService(t,e,a,n)}async getPcClientCommunicationServiceWrapper(e,t,s){if([p.Luna,p.PCLegacyClient,p.PCLegacyOverlay,p.SteamOverlay,p.SteamClient].includes(e.hostPlatformType)&&s)return new i6(s)}attachLogging(e,t){e.addIncomingCommunicationSpy(s=>{const{message:a,payload:n}=s;t.debug(a,{payload:n,logCategory:f.hostCommunication,debugEntryType:pn.IncomingCommunication})}),e.addOutgoingCommunicationSpy(s=>{const{message:a,payload:n}=s;t.debug(a,{payload:n,logCategory:f.hostCommunication,debugEntryType:pn.OutgoingCommunication})})}async getHostCommunicationService(e,t,s,a){return[p.Luna,p.PCLegacyClient,p.PCLegacyOverlay,p.SteamOverlay,p.SteamClient].includes(e.hostPlatformType)?(t.debug("Host communication service: PcClientCommunicationService",{debugFields:{hostCommunicationService:"PcClientCommunicationService"},logCategory:f.hostCommunication}),new t6(s,a)):(t.debug("Host communication service: ShellToHostCommunicationService",{debugFields:{hostCommunicationService:"ShellToHostCommunicationService"},logCategory:f.hostCommunication}),new Wc(s,a))}}var ds=(i=>(i.ParentRemoteLogTransport="ParentRemoteLogTransport",i.DesktopAppLogTransport="DesktopAppLogTransport",i))(ds||{});class cr extends iE{constructor(){super(...arguments),this._storedLogs=[]}log(e){if(!this._communicationService){this._storedLogs.push(e);return}this.sendLogEntry(e)}clear(){this._storedLogs=[]}dispose(){this.clear()}set communicationService(e){this._communicationService=e,this._storedLogs.forEach(t=>this.sendLogEntry(t)),this._storedLogs=[]}sendLogEntry(e){var t;(t=this._communicationService)==null||t.sendNotification(new eS({logEntry:e}))}}var we=(i=>(i.Unmounted="unmounted",i.Unmounting="unmounting",i.Mounting="mounting",i.Mounted="mounted",i))(we||{}),as=(i=>(i.Unloaded="unloaded",i.Loading="loading",i.Loaded="loaded",i))(as||{}),fi=(i=>(i.Inactive="inactive",i.Activating="activating",i.Active="active",i))(fi||{});class r6{constructor(e){this._microAppDetailsSubject=e}get microAppDetails(){return this._microAppDetailsSubject}updateLoadStatus(e){const t=this._microAppDetailsSubject,s=t.value;t.next({...s,loaded:e})}updateMountStatus(e){const t=this._microAppDetailsSubject,s=t.value;if(s.loaded!==as.Loaded){console.warn("Micro app is not loaded yet");return}t.next({...s,mounted:e})}updateActivationStatus(e){const t=this._microAppDetailsSubject,s=t.value;if(s.mounted!==we.Mounted){console.warn("Micro app is not mounted yet");return}t.next({...s,active:e})}waitForStatus(e,t){const s=new Fr,a=()=>{s.next(),s.complete()},n=(r,o,l)=>(Array.isArray(l)?l:[l]).includes(r[o]);return new Promise(r=>{this._microAppDetailsSubject.pipe(sE(s)).subscribe(o=>{const l=Array.isArray(t)?t:[t];n(o,e,l)&&(r(o[e]),a())})})}}class o6{constructor(){this._microAppObservers=new Map;const e={[B.main]:{microApps:[]},[B.side]:{microApps:[]},[B.modal]:{microApps:[]},[B.accessEnd]:{microApps:[]}};this._placementsSubject=new Uo(e)}get placements$(){return this._placementsSubject}registerMicroAppObserverForPlacement(e,t){const s=new r6(new Uo({mounted:we.Unmounted,loaded:as.Unloaded,active:fi.Inactive,config:t}));if(!e)throw new Error("Placement is required to register a micro app observer.");const a=this._placementsSubject.value;return a[e].microApps.push(t.spaceId),this._placementsSubject.next(a),this._microAppObservers.set(t.spaceId,s),s}removeMicroAppForPlacement(e,t){const s=this._placementsSubject.value,a=s[e].microApps.indexOf(t);a!==-1&&(s[e].microApps.splice(a,1),this._placementsSubject.next(s)),this._microAppObservers.delete(t)}getMicroAppObserverBySpaceId(e){return this._microAppObservers.get(e)}}const _p="shell-version";class VR{constructor(e){this._localStorage=e}redirectIfRequired(e){const t=this._localStorage.getValue(_p),s=this.getVersion(e.pathname);return!s||s===t?!1:t?(this._localStorage.deleteValue(_p),e.replace("".concat(e.origin,"/").concat(t,"/").concat(e.search).concat(e.hash)),!0):!1}saveShellVersion(e){const t=this.getVersion(e);t!==void 0&&this._localStorage.setValue(_p,t)}getVersion(e){const t=/\/(.*?)\//,s=e.match(t);if(e!=="/"&&(s!=null&&s[1]))return s[1]}}class $R{constructor(e=new Map){this._map=new Map,e.forEach((t,s)=>{this._map.set(s,Promise.resolve(t))})}getOrCreate(e,t){let s=this._map.get(e);return s||(s=t().catch(a=>{throw this._map.delete(e),a}),this._map.set(e,s),s)}set(e,t){this._map.set(e,Promise.resolve(t))}}class BR{constructor(e=new Map,t=!0){this._saveUndefinedValues=t,this._map=new Map,e.forEach((s,a)=>{this._map.set(a,s)})}getOrCreate(e,t){let s=this._map.get(e);if(s)return s;try{s=t()}catch(a){throw this._map.delete(e),a}return s===void 0&&!this._saveUndefinedValues||this._map.set(e,s),s}clear(){this._map.clear()}set(e,t){this._map.set(e,t)}}function c6(i,e){if(tS(i))switch(i.name){case rs.timeToInteractive.name:return u6(i,e);case rs.firstContentfulPaint.name:return l6(i,e);case rs.largestContentfulPaint.name:return p6(i,e);default:return}}function l6(i,e){return{name:"performance.fcp",details:ag(i,e)}}function p6(i,e){return{name:"performance.lcp",details:ag(i,e)}}function u6(i,e){var a;const t=i.details,s={name:"performance.tti",details:{isInteractive:(a=t==null?void 0:t.isInteractive)!=null?a:!0,...ag(i,e)}};return!s.details.isInteractive&&t.error&&(s.details.error=t.error),s}function ag(i,e){const t=i.details;return{error:t==null?void 0:t.error,microAppName:e.applicationName,microAppVersion:e.applicationBuildId,duration:Math.round(i.duration)}}var es=(i=>(i[i.DevTools=0]="DevTools",i[i.Logger=1]="Logger",i[i.CarbonTelemetry=2]="CarbonTelemetry",i[i.ConnectTelemetrySDK=3]="ConnectTelemetrySDK",i))(es||{});function gl(i,e){const t=[];i.forEach(a=>{e[a]==null&&t.push(a)});let s;return t.length>0&&(s="Missing required properties in transport caller context: ".concat(t.join(", "))),{isValid:t.length===0,error:s}}class d6{constructor(e,t){this._logger=e,this._trackingService=t,this._requiredContextFields=["applicationBuildId","applicationId","applicationName","spaceId"]}addEntry(e,t){if(e.private===!0)return;const s=c6(e,t);if(!s)return;const a=gl(this._requiredContextFields,t);if(a.error){this._logger.warn(a.error);return}this._trackingService.sendEvent(s.name,s.details)}}class h6{constructor(e,t){this._logger=e,this._requiredContextFields=["applicationName"],this._performance=t!=null?t:window.performance}addEntry(e,t,s=0){if(!this._performance)return;const a=gl(this._requiredContextFields,t);if(a.error){this._logger.info(a.error);return}e.type==="mark"?this.addMarkPerformanceEntry(e,t,s):this.addMeasurementPerformanceEntry(e,t)}addMarkPerformanceEntry(e,t,s){if("mark"in this._performance){const a=this.chromePerformanceTabId(e.name,t.applicationName);try{this._performance.mark(a,{detail:e.details,startTime:e.timestamp+s})}catch(n){this._logger.warn("Unable to add performance mark for dev tools",{error:n,errorCode:g.PerformanceFailedToAddMarkWarning})}}else this._logger.debug("performance.mark is not available in this browser.")}addMeasurementPerformanceEntry(e,t){if("measure"in this._performance){const s=typeof e.startMark=="string"?e.startMark:e.startMark.name,a=typeof e.endMark=="string"?e.endMark:e.endMark.name,n=this.chromePerformanceTabId(e.name,t.applicationName),r=this.chromePerformanceTabId(s,t.applicationName),o=this.chromePerformanceTabId(a,t.applicationName);try{this._performance.measure(n,r,o)}catch(l){this._logger.warn("Unable to perform measurement for dev tools",{error:l,errorCode:g.PerformanceFailedToMeasureWarning})}}else this._logger.debug("performance.measure is not available in this browser.")}chromePerformanceTabId(e,t){return"[".concat(t,"] ").concat(e)}}var HR=(i=>(i.MicroAppPerformance="micro-app-performance",i))(HR||{});class g6{constructor(e,t){this._logger=e,this._metricDefinitions=t,this._requiredContextFields=["applicationName"],this._metricsTypeMap={[rs.bundleLoadTime.name]:Ae.BundleLoadTime,[rs.instantiationTime.name]:Ae.InstantiationTime,[rs.firstContentfulPaint.name]:Ae.FirstContentfulPaint,[rs.largestContentfulPaint.name]:Ae.LargestContentfulPaint,[rs.timeToInteractive.name]:Ae.TimeToInteractive}}addEntry(e,t){if(e.private===!0||!tS(e))return;const s=gl(this._requiredContextFields,t);if(s.error){this._logger.info(s.error);return}const a=this.getPerformanceMetric(e);a&&this._metricDefinitions.getMetric(a,HR.MicroAppPerformance).record(e.duration,{appName:t.applicationName})}getPerformanceMetric(e){return this._metricsTypeMap[e.name]}}class m6{constructor(e,t){this._logger=e,this._rootPerformanceLogger=t,this._requiredContextFields=["applicationName"],this._appPerformanceLoggers=new BR}getAppPerformanceLogger(e){return this._appPerformanceLoggers.getOrCreate(e,()=>this._rootPerformanceLogger.createChild(e))}addEntry(e,t){const s=gl(this._requiredContextFields,t);if(s.error){this._logger.info(s.error);return}const a=this.stringifyEntry(e,t.applicationName),n={entry:e},r=this.getAppPerformanceLogger(t.applicationName);e.private?r.debug(a,n):r.info(a,n)}timeString(e){const t=e>>0;return"".concat(t,"ms")}bytesString(e){const t=e/1e3;return"".concat(t,"KB")}stringifyEntry(e,t){switch(e.type){case"mark":switch(e.edge){case"start":return'start-mark "['.concat(t,"] ").concat(e.name,'" ').concat(this.timeString(e.timestamp));case"end":return'end-mark "['.concat(t,"] ").concat(e.name,'" ').concat(this.timeString(e.timestamp));default:{const s=e.memory>-1?"mem: "+this.bytesString(e.memory):"";return'mark "['.concat(t,"] ").concat(e.name,'" ').concat(this.timeString(e.timestamp)," ").concat(s)}}case"metric":return"".concat(e.private?"private-metric":"metric",' "[').concat(t,"] ").concat(e.name,'" ').concat(this.timeString(e.duration));case"measurement":return'measurement "['.concat(t,"] ").concat(e.name,'" ').concat(this.timeString(e.duration))}}}class f6{constructor(e,t,s,a=[es.CarbonTelemetry,es.ConnectTelemetrySDK,es.DevTools,es.Logger]){this._trackingService=e,this._metricDefinitions=t,this._rootPerformanceLogger=s,this._enabledTransports=a,this._perConsumerTransports=new Map,this.rootPerformanceLogger=s,this.trackingService=e}get trackingService(){return this._trackingService}set trackingService(e){this._trackingService=e}get metricDefinitions(){return this._metricDefinitions}set metricDefinitions(e){this._metricDefinitions=e}get rootPerformanceLogger(){return this._rootPerformanceLogger}set rootPerformanceLogger(e){this._rootPerformanceLogger=e,e&&!this._logger&&(this._logger=e.createChild("PerformanceMetricTransports"))}tryGetCarbonTelemetryTransport(e,t=[]){if(this._enabledTransports.includes(es.CarbonTelemetry)&&this._logger&&this.trackingService){const a=new d6(this._logger,this.trackingService);return t.forEach(n=>{a.addEntry(n,e)}),a}}tryGetConnectTelemetrySdkTransport(e,t=[]){if(this._enabledTransports.includes(es.ConnectTelemetrySDK)&&this._logger&&this.metricDefinitions){const a=new g6(this._logger,this.metricDefinitions);return t.forEach(n=>{a.addEntry(n,e)}),a}}tryGetDevToolsTransport(e,t=[]){if(this._enabledTransports.includes(es.DevTools)&&this._logger){const a=new h6(this._logger,window.performance);return t.forEach(n=>{a.addEntry(n,e)}),a}}tryGetLoggerTransport(e,t=[]){if(this._enabledTransports.includes(es.Logger)&&this._logger&&this.rootPerformanceLogger){const a=new m6(this._logger,this.rootPerformanceLogger);return t.forEach(n=>{a.addEntry(n,e)}),a}}getTransports(e,t=[]){var n,r;if(!e.applicationName)return(n=this._logger)==null||n.warn("Insufficient application config provided. 'applicationName' must be provided. Can't construct transports."),[];const s=(r=this._perConsumerTransports.get(e.applicationName))!=null?r:new BR(new Map,!1),a=[s.getOrCreate("dev-tools",()=>this.tryGetDevToolsTransport(e,t)),s.getOrCreate("carbon",()=>this.tryGetCarbonTelemetryTransport(e,t)),s.getOrCreate("telemetry",()=>this.tryGetConnectTelemetrySdkTransport(e,t)),s.getOrCreate("logger",()=>this.tryGetLoggerTransport(e,t))].filter(o=>o!==void 0);return this._perConsumerTransports.set(e.applicationName,s),a}clearTransports(e){const t=this._perConsumerTransports.get(e.applicationName);t&&(t.clear(),this._perConsumerTransports.delete(e.applicationName))}}class y6 extends oe("[State] Features"){constructor(e,t){super(),this._features=t}get isFeatureEnabled(){return e=>this._features[e]||!1}}class v6{static create(e){return{reducers:[],states:[new y6(fa,e)]}}}class _6{constructor(e){this._logger=e,this._subject=new Fr,this._subscribers=new Map}subscribe(e,t){const s=this.createObserver(e,t);this.setSubscription(e,s)}createObserver(e,t){return{next:s=>{try{const a=t(s);a instanceof Promise&&a.catch(n=>{this.logCallbackError(e,n)})}catch(a){this.logCallbackError(e,a)}}}}logCallbackError(e,t){this._logger.warn("Error in gamepad event callback",{applicationInfo:e,error:t,logCategory:f.api,errorCode:g.GamepadEventErrorWarning})}setSubscription(e,t){var a;this._subscribers.has(e)&&((a=this._subscribers.get(e))==null||a.subscription.unsubscribe(),this._subscribers.delete(e));const s=this._subject.subscribe(t);this._subscribers.set(e,{observer:t,subscription:s})}unsubscribe(e){var t;this._subscribers.has(e)&&((t=this._subscribers.get(e))==null||t.subscription.unsubscribe(),this._subscribers.delete(e))}notifyGamepadInput(e,t){var s;(s=this._subscribers.get(e))==null||s.observer.next(t)}}const S6={[m.PC]:D.keyboard,[m.Luna]:D.keyboard,[m.Steam]:D.keyboard,[m.Web]:D.keyboard,[m.PS4]:D.playstation,[m.PS5]:D.playstation,[m.XONE]:D.xbox,[m.Scarlett]:D.xbox,[m.ScarlettUWP]:D.xbox,[m.Mobile]:D.keyboard,[m.IOS]:D.keyboard,[m.Android]:D.keyboard,[m.MacOS]:D.keyboard,[m.Switch]:D.nintendo},w6={[m.Web]:{[k.Keyboard]:D.keyboard},[m.PC]:{[k.Keyboard]:D.keyboard,[k.PlayStation]:D.playstation,[k.Xbox]:D.xbox,[k.Generic]:D.xbox,[k.Nintendo]:D.nintendo},[m.Luna]:{[k.Keyboard]:D.keyboard,[k.PlayStation]:D.playstation,[k.Xbox]:D.xbox,[k.Generic]:D.xbox},[m.Steam]:{[k.Keyboard]:D.keyboard,[k.PlayStation]:D.playstation,[k.Xbox]:D.xbox,[k.Generic]:D.xbox,[k.Nintendo]:D.nintendo},[m.PS4]:{[k.Keyboard]:D.playstation,[k.PlayStation]:D.playstation,[k.Xbox]:D.playstation,[k.Generic]:D.playstation},[m.PS5]:{[k.Keyboard]:D.playstation,[k.PlayStation]:D.playstation,[k.Xbox]:D.playstation,[k.Generic]:D.playstation},[m.XONE]:{[k.Keyboard]:D.xbox,[k.PlayStation]:D.xbox,[k.Xbox]:D.xbox,[k.Generic]:D.xbox},[m.Scarlett]:{[k.Keyboard]:D.xbox,[k.PlayStation]:D.xbox,[k.Xbox]:D.xbox,[k.Generic]:D.xbox},[m.ScarlettUWP]:{[k.Keyboard]:D.xbox,[k.PlayStation]:D.xbox,[k.Xbox]:D.xbox,[k.Generic]:D.xbox},[m.Mobile]:{[k.Keyboard]:D.keyboard,[k.PlayStation]:D.playstation,[k.Xbox]:D.xbox,[k.Generic]:D.xbox},[m.Android]:{[k.Keyboard]:D.keyboard,[k.PlayStation]:D.playstation,[k.Xbox]:D.xbox,[k.Generic]:D.xbox},[m.IOS]:{[k.Keyboard]:D.keyboard,[k.PlayStation]:D.playstation,[k.Xbox]:D.xbox,[k.Generic]:D.xbox},[m.MacOS]:{[k.Keyboard]:D.keyboard,[k.PlayStation]:D.playstation,[k.Xbox]:D.xbox,[k.Generic]:D.xbox,[k.Nintendo]:D.nintendo},[m.Switch]:{[k.Keyboard]:D.nintendo,[k.PlayStation]:D.nintendo,[k.Xbox]:D.nintendo,[k.Generic]:D.nintendo,[k.Nintendo]:D.nintendo}};class QR{constructor(e){this._logger=e}calculate(e,t){return t==null?this.getDefaultInputDeviceType(e):this.getInputDeviceType(e,t)}getInputDeviceType(e,t){const s=w6[e];if(s===void 0)return this._logger.warn("Brand to input device type map could not be retrieved for platform type. Default input device type will be used.",{platformType:e,brand:t,logCategory:f.input,errorCode:g.InputDeviceBrandDeviceTypeNotFoundWarning}),this.getDefaultInputDeviceType(e);const a=s[t];return a===void 0?(this._logger.warn("Input device type could not be retrieved. Default input device type will be used.",{platformType:e,brand:t,logCategory:f.input,errorCode:g.InputDeviceTypeNotFoundWarning}),this.getDefaultInputDeviceType(e)):a}getDefaultInputDeviceType(e){const t=S6[e];return t===void 0?(this._logger.warn('Default input device type could not be retrieved for platform type. "'.concat(D.keyboard," will be used."),{platformType:e,logCategory:f.input,errorCode:g.InputDevicePlatformTypeDeviceTypeNotFoundWarning}),D.keyboard):t}}function b6(i){let e,t,s;return typeof i=="object"?(e=i.hashFunction,t=i.expiring,s=i.tags):e=i,(a,n,r)=>{if(r.value!=null)r.value=of(r.value,e,t,s);else if(r.get!=null)r.get=of(r.get,e,t,s);else throw"Only put a Memoize() decorator on a method or get accessor."}}const Sp=new Map;function of(i,e,t=0,s){const a=Symbol("__memoized_map__");return function(...n){let r;this.hasOwnProperty(a)||Object.defineProperty(this,a,{configurable:!1,enumerable:!1,writable:!1,value:new Map});let o=this[a];if(Array.isArray(s))for(const l of s)Sp.has(l)?Sp.get(l).push(o):Sp.set(l,[o]);if(e||n.length>0||t>0){let l;e===!0?l=n.map(w=>w.toString()).join("!"):e?l=e.apply(this,n):l=n[0];const u="".concat(l,"__timestamp");let v=!1;if(t>0)if(!o.has(u))v=!0;else{let w=o.get(u);v=Date.now()-w>t}o.has(l)&&!v?r=o.get(l):(r=i.apply(this,n),o.set(l,r),t>0&&o.set(u,Date.now()))}else{const l=this;o.has(l)?r=o.get(l):(r=i.apply(this,n),o.set(l,r))}return r}}var H=(i=>(i.keyboard="keyboard",i.gamepad="gamepad",i.mouse="mouse",i))(H||{});const C6={[m.PC]:E.mouse,[m.Luna]:E.directional,[m.Steam]:E.mouse,[m.PS4]:E.directional,[m.PS5]:E.directional,[m.XONE]:E.directional,[m.Scarlett]:E.directional,[m.ScarlettUWP]:E.directional,[m.Mobile]:E.touch,[m.IOS]:E.touch,[m.Android]:E.touch,[m.Web]:E.mouse,[m.MacOS]:E.mouse,[m.Switch]:E.directional},I6={[m.PC]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.mouse},[m.Luna]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.mouse},[m.Steam]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.mouse},[m.Web]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.mouse},[m.PS4]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.directional},[m.PS5]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.directional},[m.XONE]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.directional},[m.Scarlett]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.directional},[m.ScarlettUWP]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.directional},[m.Mobile]:{[H.gamepad]:E.directional,[H.keyboard]:E.touch,[H.mouse]:E.touch},[m.Android]:{[H.gamepad]:E.directional,[H.keyboard]:E.touch,[H.mouse]:E.touch},[m.IOS]:{[H.gamepad]:E.directional,[H.keyboard]:E.touch,[H.mouse]:E.touch},[m.MacOS]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.mouse},[m.Switch]:{[H.gamepad]:E.directional,[H.keyboard]:E.directional,[H.mouse]:E.directional}},M6=[L.DpadDown,L.DpadUp,L.DpadLeft,L.DpadRight,L.A,L.B];var A6=Object.defineProperty,P6=Object.getOwnPropertyDescriptor,N6=(i,e,t,s)=>{for(var a=s>1?void 0:s?P6(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&A6(e,t,a),a};class ml{constructor(e){this._logger=e}calculate(e,t){return t===void 0?this.getDefaultNavigationMethod(e):this.getNavigationMethod(e,t)}getDefaultNavigationMethod(e){const t=C6[e];return t===void 0?(this._logger.warn('Default navigation method could not be retrieved. "'.concat(E.mouse," will be used."),{platformType:e,logCategory:f.input,errorCode:g.NavigationMethodDefaultMethodNotFoundWarning}),E.mouse):t}getNavigationMethod(e,t){const s=I6[e];if(s===void 0)return this._logger.warn("Input event type to navigation method map could not be retrieved for platform type. Default navigation method will be used.",{platformType:e,logCategory:f.input,errorCode:g.NavigationMethodInputEventMethodMapForPlatformNotFoundWarning}),this.getDefaultNavigationMethod(e);const a=s[t];return a===void 0?(this._logger.warn("Navigation method could not be retrieved for input event type. Default navigation method will be used.",{platformType:e,inputEventDeviceType:t,logCategory:f.input,errorCode:g.NavigationMethodInputEventMethodMapNotFoundWarning}),this.getDefaultNavigationMethod(e)):a}}N6([b6((i,e,t)=>"".concat(i,"-").concat(e,"-").concat(t))],ml.prototype,"calculate",1);var _e=(i=>(i.Unknown="Unknown",i.User="User",i.GameInviteAccepted="GameInviteAccepted",i.GameJoined="GameJoined",i.FatalError="FatalError",i.Auth="AuthFlow",i.HardwareBack="HardwareBack",i.GameLaunched="GameLaunched",i.MicroAppRequested="MicroAppRequested",i.PlatformTypeChanged="PlatformTypeChanged",i))(_e||{});class Qo extends d("[Shell] Send Initial OverlayReady Notifications"){constructor(){super()}}class Za extends d("[Shell] make overlay visible and tell client"){constructor(){super()}}class Gt extends d("[Shell] close overlay"){constructor(e,t=!0){super(),this.reason=e,this.shouldSendTrackingEvent=t}}class jR extends d("[Shell] update session by ticket"){constructor(e,t=!0){super(),this.ticket=e,this.isRefresh=t}}class qR extends d("[Shell] update layout mounted status"){constructor(e){super(),this.isMounted=e}}class ng extends d("[Shell] update micro-app container"){constructor(e,t){super(),this.newContainer=e,this.placement=t}}class Hi extends d("[Shell] set micro app spinner visibility intent"){constructor(e,t){super(),this.isSpinnerVisible=e,this.placement=t}}class Kp extends d("[Shell] set micro app connection visibility intent"){constructor(e,t){super(),this.isNoConnectionViewVisible=e,this.placement=t}}class rg extends d("[Shell] set navigation bar visibility intent"){constructor(e){super(),this.isNavigationBarVisible=e}}class zR extends d("[Shell] Resume Overlay Intent"){}class KR extends d("[Shell] Load Configuration Space Parameters"){}class XR extends d("[Shell] Load Feedback Space Parameters"){}class Po extends d("[Shell] Network poll status was updated"){constructor(e){super(),this.pollStatus=e}}class Xp extends d("[Shell] Browser status was updated"){constructor(e){super(),this.browserOnLine=e}}class JR extends d("[Shell] Status for checking or not-checking connection was updated"){constructor(e){super(),this.checkConnection=e}}class YR extends d("[Shell] Update Is Offline Session Intent"){constructor(e){super(),this.isOfflineSession=e}}class en extends d("[Shell] Show Expired Session Banner Intent"){constructor(e){super(),this.state=e}}class ZR extends d("[Shell] Hide offline notification intent"){}class eD extends d("[Shell] Hide Service Degradation Banner"){constructor(e){super(),this.isDegraded=e}}class Ur extends d("[Shell] Update ShellApi for plugins and microapps"){}class T6 extends d("[Shell] Notify Content Scrolled Intent"){constructor(e){super(),this.event=e}}class Qt extends d("[Shell] Report App Initialisation Failure"){constructor(e){super(),this.error=e}}class Jp extends d("[Shell] App Initialisation Completed"){}class Ca extends d("[Shell] Log Out Intent"){}class un extends d("[Shell] Show Shell Modal Intent"){constructor(e){super(),this.modal=e}}class og extends d("[Shell] Hide Shell Modal Intent"){}class cg extends d("[Shell] Quit Intent"){}class tD extends d("[Shell] Request Log Out Intent"){}class iD extends d("[Shell] Request Quit Intent"){}class sD extends d("[Shell] Set Pending Patch Available Intent"){constructor(e){super(),this.available=e}}class aD extends d("[Shell] Request Restart Intent"){constructor(e=!1){super(),this.forceQuit=e}}class lg extends d("[Shell] Request Refresh View Intent"){constructor(e){super(),this.options=e}}class R6 extends d("[Shell] Switch To Online Intent"){}class nD extends d("[Shell] process hotkey for toggling debug panel"){constructor(e){super(),this.events=e}}class D6 extends d("[Shell] set debug panel visibility"){constructor(e){super(),this.isDebugPanelVisible=e}}class O6 extends d("[Shell] set debug panel initial tab"){constructor(e){super(),this.tabName=e}}class F6 extends d("[Shell] remove debug panel tab"){constructor(e){super(),this.tabName=e}}class L6 extends d("[Shell] notify debug panel of focus event"){constructor(e){super(),this.focusRefreshKey=e}}class G6 extends d("[Shell] toggle debug panel focus group node"){constructor(e){super(),this.focusId=e}}class x6 extends d("[Shell] toggle debug panel visibility"){}class E6 extends d("[Shell] set debug panel focus"){constructor(e){super(),this.isDebugPanelFocused=e}}class rD extends d("[Shell] plugin was loaded"){constructor(e){super(),this.pluginConfig=e}}class oD extends d("[Shell] plugin spy feature"){constructor(e,t){super(),this.pluginConfig=e,this.featureId=t}}class cD extends d("[Shell] plugin handle feature"){constructor(e,t){super(),this.pluginConfig=e,this.featureId=t}}class lD extends d("[Shell] plugin handle notification"){constructor(e,t){super(),this.pluginConfig=e,this.featureId=t}}class pD extends d("[Shell] plugin register api"){constructor(e,t){super(),this.pluginConfig=e,this.apiName=t}}class uD extends d("[Shell] debug register feature dispatch "){constructor(e){super(),this.featureId=e}}class Yp extends d("[Shell] debug register feature Listener "){constructor(e,t){super(),this.featureId=e,this.message=t}}class U6 extends d("[Shell] set debug panel section index"){constructor(e){super(),this.index=e}}class k6 extends d("[Shell] Filter Host Tag index"){constructor(e){super(),this.tag=e}}class W6 extends d("[Shell] Unfilter Host Tag index"){constructor(e){super(),this.tag=e}}class V6 extends d("[Shell] Get Partner Information"){}class dD extends d("[Shell] Set Debug Panel Shortcut Buttons"){constructor(e){super(),this.buttons=e}}class $6 extends d("[Shell] Update debug fields"){constructor(e){super(),this.data=e}}class So{constructor(e,t=void 0){this.gameSpaceId=t,this._microAppConfigurations=[],this.microAppConfigurations=e}set microAppConfigurations(e){this._microAppConfigurations=e}get microAppConfigurations(){return this._microAppConfigurations}_findMicroAppConfig(e,t){return this._microAppConfigurations.find(s=>s.appName===e&&(!t&&!s.parentAppName||s.parentAppName===t))}_getAltName(e){var t;return(t=this._microAppConfigurations.find(s=>s.alternativeName===e))==null?void 0:t.appName}findMicroAppConfigsByParentName(e){const t=this._getAltName(e);return this._microAppConfigurations.filter(s=>!e&&!s.parentAppName||s.parentAppName===e||s.parentAppName===t)}findMicroAppConfigWithAltFallback(e,t){const s=this._findMicroAppConfig(e,t);if(s)return s;const a=this._getAltName(e),n=this._getAltName(t),r=[{appName:a,parentName:t},{appName:e,parentName:n},{appName:a,parentName:n}];for(const{appName:o,parentName:l}of r){if(o===void 0||l===void 0)continue;const u=this._findMicroAppConfig(o,l);if(u)return u}}addConfigurations(e){e.forEach(t=>{const s=this._findMicroAppConfig(t.appName,t.parentAppName);if(s){const a={...s.meta,...t.meta};Object.assign(s,t,{meta:a})}else this._microAppConfigurations.push(t)})}removeConfigurations(e){e.forEach(t=>{const s=this._findMicroAppConfig(t.appName,t.parentAppName);s&&this._microAppConfigurations.splice(this._microAppConfigurations.indexOf(s),1)})}hasMicroAppConfigForPlacement(e){return this._microAppConfigurations.some(t=>{var s;return t.placement===e||!!((s=t.allowedPlacements)!=null&&s.includes(e))})}serialize(){return{microAppConfigs:this._microAppConfigurations,gameSpaceId:this.gameSpaceId}}}function Rs(i){const e={};return Object.values(B).forEach(t=>e[t]=bd(i)),e}var dn=(i=>(i.Default="default",i.NativeApp="nativeApp",i.ShellApp="shellApp",i))(dn||{}),B6=Object.defineProperty,H6=Object.getOwnPropertyDescriptor,Oe=(i,e,t,s)=>{for(var a=s>1?void 0:s?H6(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&B6(e,t,a),a};class M extends oe("[Shell] Micro Apps"){constructor(e,t){super(),this._apiFactory=e,this._hostGameSpaceId=t,this._shellMicroAppConfigurations=void 0,this._spaceMicroAppConfigurations=[],this._dynamicallyMountedMicroApps=[],this._navigationInProgress=Rs(void 0),this._activeMicroApps={},this._activatingMicroApps={},this._lastActiveTopLevelAppSpaceId=void 0,this._defaultMicroAppsNames=[],this._defaultPlacement=B.main,this._nonAvailableMicroApps=[],this._accessMenu=[],this._supportsFocusSystemSingleInstance=[],this._appsToPreload=[],this._hasNavigatedToDefaultMicroApps=!1,this._loadedApplicationConfigurations=new $R,this._microAppsState=[],this._defaultNavigationCompleted=new yt,this._initApps=void 0}get loadedApplicationConfigurations(){return this._loadedApplicationConfigurations}get apiFactory(){return this._apiFactory}setActiveMicroApp(e){const{placement:t,value:s}=e;this._activeMicroApps={...this._activeMicroApps,[t]:s}}setActivatingMicroApp(e){const{placement:t,value:s}=e;this._activatingMicroApps={...this._activatingMicroApps,[t]:s}}get getActivatingMicroApp(){return e=>this._activatingMicroApps[e]}get allActiveAppNames(){return[...this.extractAppNames(this._activeMicroApps),...this.extractAppNames(this._activatingMicroApps)]}extractAppNames(e){return Object.values(e).filter(ft).map(t=>t.appName)}get getActiveMicroApp(){return e=>this._activeMicroApps[e]}isMicroAppActiveAnywhere(e){return!!(this.allActiveAppNames.includes(e)||Object.values(this._navigationInProgress).includes(e))}get microAppStateDataGetter(){return e=>this.getMicroAppStateData(e)}getMicroAppStateData(e){const{placement:t,spaceId:s}=e;let a=this._microAppsState.find(n=>n.spaceId===s&&n.placement===t);return a||(a={placement:t,spaceId:s,title:"",subtitle:"",legendItems:[],hotKeys:[]}),a}get getAllMicroAppStateData(){return this._microAppsState}clearAllMicroAppData(){this._microAppsState=[]}setMicroAppStateData(e){const t=this._microAppsState.findIndex(s=>s.placement===e.key.placement&&s.spaceId===e.key.spaceId);t>-1?this._microAppsState[t]={...e.value}:this._microAppsState.push(e.value),this._microAppsState=[...this._microAppsState]}resetMicroAppStateData(e){this.setMicroAppStateData({key:e,value:{placement:e.placement,spaceId:e.spaceId,title:e.meta.label,subtitle:"",legendItems:[],hotKeys:[]}})}setMicroAppTitle(e){const t={...this.getMicroAppStateData(e.key),title:e.value};this.setMicroAppStateData({key:e.key,value:t})}setMicroAppActiveGame(e){const t={...this.getMicroAppStateData(e.key),activeGame:e.value};this.setMicroAppStateData({key:e.key,value:t})}setMicroAppSubtitle(e){const t={...this.getMicroAppStateData(e.key),subtitle:e.value};this.setMicroAppStateData({key:e.key,value:t})}setMicroAppLegend(e){const t={...this.getMicroAppStateData(e.key),legendItems:[...e.value]};this.setMicroAppStateData({key:e.key,value:t})}setMicroAppHotKeys(e){const t={...this.getMicroAppStateData(e.key),hotKeys:[...e.value]};this.setMicroAppStateData({key:e.key,value:t})}get authenticationApplicationConfig(){return this._authenticationApplicationConfig}updateAuthenticationApplicationConfig(e){var t;this._authenticationApplicationConfig={appName:e.appName,bundleUrl:e.bundleUrl,manifestUrl:e.manifestUrl||"",spaceId:e.spaceId,meta:{iconUrl:e.iconUrl||"",label:(t=e.label)!=null?t:e.appName},placement:this.defaultPlacement,coverImage:e.coverImage,integrityHash:e.integrityHash,parentAppName:null,isHidden:!1,populations:[]}}get navigatingMicroApp(){return e=>this._navigationInProgress[e]}setNavigationInProgress(e){const{placement:t,value:s}=e;this._navigationInProgress={...this._navigationInProgress,[t]:s}}createShellAppsConfiguration(e){this._shellMicroAppConfigurations===void 0&&(this._shellMicroAppConfigurations=new So(e))}createSpaceMicroAppsConfiguration(e){this.hasSpaceMicroAppConfig(e.gameSpaceId)||this._spaceMicroAppConfigurations.push(new So(e.microAppConfigs,e.gameSpaceId))}wipeConfigData(){this._activatingMicroApps={},this._activeMicroApps={},this._spaceMicroAppConfigurations=[],this._shellMicroAppConfigurations=void 0}get shellConfigs(){return this._shellMicroAppConfigurations}get spaceConfigs(){return this._spaceMicroAppConfigurations}initialChildWindowSync(e){this._shellMicroAppConfigurations=new So(e.shellConfigs.microAppConfigs,e.shellConfigs.gameSpaceId),this._spaceMicroAppConfigurations=e.spaceConfigs.map(t=>new So(t.microAppConfigs,t.gameSpaceId))}hasSpaceMicroAppConfig(e){return this.findSpaceMicroAppConfig(e)!==void 0}findMicroAppConfig(e,t,s){var n,r;if(((n=this._authenticationApplicationConfig)==null?void 0:n.appName)===e)return this._authenticationApplicationConfig;let a;if(t===null&&(a=this.findTopLevelMicroAppConfigByName(e,this._hostGameSpaceId)),a||(a=(r=this._shellMicroAppConfigurations)==null?void 0:r.findMicroAppConfigWithAltFallback(e,t)),!a&&s){const o=this.findSpaceMicroAppConfig(s);a=o==null?void 0:o.findMicroAppConfigWithAltFallback(e,t)}return a}get findMicroAppConfigsByGameSpace(){return(e,t)=>{var s,a;return(a=(s=this.findSpaceMicroAppConfig(e))==null?void 0:s.findMicroAppConfigsByParentName(t))!=null?a:[]}}findSpaceMicroAppConfig(e){return this._spaceMicroAppConfigurations.find(t=>t.gameSpaceId===e)}get isTopLevelAppBySpaceId(){return(e,t)=>this.findMicroAppConfigsByGameSpace(t,null).find(s=>s.spaceId===e)!==void 0}findTopLevelMicroAppConfigByName(e,t){var s;return(s=this.findSpaceMicroAppConfig(t))==null?void 0:s.findMicroAppConfigWithAltFallback(e,null)}get getTopLevelMicroAppConfigByName(){return(e,t)=>this.findTopLevelMicroAppConfigByName(e,t)}get lastActiveTopLevelAppSpaceId(){return this._lastActiveTopLevelAppSpaceId}set lastActiveTopLevelAppSpaceId(e){this._lastActiveTopLevelAppSpaceId=e}removeAllFromMounted(){this._dynamicallyMountedMicroApps=[]}removeFromMounted(e){const t=this._dynamicallyMountedMicroApps.findIndex(s=>s.placement===e.placement&&s.spaceId===e.spaceId);t>-1&&this._dynamicallyMountedMicroApps.splice(t,1)}addToMounted(e){this._dynamicallyMountedMicroApps.findIndex(s=>s.placement===e.placement&&s.spaceId===e.spaceId)<0&&(this._dynamicallyMountedMicroApps.push({...e}),this._dynamicallyMountedMicroApps=[...this._dynamicallyMountedMicroApps])}get dynamicallyMountedMicroApps(){return[...this._dynamicallyMountedMicroApps]}set defaultMicroAppsNames(e){this._defaultMicroAppsNames=e}get defaultMicroAppsNames(){return this._defaultMicroAppsNames}get defaultPlacement(){return this._defaultPlacement}set defaultPlacement(e){this._defaultPlacement=e}get nonAvailableMicroApps(){return this._nonAvailableMicroApps}set nonAvailableMicroApps(e){this._nonAvailableMicroApps=e}get accessMenu(){return this._accessMenu}set accessMenu(e){this._accessMenu=e}get supportsFocusSystemSingleInstance(){return this._supportsFocusSystemSingleInstance}set supportsFocusSystemSingleInstance(e){this._supportsFocusSystemSingleInstance=e}get microAppSupportsFocusSystemSingleInstance(){return e=>this._supportsFocusSystemSingleInstance.includes(e)}convertToShellMicroAppConfigs(e,t){return e.map(s=>({appName:s.appName,spaceId:s.spaceId,microAppType:dn.NativeApp,bundleUrl:"",manifestUrl:"",meta:{iconUrl:"",label:s.meta.label},placement:this.defaultPlacement,parentAppName:t,isHidden:!1,populations:[]}))}addNativeSpaceMicroAppConfigurations(e){const t=this.convertToShellMicroAppConfigs(e.microAppConfigs,e.parentAppName),s=this.findSpaceMicroAppConfig(e.gameSpaceId);s?s.addConfigurations(t):this.createSpaceMicroAppsConfiguration({gameSpaceId:e.gameSpaceId,microAppConfigs:t})}updateNativeMicroAppConfigurations({gameSpaceId:e,addApplications:t,removeApplications:s,parentAppName:a}){t.length>0&&this.addNativeSpaceMicroAppConfigurations({gameSpaceId:e,microAppConfigs:t,parentAppName:a});const n=this.findSpaceMicroAppConfig(e);if(n&&s.length>0){const r=this.convertToShellMicroAppConfigs(s,a);n.removeConfigurations(r),n.microAppConfigurations.length===0&&this.removeSpaceConfiguration(n)}}removeSpaceConfiguration(e){const t=this._spaceMicroAppConfigurations.indexOf(e);t!==-1&&this._spaceMicroAppConfigurations.splice(t,1)}get hasMicroAppConfigForPlacement(){return(e,t)=>{var s,a;return(a=(s=this.findSpaceMicroAppConfig(e))==null?void 0:s.hasMicroAppConfigForPlacement(t))!=null?a:!1}}set appsToPreload(e){this._appsToPreload=e}get appsToPreload(){return this._appsToPreload}get hasNavigatedToDefaultMicroApps(){return this._hasNavigatedToDefaultMicroApps}set hasNavigatedToDefaultMicroApps(e){this._hasNavigatedToDefaultMicroApps=e,e&&this._defaultNavigationCompleted.resolve()}get defaultNavigationCompleted(){return this._defaultNavigationCompleted.promise}get initialAppsState(){return this._initApps}set initialAppsState(e){this._initApps=e}}Oe([P],M.prototype,"setActiveMicroApp",1);Oe([P],M.prototype,"setActivatingMicroApp",1);Oe([P],M.prototype,"clearAllMicroAppData",1);Oe([P],M.prototype,"setMicroAppStateData",1);Oe([P],M.prototype,"resetMicroAppStateData",1);Oe([P],M.prototype,"setMicroAppTitle",1);Oe([P],M.prototype,"setMicroAppActiveGame",1);Oe([P],M.prototype,"setMicroAppSubtitle",1);Oe([P],M.prototype,"setMicroAppLegend",1);Oe([P],M.prototype,"setMicroAppHotKeys",1);Oe([P],M.prototype,"updateAuthenticationApplicationConfig",1);Oe([P],M.prototype,"setNavigationInProgress",1);Oe([P],M.prototype,"createShellAppsConfiguration",1);Oe([P],M.prototype,"createSpaceMicroAppsConfiguration",1);Oe([P],M.prototype,"wipeConfigData",1);Oe([P],M.prototype,"initialChildWindowSync",1);Oe([P],M.prototype,"removeAllFromMounted",1);Oe([P],M.prototype,"removeFromMounted",1);Oe([P],M.prototype,"addToMounted",1);Oe([P],M.prototype,"addNativeSpaceMicroAppConfigurations",1);Oe([P],M.prototype,"updateNativeMicroAppConfigurations",1);class $t extends d("[Shell] Manage Back Button Shortcut"){}class Qi extends d("[Shell] Manage Exit Button Shortcut"){}class hD extends d("[Shell] Manage Exit Button Shortcut For Input Device Type"){}var Q6=Object.defineProperty,j6=Object.getOwnPropertyDescriptor,Xt=(i,e,t,s)=>{for(var a=s>1?void 0:s?j6(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Q6(e,t,a),a};const q6="debug-panel-focus-group",z6=[{name:"general"},{name:"logs"},{name:"runtime"},{name:"host"},{name:"apps"},{name:"history"},{name:"plugins"},{name:"session"},{name:"url"},{name:"focus"},{name:"life-cycle"}];class te extends oe("[Shell] Debug Panel"){constructor(e,t,s={}){super(),this._runtimeParameterConfig=e,this._runtimeParameters=t,this._debugFields=s,this._sections=z6,this._partnerContext=void 0,this._isDebugPanelFocused=!1,this._isDebugPanelVisible=!1,this._rightStickY=0,this._comboCheck=[{combo:{sequence:[L.DpadDown,L.DpadDown,L.DpadUp,L.DpadUp,L.DpadRight,L.DpadLeft,L.DpadRight,L.DpadLeft,L.DpadRight,L.DpadLeft,L.DpadUp],delayInMs:1e3,action:()=>{this._isDebugPanelVisible=!this._isDebugPanelVisible,this._isDebugPanelFocused=this._isDebugPanelVisible}},times:[]},{combo:{sequence:[L.DpadDown,L.DpadDown,L.DpadUp,L.DpadUp,L.DpadRight,L.DpadLeft,L.DpadRight,L.DpadLeft,L.DpadRight,L.DpadLeft,L.DpadRight],delayInMs:1e3,action:()=>{this._debugSectionIndex++}},times:[]},{combo:{sequence:[L.DpadDown,L.DpadDown,L.DpadUp,L.DpadUp,L.DpadRight,L.DpadLeft,L.DpadRight,L.DpadLeft,L.DpadRight,L.DpadLeft,L.DpadLeft],delayInMs:1e3,action:()=>{this._debugSectionIndex=this._debugSectionIndex===0?0:this._debugSectionIndex-1}},times:[]},{combo:{sequence:[L.DpadDown,L.DpadDown,L.DpadUp,L.DpadUp,L.DpadRight,L.DpadLeft,L.DpadUp],delayInMs:1e3,action:()=>{this._isDebugPanelFocused||!this._isDebugPanelVisible||(this._isDebugPanelFocused=!this._isDebugPanelFocused)}},times:[]}],this._filteredHostTags=new Set(["message: MessageViewMoved","message: MessageFpsUpdate"]),this._shortcutButtons=[],this._focusRefreshKey=0,this._focusCollapsedGroups=new Map([[q6,!0]]),this._debugSectionIndex=0,this._pluginConfigs=[],this._data=new Map,this._registeredFeatureDispatchHandlers=[],this._registeredFeatureListenerHandlers=new Map,this._isDebugPanelVisible=this._runtimeParameters.debug;const a=this.sectionIndex(this._runtimeParameters.debugTab);this._debugSectionIndex=a===-1?0:a}get sections(){return this._sections}get sectionIndex(){return e=>this.sections.findIndex(t=>t.name===e)}removeSection(e){const t=this.sectionIndex(e);t!==-1&&this.sections.splice(t,1)}get fullUrl(){return this._runtimeParameters.fullUrl}get runtimeParameters(){return this._runtimeParameters}get isDebugPanelVisible(){return this._isDebugPanelVisible}set isDebugPanelVisible(e){this._isDebugPanelVisible=e}get isDebugPanelFocused(){return this._isDebugPanelFocused}set isDebugPanelFocused(e){this._isDebugPanelFocused=e}get rightStickY(){return this._rightStickY}set rightStickY(e){this._rightStickY=e}set focusRefreshKey(e){this._focusRefreshKey=e}get focusRefreshKey(){return this._focusRefreshKey}get shortcutButtons(){return this._shortcutButtons}set shortcutButtons(e){this._shortcutButtons=e}toggleFocusGroup(e){this._focusCollapsedGroups.set(e,!this._focusCollapsedGroups.get(e)),this._focusCollapsedGroups=new Map(this._focusCollapsedGroups)}get focusCollapsedGroups(){return this._focusCollapsedGroups}registerButtonPressForCombo(e){const t={button:e,timestamp:Date.now()};this._comboCheck.forEach(s=>this.checkCombo(s,t))}checkCombo(e,t){const s=e.times.length?e.times[0].timestamp:void 0,a=s?t.timestamp-s:0;(e.combo.delayInMs&&a?a<e.combo.delayInMs:!0)||(e.times=[]),t.button===e.combo.sequence[e.times.length]?(e.times.unshift(t),e.times.length===e.combo.sequence.length&&(e.combo.action&&e.combo.action(),e.times=[])):e.times=[]}get debugSectionIndex(){return this._debugSectionIndex}set debugSectionIndex(e){this._debugSectionIndex=e}addLoadedPlugin(e){this._pluginConfigs=[...this._pluginConfigs],this._pluginConfigs.push(e)}get loadedPlugins(){return this._pluginConfigs}get pluginData(){return this._data}addRegisteredApi(e){const t=this.getPluginDebugInfo(e.config);t.registeredApis.push(e.api),this.updatePluginDebugInfo(e.config,t)}addPluginSpyInfo(e){const t=this.getPluginDebugInfo(e.config);t.spyFeatures.add(e.featureId),this.updatePluginDebugInfo(e.config,t)}addPluginHandlerInfo(e){const t=this.getPluginDebugInfo(e.config);t.handlers.add(e.featureId),this.updatePluginDebugInfo(e.config,t)}addPluginNotificationInfo(e){const t=this.getPluginDebugInfo(e.config);t.listeners.add(e.featureId),this.updatePluginDebugInfo(e.config,t)}getPluginDebugInfo(e){return this._data.get(e)||{registeredApis:[],spyFeatures:new Set,handlers:new Set,listeners:new Set}}updatePluginDebugInfo(e,t){this._data.set(e,t);const s=this._data;this._data=new Map(s)}get registeredFeatureDispatchHandlers(){return this._registeredFeatureDispatchHandlers}get registeredFeatureListenerHandlers(){return this._registeredFeatureListenerHandlers}get maskedParameters(){return this._runtimeParameterConfig.filter(e=>e.containsSensitiveData)}addFeatureDispatchHandler(e){this._registeredFeatureDispatchHandlers=[...this._registeredFeatureDispatchHandlers,e]}addFeatureListenerHandler({featureId:e,message:t}){const s=new Map(this._registeredFeatureListenerHandlers);s.set(e,t),this._registeredFeatureListenerHandlers=s}get filteredHostTags(){return this._filteredHostTags}addFilteredTag(e){const t=new Set(this._filteredHostTags);t.add(e),this._filteredHostTags=t}removeFilteredTag(e){const t=new Set(this._filteredHostTags);t.delete(e),this._filteredHostTags=t}set partnerContext(e){this._partnerContext=e}get partnerContext(){return this._partnerContext}get debugFields(){return this._debugFields}updateDebugField(e){this._debugFields={...this._debugFields,...e}}}Xt([P],te.prototype,"removeSection",1);Xt([P],te.prototype,"toggleFocusGroup",1);Xt([P],te.prototype,"registerButtonPressForCombo",1);Xt([P],te.prototype,"addLoadedPlugin",1);Xt([P],te.prototype,"addRegisteredApi",1);Xt([P],te.prototype,"addPluginSpyInfo",1);Xt([P],te.prototype,"addPluginHandlerInfo",1);Xt([P],te.prototype,"addPluginNotificationInfo",1);Xt([P],te.prototype,"addFeatureDispatchHandler",1);Xt([P],te.prototype,"addFeatureListenerHandler",1);Xt([P],te.prototype,"addFilteredTag",1);Xt([P],te.prototype,"removeFilteredTag",1);Xt([P],te.prototype,"updateDebugField",1);var K6=Object.defineProperty,X6=Object.getOwnPropertyDescriptor,fl=(i,e,t,s)=>{for(var a=s>1?void 0:s?X6(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&K6(e,t,a),a};class $e extends oe("[Shell] Error"){constructor(){super(...arguments),this._shellErrors={},this._shellGlobalError=null}get getShellError(){return e=>{if(this._shellGlobalError)return this._shellGlobalError;const t=e||Object.values(B).find(s=>this._shellErrors[s]);return t?this._shellErrors[t]:void 0}}setShellGlobalError(e){this._shellGlobalError=e}setShellError(e){const{placement:t,value:s}=e;this._shellErrors={...this._shellErrors,[t]:s}}clearShellError(e){this._shellErrors={...this._shellErrors,[e]:void 0}}clearAllShellErrors(){this._shellGlobalError=null,this._shellErrors={}}}fl([P],$e.prototype,"setShellGlobalError",1);fl([P],$e.prototype,"setShellError",1);fl([P],$e.prototype,"clearShellError",1);fl([P],$e.prototype,"clearAllShellErrors",1);class gD extends d("[Shell] Subscribe to Gamepad Events"){constructor(e,t){super(),this.spaceId=e,this.callback=t}}class mD extends d("[Shell] Unsubscribe from Gamepad Events"){constructor(e){super(),this.spaceId=e}}class fD extends d("[Shell] Notify Gamepad Connected"){constructor(e){super(),this.brand=e}}class yD extends d("[Shell] Notify Gamepad Disconnected"){constructor(e){super(),this.brand=e}}class Zp extends d("[Shell] Notify Gamepad Input"){constructor(e,t){super(),this.brand=e,this.events=t}}class kr extends d("[Shell] Notify Internal Focus Changed"){}class lr extends d("[Shell] Notify Component Is Selected"){constructor(e){super(),this.componentType=e}}class er extends d("[Shell] Update input device type"){constructor(e){super(),this.brand=e}}class vD extends d("[Shell] Sync navigation method"){constructor(e){super(),this.navigationMethod=e}}class ja extends d("[Shell] Update navigation method"){constructor(e){super(),this.inputEventDeviceType=e}}class _D extends d("[Shell] Add Mouse Over Element Listener"){constructor(e){super(),this.elementListener=e}}class SD extends d("[Shell] Remove Mouse Over Element Listener"){constructor(e){super(),this.elementListener=e}}class wD extends d("[Shell] Add Mouse Out Element Listener"){constructor(e){super(),this.elementListener=e}}class bD extends d("[Shell] Remove Mouse Out Element Listener"){constructor(e){super(),this.elementListener=e}}class eu extends d("[Shell] Disable Gamepad Inputs"){}class tu extends d("[Shell] Enable Gamepad Inputs"){}var J6=Object.defineProperty,Y6=Object.getOwnPropertyDescriptor,CD=(i,e,t,s)=>{for(var a=s>1?void 0:s?Y6(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&J6(e,t,a),a};class Dt extends oe("Input State"){constructor(){super(...arguments),this._connectedGamepads=[],this._selectedComponentType=null,this._gamepadInputsEnabled=!0}set gamepadInputEnabled(e){this._gamepadInputsEnabled=e}get gamepadInputEnabled(){return this._gamepadInputsEnabled}addGamepad(e){this._connectedGamepads.push(e)}get lastConnectedGamepad(){var e;return(e=this._connectedGamepads[this._connectedGamepads.length-1])!=null?e:null}removeGamepad(e){const t=this._connectedGamepads.indexOf(e);t>=0&&this._connectedGamepads.splice(t,1)}get selectedComponentType(){return this._selectedComponentType}set selectedComponentType(e){this._selectedComponentType=e}}CD([P],Dt.prototype,"addGamepad",1);CD([P],Dt.prototype,"removeGamepad",1);var Z6=Object.defineProperty,e7=Object.getOwnPropertyDescriptor,ot=(i,e,t,s)=>{for(var a=s>1?void 0:s?e7(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Z6(e,t,a),a};class Je extends z{constructor(e,t,s,a,n,r){super(),this._inputAggregator=e,this._gamepadSubject=t,this._logger=s,this._focusSystem=a,this._inputDeviceTypeCalculator=n,this._navigationMethodCalculator=r,this._logger=s.createChild("Input.reducer"),this._logger.settings.logCategory=f.input}async subscribeToGamepadEvents(e,t){this._gamepadSubject.subscribe(t.spaceId,t.callback)}async unsubscribeFromGamepadEvents(e,t){this._gamepadSubject.unsubscribe(t.spaceId)}async notifyGamepadConnected(e,t){if(t.brand===Up.Keyboard)return;this.getMutableState(e,Dt).addGamepad(t.brand),await this.dispatch(e,new er(t.brand))}async notifyGamepadDisconnected(e,t){const s=this.getMutableState(e,Dt);s.removeGamepad(t.brand);const a=s.lastConnectedGamepad;await this.dispatch(e,new er(a))}async notifyGamepadInput(e,t){const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,M),n=this.getMutableState(e,Dt);if(!s.isOverlayVisible||!n.gamepadInputEnabled){this._logger.debug("Input event ignored. Overlay is not visible or gamepad gamepad input is disabled");return}const r=this.calculateInputDeviceType(e,t.brand,t.events);if(await this.dispatch(e,new ja(r)),await this.dispatch(e,new er(t.brand)),await this.dispatch(e,new nD(t.events)),t.events.some(F=>F.button===L.Y&&[$a.ButtonPress,$a.ButtonHold].includes(F.type))){const F=this.getReadOnlyState(e,S);if(this.shouldDispatchCloseOverlayOnButtonY(F.hostPlatformType)){const V=this.getReadOnlyState(e,$e);await this.dispatch(e,new Gt(V.getShellError()?_e.FatalError:_e.User));return}}const l=this.getReadOnlyState(e,M).defaultPlacement,u=s.focusedMicroApp,w=Es[s.layoutType].sort(F=>F===l?-1:1).map(F=>a.getActiveMicroApp(F)).filter(F=>(u==null?void 0:u.spaceId)!==(F==null?void 0:F.spaceId)||(u==null?void 0:u.placement)!==(F==null?void 0:F.placement)).map(F=>({app:F,buttons:this.getMicroAppButtons(e,!0,F),events:[]})),b=u?this.getMicroAppButtons(e,!1,u):new Set,I=u?{app:u,buttons:this.getMicroAppButtons(e,!0,u),events:[]}:void 0;u&&this._gamepadSubject.notifyGamepadInput(u.spaceId,t.events);const R=[],x=this.getReadOnlyState(e,te);t.events.forEach(F=>{if(!x.isDebugPanelFocused||!x.shortcutButtons.includes(F.button)){if(b.has(F.button)||I&&I.buttons.has(F.button))return;for(const V of w)if(V.buttons.has(F.button)&&V.app){V.events.push(F);return}}R.push(F)});for(const F of w)F.events.length>0&&F.app&&this._gamepadSubject.notifyGamepadInput(F.app.spaceId,F.events);for(const F of R)this._logger.debug("Input event to focus system - ".concat(F.button," ").concat(F.type),{event:F}),this._focusSystem.input(F)}async addMouseOverElementListener(e,t){this._inputAggregator.addMouseOverElementListener(t.elementListener)}async removeMouseOverElementListener(e,t){this._inputAggregator.removeMouseOverElementListener(t.elementListener)}async addMouseOutElementListener(e,t){this._inputAggregator.addMouseOutElementListener(t.elementListener)}async removeMouseOutElementListener(e,t){this._inputAggregator.removeMouseOutElementListener(t.elementListener)}async disableGamepadInputs(e){const t=this.getMutableState(e,Dt);t.gamepadInputEnabled=!1,this._disableGamepadInputTimeoutId&&clearTimeout(this._disableGamepadInputTimeoutId),this._disableGamepadInputTimeoutId=setTimeout(()=>{this.getMutableState(e,Dt).gamepadInputEnabled||(this._logger.debug("Gamepad inputs were disabled for more than 5 seconds. They will be re-enabled as a safeguard"),t.gamepadInputEnabled=!0)},5e3)}async enableGamepadInputs(e){const t=this.getMutableState(e,Dt);t.gamepadInputEnabled=!0}calculateInputDeviceType(e,t,s){return t!==Up.Keyboard?H.gamepad:!s.some(n=>M6.includes(n.button))&&this.getReadOnlyState(e,S).navigationMethod!==E.directional?H.keyboard:H.gamepad}shouldDispatchCloseOverlayOnButtonY(e){return![p.MacOS,p.PCWebOverlay,p.PCLegacyOverlay,p.PCLegacyClient,p.PCElectronClient,p.PCWebClient,p.Luna,p.Scarlett,p.XONE,p.SteamOverlay,p.SteamClient,p.Switch].includes(e)}getMicroAppButtons(e,t,s){const a=this.getReadOnlyState(e,M),n=s?[a.getMicroAppStateData(s)]:a.getAllMicroAppStateData;return new Set(n.reduce((r,o)=>r.concat(o.legendItems.filter(l=>t?l.isGlobal:!0).map(l=>l.button).concat(o.hotKeys)),[]))}async setInternalFocusChanged(){this._inputAggregator.notifyFocusChange()}async toggleKeyboardAdapter(e,t){const s=this.getMutableState(e,Dt);if(s.selectedComponentType!==t.componentType){s.selectedComponentType=t.componentType,this._inputAggregator.notifySelectionChange(t.componentType);const a=this.getReadOnlyState(e,S);Ba.includes(a.platformType)&&await this.dispatch(e,new Qi),await this.dispatch(e,new $t)}}async updateInputDeviceType(e,t){const s=this.getMutableState(e,S),a=this._inputDeviceTypeCalculator.calculate(s.platformType,t.brand);s.inputDeviceType!==a&&(this._logger.debug("Updated input device type to ".concat(a)),s.inputDeviceType=a,Ba.includes(s.platformType)&&this.dispatch(e,new hD))}async updateNavigationMethod(e,t){const s=e.rootState.states[S.moduleName],a=this._navigationMethodCalculator.calculate(s.platformType,t.inputEventDeviceType);if(a===s.navigationMethod)return;this._logger.debug("Updated navigation method to ".concat(a));const n=this.getReadOnlyState(e,Dt);if(n.selectedComponentType&&n.selectedComponentType!==pa.contextMenu)return;const r=this.getMutableState(e,S);r.navigationMethod!==a&&(r.navigationMethod=a),this._focusSystem.updateNavigationMethod(a)}async syncNavigationMethod(e,t){this._focusSystem.updateNavigationMethod(t.navigationMethod)}}ot([h(gD)],Je.prototype,"subscribeToGamepadEvents",1);ot([h(mD)],Je.prototype,"unsubscribeFromGamepadEvents",1);ot([h(fD)],Je.prototype,"notifyGamepadConnected",1);ot([h(yD)],Je.prototype,"notifyGamepadDisconnected",1);ot([h(Zp)],Je.prototype,"notifyGamepadInput",1);ot([h(_D)],Je.prototype,"addMouseOverElementListener",1);ot([h(SD)],Je.prototype,"removeMouseOverElementListener",1);ot([h(wD)],Je.prototype,"addMouseOutElementListener",1);ot([h(bD)],Je.prototype,"removeMouseOutElementListener",1);ot([h(eu)],Je.prototype,"disableGamepadInputs",1);ot([h(tu)],Je.prototype,"enableGamepadInputs",1);ot([h(kr)],Je.prototype,"setInternalFocusChanged",1);ot([h(lr)],Je.prototype,"toggleKeyboardAdapter",1);ot([h(er)],Je.prototype,"updateInputDeviceType",1);ot([h(ja)],Je.prototype,"updateNavigationMethod",1);ot([h(vD)],Je.prototype,"syncNavigationMethod",1);class t7{static create(e,t,s){return{reducers:[new Je(e,new _6(t),t,s,new QR(t),new ml(t))],states:[new Dt]}}}class i7{static addListeners(e){window.addEventListener("online",()=>{e.dispatchIntent(new Xp(!0))}),window.addEventListener("offline",()=>{e.dispatchIntent(new Xp(!1))})}}class yl extends d("[Player Notifications] Open Player Notification Connection"){}class jo extends d("[Player Notifications] Close Player Notification Connection"){}class pr extends d("[Player Notifications] Update Player Notification Connection"){constructor(e,t){super(),this.subscriberId=e,this.config=t}}class ur extends d("[Player Notifications] Subscribe to Player Notification"){constructor(e,t){super(),this.callback=e,this.subscriberId=t}}class pg extends d("[Player Notifications] Unsubscribe from Player Notification"){constructor(e){super(),this.callback=e}}class ID extends d("[Player Notifications] Renew Player Notification Web Socket connection"){}class MD extends d("[Player Notifications] Connection state is updated"){constructor(e){super(),this.state=e}}var s7=Object.defineProperty,a7=Object.getOwnPropertyDescriptor,AD=(i,e,t,s)=>{for(var a=s>1?void 0:s?a7(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&s7(e,t,a),a},ra=(i=>(i.topRight="topRight",i.topLeft="topLeft",i.bottomRight="bottomRight",i.bottomLeft="bottomLeft",i))(ra||{});class Q extends oe("[Shell] Application"){constructor(e){super(),this._appId=e,this._isLayoutMounted=!1,this._isMicroAppSpinnerVisible=Rs(!1),this._isNoConnectionViewVisible=Rs(!1),this._isNavigationBarVisible=!1,this._isAccountLinkingInProgress=!1,this._notificationPosition="topRight",this._hostFeatures=void 0,this._showOfflineNotification=!1,this._showExpiredSessionBanner=!1,this._showServiceDegradationBanner=!1,this._isLegacyUIDecommissioned=!0,this._feedbackButtonUrl="",this._activeModal=null,this._pendingPatchAvailable=!1,this._windowState=void 0,this._isInitializationCompleted=!1}get pendingPatchAvailable(){return this._pendingPatchAvailable}set pendingPatchAvailable(e){this._pendingPatchAvailable=e}get showOfflineNotification(){return this._showOfflineNotification}set showOfflineNotification(e){this._showOfflineNotification=e}get showExpiredSessionBanner(){return this._showExpiredSessionBanner}set showExpiredSessionBanner(e){this._showExpiredSessionBanner=e}get notificationPosition(){return this._notificationPosition}set notificationPosition(e){this._notificationPosition=e}get isAccountLinkingInProgress(){return this._isAccountLinkingInProgress}set isAccountLinkingInProgress(e){this._isAccountLinkingInProgress=e}get feedbackButtonUrl(){return this._feedbackButtonUrl}set feedbackButtonUrl(e){this._feedbackButtonUrl=e}get appId(){return this._appId}get isNavigationBarVisible(){return this._isNavigationBarVisible}set isNavigationBarVisible(e){this._isNavigationBarVisible=e}set isLayoutMounted(e){this._isLayoutMounted=e}get isLayoutMounted(){return this._isLayoutMounted}get isNoConnectionViewVisible(){return e=>this._isNoConnectionViewVisible[e]}setIsNoConnectionViewVisible(e){const{value:t,placement:s}=e;this._isNoConnectionViewVisible={...this._isNoConnectionViewVisible,[s]:t}}get isMicroAppSpinnerVisible(){return e=>this._isMicroAppSpinnerVisible[e]}setIsMicroAppSpinnerVisible(e){const{value:t,placement:s}=e;this._isMicroAppSpinnerVisible={...this._isMicroAppSpinnerVisible,[s]:t}}get hostFeatures(){return this._hostFeatures}set hostFeatures(e){this._hostFeatures=e}get isLegacyUIDecommissioned(){return this._isLegacyUIDecommissioned}set isLegacyUIDecommissioned(e){this._isLegacyUIDecommissioned=e}get activeModal(){return this._activeModal}set activeModal(e){this._activeModal=e}get windowState(){return this._windowState}set windowState(e){this._windowState=e}get initializationCompleted(){return this._isInitializationCompleted}set initializationCompleted(e){this._isInitializationCompleted=e}get showServiceDegradationBanner(){return this._showServiceDegradationBanner}set showServiceDegradationBanner(e){this._showServiceDegradationBanner=e}}AD([P],Q.prototype,"setIsNoConnectionViewVisible",1);AD([P],Q.prototype,"setIsMicroAppSpinnerVisible",1);class PD extends d("[Shell] Set session timeout"){constructor(e){super(),this.initialTimeout=e}}class ND extends d("[Shell] Clear session timeout"){}class Re extends d("[Shell] Set authentication in progress"){constructor(e){super(),this.inProgress=e}}class ug extends d("[Shell] Refresh session"){constructor(e){super(),this.ticket=e}}class TD extends d("[Shell] UbiTicket refresh request"){}class RD extends d("[Shell] Host shutdown"){}class DD extends d("[Shell] Validate Session"){constructor(e,t,s){super(),this.session=e,this.password=t,this.email=s}}class OD extends d("[Shell] Pass authenticate stats"){constructor(e){super(),this.data=e}}class FD extends d("[Shell] Set auth dolphin error retried"){constructor(e){super(),this.retried=e}}class vl extends d("[Shell] Set viewport mode"){constructor(e){super(),this.mode=e}}class dg extends d("[Shell] Set Navigation Bar View Mode"){constructor(e){super(),this.mode=e}}class hg extends d("[Shell] Set Title Bar View Mode"){constructor(e){super(),this.mode=e}}class _l extends d("[Shell] Reset UI Visibility"){}class LD extends d("[Shell] Set Sidebar View Mode"){constructor(e){super(),this.mode=e}}class GD extends d("[Shell] Set Sidebar View State"){constructor(e){super(),this.state=e}}var ua=(i=>(i.NotInitialized="notInitialized",i.Success="success",i.Failed="failed",i))(ua||{});class oa extends oe("ConnectionStatusState"){constructor(e=!0){super(),this._playerNotificationsConnectionState={status:Vi.NotInitialized},this._networkPollStatus=ua.NotInitialized,this._pollAttempt=0,this._wssAttempt=0,this._browserOnLine=!0,this._checkConnection=!0,this._browserOnLine=e}get playerNotificationsConnectionState(){return this._playerNotificationsConnectionState}set playerNotificationsConnectionState(e){this._playerNotificationsConnectionState=e}get networkPollStatus(){return this._networkPollStatus}set networkPollStatus(e){this._networkPollStatus=e}get isNetworkConnected(){return this._networkPollStatus===ua.NotInitialized?this._browserOnLine:this._networkPollStatus===ua.Success}get pollAttempt(){return this._pollAttempt}set pollAttempt(e){this._pollAttempt=e}get wssAttempt(){return this._wssAttempt}set wssAttempt(e){this._wssAttempt=e}get browserOnLine(){return this._browserOnLine}set browserOnLine(e){this._browserOnLine=e}get checkConnection(){return this._checkConnection}set checkConnection(e){this._checkConnection=e}}var n7=Object.defineProperty,r7=Object.getOwnPropertyDescriptor,Sl=(i,e,t,s)=>{for(var a=s>1?void 0:s?r7(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&n7(e,t,a),a};class Wr extends z{constructor(e,t){super(),this._logger=e,this._networkPollingService=t,this._logger=this._logger.createChild("ConnectionStatus.reducer"),this._logger.settings.logCategory=f.playerNotification,this._networkPollingService.checkConnection()}async updateNotificationConnectionStateIntent(e,t){const s=this.getMutableState(e,oa);return s.playerNotificationsConnectionState=t.state,t.state.status===Vi.Opened&&(s.wssAttempt=0),t.state.status===Vi.RetryNext&&(s.wssAttempt=s.wssAttempt+1),this.handleOnlineModeUpdate(e)}async updateNetworkState(e,t){const s=this.getMutableState(e,oa),a=s.networkPollStatus;return s.networkPollStatus=t.pollStatus,t.pollStatus!==a?s.pollAttempt=0:s.pollAttempt=s.pollAttempt+1,this.handleOnlineModeUpdate(e)}async updateBrowserState(e,t){const s=this.getMutableState(e,oa),a=s.browserOnLine;if(s.browserOnLine=t.browserOnLine,!!s.checkConnection)return a!==t.browserOnLine&&this._networkPollingService.checkConnection(),this.handleOnlineModeUpdate(e)}async handleOnlineModeUpdate(e){const t=this.getMutableState(e,S),s=this.getMutableState(e,Q);if(t.isOnline)s.showOfflineNotification=!1,this._logger.info("Network connection restored"),t.isPlayerSessionValidAfterThirtyMinutes||(this._logger.info("Refreshing session"),this.dispatch(e,new ug));else{this.dispatch(e,new _l),this.dispatch(e,new Qi);const a=Wo.isAvailable()?"No network connection. Shell is in offline mode":"No network connection and no service worker to run offline mode";this._logger.info(a),s.showOfflineNotification=!0}}async updateConnectionStatusCheck(e,t){const s=this.getMutableState(e,oa);return s.checkConnection=t.checkConnection,t.checkConnection?this._networkPollingService.checkConnection():this._networkPollingService.stopPolling(),this.handleOnlineModeUpdate(e)}}Sl([h(MD)],Wr.prototype,"updateNotificationConnectionStateIntent",1);Sl([h(Po)],Wr.prototype,"updateNetworkState",1);Sl([h(Xp)],Wr.prototype,"updateBrowserState",1);Sl([h(JR)],Wr.prototype,"updateConnectionStatusCheck",1);class qo extends d("[Shell] update session user mapping for service worker"){constructor(e,t){super(),this.sessionId=e,this.profileId=t}}class xD extends d("[Shell] initialize service worker"){}class ED extends d("[Shell] service worker controller was changed"){}class iu extends d("[Shell] wipe cached data"){}class UD extends d("[Shell] wipe cached data if version match"){}class die extends d("[Shell] re send manifests data to service worker"){}class In extends d("[Shell] register cache definitions in service worker"){constructor(e){super(),this.definitions=e}}class wl extends d("[Shell] unregister cache definitions in service worker"){constructor(e){super(),this.definitions=e}}class su extends d("[Shell] load manifest data"){constructor(e){super(),this.manifestUrls=e}}class kD extends d("[Shell] register manifest data"){constructor(e){super(),this.manifest=e}}class au extends d("[Shell] set cache opaque request intent"){constructor(e){super(),this.cacheOpaqueRequests=e}}class WD extends d("[Shell] set service worker offline intent"){constructor(e){super(),this.offline=e}}class VD extends d("[Shell] check data is cached intent"){constructor(e,t){super(),this.url=e,this.options=t}}Bt.NetworkFirst+"",7*24*3600,Bt.NetworkOnly+"",Bt.StaleWhileRevalidate+"",7*24*3600,Bt.Static+"",60*24*3600;const gg={[St.PerUser]:7*24*3600,[St.PerSession]:6*3600,[St.Everyone]:60*24*3600};Bt.Static,St.Everyone;Bt.NetworkFirst,St.PerSession;Bt.NetworkOnly,St.Everyone;Bt.NetworkFirst,St.Everyone,"".concat(gg[St.Everyone],"s");Bt.StaleWhileRevalidate,St.Everyone,"".concat(gg[St.Everyone],"s");Bt.NetworkFirst,St.Everyone,"".concat(gg[St.Everyone],"s");const o7={url:"https://public-ubiservices.ubi.com/v1/status/global/ubiconnect/configcache/api",cachingStrategy:Bt.NetworkOnly,scope:St.Everyone,isRegexp:!1};Bt.Static,St.Everyone;const c7={initialDelay:Ht*2,backoffFactor:1.5,maxDelay:Ht*3,healthCheckEndpoint:o7.url};var l7=Object.defineProperty,p7=Object.getOwnPropertyDescriptor,u7=(i,e,t,s)=>{for(var a=s>1?void 0:s?p7(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&l7(e,t,a),a};class $D{constructor(e,t,s){this._store=e,this._httpClient=t,this._config={...c7,...s}}async registerCacheDefinitions(){const e=[{url:this._config.healthCheckEndpoint,cachingStrategy:Bt.NetworkOnly,scope:St.Everyone}];await this._store.dispatchIntent(new In(e))}async checkConnection(){await this.pollForOnline()}stopPolling(){this._timeoutReference&&(window.clearTimeout(this._timeoutReference),this._timeoutReference=void 0),this._store.dispatchIntent(new Po(ua.NotInitialized))}async pollForOnline(e=this._config.initialDelay){this._timeoutReference&&(window.clearTimeout(this._timeoutReference),this._timeoutReference=void 0);const t=await this.ping(this._config.healthCheckEndpoint),s=this.calculateNewDelay(t?this._config.initialDelay:e,this._config.backoffFactor,this._config.maxDelay);this._timeoutReference=window.setTimeout(()=>{this.pollForOnline(s)},s),t?await this._store.dispatchIntent(new Po(ua.Success)):await this._store.dispatchIntent(new Po(ua.Failed))}calculateNewDelay(e,t,s){const a=t*e;return a>s?s:a}async ping(e){try{return await this._httpClient.getRaw(e),!0}catch(t){return!1}}}u7([_()],$D.prototype,"pollForOnline",1);class BD extends d("[Shell] Set Last Played Game As Host Game"){}class zo extends d("[Shell] Load Game data"){constructor(e){super(),this.spaceId=e}}class HD extends d("[Shell] Navigate To Default Micro App"){}class QD extends d("[Shell] Get initial apps"){}class Ko extends d("[Shell] Blur micro app"){constructor(e){super(),this.shellMicroAppConfig=e}}class Mn extends d("[Shell] Blur Currently Focused Micro Application"){}class jD extends d("[Shell] Focus micro app"){constructor(e){super(),this.shellMicroAppConfig=e}}class bl extends d("[Shell] Activate Micro App"){constructor(e,t,s=ci.forwards,a=!0){super(),this.microAppConfig=e,this.navigationContext=t,this.direction=s,this.showGenericErrorOrThrow=a}}class qD extends d("[Shell] Show Deactivate Confirmation Dialog"){constructor(e){super(),this.reason=e}}class tn extends d("[Shell] Ensure Micro App Configurations Are Loaded"){constructor(e,t){super(),this.gameSpaceId=e,this.gameApplicationId=t}}class Vr extends d("[Shell] Deactivate  micro app"){constructor(e,t,s){super(),this.shouldSaveStateToNavigationHistory=e,this.microApp=t,this.deactivateRequest=s}}class sn extends d("[Shell] Deactivate all micro apps"){constructor(e=!1){super(),this.shouldSaveStateToNavigationHistory=e}}class No extends d("[Shell] Unmount all micro apps"){}class zD extends d("[Shell] Load Authentication Micro App"){constructor(e,t){super(),this.authData=e,this.additionalData=t}}class KD extends d("[Shell] Scroll active micro app content"){constructor(e,t){super(),this.placement=e,this.options=t}}class XD extends d("[Shell] Check if app is available"){constructor(e,t){super(),this.microAppConfig=e,this.navigationContext=t}}class Xo extends d("[Shell] Set non available micro-apps"){constructor(e){super(),this.nonAvailableMicroApps=e}}class Xe extends d("[Shell] Get legacy parent app name"){constructor(e,t){super(),this.microAppName=e,this.game=t}}class JD extends d("[Shell] Enable focus-system single instance for micro-app "){constructor(e){super(),this.appName=e}}class mg extends d("[Shell] Verify Available MicroApps Intent"){}class fg extends d("[Shell] Cache Auth App Config"){}class yg extends d("[Shell App] Save To Navigation History"){constructor(e,t){super(),this.appConfig=e,this.navigationContext=t}}class Jo extends d("[Shell App] Clear Navigation History"){}class YD extends d("[Shell App] Push To Navigation History State"){constructor(e,t){super(),this.appConfig=e,this.navigationContext=t}}class ZD extends d("[Shell App] Push To Navigation History Queue State"){constructor(e,t){super(),this.appConfig=e,this.navigationContext=t}}class vg extends d("[Shell App] Push Navigation History Queue To Stack State"){}class eO extends d("[Shell App] Replace Current Navigation History State"){constructor(e,t){super(),this.appConfig=e,this.navigationContext=t}}class tO extends d("[Shell App] Clear Specific Placement Navigation History State"){constructor(e){super(),this.placement=e}}class gs extends d("[Shell] Navigate Back"){constructor(e){super(),this.placement=e}}class nu extends d("[Shell] Try Navigate Back"){}class Ai extends d("[Shell] Navigate to login page"){constructor(e,t){super(),this.authData=e,this.additionalData=t}}class iO extends d("[Shell] Is navigate back available"){constructor(e){super(),this.placement=e}}class $r extends d("[Shell] Close Micro App Modal"){constructor(e){super(),this.closeReason=e}}class sO extends d("[Shell] Open External Link"){constructor(e){super(),this.data=e}}var J=(i=>(i.AppAuthentication="upn-login-form",i.AppAuth="auth",i.AppChat="app-chat",i.AppGamePage="app-game-page",i.AppGamerProfile="gamer-profile",i.AppNotifications="app-notifications",i.Challenges="challenges",i.FriendsList="friends-list",i.IngameStore="app-ingame-store",i.KeyActivation="app-key-activation",i.LiveFeed="live-feed",i.Rewards="rewards",i.StatsMicroApp="stats-microapp",i.UbisoftPlusApp="ubisoftplus-app",i.WeeklyChallenges="weekly-challenges",i.WebBrowser="app-web-browser",i.SharePlay="share-play",i.RemotePlay="remote-play",i.Store="store-app",i.Homepage="app-home-page",i.Social="social",i.Library="app-library",i.ProductDetails="app-product-details",i.DownloadManager="game-dl-mgr",i.MiniDownloader="mini-dl-app",i.Promotab="promotab",i))(J||{});function aO(i){return Br(i)?!0:i.isStandalone?!1:!i.hostSpaceId}function d7(i){return i.mobileCompanionAppType===Bi.LegacyCompanionApp?!0:aO(i)}function h7(i){return e=>i!==ve.Full}function g7(i,e){return i.ticket.length>0||i.token.length>0}function m7(i,e){return i.ticket.length>0&&e.profileId.length>0}function f7(i){return()=>{const{isOnline:e}=i.getReadonlyState(S);return e}}function Br(i){const e=i.microApp.toLowerCase();return e===J.AppAuth||e===J.AppAuthentication}function y7(i){if(Br(i)&&i.microAppParams&&Object.values(i.microAppParams).length>0)return i.microAppParams}const dr={session:{ticket:""},errorData:void 0,user:void 0},v7={shouldCloseOverlay:aO,defaultAuthenticationData:dr,shouldLoginWithCredentials:g7};function _g(i){return i.profileId.length===0?i.ticket.length>0&&[ve.Default,ve.LateSignOn].includes(i.authFlow)?ve.LateSignOn:ve.LoginOnly:ve.Full}class ru extends d("[Shell] Redirect to third party authentication page"){constructor(e,t,s,a){super(),this.url=e,this.data=t,this.callbackParameterName=s,this.multipleParametersNames=a}}class nO extends d("[Shell] Set first party authentication token"){constructor(e,t){super(),this.token=e,this.platformType=t}}class rO extends d("[Shell] Set authentication error"){constructor(e,t){super(),this.errorMessage=e,this.errorContext=t}}class oO extends d("[Shell] Get authentication api intent"){}class cO extends d("[Shell] verify user credentials"){constructor(e,t,s){super(),this.email=e,this.password=t,this.profileId=s}}class lO extends d("[Shell] Get connect platform auth token intent"){}var ge=(i=>(i.TicketRefreshFailed="Ticket Refresh Failed",i.UnexpectedError="Unexpected error when authenticating with ticket",i.UbiservicesError="Ubiservices returned an error when authenticating with provided ticket",i.MissingTicket="Missing required ticket when authenticating",i.Timeout="Authentication timeout",i.MalformedJsonResponse="Expected json in response",i.ClientAuthError="Client is unable to authenticate with session passed by Shell",i.OfflineProfileMissMatch="Offline profile id does not match that in last session",i.NetworkError="Failed to fetch",i.ValidateLoginSessionError="Error when validating login session",i))(ge||{});function To(i=!1){return{code:i?g.Jellyfish_001:g.Dolphin_18,message:"Unexpected authentication error"}}function _7(i,e=!1){const t=S7.get(JSON.stringify(i));return t!=null?t:To(e)}const S7=new Map([['{"httpCode":400,"errorCode":1}',{code:g.Dolphin_1,message:"Could not find Ubi-AppId in request header"}],['{"httpCode":400,"errorCode":2}',{code:g.Dolphin_2,message:"A parameter is invalid"}],['{"httpCode":400,"errorCode":1314}',{code:g.Dolphin_3,message:"Roaming profile id not found"}],['{"httpCode":401,"errorCode":2}',{code:g.Dolphin_30,message:"An unsupported credential type was received"}],['{"httpCode":401,"errorCode":3}',{code:g.Jellyfish_005,message:"The request requires user authentication during startup. The authorization header is either absent, invalid or expired"}],['{"httpCode":401,"errorCode":3,"isRefresh":true}',{code:g.Dolphin_5,message:"The request requires user authentication during session refresh. The authorization header is either absent, invalid or expired"}],['{"httpCode":401,"errorCode":1208}',{code:g.Dolphin_26,message:"Session renew is forbidden because the profile has been unlinked"}],['{"httpCode":401,"errorCode":1214}',{code:g.Dolphin_6,message:"The user is required to change his password before login in (account flagged with suspicious activity)"}],['{"httpCode":401,"errorCode":1216}',{code:g.Dolphin_7,message:"The user account is locked"}],['{"httpCode":401,"errorCode":1218}',{code:g.Dolphin_8,message:"The user account is pending deactivated"}],['{"httpCode":401,"errorCode":1220}',{code:g.Dolphin_9,message:"The user account is minor and marked pending deactivated"}],['{"httpCode":401,"errorCode":1315}',{code:g.Dolphin_10,message:"Roaming profile already added to another user"}],['{"httpCode":401,"errorCode":1316}',{code:g.Dolphin_11,message:"Roaming profile is not added to any user"}],['{"httpCode":403,"errorCode":4003}',{code:g.Dolphin_12,message:"The origin supplied is not allowed to access this service"}],['{"httpCode":429,"errorCode":3333}',{code:g.Dolphin_13,message:"The resource is over used. The request have been throttled"}],['{"httpCode":429,"errorCode":1100}',{code:g.Dolphin_13,message:"The resource is over used. The request have been throttled"}],['{"httpCode":500,"errorCode":100}',{code:g.Dolphin_14,message:"Internal Server Error"}],['{"httpCode":500,"errorCode":8888}',{code:g.Dolphin_15,message:"The Gateway encountered an unexpected error while communicating with backend service"}],['{"httpCode":504,"errorCode":6}',{code:g.Dolphin_16,message:"Could not fulfil request: Third party server not responding"}],['{"httpCode":504,"errorCode":5004}',{code:g.Dolphin_17,message:"The Gateway encountered a timeout while communicating with backend service"}]]);async function Yo(i,e,t,s){try{if(i instanceof Error&&i.name==="SyntaxError"){const n={code:g.Dolphin_27,message:ge.MalformedJsonResponse};return{errorType:ge.UbiservicesError,errorDetails:{parameters:e,logCategory:f.authentication,errorCode:n.code,error:i,message:n.message},error:n}}if(Td(i)){const n={code:g.FailedFetchAuthenticationError,message:ge.NetworkError};return{errorType:ge.UbiservicesError,errorDetails:{parameters:e,logCategory:f.authentication,errorCode:n.code,error:i,message:n.message},error:n}}if(i instanceof iS){const n=await i.response.json(),r="errorCode"in n?n.errorCode:-1,l={httpCode:"httpCode"in n?n.httpCode:-1,errorCode:r};s&&(l.isRefresh=s);const u=_7(l,t);return{errorType:ge.UbiservicesError,errorDetails:{parameters:e,logCategory:f.authentication,errorCode:u.code,error:i,message:n},error:u}}if(s)return{errorType:ge.TicketRefreshFailed,errorDetails:{parameters:e,logCategory:f.authentication,errorCode:g.TicketRefreshFailedError,error:i},error:To(t)};const a=To(t);return{errorType:ge.UnexpectedError,errorDetails:{parameters:e,logCategory:f.authentication,errorCode:a.code,message:a.message,error:i},error:a}}catch(a){const n=To(t);return{errorType:ge.MalformedJsonResponse,errorDetails:{parameters:e,error:a,logCategory:f.authentication,errorCode:n.code,message:n.message},error:n}}}class Hr{constructor(e,t,s,a,n){this._logger=e,this._runtimeParameters=t,this._appId=s,this._authenticationService=a,this._store=n,this.authenticationTimeoutInMs=30*1e3,this._authData={session:{ticket:""},errorData:void 0,user:void 0},this.isMicroAppAuth&&this._runtimeParameters.microAppParams&&Object.values(this._runtimeParameters.microAppParams).length>0&&(this._authAdditionalParameters=this._runtimeParameters.microAppParams)}async getAuthApi(){const e=await this._store.dispatchIntent(new oO);if(e===void 0)throw new Error("Could not retrieve the authentication api!");return e}async processAuthentication(){try{this._authData=await q(this.authenticationTimeoutInMs,this.authenticate())}catch(e){return this._logger.error(ge.Timeout,{error:e,logCategory:f.authentication,errorCode:g.Dolphin_19}),await this._store.dispatchIntent(new Re(!1)),this.handleAuthenticationFailure()}return this._logger.debug("".concat(this._authData.user?"":"Empty ","Authentication result ").concat(this._authData.user?"for ".concat(this._authData.user):""),{authData:this._authData,logCategory:f.authentication}),this._authData.session.sessionId&&!this._authData.errorData&&!this._authAdditionalParameters?new at(this._authData.session):(this._logger.debug("User is not authenticated",{logCategory:f.authentication}),this.handleAuthenticationFailure(this._authData,this._authAdditionalParameters))}handleAuthenticationFailure(e,t){return new Ai(e,t)}shouldCloseOverlay(){return this.isMicroAppAuth}get isMicroAppAuth(){const e=this._runtimeParameters.microApp.toLowerCase();return e===J.AppAuth||e===J.AppAuthentication}async doPostAuthenticationActions(e){}async setAuthenticationError(e,t){}async validateLoginSession(e,t,s){return!!e}async handleSessionCloseExpiration(e){this._authenticationError=void 0;try{const t=await this._authenticationService.v3.renewSession(e);this._store.dispatchIntent(new at(t));return}catch(t){return await this.handleUbiservicesErrorRsp(t,!0),this._authenticationError}}async refreshSession(e,t){if(e)try{const s=await this._authenticationService.v3.renewTicket(t||e.ticket,e.sessionId,!!e.rememberMeTicket);await this._store.dispatchIntent(new at(s))}catch(s){await this.handleUbiservicesErrorRsp(s,!0)}}async ubiTicketRefreshRequest(){}async handleUbiservicesErrorRsp(e,t,s=!0){const a=this._store.getReadonlyState(Q).initializationCompleted,n=await Yo(e,this._runtimeParameters,a,t);return this._authenticationError=n.error,s&&this._logger.error(n.errorType,n.errorDetails),this._authenticationError}}class an extends Hr{constructor(e,t,s,a,n,r){super(e,t,s,a,n),this._v2Strategy=r}get name(){return this._v2Strategy.name}processAuthentication(){return this._v2Strategy.processAuthentication()}shouldCloseOverlay(){return this._v2Strategy.shouldCloseOverlay()}async handleSessionCloseExpiration(e){}async doPostAuthenticationActions(e){}isApplicable(){return!1}authenticate(){throw new Error("Method not implemented.")}getAuthApi(){throw new Error("Method not implemented.")}handleAuthenticationFailure(e,t){return{}}get isMicroAppAuth(){return Br(this._runtimeParameters)}async setAuthenticationError(e,t){}async validateLoginSession(e,t,s){return!0}async refreshSession(e,t){}async ubiTicketRefreshRequest(){}async handleUbiservicesErrorRsp(e,t,s){}}const w7="abda351c-f251-4a70-8fb1-32bd42089262",b7="2d375d5a-dd3f-48d2-9c6a-21423e40f2c2",C7="45d58365-547f-4b45-ab5b-53ed14cc79ed",I7="77560d22-668e-40ad-a445-69ae77826b40",M7="P.CONNECTVIEW.SHELLRECOVERY",A7="P.CONNECTVIEW.CLIENTMESSAGE",P7=2;class pO extends d("[Shell] Set Tokenized Credentials"){constructor(e){super(),this.session=e}}class Sg extends d("[Shell] Set Authentication Error Info"){constructor(e){super(),this.errorInfo=e}}class Be extends d("[Shell API] Navigate To Micro App"){constructor(e,t){super(),this.navigationContext=e,this.options=t}}class uO extends d("[Shell API] Navigate Parent window To Micro App"){constructor(e){super(),this.navigationContext=e}}class ms extends d("[Shell API] Request available micro apps"){constructor(e){super(),this.game=e}}class dO extends d("[Shell API] Get available micro apps"){constructor(e){super(),this.options=e}}class Ci extends d("[Shell API] Request is micro app available"){constructor(e,t,s){super(),this.appName=e,this.game=t,this.parentAppName=s}}class hO extends d("[Shell API] Release Focus"){constructor(e,t){super(),this.appConfig=e,this.direction=t}}class gO extends d("[Shell API] Report Fatal Error"){constructor(e,t){super(),this.appConfig=e,this.error=t}}class mO extends d("[Shell API] Report Shell Fatal Error"){constructor(e){super(),this.appConfig=e}}class fO extends d("[Shell Plugin] Report Fatal Plugin Error"){constructor(e,t){super(),this.pluginConfig=e,this.error=t}}class yO extends d("[Shell] Get ubi services wrapper"){constructor(e){super(),this.appConfig=e}}class wg extends d("[Shell] Get ubi services wrapper by app id"){constructor(e){super(),this.applicationId=e}}class vO extends d("[Shell] Get connect services"){}class _O extends d("[Shell] Send dna event"){constructor(e,t,s){super(),this.applicationConfig=e,this.eventName=t,this.eventData=s}}class hr extends d("[Shell] Send Shell dna event"){constructor(e,t){super(),this.eventName=e,this.eventData=t}}class SO extends d("[Shell] Send Adobe Tracking event"){constructor(e,t){super(),this.eventName=e,this.eventData=t}}class wO extends d("[Shell API] Get cache"){constructor(e,t,s){super(),this.spaceId=e,this.cacheType=t,this.shared=s}}class bO extends d("[Shell] Get image data"){constructor(e){super(),this.imageType=e}}class CO extends d("[Shell] Get api"){constructor(e,t,s){super(),this.appName=e,this.spaceId=t,this.applicationId=s}}class Ii extends oe("ConfigurationState"){constructor(){super(...arguments),this._serviceUrls=null,this._lastUpdate=null,this._legacyClientParameters=null}get serviceUrls(){var e;return(e=this._serviceUrls)!=null?e:void 0}set serviceUrls(e){this._serviceUrls=e}get remoteLogs(){return this._remoteLogs}set remoteLogs(e){this._remoteLogs=e}get lastUpdate(){var e;return(e=this._lastUpdate)!=null?e:void 0}set lastUpdate(e){this._lastUpdate=e!=null?e:null}get legacyClientParameters(){var e;return(e=this._legacyClientParameters)!=null?e:void 0}set legacyClientParameters(e){this._legacyClientParameters=e!=null?e:null}}class qa extends Error{constructor(e,t){super(e),this.errorCode=t}}class IO extends d("[Shell] Load Game Entitlements"){}class ji extends d("[Shell] Set Shell Error"){constructor(e,t){super(),this.error=e,this.placement=t}}class za extends d("[Shell] Clear All Shell Placement Error"){}class MO extends d("[Shell] Clear Shell Placement Error"){constructor(e){super(),this.placement=e}}class ou extends d("[Shell] Set Recovery State Intent"){constructor(e){super(),this.options=e}}class AO extends d("[Shell] Load Interactions"){constructor(e){super(),this.userId=e}}class N7 extends d("[Shell] Register Interaction"){constructor(e,t){super(),this.key=e,this.value=t}}class T7 extends d("[Shell] Clear Interaction"){constructor(e){super(),this.key=e}}class R7 extends d("[Shell] Clear All Interactions"){}var D7=Object.defineProperty,O7=Object.getOwnPropertyDescriptor,Ct=(i,e,t,s)=>{for(var a=s>1?void 0:s?O7(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&D7(e,t,a),a};function zn(i,e){return i&&e?ba(i.applicationData,e.applicationData)&&i.appName===e.appName:i===e}class Y extends oe("[Shell] Navigation History"){constructor(){super(...arguments),this._useExclusiveStack=!1,this._defaultStack=Rs({stack:[],current:void 0}),this._exclusiveStack=Rs({stack:[],current:void 0}),this._historyQueueStack=[],this._preservedDefaultStack=null}get useExclusiveStack(){return this._useExclusiveStack}set useExclusiveStack(e){this._useExclusiveStack=e}get stackMap(){return this._useExclusiveStack?this._exclusiveStack:this._defaultStack}get stacks(){return Object.values(this.stackMap).map(e=>e.stack)}preserveDefaultStack(){this._preservedDefaultStack={...this._defaultStack}}clearPreservedDefaultStack(){this._preservedDefaultStack=null}restoreDefaultStack(){this._preservedDefaultStack&&(this._defaultStack=this._preservedDefaultStack,this.clearPreservedDefaultStack())}addToStack(e){const{value:t,placement:s}=e;zn(t,this.getLastItem(s))||this.stackMap[s].stack.push(t)}get hasItems(){return e=>this.stackMap[e].stack.length>0}get currentItem(){return e=>this.stackMap[e].current}getLastItem(e){const t=this.stackMap[e].stack;return t[t.length-1]}removeLastItem(e){const t=this.stackMap[e];t.current=t.stack.pop()}clearHistory(){this._defaultStack=Rs({stack:[],current:void 0}),this._exclusiveStack=Rs({stack:[],current:void 0})}clearExclusiveHistory(){this._exclusiveStack=Rs({stack:[],current:void 0})}clearPlacementHistory(e){this.stackMap[e]={current:void 0,stack:[]}}pushItem(e){const{value:t,placement:s}=e,a=this.stackMap[s],n=a.current;a.current=t,n&&(zn(a.current,n)||this.addToStack({placement:s,value:n}))}replaceCurrentItem(e){var n;const{value:t,placement:s}=e,a=this.stackMap[s];((n=a.current)==null?void 0:n.appName)===t.appName&&(zn(t,this.getLastItem(s))&&this.removeLastItem(s),a.current=t)}onMicroAppActivation(e){const{value:t,placement:s}=e,a=this.stackMap[s],n=a.current;a.current=t,a.current.isActivation=!0,n&&(n.appName!==a.current.appName||!zn(a.current,n))&&this.addToStack({placement:s,value:n})}onMicroAppBackActivation(e){const{value:t,placement:s}=e,a=this.stackMap[s];a.current=t}saveAllHistory(){Object.values(this.stackMap).forEach(e=>{e.current&&(e.stack.push(e.current),e.current=void 0)})}pushItemToHistoryQueue(e){this._historyQueueStack.push(e)}pushHistoryQueueToStack(){this._historyQueueStack.forEach(e=>{this.pushItem(e)}),this._historyQueueStack=[]}}Ct([P],Y.prototype,"preserveDefaultStack",1);Ct([P],Y.prototype,"clearPreservedDefaultStack",1);Ct([P],Y.prototype,"restoreDefaultStack",1);Ct([P],Y.prototype,"addToStack",1);Ct([P],Y.prototype,"removeLastItem",1);Ct([P],Y.prototype,"clearHistory",1);Ct([P],Y.prototype,"clearExclusiveHistory",1);Ct([P],Y.prototype,"clearPlacementHistory",1);Ct([P],Y.prototype,"pushItem",1);Ct([P],Y.prototype,"replaceCurrentItem",1);Ct([P],Y.prototype,"onMicroAppActivation",1);Ct([P],Y.prototype,"onMicroAppBackActivation",1);Ct([P],Y.prototype,"saveAllHistory",1);Ct([P],Y.prototype,"pushItemToHistoryQueue",1);Ct([P],Y.prototype,"pushHistoryQueueToStack",1);var F7=Object.defineProperty,L7=Object.getOwnPropertyDescriptor,Cl=(i,e,t,s)=>{for(var a=s>1?void 0:s?L7(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&F7(e,t,a),a};class Ft extends oe("PcClientNotificationState"){constructor(){super(...arguments),this._notifications=[]}get notifications(){return this._notifications}get notificationsEnabledSettings(){return this._notificationsEnabledSettings}set notificationsEnabledSettings(e){this._notificationsEnabledSettings=e}pushNotification(e){this._notifications.findIndex(s=>s.id===e.id)<0&&this._notifications.push(e)}dismissNotification(e){const t=this._notifications.findIndex(s=>s.id===e);t>=0&&this._notifications.splice(t,1)}updateNotification(e){const t=this._notifications.findIndex(s=>s.id===e.id);t>=0&&(this._notifications[t].state=e.state)}clearNotifications(e){e?this._notifications=this._notifications.filter(t=>!e.includes(t.type)):this._notifications=[]}}Cl([P],Ft.prototype,"pushNotification",1);Cl([P],Ft.prototype,"dismissNotification",1);Cl([P],Ft.prototype,"updateNotification",1);Cl([P],Ft.prototype,"clearNotifications",1);var G7=Object.defineProperty,x7=Object.getOwnPropertyDescriptor,E7=(i,e,t,s)=>{for(var a=s>1?void 0:s?x7(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&G7(e,t,a),a};const PO="US_NOTIFICATION_MAINTENANCE",NO="US_CONCURRENT_CONNECT_DETECTED",cf="AVATARS_AVATAR_UPDATED",lf="wallet-balance-update";class da extends oe("PlayerNotificationState"){constructor(){super(...arguments),this._baseNotificationTypes=[PO,NO],this._subscriberIdToPlayerNotificationConfigMap={},this._callbackToActualCallbackMap=new Map}getConfigForSubscriber(e){return this._subscriberIdToPlayerNotificationConfigMap[e]}get baseNotificationTypes(){return this._baseNotificationTypes}get spaceIndependentNotificationTypes(){return[...new Set(Object.values(this._subscriberIdToPlayerNotificationConfigMap).flatMap(e=>{var t;return(t=e==null?void 0:e.spaceIndependentNotificationTypes)!=null?t:[]}))]}get spaceDependentNotificationTypes(){let e=[...new Set(Object.values(this._subscriberIdToPlayerNotificationConfigMap).flatMap(t=>{var s;return(s=t==null?void 0:t.notificationTypes)!=null?s:[]}))];return e=e.filter(t=>!this.spaceIndependentNotificationTypes.includes(t)),this.baseNotificationTypes.concat(e)}get spaceIds(){return[...new Set(Object.values(this._subscriberIdToPlayerNotificationConfigMap).flatMap(t=>{var s;return(s=t==null?void 0:t.spaceIds)!=null?s:[]}))]}addConfigForSubscriber(e){this._subscriberIdToPlayerNotificationConfigMap[e.subscriberId]=e.config}get callbackToActualCallbackMap(){return this._callbackToActualCallbackMap}}E7([P],da.prototype,"addConfigForSubscriber",1);class TO extends d("[OverlayUser] LoadUserActivity"){}class bg extends d("[OverlayUser] UpdateUserActivity"){constructor(e){super(),this.newActivityStatus=e}}class RO extends d("[OverlayUser] ObserveUserSubscriptionStatusIntent"){}class DO extends d("[OverlayUser] UnobserveUserSubscriptionStatusIntent"){}class cu extends d("[OverlayUser] UpdateUserWallet"){}class OO extends d("[OverlayUser] LoadUserLevel"){}class lu extends d("[OverlayUser] LoadUserAvatar"){}var U7=Object.defineProperty,k7=Object.getOwnPropertyDescriptor,Ve=(i,e,t,s)=>{for(var a=s>1?void 0:s?k7(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&U7(e,t,a),a};class xe extends z{constructor(e,t,s,a,n,r,o,l,u,v,w,b){super(),this._logger=e,this._rxService=t,this._remoteLotsQueueInitializer=s,this._trackingService=a,this._authenticationStrategy=n,this._documentLifecycleListenerService=r,this._kinderGarden=o,this._ipLocationService=l,this._performanceMeter=u,this._lifeGuardService=v,this._shellConfig=w,this._featureHandlerService=b,this._shellStartDate=null,this._navigateToLoginAction=null,this._logger=this._logger.createChild("RuntimeContext.reducer"),this._logger.settings.logCategory=f.shell}async subscribe(e,t){this._rxService.subscribe(t.observer)}async unsubscribe(e,t){this._rxService.unsubscribe(t.observers)}isValidSession(e){return!!e&&!!e.ticket&&!!e.sessionId&&!!e.profileId}async updateUserSession(e,t){var n,r,o,l;if(!this.isValidSession(t.session))return this._logger.warn("Session update is invalid",{session:t.session,logCategory:f.authentication,errorCode:g.InvalidSessionUpdateWarning}),this._performanceMeter.mark.invalidSession(),this.logoutUser(e);this._logger.info("Updating user session",{logCategory:f.authentication}),await this.dispatch(e,new nr(t.session.clientIpCountry));const s=this.getMutableState(e,S),a=s.playerSession;if(!a){await this.dispatch(e,new Re(!0));const u=await this.validateLoginSession(e,t.session,t.password,t.email);if(await this.dispatch(e,new Re(!1)),!u){this._logger.warn("Session won't be updated because the authentication of sessionId ".concat((n=t.session)==null?void 0:n.sessionId," failed."),{sessionId:(r=t.session)==null?void 0:r.sessionId,logCategory:f.authentication,errorCode:g.Dolphin_28});return}}if(s.setPlayerSession(t.session),this._rxService.notifyRuntimeContextUpdate(s.runtimeContext,!0),this.dispatch(e,new qo(t.session.sessionId,t.session.profileId)),!a||a.sessionId!==t.session.sessionId||a.expiration!==t.session.expiration){this._logger.debug("Session change from ".concat(a==null?void 0:a.sessionId," to ").concat(t.session.sessionId),{sessionId:(o=t.session)==null?void 0:o.sessionId,oldSessionId:a==null?void 0:a.sessionId,logCategory:f.authentication});const v=!t.session.rememberMeTicket&&((l=window.upn)==null?void 0:l.enableAuthAppPc)?Ht:void 0;await this.dispatch(e,new PD(v)),this._remoteLotsQueueInitializer.updateSession(t.session)}if(await this.dispatch(e,new Dd(t.session)),!a){await this.loginUser(e,t.session);return}if((a==null?void 0:a.profileId)!==t.session.profileId)return this.switchUser(e,t.session)}async validateLoginSession(e,t,s,a){return this._authenticationStrategy instanceof an?this.dispatch(e,new DD(t,s,a)):this._authenticationStrategy.validateLoginSession(t,s,a)}async updateOfflineSession(e,t){var n,r;if(!this.isValidSession(t.session))return this._logger.warn("Offline session is invalid",{session:t.session,logCategory:f.authentication,errorCode:g.InvalidSessionUpdateWarning}),this._performanceMeter.mark.invalidSession(),this.logoutUser(e);await this.dispatch(e,new YR(!0)),await this.dispatch(e,new WD(!0)),await this.dispatch(e,new nr(t.session.clientIpCountry)),this._logger.info("Updating offline session",{logCategory:f.authentication}),await this.dispatch(e,new Re(!0));const s=await this.validateLoginSession(e,t.session,t.password,t.email);if(await this.dispatch(e,new Re(!1)),!s){this._logger.warn("Session won't be updated because the authentication of sessionId ".concat((n=t.session)==null?void 0:n.sessionId," failed."),{sessionId:(r=t.session)==null?void 0:r.sessionId,logCategory:f.authentication,errorCode:g.Dolphin_28});return}const a=this.getMutableState(e,S);a.setPlayerSession(t.session),this._rxService.notifyRuntimeContextUpdate(a.runtimeContext,!0),this.dispatch(e,new qo(t.session.sessionId,t.session.profileId)),this.loginUser(e,t.session)}async loginUser(e,t){const s=this.getMutableState(e,S);s.initialSessionSet=!0;const a=this.getMutableState(e,Q);a.isAccountLinkingInProgress=!1,await this.dispatch(e,new Qi);const n=s.isOnMobile,r=s.isExclusiveMode;if(await this.dispatch(e,new rg(!n&&!r)),this._performanceMeter.startMeasurement(_i.deactiveUnmountAllMicroApps,{private:!1}),await this.dispatch(e,new sn),await this.dispatch(e,new No),this._performanceMeter.endMeasurement(_i.deactiveUnmountAllMicroApps,{private:!1}),await this.doPostAuthenticationActions(e,t),this._featureHandlerService.handleFeature(c.LoginResult,{loginData:t}),this._authenticationStrategy.shouldCloseOverlay())await this.dispatch(e,new Gt(_e.Auth));else try{await this.initializeShell(e,t)}catch(l){this._logger.error("Failed to initialize shell",{error:l,errorCode:g.RuntimeContextShellInitError}),await q(Ls,this._logger.flushAllTransports()).catch(console.error).finally(()=>window.showError(l))}finally{s.setReadyToAcceptNavigationRequest()}this._performanceMeter.mark.userLoggedIn()}async doPostAuthenticationActions(e,t){const s=this.getReadOnlyState(e,S);if([p.Android,p.IOS,p.Mobile,p.MacOS].includes(s.hostPlatformType))return this.dispatch(e,new pO(t))}async logoutUser(e){var r;const t=this.getMutableState(e,S);this._logger.info("Logout started for session:".concat((r=t.playerSession)==null?void 0:r.sessionId),{logCategory:f.authentication}),this._kinderGarden.closeAllChildWindows(),await Promise.all([this.dispatch(e,new ND),this.dispatch(e,new jo),this.dispatch(e,new No),this.unobserveUserSubscriptionStatus(e)]),await this.dispatch(e,new Jo);try{await q(Ls,Promise.all([this._trackingService.flush(),this._logger.flushAllTransports()]))}catch(o){this._logger.warn("Fail to flush logging and tracking data within ".concat(Ls,"ms on logout"),{errorCode:g.FailedFlushLogTrackingOnLogoutWarning})}t.initialSessionSet=!1,t.setPlayerSession(void 0),this.getMutableState(e,Ft).clearNotifications(),this.getMutableState(e,M).wipeConfigData(),await this.dispatch(e,new za);const n=this._authenticationStrategy instanceof an?this.getAuthenticationFailureHandler(e,dr):this._authenticationStrategy.handleAuthenticationFailure(dr);await this.dispatch(e,n),this._remoteLotsQueueInitializer.updateSession(void 0)}getAuthenticationFailureHandler(e,t){this._logger.warn("User authentication was unsuccessful",{authData:t,logCategory:f.authentication,errorCode:g.FailedUserAuthenticationWarning});const{hostPlatformType:s}=this.getReadOnlyState(e,S);return[p.PCLegacyClient,p.PCLegacyOverlay,p.PCElectronOverlay,p.Luna,p.SteamOverlay,p.SteamClient].includes(s)?new Qt({message:"error.generic",errorCode:g.FailedUserAuthenticationWarning}):new Ai(t)}async switchUser(e,t){await this.unobserveUserSubscriptionStatus(e),await this.dispatch(e,new No),await this.dispatch(e,new jo),await this.initializeShell(e,t)}async initializeShell(e,t){var r;const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,Ii);if(this.dispatch(e,new AO((r=s.playerSession)==null?void 0:r.userId)),await this.dispatch(e,new Qi),s.isUWP&&!s.isHostGameSet()){try{await this.dispatch(e,new BD)}catch(o){this._logger.warn("Failed to fetch last played game data",{errorCode:g.FailedFetchLastPlayedDataWarning})}if(!s.isHostGameSet()){this._logger.error("Failed to set a host game based on last played games",{errorCode:g.RuntimeContextSetHostGameFromLastPlayedError}),await this.dispatch(e,new ji({message:"message.noGameInStandalone"}));return}}Promise.all([this.dispatch(e,new OO),this.dispatch(e,new lu),this.dispatch(e,new zo(s.hostGame.spaceId))]).then(()=>{this._performanceMeter.mark.userGameDataLoaded()}).catch(o=>{this._logger.warn("Failed to load Game Icon or User Level or Avatar during initialization",{error:o,errorCode:g.FailedLoadGameIconOrUserLevelOrAvatarWarning})});try{await this.dispatch(e,new KR),await this.initializeLoggingAndTracking(t,s,a),await Promise.all([this.dispatch(e,new Ed),this.dispatch(e,new Jo)])}catch(o){if(o instanceof qa)throw o;this._logger.warn("Failed to fetch shell space configuration, or to clear navigation history",{logCategory:f.shell,error:o,errorCode:g.FailedFetchShellSpaceConfigurationWarning})}this._performanceMeter.mark.spaceParamsConfigLoaded();try{await Promise.all([this.dispatch(e,new HD).finally(()=>{this.getMutableState(e,M).hasNavigatedToDefaultMicroApps=!0}),this.dispatch(e,new yl),this.subscribeToAvatarChangeNotification(e)])}catch(o){this._logger.warn("Failed to navigate to default microapp or open PNOT connection",{logCategory:f.shell,e:o,errorCode:g.FailedNavigateDefaultMicroappOrOpenPNOTConnectionWarning})}if(this._performanceMeter.mark.playerNotificationsInitialized(),s.isDesktopApp){try{await Promise.all([this.dispatch(e,new IO),this.dispatch(e,new RO),this.dispatch(e,new cu)])}catch(o){this._logger.warn("Failed to load player entitlements, Ubisoft+ subscription status or wallet status",{logCategory:f.shell,e:o,errorCode:g.FailedLoadPlayerEntitlementsUbisoftPlusStatusOrWalletStatusWarning})}this.subscribeToWalletChangeNotification(e),this._performanceMeter.mark.desktopInitDone()}this._performanceMeter.mark.shellInitializedWithSession();try{await this.dispatch(e,new Ur)}catch(o){this._logger.error("Failed to update API for plugins and micro apps",{logCategory:f.shell,e:o,errorCode:g.FailedToUpdateApi})}const{appsToPreload:n}=this.getReadOnlyState(e,M);this.dispatch(e,new mg),this._lifeGuardService.loadMicroApps(n)}async subscribeToAvatarChangeNotification(e){const t=this.getReadOnlyState(e,S).shellCrossPlatformSpaceId,s="shell-avatar-".concat(t);await this.dispatch(e,new pr(s,{notificationTypes:[cf],spaceIds:[I7]})),this.dispatch(e,new ur(this.avatarNotificationCallback.bind(this,e),s))}async avatarNotificationCallback(e,t){(t==null?void 0:t.notificationType)===cf&&t.content.avatarType==="avatars"&&await this.dispatch(e,new lu)}async subscribeToWalletChangeNotification(e){const t="shell-wallet-".concat(this.getReadOnlyState(e,S).shellCrossPlatformSpaceId);await this.dispatch(e,new pr(t,{notificationTypes:[lf],spaceIds:[C7]})),this.dispatch(e,new ur(async s=>{s.notificationType===lf&&this.dispatch(e,new cu)},t))}async unobserveUserSubscriptionStatus(e){this.getMutableState(e,S).isDesktopApp&&await this.dispatch(e,new DO)}async initializeLoggingAndTracking(e,t,s){const{environment:a}=t,{remoteLogs:n,serviceUrls:r}=s;await this._remoteLotsQueueInitializer.initializeQueueServices(e,a,n,r)}async setActiveGame(e,t){const s=t.game,a=this.getMutableState(e,S);if(!qt.validate(s.spaceId)||!qt.validate(s.applicationId)){this._logger.error("".concat(t==null?void 0:t.caller,": Invalid game passed as active game"),{game:s,logCategory:f.navigation,errorCode:g.InvalidGameParameter});return}if(a.activeGame.spaceId===s.spaceId){this._logger.debug("The game with space id: ".concat(a.activeGame.spaceId," is already active"),{game:s,logCategory:f.shell});return}this._logger.debug("Updating active game from ".concat(a.activeGame.spaceId," to ").concat(s.spaceId),{game:s,logCategory:f.shell}),this.dispatch(e,new zo(s.spaceId)),this.getMutableState(e,M).setMicroAppActiveGame({key:t.config,value:t.game}),a.activeGame=s}async updateOrientation(e,t){const s=this.getMutableState(e,S);s.orientation!==t.orientation&&(s.orientation=t.orientation)}async initCommonEventData(e,t){const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,Ii);t.session&&await this.initializeLoggingAndTracking(t.session,s,a)}async syncContext(e,t){this.getMutableState(e,S).syncState(t.context)}async SetFocusedMicroApp(e,t){var n,r;const s=this.getMutableState(e,S),a=s.focusedMicroApp;((a==null?void 0:a.spaceId)!==((n=t.focusedMicroApp)==null?void 0:n.spaceId)||(a==null?void 0:a.placement)!==((r=t.focusedMicroApp)==null?void 0:r.placement))&&(s.focusedMicroApp=t.focusedMicroApp)}async sendShellStartTrackingEvent(e){this.getMutableState(e,S).isOverlayVisible&&(this._shellStartDate=new Date,this._trackingService.sendEvent("shellStart"),this._documentLifecycleListenerService.addBeforeUnloadListener(this.sendShellQuitEventCallback))}async sendShellQuitTrackingEvent(e,t){this._trackingService.sendEvent("shellQuit",{closeReason:t.closeReason,secondsSinceStart:this.getSecondsSinceStart()}),this._documentLifecycleListenerService.removeBeforeUnloadListener(this.sendShellQuitEventCallback)}async switchToExclusiveModeIntent(e,t){const{navigationContext:s}=t,a=this.getMutableState(e,S),n=this.getMutableState(e,Y);if(a.isExclusiveMode&&n.useExclusiveStack)return this._logger.warn("Application is in exclusive mode already",{errorCode:g.MicroappExclusiveModeAlreadyWarning}),!1;if(![m.PC,m.PS4,m.PS5,m.Scarlett,m.XONE,m.Steam,m.Web].includes(a.platformType)||a.isStandalone)return this._logger.warn("Exclusive mode is not supported for ".concat(a.platformType),{errorCode:g.ExclusiveModeNotSupportedForPlatformWarning}),!1;if(await this.dispatch(e,new sn(!0)),n.saveAllHistory(),a.isExclusiveMode=!0,n.useExclusiveStack=!0,!s)return!0;const r=await this.dispatch(e,new Be(s));return r||await this.dispatch(e,new Ld),r}async exitExclusiveModeIntent(e,t){const s=this.getMutableState(e,S),a=this.getMutableState(e,Y),n=this.getReadOnlyState(e,M);if(!s.isExclusiveMode)return this._logger.warn("Application is not in exclusive mode",{errorCode:g.MicroappNotInExclusiveModeWarning}),!1;await this.dispatch(e,new sn(!0)),a.clearExclusiveHistory(),s.isExclusiveMode=!1,a.useExclusiveStack=!1;let r=!0;return t.shouldReactivateDefaultHistory&&await Promise.all(Es[s.layoutType].map(async o=>{n.getActiveMicroApp(o)||await this.dispatch(e,new gs(o))||(this._logger.error("Not able to exit exclusive mode and reactivate micro app in ".concat(o),{errorCode:g.RuntimeContextExitExclusiveModeError}),await this.dispatch(e,new ji({message:"error.generic"})),r=!1)})),r}sendShellQuitEventCallback(){this._trackingService.sendEvent("shellQuit",{closeReason:_e.Unknown,secondsSinceStart:this.getSecondsSinceStart()}),this._trackingService.flush()}getSecondsSinceStart(){var t;const e=(t=this._shellStartDate)==null?void 0:t.valueOf();return e?Math.round((Date.now()-e)/1e3):0}async setCountryCode(e,t){const s=this.getMutableState(e,S);let a=s.country?s.country:t.country;return a?[m.PC,m.Steam].includes(s.platformType)&&this.getIpLocationCountry():a=await this.getIpLocationCountry(),a?(s.country=a,!0):!1}async getIpLocationCountry(){try{return(await this._ipLocationService.v2.getMyIpLocation()).countryCode}catch(e){this._logger.warn("Fail to get ip location",{error:e,logCategory:f.uncategorized,errorCode:g.FailedGetIpLocationWarning})}}async setOwnershipGroup(e,t){const s=this.getMutableState(e,S);s.ownershipGroup=t.ownershipGroup}async processInitialAuthenticationWithRetry(e){var a;const t=this.getMutableState(e,S);await this.dispatch(e,new Re(!0)),await this.dispatch(e,new za);const s=await this._authenticationStrategy.processAuthentication();return s instanceof Qt?await this.dispatch(e,s):((a=window.upn)!=null&&a.enableAuthAppPc&&s instanceof at&&await this.dispatch(e,new fg),t.initialPostAuthIntentDeferred.resolve(s)),await this.dispatch(e,new Re(!1)),t.initialPostAuthIntentDeferred.promise}async initialLoadMicroAppConfigurationsWithRetry(e){const t=this.getMutableState(e,S);await this.dispatch(e,new Re(!0)),await this.dispatch(e,new za);try{await this.dispatch(e,new tn(t.hostGame.spaceId,t.hostGame.applicationId)),t.initialLoadMicroAppConfigDeferred.resolve()}catch(s){if(s instanceof qa&&s.errorCode===g.FailedFetchMicroAppConfigError)this.dispatch(e,new Qt(s));else throw s}return await this.dispatch(e,new Re(!1)),t.initialLoadMicroAppConfigDeferred.promise}async navigateToLoginWithRetry(e,t){const s=this.getMutableState(e,S);return await this.dispatch(e,new Re(!0)),await this.dispatch(e,new za),t.action&&(this._navigateToLoginAction=t.action),this._navigateToLoginAction&&await this.dispatch(e,this._navigateToLoginAction)&&s.navigateToLoginWithRetryDeferred.resolve(),await this.dispatch(e,new Re(!1)),s.navigateToLoginWithRetryDeferred.promise}}Ve([h(Er)],xe.prototype,"subscribe",1);Ve([h(Rd)],xe.prototype,"unsubscribe",1);Ve([h(at)],xe.prototype,"updateUserSession",1);Ve([h(qc)],xe.prototype,"updateOfflineSession",1);Ve([h(Hp)],xe.prototype,"setActiveGame",1);Ve([h(Qp)],xe.prototype,"updateOrientation",1);Ve([h(Dd)],xe.prototype,"initCommonEventData",1);Ve([h(WS)],xe.prototype,"syncContext",1);Ve([h(jp)],xe.prototype,"SetFocusedMicroApp",1);Ve([h(Od)],xe.prototype,"sendShellStartTrackingEvent",1);Ve([h(ar)],xe.prototype,"sendShellQuitTrackingEvent",1);Ve([h(Fd)],xe.prototype,"switchToExclusiveModeIntent",1);Ve([h(Ld)],xe.prototype,"exitExclusiveModeIntent",1);Ve([_()],xe.prototype,"sendShellQuitEventCallback",1);Ve([h(nr)],xe.prototype,"setCountryCode",1);Ve([h(Gd)],xe.prototype,"setOwnershipGroup",1);Ve([h(xd)],xe.prototype,"processInitialAuthenticationWithRetry",1);Ve([h(Ed)],xe.prototype,"initialLoadMicroAppConfigurationsWithRetry",1);Ve([h(Ud)],xe.prototype,"navigateToLoginWithRetry",1);class W7{static create(e){const t=new xe(e.logger,e.runtimeRxService,e.remoteLogsQueueInitializer,e.trackingService,e.authenticationStrategy,e.documentLifecycleListener,e.kinderGarden,e.ubiServicesService.ubiServices.ipLocationService,e.performanceMeter,e.lifeGuardService,e.shellConfig,e.featureHandlerService),s=new QR(e.logger).calculate(e.runtimeParameters.platformType),a=new ml(e.logger).calculate(e.runtimeParameters.platformType),n=new oa(navigator.onLine);return i7.addListeners(e.store),{reducers:[t,new Wr(e.logger,new $D(e.store,e.httpClientFactory.getUbiHttpClient()))],states:[n,new S(e.runtimeParameters,s,a,e.shellConfig,{connectionStatusState:n})]}}}var ue=(i=>(i.Arabic="ar",i.German="de",i.English="en",i.Spanish="es",i.French="fr",i.Italian="it",i.Japanese="ja",i.Korean="ko",i.Polish="pl",i.Portugese="pt",i.BrazilianPortugese="pt-BR",i.Russian="ru",i.Ukrainian="uk",i.SimplifiedChinese="zh-CN",i.TraditionalChinese="zh-TW",i))(ue||{});const pf=new Map([["ar",{locale:"ar-AR",language:"ar"}],["de",{locale:"de-DE",language:"de"}],["en",{locale:"en-US",language:"en"}],["es",{locale:"es-ES",language:"es"}],["fr",{locale:"fr-FR",language:"fr"}],["it",{locale:"it-IT",language:"it"}],["ja",{locale:"ja-JP",language:"ja"}],["ko",{locale:"ko-KR",language:"ko"}],["pl",{locale:"pl-PL",language:"pl"}],["ru",{locale:"ru-RU",language:"ru"}],["pt",{locale:"pt-BR",language:"pt-BR"}],["pt-BR",{locale:"pt-BR",language:"pt-BR"}],["zh-CN",{locale:"zh-CN",language:"zh-CN"}],["zh-TW",{locale:"zh-TW",language:"zh-TW"}],["uk",{locale:"uk-UA",language:"uk"}]]),V7={"access.level":"Level {value}","beta.beta":"Beta","beta.confirmLogout":"Logging out will pause any ongoing downloads, are you sure you want to log out?","beta.confirmQuit":"Quitting will pause any ongoing downloads and close this app. Are you sure you want to quit?","beta.confirmSwitchToStandard":"This will close the current Ubisoft Connect app and pause any ongoing downloads. It will then launch the Standard version of the app.","beta.confirmSwitchToStandardHeading":"Are you sure you want to switch to Standard?","beta.standard":"Standard","beta.switchToStandard":"Switch to standard","beta.switchToStandardDescription":"Switch between the Beta version of Ubisoft Connect PC and its Standard version.","button.accept":"Accept","button.cancel":"Cancel","button.close":"Close","button.confirm":"Confirm","button.continue":"Continue","button.decline":"Decline","button.giveUsFeedback":"Give us feedback","button.helpLink":"Ubisoft Help","button.join":"Join game","button.logOut":"Log out","button.quit":"Quit","button.restart":"Restart","button.restartClient":"Restart client","button.retry":"Retry","button.subscribeToUbisoftPlus":"Subscribe to Ubisoft+","button.support":"Support","button.tryAgain":"Try again","error.games":"Games played are currently not available.","error.generic":"Ubisoft services are temporarily unavailable. Please try again later.","error.login":"There was an error during your login to Ubisoft Connect. Please restart your client and try again.","error.loginOffline":"We are not able to log you in offline with this account. Please log in online with this account first before log in offline.","error.network":"We seem to be experiencing issues with your network connection. Please try again.","error.noConnection":"No connection","error.unableToConnect":"Please check your network connection and try again in a moment (Error {errorCode}).","legend.label.back":"Back","legend.label.exit":"Exit","legend.label.select":"Select","legend.label.viewApp":"View {application}","message.downloadComplete":"{game} has finished downloading","message.expiredSession":"Something went wrong. Please try again later, we'll do our best to fix this rapidly.","message.friendGameInvite":"{username} has invited you to a game","message.friendGroupInvite":"{username} has invited you to join {group}","message.friendInvite":"{username} wants to be your friend","message.friendOnline":"{username} is online","message.friendPlaying":"{username} is playing {game}","message.gameReadyToPlay":"{game} is ready to play","message.gameUpdateAvailable":"An update for {game} is available","message.groupInvite":"You have been invited to join {group}","message.helpLink":"For help, please visit:","message.longLoadTime":"Loading is taking longer than expected. Please wait while we try to connect you.","message.noGameInStandalone":"We couldn't find if you played any Ubisoft games recently. Play one and come back later to enjoy the benefits of Ubisoft Connect!","message.noInternetConnection":"No internet connection. Ubisoft Connect works best with an internet connection.","message.overlayShortcut":"Press Shift + F2 while in game to activate the overlay.","message.pendingPatch":"An update has automatically been downloaded for Ubisoft Connect. It will be installed once the application has been restarted.","message.reconnect":"Please check your internet connection while we try to reconnect you.","message.restartClient":"If this doesn't help, we recommend restarting Ubisoft Connect.","message.restartWhenGameRunning":"Sorry, closing Ubisoft PC while game runs may have unforeseen effects on your game. Please ensure you exit your game before you do. You'll need to restart Ubisoft Connect PC.","message.restartWhenOffline":"Client is offline. Please check your network connection and restart the client to enable online functionalities.","message.service.degradation":"Helping you reconnect, some features may be temporarily unavailable.","message.screenshotSaved":"Screenshot saved","message.sharePlayInviteFailed":"Share Play invite failed to send. Please try again.","message.sharePlayRemainingMinutes":"Minutes remaining in session: {time}","message.sharePlaySessionEnded":"Session ended","message.ubiserviceUnavailable":"Sorry, service currently unavailable. Please try again later.","message.updateSessionFailed":"Sorry, you need to restart Ubisoft Connect PC. Your current downloads will be paused after closing.","profile.menu.accountManagement":"Account management","profile.menu.appearOffline":"Appear Offline","profile.menu.away":"Away","profile.menu.doNotDisturb":"Do not disturb","profile.menu.logOut":"Log out","profile.menu.myWallet":"Wallet","profile.menu.online":"Online","profile.menu.profile":"Profile","profile.menu.quit":"Quit","profile.menu.settings":"Settings","profile.menu.support":"Support","quicklaunch.details":"Details","quicklaunch.header":"Quick launch","quicklaunch.launch":"Launch","quicklaunch.running":"Running...","quicklaunch.update":"Update","quicklaunch.update.available":"Update available","shareplay.controls.active":"Shift+F2 to pause guest controls","shareplay.controls.paused":"Guest controls paused","shareplay.latency":"Latency","shareplay.network":"Network","shareplay.network.fair":"Fair","shareplay.network.good":"Good","shareplay.network.poor":"Poor","shareplay.network.unknown":"Unknown","shell.features_disabled_due_to_external_launch":"Some features has been disabled because Ubisoft Connect was launched form another application","shell.reloadShell":"This app needs to be updated, please click \\'Confirm\\' to continue","sidebar.collapse":"Collapse sidebar","sidebar.expand":"Expand sidebar","title.friends.xbox":"Ubisoft friends","title.sessionTimedOut":"Session timed out","title.unableToConnect":"Unable to connect"};var Cg={};Object.defineProperty(Cg,"__esModule",{value:!0});var FO=Cg.shouldPolyfill=void 0;function $7(){try{return new Intl.Locale("und-x-private").toString()==="x-private"}catch(i){return!0}}function B7(){return!("Locale"in Intl)||$7()}FO=Cg.shouldPolyfill=B7;var LO={};function H7(i){return Intl.getCanonicalLocales(i)}var wp={supplemental:{languageMatching:{"written-new":[{paradigmLocales:{_locales:"en en_GB es es_419 pt_BR pt_PT"}},{$enUS:{_value:"AS+CA+GU+MH+MP+PH+PR+UM+US+VI"}},{$cnsar:{_value:"HK+MO"}},{$americas:{_value:"019"}},{$maghreb:{_value:"MA+DZ+TN+LY+MR+EH"}},{no:{_desired:"nb",_distance:"1"}},{bs:{_desired:"hr",_distance:"4"}},{bs:{_desired:"sh",_distance:"4"}},{hr:{_desired:"sh",_distance:"4"}},{sr:{_desired:"sh",_distance:"4"}},{aa:{_desired:"ssy",_distance:"4"}},{de:{_desired:"gsw",_distance:"4",_oneway:"true"}},{de:{_desired:"lb",_distance:"4",_oneway:"true"}},{no:{_desired:"da",_distance:"8"}},{nb:{_desired:"da",_distance:"8"}},{ru:{_desired:"ab",_distance:"30",_oneway:"true"}},{en:{_desired:"ach",_distance:"30",_oneway:"true"}},{nl:{_desired:"af",_distance:"20",_oneway:"true"}},{en:{_desired:"ak",_distance:"30",_oneway:"true"}},{en:{_desired:"am",_distance:"30",_oneway:"true"}},{es:{_desired:"ay",_distance:"20",_oneway:"true"}},{ru:{_desired:"az",_distance:"30",_oneway:"true"}},{ur:{_desired:"bal",_distance:"20",_oneway:"true"}},{ru:{_desired:"be",_distance:"20",_oneway:"true"}},{en:{_desired:"bem",_distance:"30",_oneway:"true"}},{hi:{_desired:"bh",_distance:"30",_oneway:"true"}},{en:{_desired:"bn",_distance:"30",_oneway:"true"}},{zh:{_desired:"bo",_distance:"20",_oneway:"true"}},{fr:{_desired:"br",_distance:"20",_oneway:"true"}},{es:{_desired:"ca",_distance:"20",_oneway:"true"}},{fil:{_desired:"ceb",_distance:"30",_oneway:"true"}},{en:{_desired:"chr",_distance:"20",_oneway:"true"}},{ar:{_desired:"ckb",_distance:"30",_oneway:"true"}},{fr:{_desired:"co",_distance:"20",_oneway:"true"}},{fr:{_desired:"crs",_distance:"20",_oneway:"true"}},{sk:{_desired:"cs",_distance:"20"}},{en:{_desired:"cy",_distance:"20",_oneway:"true"}},{en:{_desired:"ee",_distance:"30",_oneway:"true"}},{en:{_desired:"eo",_distance:"30",_oneway:"true"}},{es:{_desired:"eu",_distance:"20",_oneway:"true"}},{da:{_desired:"fo",_distance:"20",_oneway:"true"}},{nl:{_desired:"fy",_distance:"20",_oneway:"true"}},{en:{_desired:"ga",_distance:"20",_oneway:"true"}},{en:{_desired:"gaa",_distance:"30",_oneway:"true"}},{en:{_desired:"gd",_distance:"20",_oneway:"true"}},{es:{_desired:"gl",_distance:"20",_oneway:"true"}},{es:{_desired:"gn",_distance:"20",_oneway:"true"}},{hi:{_desired:"gu",_distance:"30",_oneway:"true"}},{en:{_desired:"ha",_distance:"30",_oneway:"true"}},{en:{_desired:"haw",_distance:"20",_oneway:"true"}},{fr:{_desired:"ht",_distance:"20",_oneway:"true"}},{ru:{_desired:"hy",_distance:"30",_oneway:"true"}},{en:{_desired:"ia",_distance:"30",_oneway:"true"}},{en:{_desired:"ig",_distance:"30",_oneway:"true"}},{en:{_desired:"is",_distance:"20",_oneway:"true"}},{id:{_desired:"jv",_distance:"20",_oneway:"true"}},{en:{_desired:"ka",_distance:"30",_oneway:"true"}},{fr:{_desired:"kg",_distance:"30",_oneway:"true"}},{ru:{_desired:"kk",_distance:"30",_oneway:"true"}},{en:{_desired:"km",_distance:"30",_oneway:"true"}},{en:{_desired:"kn",_distance:"30",_oneway:"true"}},{en:{_desired:"kri",_distance:"30",_oneway:"true"}},{tr:{_desired:"ku",_distance:"30",_oneway:"true"}},{ru:{_desired:"ky",_distance:"30",_oneway:"true"}},{it:{_desired:"la",_distance:"20",_oneway:"true"}},{en:{_desired:"lg",_distance:"30",_oneway:"true"}},{fr:{_desired:"ln",_distance:"30",_oneway:"true"}},{en:{_desired:"lo",_distance:"30",_oneway:"true"}},{en:{_desired:"loz",_distance:"30",_oneway:"true"}},{fr:{_desired:"lua",_distance:"30",_oneway:"true"}},{hi:{_desired:"mai",_distance:"20",_oneway:"true"}},{en:{_desired:"mfe",_distance:"30",_oneway:"true"}},{fr:{_desired:"mg",_distance:"30",_oneway:"true"}},{en:{_desired:"mi",_distance:"20",_oneway:"true"}},{en:{_desired:"ml",_distance:"30",_oneway:"true"}},{ru:{_desired:"mn",_distance:"30",_oneway:"true"}},{hi:{_desired:"mr",_distance:"30",_oneway:"true"}},{id:{_desired:"ms",_distance:"30",_oneway:"true"}},{en:{_desired:"mt",_distance:"30",_oneway:"true"}},{en:{_desired:"my",_distance:"30",_oneway:"true"}},{en:{_desired:"ne",_distance:"30",_oneway:"true"}},{nb:{_desired:"nn",_distance:"20"}},{no:{_desired:"nn",_distance:"20"}},{en:{_desired:"nso",_distance:"30",_oneway:"true"}},{en:{_desired:"ny",_distance:"30",_oneway:"true"}},{en:{_desired:"nyn",_distance:"30",_oneway:"true"}},{fr:{_desired:"oc",_distance:"20",_oneway:"true"}},{en:{_desired:"om",_distance:"30",_oneway:"true"}},{en:{_desired:"or",_distance:"30",_oneway:"true"}},{en:{_desired:"pa",_distance:"30",_oneway:"true"}},{en:{_desired:"pcm",_distance:"20",_oneway:"true"}},{en:{_desired:"ps",_distance:"30",_oneway:"true"}},{es:{_desired:"qu",_distance:"30",_oneway:"true"}},{de:{_desired:"rm",_distance:"20",_oneway:"true"}},{en:{_desired:"rn",_distance:"30",_oneway:"true"}},{fr:{_desired:"rw",_distance:"30",_oneway:"true"}},{hi:{_desired:"sa",_distance:"30",_oneway:"true"}},{en:{_desired:"sd",_distance:"30",_oneway:"true"}},{en:{_desired:"si",_distance:"30",_oneway:"true"}},{en:{_desired:"sn",_distance:"30",_oneway:"true"}},{en:{_desired:"so",_distance:"30",_oneway:"true"}},{en:{_desired:"sq",_distance:"30",_oneway:"true"}},{en:{_desired:"st",_distance:"30",_oneway:"true"}},{id:{_desired:"su",_distance:"20",_oneway:"true"}},{en:{_desired:"sw",_distance:"30",_oneway:"true"}},{en:{_desired:"ta",_distance:"30",_oneway:"true"}},{en:{_desired:"te",_distance:"30",_oneway:"true"}},{ru:{_desired:"tg",_distance:"30",_oneway:"true"}},{en:{_desired:"ti",_distance:"30",_oneway:"true"}},{ru:{_desired:"tk",_distance:"30",_oneway:"true"}},{en:{_desired:"tlh",_distance:"30",_oneway:"true"}},{en:{_desired:"tn",_distance:"30",_oneway:"true"}},{en:{_desired:"to",_distance:"30",_oneway:"true"}},{ru:{_desired:"tt",_distance:"30",_oneway:"true"}},{en:{_desired:"tum",_distance:"30",_oneway:"true"}},{zh:{_desired:"ug",_distance:"20",_oneway:"true"}},{ru:{_desired:"uk",_distance:"20",_oneway:"true"}},{en:{_desired:"ur",_distance:"30",_oneway:"true"}},{ru:{_desired:"uz",_distance:"30",_oneway:"true"}},{fr:{_desired:"wo",_distance:"30",_oneway:"true"}},{en:{_desired:"xh",_distance:"30",_oneway:"true"}},{en:{_desired:"yi",_distance:"30",_oneway:"true"}},{en:{_desired:"yo",_distance:"30",_oneway:"true"}},{zh:{_desired:"za",_distance:"20",_oneway:"true"}},{en:{_desired:"zu",_distance:"30",_oneway:"true"}},{ar:{_desired:"aao",_distance:"10",_oneway:"true"}},{ar:{_desired:"abh",_distance:"10",_oneway:"true"}},{ar:{_desired:"abv",_distance:"10",_oneway:"true"}},{ar:{_desired:"acm",_distance:"10",_oneway:"true"}},{ar:{_desired:"acq",_distance:"10",_oneway:"true"}},{ar:{_desired:"acw",_distance:"10",_oneway:"true"}},{ar:{_desired:"acx",_distance:"10",_oneway:"true"}},{ar:{_desired:"acy",_distance:"10",_oneway:"true"}},{ar:{_desired:"adf",_distance:"10",_oneway:"true"}},{ar:{_desired:"aeb",_distance:"10",_oneway:"true"}},{ar:{_desired:"aec",_distance:"10",_oneway:"true"}},{ar:{_desired:"afb",_distance:"10",_oneway:"true"}},{ar:{_desired:"ajp",_distance:"10",_oneway:"true"}},{ar:{_desired:"apc",_distance:"10",_oneway:"true"}},{ar:{_desired:"apd",_distance:"10",_oneway:"true"}},{ar:{_desired:"arq",_distance:"10",_oneway:"true"}},{ar:{_desired:"ars",_distance:"10",_oneway:"true"}},{ar:{_desired:"ary",_distance:"10",_oneway:"true"}},{ar:{_desired:"arz",_distance:"10",_oneway:"true"}},{ar:{_desired:"auz",_distance:"10",_oneway:"true"}},{ar:{_desired:"avl",_distance:"10",_oneway:"true"}},{ar:{_desired:"ayh",_distance:"10",_oneway:"true"}},{ar:{_desired:"ayl",_distance:"10",_oneway:"true"}},{ar:{_desired:"ayn",_distance:"10",_oneway:"true"}},{ar:{_desired:"ayp",_distance:"10",_oneway:"true"}},{ar:{_desired:"bbz",_distance:"10",_oneway:"true"}},{ar:{_desired:"pga",_distance:"10",_oneway:"true"}},{ar:{_desired:"shu",_distance:"10",_oneway:"true"}},{ar:{_desired:"ssh",_distance:"10",_oneway:"true"}},{az:{_desired:"azb",_distance:"10",_oneway:"true"}},{et:{_desired:"vro",_distance:"10",_oneway:"true"}},{ff:{_desired:"ffm",_distance:"10",_oneway:"true"}},{ff:{_desired:"fub",_distance:"10",_oneway:"true"}},{ff:{_desired:"fue",_distance:"10",_oneway:"true"}},{ff:{_desired:"fuf",_distance:"10",_oneway:"true"}},{ff:{_desired:"fuh",_distance:"10",_oneway:"true"}},{ff:{_desired:"fui",_distance:"10",_oneway:"true"}},{ff:{_desired:"fuq",_distance:"10",_oneway:"true"}},{ff:{_desired:"fuv",_distance:"10",_oneway:"true"}},{gn:{_desired:"gnw",_distance:"10",_oneway:"true"}},{gn:{_desired:"gui",_distance:"10",_oneway:"true"}},{gn:{_desired:"gun",_distance:"10",_oneway:"true"}},{gn:{_desired:"nhd",_distance:"10",_oneway:"true"}},{iu:{_desired:"ikt",_distance:"10",_oneway:"true"}},{kln:{_desired:"enb",_distance:"10",_oneway:"true"}},{kln:{_desired:"eyo",_distance:"10",_oneway:"true"}},{kln:{_desired:"niq",_distance:"10",_oneway:"true"}},{kln:{_desired:"oki",_distance:"10",_oneway:"true"}},{kln:{_desired:"pko",_distance:"10",_oneway:"true"}},{kln:{_desired:"sgc",_distance:"10",_oneway:"true"}},{kln:{_desired:"tec",_distance:"10",_oneway:"true"}},{kln:{_desired:"tuy",_distance:"10",_oneway:"true"}},{kok:{_desired:"gom",_distance:"10",_oneway:"true"}},{kpe:{_desired:"gkp",_distance:"10",_oneway:"true"}},{luy:{_desired:"ida",_distance:"10",_oneway:"true"}},{luy:{_desired:"lkb",_distance:"10",_oneway:"true"}},{luy:{_desired:"lko",_distance:"10",_oneway:"true"}},{luy:{_desired:"lks",_distance:"10",_oneway:"true"}},{luy:{_desired:"lri",_distance:"10",_oneway:"true"}},{luy:{_desired:"lrm",_distance:"10",_oneway:"true"}},{luy:{_desired:"lsm",_distance:"10",_oneway:"true"}},{luy:{_desired:"lto",_distance:"10",_oneway:"true"}},{luy:{_desired:"lts",_distance:"10",_oneway:"true"}},{luy:{_desired:"lwg",_distance:"10",_oneway:"true"}},{luy:{_desired:"nle",_distance:"10",_oneway:"true"}},{luy:{_desired:"nyd",_distance:"10",_oneway:"true"}},{luy:{_desired:"rag",_distance:"10",_oneway:"true"}},{lv:{_desired:"ltg",_distance:"10",_oneway:"true"}},{mg:{_desired:"bhr",_distance:"10",_oneway:"true"}},{mg:{_desired:"bjq",_distance:"10",_oneway:"true"}},{mg:{_desired:"bmm",_distance:"10",_oneway:"true"}},{mg:{_desired:"bzc",_distance:"10",_oneway:"true"}},{mg:{_desired:"msh",_distance:"10",_oneway:"true"}},{mg:{_desired:"skg",_distance:"10",_oneway:"true"}},{mg:{_desired:"tdx",_distance:"10",_oneway:"true"}},{mg:{_desired:"tkg",_distance:"10",_oneway:"true"}},{mg:{_desired:"txy",_distance:"10",_oneway:"true"}},{mg:{_desired:"xmv",_distance:"10",_oneway:"true"}},{mg:{_desired:"xmw",_distance:"10",_oneway:"true"}},{mn:{_desired:"mvf",_distance:"10",_oneway:"true"}},{ms:{_desired:"bjn",_distance:"10",_oneway:"true"}},{ms:{_desired:"btj",_distance:"10",_oneway:"true"}},{ms:{_desired:"bve",_distance:"10",_oneway:"true"}},{ms:{_desired:"bvu",_distance:"10",_oneway:"true"}},{ms:{_desired:"coa",_distance:"10",_oneway:"true"}},{ms:{_desired:"dup",_distance:"10",_oneway:"true"}},{ms:{_desired:"hji",_distance:"10",_oneway:"true"}},{ms:{_desired:"id",_distance:"10",_oneway:"true"}},{ms:{_desired:"jak",_distance:"10",_oneway:"true"}},{ms:{_desired:"jax",_distance:"10",_oneway:"true"}},{ms:{_desired:"kvb",_distance:"10",_oneway:"true"}},{ms:{_desired:"kvr",_distance:"10",_oneway:"true"}},{ms:{_desired:"kxd",_distance:"10",_oneway:"true"}},{ms:{_desired:"lce",_distance:"10",_oneway:"true"}},{ms:{_desired:"lcf",_distance:"10",_oneway:"true"}},{ms:{_desired:"liw",_distance:"10",_oneway:"true"}},{ms:{_desired:"max",_distance:"10",_oneway:"true"}},{ms:{_desired:"meo",_distance:"10",_oneway:"true"}},{ms:{_desired:"mfa",_distance:"10",_oneway:"true"}},{ms:{_desired:"mfb",_distance:"10",_oneway:"true"}},{ms:{_desired:"min",_distance:"10",_oneway:"true"}},{ms:{_desired:"mqg",_distance:"10",_oneway:"true"}},{ms:{_desired:"msi",_distance:"10",_oneway:"true"}},{ms:{_desired:"mui",_distance:"10",_oneway:"true"}},{ms:{_desired:"orn",_distance:"10",_oneway:"true"}},{ms:{_desired:"ors",_distance:"10",_oneway:"true"}},{ms:{_desired:"pel",_distance:"10",_oneway:"true"}},{ms:{_desired:"pse",_distance:"10",_oneway:"true"}},{ms:{_desired:"tmw",_distance:"10",_oneway:"true"}},{ms:{_desired:"urk",_distance:"10",_oneway:"true"}},{ms:{_desired:"vkk",_distance:"10",_oneway:"true"}},{ms:{_desired:"vkt",_distance:"10",_oneway:"true"}},{ms:{_desired:"xmm",_distance:"10",_oneway:"true"}},{ms:{_desired:"zlm",_distance:"10",_oneway:"true"}},{ms:{_desired:"zmi",_distance:"10",_oneway:"true"}},{ne:{_desired:"dty",_distance:"10",_oneway:"true"}},{om:{_desired:"gax",_distance:"10",_oneway:"true"}},{om:{_desired:"hae",_distance:"10",_oneway:"true"}},{om:{_desired:"orc",_distance:"10",_oneway:"true"}},{or:{_desired:"spv",_distance:"10",_oneway:"true"}},{ps:{_desired:"pbt",_distance:"10",_oneway:"true"}},{ps:{_desired:"pst",_distance:"10",_oneway:"true"}},{qu:{_desired:"qub",_distance:"10",_oneway:"true"}},{qu:{_desired:"qud",_distance:"10",_oneway:"true"}},{qu:{_desired:"quf",_distance:"10",_oneway:"true"}},{qu:{_desired:"qug",_distance:"10",_oneway:"true"}},{qu:{_desired:"quh",_distance:"10",_oneway:"true"}},{qu:{_desired:"quk",_distance:"10",_oneway:"true"}},{qu:{_desired:"qul",_distance:"10",_oneway:"true"}},{qu:{_desired:"qup",_distance:"10",_oneway:"true"}},{qu:{_desired:"qur",_distance:"10",_oneway:"true"}},{qu:{_desired:"qus",_distance:"10",_oneway:"true"}},{qu:{_desired:"quw",_distance:"10",_oneway:"true"}},{qu:{_desired:"qux",_distance:"10",_oneway:"true"}},{qu:{_desired:"quy",_distance:"10",_oneway:"true"}},{qu:{_desired:"qva",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvc",_distance:"10",_oneway:"true"}},{qu:{_desired:"qve",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvh",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvi",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvj",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvl",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvm",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvn",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvo",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvp",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvs",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvw",_distance:"10",_oneway:"true"}},{qu:{_desired:"qvz",_distance:"10",_oneway:"true"}},{qu:{_desired:"qwa",_distance:"10",_oneway:"true"}},{qu:{_desired:"qwc",_distance:"10",_oneway:"true"}},{qu:{_desired:"qwh",_distance:"10",_oneway:"true"}},{qu:{_desired:"qws",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxa",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxc",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxh",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxl",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxn",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxo",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxp",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxr",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxt",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxu",_distance:"10",_oneway:"true"}},{qu:{_desired:"qxw",_distance:"10",_oneway:"true"}},{sc:{_desired:"sdc",_distance:"10",_oneway:"true"}},{sc:{_desired:"sdn",_distance:"10",_oneway:"true"}},{sc:{_desired:"sro",_distance:"10",_oneway:"true"}},{sq:{_desired:"aae",_distance:"10",_oneway:"true"}},{sq:{_desired:"aat",_distance:"10",_oneway:"true"}},{sq:{_desired:"aln",_distance:"10",_oneway:"true"}},{syr:{_desired:"aii",_distance:"10",_oneway:"true"}},{uz:{_desired:"uzs",_distance:"10",_oneway:"true"}},{yi:{_desired:"yih",_distance:"10",_oneway:"true"}},{zh:{_desired:"cdo",_distance:"10",_oneway:"true"}},{zh:{_desired:"cjy",_distance:"10",_oneway:"true"}},{zh:{_desired:"cpx",_distance:"10",_oneway:"true"}},{zh:{_desired:"czh",_distance:"10",_oneway:"true"}},{zh:{_desired:"czo",_distance:"10",_oneway:"true"}},{zh:{_desired:"gan",_distance:"10",_oneway:"true"}},{zh:{_desired:"hak",_distance:"10",_oneway:"true"}},{zh:{_desired:"hsn",_distance:"10",_oneway:"true"}},{zh:{_desired:"lzh",_distance:"10",_oneway:"true"}},{zh:{_desired:"mnp",_distance:"10",_oneway:"true"}},{zh:{_desired:"nan",_distance:"10",_oneway:"true"}},{zh:{_desired:"wuu",_distance:"10",_oneway:"true"}},{zh:{_desired:"yue",_distance:"10",_oneway:"true"}},{"*":{_desired:"*",_distance:"80"}},{"en-Latn":{_desired:"am-Ethi",_distance:"10",_oneway:"true"}},{"ru-Cyrl":{_desired:"az-Latn",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"bn-Beng",_distance:"10",_oneway:"true"}},{"zh-Hans":{_desired:"bo-Tibt",_distance:"10",_oneway:"true"}},{"ru-Cyrl":{_desired:"hy-Armn",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"ka-Geor",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"km-Khmr",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"kn-Knda",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"lo-Laoo",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"ml-Mlym",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"my-Mymr",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"ne-Deva",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"or-Orya",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"pa-Guru",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"ps-Arab",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"sd-Arab",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"si-Sinh",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"ta-Taml",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"te-Telu",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"ti-Ethi",_distance:"10",_oneway:"true"}},{"ru-Cyrl":{_desired:"tk-Latn",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"ur-Arab",_distance:"10",_oneway:"true"}},{"ru-Cyrl":{_desired:"uz-Latn",_distance:"10",_oneway:"true"}},{"en-Latn":{_desired:"yi-Hebr",_distance:"10",_oneway:"true"}},{"sr-Cyrl":{_desired:"sr-Latn",_distance:"5"}},{"zh-Hans":{_desired:"za-Latn",_distance:"10",_oneway:"true"}},{"zh-Hans":{_desired:"zh-Hani",_distance:"20",_oneway:"true"}},{"zh-Hant":{_desired:"zh-Hani",_distance:"20",_oneway:"true"}},{"ar-Arab":{_desired:"ar-Latn",_distance:"20",_oneway:"true"}},{"bn-Beng":{_desired:"bn-Latn",_distance:"20",_oneway:"true"}},{"gu-Gujr":{_desired:"gu-Latn",_distance:"20",_oneway:"true"}},{"hi-Deva":{_desired:"hi-Latn",_distance:"20",_oneway:"true"}},{"kn-Knda":{_desired:"kn-Latn",_distance:"20",_oneway:"true"}},{"ml-Mlym":{_desired:"ml-Latn",_distance:"20",_oneway:"true"}},{"mr-Deva":{_desired:"mr-Latn",_distance:"20",_oneway:"true"}},{"ta-Taml":{_desired:"ta-Latn",_distance:"20",_oneway:"true"}},{"te-Telu":{_desired:"te-Latn",_distance:"20",_oneway:"true"}},{"zh-Hans":{_desired:"zh-Latn",_distance:"20",_oneway:"true"}},{"ja-Jpan":{_desired:"ja-Latn",_distance:"5",_oneway:"true"}},{"ja-Jpan":{_desired:"ja-Hani",_distance:"5",_oneway:"true"}},{"ja-Jpan":{_desired:"ja-Hira",_distance:"5",_oneway:"true"}},{"ja-Jpan":{_desired:"ja-Kana",_distance:"5",_oneway:"true"}},{"ja-Jpan":{_desired:"ja-Hrkt",_distance:"5",_oneway:"true"}},{"ja-Hrkt":{_desired:"ja-Hira",_distance:"5",_oneway:"true"}},{"ja-Hrkt":{_desired:"ja-Kana",_distance:"5",_oneway:"true"}},{"ko-Kore":{_desired:"ko-Hani",_distance:"5",_oneway:"true"}},{"ko-Kore":{_desired:"ko-Hang",_distance:"5",_oneway:"true"}},{"ko-Kore":{_desired:"ko-Jamo",_distance:"5",_oneway:"true"}},{"ko-Hang":{_desired:"ko-Jamo",_distance:"5",_oneway:"true"}},{"*-*":{_desired:"*-*",_distance:"50"}},{"ar-*-$maghreb":{_desired:"ar-*-$maghreb",_distance:"4"}},{"ar-*-$!maghreb":{_desired:"ar-*-$!maghreb",_distance:"4"}},{"ar-*-*":{_desired:"ar-*-*",_distance:"5"}},{"en-*-$enUS":{_desired:"en-*-$enUS",_distance:"4"}},{"en-*-GB":{_desired:"en-*-$!enUS",_distance:"3"}},{"en-*-$!enUS":{_desired:"en-*-$!enUS",_distance:"4"}},{"en-*-*":{_desired:"en-*-*",_distance:"5"}},{"es-*-$americas":{_desired:"es-*-$americas",_distance:"4"}},{"es-*-$!americas":{_desired:"es-*-$!americas",_distance:"4"}},{"es-*-*":{_desired:"es-*-*",_distance:"5"}},{"pt-*-$americas":{_desired:"pt-*-$americas",_distance:"4"}},{"pt-*-$!americas":{_desired:"pt-*-$!americas",_distance:"4"}},{"pt-*-*":{_desired:"pt-*-*",_distance:"5"}},{"zh-Hant-$cnsar":{_desired:"zh-Hant-$cnsar",_distance:"4"}},{"zh-Hant-$!cnsar":{_desired:"zh-Hant-$!cnsar",_distance:"4"}},{"zh-Hant-*":{_desired:"zh-Hant-*",_distance:"5"}},{"*-*-*":{_desired:"*-*-*",_distance:"4"}}]}}},Q7={"001":["001","001-status-grouping","002","005","009","011","013","014","015","017","018","019","021","029","030","034","035","039","053","054","057","061","142","143","145","150","151","154","155","AC","AD","AE","AF","AG","AI","AL","AM","AO","AQ","AR","AS","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BL","BM","BN","BO","BQ","BR","BS","BT","BV","BW","BY","BZ","CA","CC","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","CP","CQ","CR","CU","CV","CW","CX","CY","CZ","DE","DG","DJ","DK","DM","DO","DZ","EA","EC","EE","EG","EH","ER","ES","ET","EU","EZ","FI","FJ","FK","FM","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL","GM","GN","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HM","HN","HR","HT","HU","IC","ID","IE","IL","IM","IN","IO","IQ","IR","IS","IT","JE","JM","JO","JP","KE","KG","KH","KI","KM","KN","KP","KR","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MF","MG","MH","MK","ML","MM","MN","MO","MP","MQ","MR","MS","MT","MU","MV","MW","MX","MY","MZ","NA","NC","NE","NF","NG","NI","NL","NO","NP","NR","NU","NZ","OM","PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PS","PT","PW","PY","QA","QO","RE","RO","RS","RU","RW","SA","SB","SC","SD","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","SS","ST","SV","SX","SY","SZ","TA","TC","TD","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TR","TT","TV","TW","TZ","UA","UG","UM","UN","US","UY","UZ","VA","VC","VE","VG","VI","VN","VU","WF","WS","XK","YE","YT","ZA","ZM","ZW"],"002":["002","002-status-grouping","011","014","015","017","018","202","AO","BF","BI","BJ","BW","CD","CF","CG","CI","CM","CV","DJ","DZ","EA","EG","EH","ER","ET","GA","GH","GM","GN","GQ","GW","IC","IO","KE","KM","LR","LS","LY","MA","MG","ML","MR","MU","MW","MZ","NA","NE","NG","RE","RW","SC","SD","SH","SL","SN","SO","SS","ST","SZ","TD","TF","TG","TN","TZ","UG","YT","ZA","ZM","ZW"],"003":["003","013","021","029","AG","AI","AW","BB","BL","BM","BQ","BS","BZ","CA","CR","CU","CW","DM","DO","GD","GL","GP","GT","HN","HT","JM","KN","KY","LC","MF","MQ","MS","MX","NI","PA","PM","PR","SV","SX","TC","TT","US","VC","VG","VI"],"005":["005","AR","BO","BR","BV","CL","CO","EC","FK","GF","GS","GY","PE","PY","SR","UY","VE"],"009":["009","053","054","057","061","AC","AQ","AS","AU","CC","CK","CP","CX","DG","FJ","FM","GU","HM","KI","MH","MP","NC","NF","NR","NU","NZ","PF","PG","PN","PW","QO","SB","TA","TK","TO","TV","UM","VU","WF","WS"],"011":["011","BF","BJ","CI","CV","GH","GM","GN","GW","LR","ML","MR","NE","NG","SH","SL","SN","TG"],"013":["013","BZ","CR","GT","HN","MX","NI","PA","SV"],"014":["014","BI","DJ","ER","ET","IO","KE","KM","MG","MU","MW","MZ","RE","RW","SC","SO","SS","TF","TZ","UG","YT","ZM","ZW"],"015":["015","DZ","EA","EG","EH","IC","LY","MA","SD","TN"],"017":["017","AO","CD","CF","CG","CM","GA","GQ","ST","TD"],"018":["018","BW","LS","NA","SZ","ZA"],"019":["003","005","013","019","019-status-grouping","021","029","419","AG","AI","AR","AW","BB","BL","BM","BO","BQ","BR","BS","BV","BZ","CA","CL","CO","CR","CU","CW","DM","DO","EC","FK","GD","GF","GL","GP","GS","GT","GY","HN","HT","JM","KN","KY","LC","MF","MQ","MS","MX","NI","PA","PE","PM","PR","PY","SR","SV","SX","TC","TT","US","UY","VC","VE","VG","VI"],"021":["021","BM","CA","GL","PM","US"],"029":["029","AG","AI","AW","BB","BL","BQ","BS","CU","CW","DM","DO","GD","GP","HT","JM","KN","KY","LC","MF","MQ","MS","PR","SX","TC","TT","VC","VG","VI"],"030":["030","CN","HK","JP","KP","KR","MN","MO","TW"],"034":["034","AF","BD","BT","IN","IR","LK","MV","NP","PK"],"035":["035","BN","ID","KH","LA","MM","MY","PH","SG","TH","TL","VN"],"039":["039","AD","AL","BA","ES","GI","GR","HR","IT","ME","MK","MT","PT","RS","SI","SM","VA","XK"],"053":["053","AU","CC","CX","HM","NF","NZ"],"054":["054","FJ","NC","PG","SB","VU"],"057":["057","FM","GU","KI","MH","MP","NR","PW","UM"],"061":["061","AS","CK","NU","PF","PN","TK","TO","TV","WF","WS"],142:["030","034","035","142","143","145","AE","AF","AM","AZ","BD","BH","BN","BT","CN","CY","GE","HK","ID","IL","IN","IQ","IR","JO","JP","KG","KH","KP","KR","KW","KZ","LA","LB","LK","MM","MN","MO","MV","MY","NP","OM","PH","PK","PS","QA","SA","SG","SY","TH","TJ","TL","TM","TR","TW","UZ","VN","YE"],143:["143","KG","KZ","TJ","TM","UZ"],145:["145","AE","AM","AZ","BH","CY","GE","IL","IQ","JO","KW","LB","OM","PS","QA","SA","SY","TR","YE"],150:["039","150","151","154","155","AD","AL","AT","AX","BA","BE","BG","BY","CH","CQ","CZ","DE","DK","EE","ES","FI","FO","FR","GB","GG","GI","GR","HR","HU","IE","IM","IS","IT","JE","LI","LT","LU","LV","MC","MD","ME","MK","MT","NL","NO","PL","PT","RO","RS","RU","SE","SI","SJ","SK","SM","UA","VA","XK"],151:["151","BG","BY","CZ","HU","MD","PL","RO","RU","SK","UA"],154:["154","AX","CQ","DK","EE","FI","FO","GB","GG","IE","IM","IS","JE","LT","LV","NO","SE","SJ"],155:["155","AT","BE","CH","DE","FR","LI","LU","MC","NL"],202:["011","014","017","018","202","AO","BF","BI","BJ","BW","CD","CF","CG","CI","CM","CV","DJ","ER","ET","GA","GH","GM","GN","GQ","GW","IO","KE","KM","LR","LS","MG","ML","MR","MU","MW","MZ","NA","NE","NG","RE","RW","SC","SH","SL","SN","SO","SS","ST","SZ","TD","TF","TG","TZ","UG","YT","ZA","ZM","ZW"],419:["005","013","029","419","AG","AI","AR","AW","BB","BL","BO","BQ","BR","BS","BV","BZ","CL","CO","CR","CU","CW","DM","DO","EC","FK","GD","GF","GP","GS","GT","GY","HN","HT","JM","KN","KY","LC","MF","MQ","MS","MX","NI","PA","PE","PR","PY","SR","SV","SX","TC","TT","UY","VC","VE","VG","VI"],EU:["AT","BE","BG","CY","CZ","DE","DK","EE","ES","EU","FI","FR","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI","SK"],EZ:["AT","BE","CY","DE","EE","ES","EZ","FI","FR","GR","IE","IT","LT","LU","LV","MT","NL","PT","SI","SK"],QO:["AC","AQ","CP","DG","QO","TA"],UN:["AD","AE","AF","AG","AL","AM","AO","AR","AT","AU","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BN","BO","BR","BS","BT","BW","BY","BZ","CA","CD","CF","CG","CH","CI","CL","CM","CN","CO","CR","CU","CV","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EE","EG","ER","ES","ET","FI","FJ","FM","FR","GA","GB","GD","GE","GH","GM","GN","GQ","GR","GT","GW","GY","HN","HR","HT","HU","ID","IE","IL","IN","IQ","IR","IS","IT","JM","JO","JP","KE","KG","KH","KI","KM","KN","KP","KR","KW","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MG","MH","MK","ML","MM","MN","MR","MT","MU","MV","MW","MX","MY","MZ","NA","NE","NG","NI","NL","NO","NP","NR","NZ","OM","PA","PE","PG","PH","PK","PL","PT","PW","PY","QA","RO","RS","RU","RW","SA","SB","SC","SD","SE","SG","SI","SK","SL","SM","SN","SO","SR","SS","ST","SV","SY","SZ","TD","TG","TH","TJ","TL","TM","TN","TO","TR","TT","TV","TZ","UA","UG","UN","US","UY","UZ","VC","VE","VN","VU","WS","YE","ZA","ZM","ZW"]},Ig=/-u(?:-[0-9a-z]{2,8})+/gi;function ps(i,e,t){if(t===void 0&&(t=Error),!i)throw new t(e)}var j7=838,bp;function q7(){var i,e;if(!bp){var t=(e=(i=wp.supplemental.languageMatching["written-new"][0])===null||i===void 0?void 0:i.paradigmLocales)===null||e===void 0?void 0:e._locales.split(" "),s=wp.supplemental.languageMatching["written-new"].slice(1,5),a=wp.supplemental.languageMatching["written-new"].slice(5),n=a.map(function(r){var o=Object.keys(r)[0],l=r[o];return{supported:o,desired:l._desired,distance:+l._distance,oneway:l.oneway==="true"}},{});bp={matches:n,matchVariables:s.reduce(function(r,o){var l=Object.keys(o)[0],u=o[l];return r[l.slice(1)]=u._value.split("+"),r},{}),paradigmLocales:ko(ko([],t,!0),t.map(function(r){return new Intl.Locale(r.replace(/_/g,"-")).maximize().toString()}),!0)}}return bp}function wo(i,e,t){var s=e.split("-"),a=s[0],n=s[1],r=s[2],o=!0;if(r&&r[0]==="$"){var l=r[1]!=="!",u=l?t[r.slice(1)]:t[r.slice(2)],v=u.map(function(w){return Q7[w]||[w]}).reduce(function(w,b){return ko(ko([],w,!0),b,!0)},[]);o&&(o=v.indexOf(i.region||"")>1==l)}else o&&(o=i.region?r==="*"||r===i.region:!0);return o&&(o=i.script?n==="*"||n===i.script:!0),o&&(o=i.language?a==="*"||a===i.language:!0),o}function uf(i){return[i.language,i.script,i.region].filter(Boolean).join("-")}function Cp(i,e,t){for(var s=0,a=t.matches;s<a.length;s++){var n=a[s],r=wo(i,n.desired,t.matchVariables)&&wo(e,n.supported,t.matchVariables);if(!n.oneway&&!r&&(r=wo(i,n.supported,t.matchVariables)&&wo(e,n.desired,t.matchVariables)),r){var o=n.distance*10;return t.paradigmLocales.indexOf(uf(i))>-1!=t.paradigmLocales.indexOf(uf(e))>-1?o-1:o}}throw new Error("No matching distance found")}function z7(i,e){var t=new Intl.Locale(i).maximize(),s=new Intl.Locale(e).maximize(),a={language:t.language,script:t.script||"",region:t.region||""},n={language:s.language,script:s.script||"",region:s.region||""},r=0,o=q7();return a.language!==n.language&&(r+=Cp({language:t.language,script:"",region:""},{language:s.language,script:"",region:""},o)),a.script!==n.script&&(r+=Cp({language:t.language,script:a.script,region:""},{language:s.language,script:a.script,region:""},o)),a.region!==n.region&&(r+=Cp(a,n,o)),r}function K7(i,e,t){t===void 0&&(t=j7);var s=1/0,a={matchedDesiredLocale:"",distances:{}};return i.forEach(function(n,r){a.distances[n]||(a.distances[n]={}),e.forEach(function(o){var l=z7(n,o)+0+r*40;a.distances[n][o]=l,l<s&&(s=l,a.matchedDesiredLocale=n,a.matchedSupportedLocale=o)})}),s>=t&&(a.matchedDesiredLocale=void 0,a.matchedSupportedLocale=void 0),a}function X7(i,e,t){var s,a,n=[],r=e.reduce(function(l,u){var v=u.replace(Ig,"");return n.push(v),l[v]=u,l},{}),o=K7(n,i);return o.matchedSupportedLocale&&o.matchedDesiredLocale&&(s=o.matchedSupportedLocale,a=r[o.matchedDesiredLocale].slice(o.matchedDesiredLocale.length)||void 0),s?{locale:s,extension:a}:{locale:t()}}function J7(i,e){var t=e.toLowerCase();ps(i!==void 0,"ukey must be defined");var s=t;return s}function df(i){return Intl.getCanonicalLocales(i)[0]}function Y7(i,e,t){ps(i.indexOf("-u-")===-1,"Expected locale to not have a Unicode locale extension");for(var s="-u",a=0,n=e;a<n.length;a++){var r=n[a];s+="-".concat(r)}for(var o=0,l=t;o<l.length;o++){var u=l[o],v=u.key,w=u.value;s+="-".concat(v),w!==""&&(s+="-".concat(w))}if(s==="-u")return df(i);var b=i.indexOf("-x-"),I;if(b===-1)I=i+s;else{var R=i.slice(0,b),x=i.slice(b);I=R+s+x}return df(I)}function GO(i,e){for(var t=e;;){if(i.indexOf(t)>-1)return t;var s=t.lastIndexOf("-");if(!~s)return;s>=2&&t[s-2]==="-"&&(s-=2),t=t.slice(0,s)}}function Z7(i,e,t){for(var s={locale:""},a=0,n=e;a<n.length;a++){var r=n[a],o=r.replace(Ig,""),l=GO(i,o);if(l)return s.locale=l,r!==o&&(s.extension=r.slice(o.length,r.length)),s}return s.locale=t(),s}function eW(i){ps(i===i.toLowerCase(),"Expected extension to be lowercase"),ps(i.slice(0,3)==="-u-","Expected extension to be a Unicode locale extension");for(var e=[],t=[],s,a=i.length,n=3;n<a;){var r=i.indexOf("-",n),o=void 0;r===-1?o=a-n:o=r-n;var l=i.slice(n,n+o);ps(o>=2,"Expected a subtag to have at least 2 characters"),s===void 0&&o!=2?e.indexOf(l)===-1&&e.push(l):o===2?(s={key:l,value:""},t.find(function(u){return u.key===(s==null?void 0:s.key)})===void 0&&t.push(s)):(s==null?void 0:s.value)===""?s.value=l:(ps(s!==void 0,"Expected keyword to be defined"),s.value+="-"+l),n+=o+1}return{attributes:e,keywords:t}}function xO(i,e,t,s,a,n){var r,o=t.localeMatcher,l;o==="lookup"?l=Z7(Array.from(i),e,n):l=X7(Array.from(i),e,n),l==null&&(l={locale:n(),extension:""});var u=l.locale,v=a[u],w={locale:"en",dataLocale:u},b,I;l.extension?(b=eW(l.extension),I=b.keywords):I=[];for(var R=[],x=function(ke){var Yi=(r=v==null?void 0:v[ke])!==null&&r!==void 0?r:[];ps(Array.isArray(Yi),"keyLocaleData for ".concat(ke," must be an array"));var mi=Yi[0];ps(mi===void 0||typeof mi=="string","value must be a string or undefined");var Hn=void 0,km=I.find(function(vx){return vx.key===ke});if(km){var hp=km.value;hp!==""?Yi.indexOf(hp)>-1&&(mi=hp,Hn={key:ke,value:mi}):Yi.indexOf("true")>-1&&(mi="true",Hn={key:ke,value:mi})}var Gi=t[ke];if(ps(Gi==null||typeof Gi=="string","optionsValue must be a string or undefined"),typeof Gi=="string"){var yx=ke.toLowerCase();Gi=J7(yx,Gi),Gi===""&&(Gi="true")}Gi!==mi&&Yi.indexOf(Gi)>-1&&(mi=Gi,Hn=void 0),Hn&&R.push(Hn),w[ke]=mi},F=0,V=s;F<V.length;F++){var ce=V[F];x(ce)}var Ue=[];return R.length>0&&(Ue=[],u=Y7(u,Ue,R)),w.locale=u,w}function tW(i,e){for(var t=[],s=0,a=e;s<a.length;s++){var n=a[s],r=n.replace(Ig,""),o=GO(i,r);o&&t.push(o)}return t}function iW(i,e,t,s){return xO(e,H7(i),{localeMatcher:(s==null?void 0:s.algorithm)||"best fit"},[],{},function(){return t}).locale}const sW=Object.freeze(Object.defineProperty({__proto__:null,LookupSupportedLocales:tW,ResolveLocale:xO,match:iW},Symbol.toStringTag,{value:"Module"})),aW=TS(sW);var Il={};Object.defineProperty(Il,"__esModule",{value:!0});Il.supportedLocales=void 0;Il.supportedLocales=["af","af-NA","agq","ak","am","ar","ar-AE","ar-BH","ar-DJ","ar-DZ","ar-EG","ar-EH","ar-ER","ar-IL","ar-IQ","ar-JO","ar-KM","ar-KW","ar-LB","ar-LY","ar-MA","ar-MR","ar-OM","ar-PS","ar-QA","ar-SA","ar-SD","ar-SO","ar-SS","ar-SY","ar-TD","ar-TN","ar-YE","as","asa","ast","az","az-Cyrl","az-Latn","bas","be","be-tarask","bem","bez","bg","bm","bn","bn-IN","bo","bo-IN","br","brx","bs","bs-Cyrl","bs-Latn","ca","ca-AD","ca-ES-valencia","ca-FR","ca-IT","ccp","ccp-IN","ce","ceb","cgg","chr","ckb","ckb-IR","cs","cy","da","da-GL","dav","de","de-AT","de-BE","de-CH","de-IT","de-LI","de-LU","dje","doi","dsb","dua","dyo","dz","ebu","ee","ee-TG","el","el-CY","en","en-001","en-150","en-AE","en-AG","en-AI","en-AS","en-AT","en-AU","en-BB","en-BE","en-BI","en-BM","en-BS","en-BW","en-BZ","en-CA","en-CC","en-CH","en-CK","en-CM","en-CX","en-CY","en-DE","en-DG","en-DK","en-DM","en-ER","en-FI","en-FJ","en-FK","en-FM","en-GB","en-GD","en-GG","en-GH","en-GI","en-GM","en-GU","en-GY","en-HK","en-IE","en-IL","en-IM","en-IN","en-IO","en-JE","en-JM","en-KE","en-KI","en-KN","en-KY","en-LC","en-LR","en-LS","en-MG","en-MH","en-MO","en-MP","en-MS","en-MT","en-MU","en-MW","en-MY","en-NA","en-NF","en-NG","en-NL","en-NR","en-NU","en-NZ","en-PG","en-PH","en-PK","en-PN","en-PR","en-PW","en-RW","en-SB","en-SC","en-SD","en-SE","en-SG","en-SH","en-SI","en-SL","en-SS","en-SX","en-SZ","en-TC","en-TK","en-TO","en-TT","en-TV","en-TZ","en-UG","en-UM","en-VC","en-VG","en-VI","en-VU","en-WS","en-ZA","en-ZM","en-ZW","eo","es","es-419","es-AR","es-BO","es-BR","es-BZ","es-CL","es-CO","es-CR","es-CU","es-DO","es-EA","es-EC","es-GQ","es-GT","es-HN","es-IC","es-MX","es-NI","es-PA","es-PE","es-PH","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et","eu","ewo","fa","fa-AF","ff","ff-Adlm","ff-Adlm-BF","ff-Adlm-CM","ff-Adlm-GH","ff-Adlm-GM","ff-Adlm-GW","ff-Adlm-LR","ff-Adlm-MR","ff-Adlm-NE","ff-Adlm-NG","ff-Adlm-SL","ff-Adlm-SN","ff-Latn","ff-Latn-BF","ff-Latn-CM","ff-Latn-GH","ff-Latn-GM","ff-Latn-GN","ff-Latn-GW","ff-Latn-LR","ff-Latn-MR","ff-Latn-NE","ff-Latn-NG","ff-Latn-SL","fi","fil","fo","fo-DK","fr","fr-BE","fr-BF","fr-BI","fr-BJ","fr-BL","fr-CA","fr-CD","fr-CF","fr-CG","fr-CH","fr-CI","fr-CM","fr-DJ","fr-DZ","fr-GA","fr-GF","fr-GN","fr-GP","fr-GQ","fr-HT","fr-KM","fr-LU","fr-MA","fr-MC","fr-MF","fr-MG","fr-ML","fr-MQ","fr-MR","fr-MU","fr-NC","fr-NE","fr-PF","fr-PM","fr-RE","fr-RW","fr-SC","fr-SN","fr-SY","fr-TD","fr-TG","fr-TN","fr-VU","fr-WF","fr-YT","fur","fy","ga","ga-GB","gd","gl","gsw","gsw-FR","gsw-LI","gu","guz","gv","ha","ha-GH","ha-NE","haw","he","hi","hr","hr-BA","hsb","hu","hy","ia","id","ig","ii","is","it","it-CH","it-SM","it-VA","ja","jgo","jmc","jv","ka","kab","kam","kde","kea","kgp","khq","ki","kk","kkj","kl","kln","km","kn","ko","ko-KP","kok","ks","ks-Arab","ksb","ksf","ksh","ku","kw","ky","lag","lb","lg","lkt","ln","ln-AO","ln-CF","ln-CG","lo","lrc","lrc-IQ","lt","lu","luo","luy","lv","mai","mas","mas-TZ","mer","mfe","mg","mgh","mgo","mi","mk","ml","mn","mni","mni-Beng","mr","ms","ms-BN","ms-ID","ms-SG","mt","mua","my","mzn","naq","nb","nb-SJ","nd","nds","nds-NL","ne","ne-IN","nl","nl-AW","nl-BE","nl-BQ","nl-CW","nl-SR","nl-SX","nmg","nn","nnh","no","nus","nyn","om","om-KE","or","os","os-RU","pa","pa-Arab","pa-Guru","pcm","pl","ps","ps-PK","pt","pt-AO","pt-CH","pt-CV","pt-GQ","pt-GW","pt-LU","pt-MO","pt-MZ","pt-PT","pt-ST","pt-TL","qu","qu-BO","qu-EC","rm","rn","ro","ro-MD","rof","ru","ru-BY","ru-KG","ru-KZ","ru-MD","ru-UA","rw","rwk","sa","sah","saq","sat","sat-Olck","sbp","sc","sd","sd-Arab","sd-Deva","se","se-FI","se-SE","seh","ses","sg","shi","shi-Latn","shi-Tfng","si","sk","sl","smn","sn","so","so-DJ","so-ET","so-KE","sq","sq-MK","sq-XK","sr","sr-Cyrl","sr-Cyrl-BA","sr-Cyrl-ME","sr-Cyrl-XK","sr-Latn","sr-Latn-BA","sr-Latn-ME","sr-Latn-XK","su","su-Latn","sv","sv-AX","sv-FI","sw","sw-CD","sw-KE","sw-UG","ta","ta-LK","ta-MY","ta-SG","te","teo","teo-KE","tg","th","ti","ti-ER","tk","to","tr","tr-CY","tt","twq","tzm","ug","uk","und","ur","ur-IN","uz","uz-Arab","uz-Cyrl","uz-Latn","vai","vai-Latn","vai-Vaii","vi","vun","wae","wo","xh","xog","yav","yi","yo","yo-BJ","yrl","yrl-CO","yrl-VE","yue","yue-Hans","yue-Hant","zgh","zh","zh-Hans","zh-Hans-HK","zh-Hans-MO","zh-Hans-SG","zh-Hant","zh-Hant-HK","zh-Hant-MO","zu"];Object.defineProperty(LO,"__esModule",{value:!0});var nW=LO.shouldPolyfill=dW,rW=aW,oW=Il;function cW(){return!Intl.NumberFormat.polyfilled&&!Intl.NumberFormat.supportedLocalesOf(["es"]).length}function lW(){try{var i=new Intl.NumberFormat("en",{style:"unit",unit:"bit",unitDisplay:"long",notation:"scientific"}).format(1e4);if(i!=="1E4 bits")return!1}catch(e){return!1}return!0}function pW(){try{var i=new Intl.NumberFormat("en",{notation:"compact",minimumSignificantDigits:3,maximumSignificantDigits:3,minimumFractionDigits:2,maximumFractionDigits:2,roundingPriority:"morePrecision"}).format(1e8);return i==="100.00M"}catch(e){return!1}}function uW(i){if(!i)return!0;var e=Array.isArray(i)?i:[i];return Intl.NumberFormat.supportedLocalesOf(e).length===e.length}function dW(i){if(i===void 0&&(i="en"),typeof Intl>"u"||!("NumberFormat"in Intl)||!lW()||!pW()||cW()||!uW(i))return i?(0,rW.match)([i],oW.supportedLocales,"en"):void 0}var Mg={};function hW(i){return Intl.getCanonicalLocales(i)}var Ag=/-u(?:-[0-9a-z]{2,8})+/gi;function Va(i,e,t){if(t===void 0&&(t=Error),!i)throw new t(e)}function Pg(i,e){for(var t=e;;){if(i.has(t))return t;var s=t.lastIndexOf("-");if(!~s)return;s>=2&&t[s-2]==="-"&&(s-=2),t=t.slice(0,s)}}function gW(i,e,t){for(var s={locale:""},a=0,n=e;a<n.length;a++){var r=n[a],o=r.replace(Ag,""),l=Pg(i,o);if(l)return s.locale=l,r!==o&&(s.extension=r.slice(o.length+1,r.length)),s}return s.locale=t(),s}function mW(i,e,t){var s={},a={},n={},r=new Set;i.forEach(function(x){var F=new Intl.Locale(x).minimize().toString(),V=Intl.getCanonicalLocales(x)[0]||x;s[F]=x,a[x]=x,n[V]=x,r.add(F),r.add(x),r.add(V)});for(var o,l=0,u=e;l<u.length;l++){var v=u[l];if(o)break;var w=v.replace(Ag,"");if(i.has(w)){o=w;break}if(r.has(w)){o=w;break}var b=new Intl.Locale(w),I=b.maximize().toString(),R=b.minimize().toString();if(r.has(R)){o=R;break}o=Pg(r,I)}return o?{locale:a[o]||n[o]||s[o]||o}:{locale:t()}}function fW(i,e){Va(e.length===2,"key must have 2 elements");var t=i.length,s="-".concat(e,"-"),a=i.indexOf(s);if(a!==-1){for(var n=a+4,r=n,o=n,l=!1;!l;){var u=i.indexOf("-",o),v=void 0;u===-1?v=t-o:v=u-o,v===2?l=!0:u===-1?(r=t,l=!0):(r=u,o=u+1)}return i.slice(n,r)}if(s="-".concat(e),a=i.indexOf(s),a!==-1&&a+3===t)return""}function EO(i,e,t,s,a,n){var r=t.localeMatcher,o;r==="lookup"?o=gW(i,e,n):o=mW(i,e,n);for(var l=o.locale,u={locale:"",dataLocale:l},v="-u",w=0,b=s;w<b.length;w++){var I=b[w];Va(l in a,"Missing locale data for ".concat(l));var R=a[l];Va(typeof R=="object"&&R!==null,"locale data ".concat(I," must be an object"));var x=R[I];Va(Array.isArray(x),"keyLocaleData for ".concat(I," must be an array"));var F=x[0];Va(typeof F=="string"||F===null,"value must be string or null but got ".concat(typeof F," in key ").concat(I));var V="";if(o.extension){var ce=fW(o.extension,I);ce!==void 0&&(ce!==""?~x.indexOf(ce)&&(F=ce,V="-".concat(I,"-").concat(F)):~ce.indexOf("true")&&(F="true",V="-".concat(I)))}if(I in t){var Ue=t[I];Va(typeof Ue=="string"||typeof Ue>"u"||Ue===null,"optionsValue must be String, Undefined or Null"),~x.indexOf(Ue)&&Ue!==F&&(F=Ue,V="")}u[I]=F,v+=V}if(v.length>2){var ke=l.indexOf("-x-");if(ke===-1)l=l+v;else{var Yi=l.slice(0,ke),mi=l.slice(ke,l.length);l=Yi+v+mi}l=Intl.getCanonicalLocales(l)[0]}return u.locale=l,u}function yW(i,e){for(var t=[],s=0,a=e;s<a.length;s++){var n=a[s],r=n.replace(Ag,""),o=Pg(i,r);o&&t.push(o)}return t}function vW(i,e,t,s){var a=e.reduce(function(n,r){return n.add(r),n},new Set);return EO(a,hW(i),{localeMatcher:(s==null?void 0:s.algorithm)||"best fit"},[],{},function(){return t}).locale}const _W=Object.freeze(Object.defineProperty({__proto__:null,LookupSupportedLocales:yW,ResolveLocale:EO,match:vW},Symbol.toStringTag,{value:"Module"})),SW=TS(_W);var Ml={};Object.defineProperty(Ml,"__esModule",{value:!0});Ml.supportedLocales=void 0;Ml.supportedLocales=["af","ak","am","an","ar","ars","as","asa","ast","az","bal","be","bem","bez","bg","bho","bm","bn","bo","br","brx","bs","ca","ce","ceb","cgg","chr","ckb","cs","cy","da","de","doi","dsb","dv","dz","ee","el","en","eo","es","et","eu","fa","ff","fi","fil","fo","fr","fur","fy","ga","gd","gl","gsw","gu","guw","gv","ha","haw","he","hi","hnj","hr","hsb","hu","hy","ia","id","ig","ii","io","is","it","iu","ja","jbo","jgo","jmc","jv","jw","ka","kab","kaj","kcg","kde","kea","kk","kkj","kl","km","kn","ko","ks","ksb","ksh","ku","kw","ky","lag","lb","lg","lij","lkt","ln","lo","lt","lv","mas","mg","mgo","mk","ml","mn","mo","mr","ms","mt","my","nah","naq","nb","nd","ne","nl","nn","nnh","no","nqo","nr","nso","ny","nyn","om","or","os","osa","pa","pap","pcm","pl","prg","ps","pt-PT","pt","rm","ro","rof","ru","rwk","sah","saq","sat","sc","scn","sd","sdh","se","seh","ses","sg","sh","shi","si","sk","sl","sma","smi","smj","smn","sms","sn","so","sq","sr","ss","ssy","st","su","sv","sw","syr","ta","te","teo","th","ti","tig","tk","tl","tn","to","tpi","tr","ts","tzm","ug","uk","und","ur","uz","ve","vi","vo","vun","wa","wae","wo","xh","xog","yi","yo","yue","zh","zu"];Object.defineProperty(Mg,"__esModule",{value:!0});var UO=Mg.shouldPolyfill=void 0,wW=SW,bW=Ml;function CW(i){if(!i)return!0;var e=Array.isArray(i)?i:[i];return Intl.PluralRules.supportedLocalesOf(e).length===e.length}function IW(i){if(i===void 0&&(i="en"),!("PluralRules"in Intl)||new Intl.PluralRules("en",{minimumFractionDigits:2}).select(1)==="one"||!CW(i))return i?(0,wW.match)([i],bW.supportedLocales,"en"):void 0}UO=Mg.shouldPolyfill=IW;function MW(i,e={timeout:0}){const a=e.timeout||1,n=performance.now();return setTimeout(function(){i({get didTimeout(){const o=performance.now()-n-1>a;return e.timeout!==0?o:!1},timeRemaining:function(){return Math.max(0,16-(performance.now()-n))}})},1)}function AW(i){clearTimeout(i)}let kO=!1,WO=!1;async function PW(){(!("ResizeObserver"in window)||RW())&&(window.ResizeObserver=C2),Ng()||G(()=>import("./asia-fonts.module-8e85bb6d.js"),["assets/asia-fonts.module-8e85bb6d.js","assets/asia-fonts.module-c79f546b.css"]),await TW(),NW(),DW()}function NW(){window.requestIdleCallback||(window.requestIdleCallback=MW),window.cancelIdleCallback||(window.cancelIdleCallback=AW)}async function TW(){Ng()||(hf()&&await G(()=>import("./polyfill-424130ef.js").then(i=>i.p),["assets/polyfill-424130ef.js","assets/vendor-ff46a377.js","assets/tslib.es6-7130f5d2.js","assets/upn-vendor-bf1ed58d.js"]),FO()&&await G(()=>import("./polyfill-b2ed1286.js").then(i=>i.p),["assets/polyfill-b2ed1286.js","assets/tslib.es6-7130f5d2.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/index-0071995d.js"]),UO()&&(await G(()=>import("./polyfill-4882ebb0.js").then(i=>i.p),["assets/polyfill-4882ebb0.js","assets/tslib.es6-7130f5d2.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/index-0071995d.js"]),kO=!0),nW()&&(await G(()=>import("./polyfill-44738ef8.js").then(i=>i.p),["assets/polyfill-44738ef8.js","assets/tslib.es6-7130f5d2.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/index-62695043.js"]),WO=!0),hf()&&await G(()=>import("./polyfill-d4ddb786.js").then(i=>i.p),["assets/polyfill-d4ddb786.js","assets/tslib.es6-7130f5d2.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/index-62695043.js"]))}function Ng(i){return(i!=null?i:navigator.userAgent).search("MSAuthHost")>=0}function RW(i){return(i!=null?i:navigator.userAgent).search("PlayStation")>=0}function hf(i){return(i!=null?i:navigator.userAgent).search("Nintendo")>=0}function DW(){"process"in window||Object.defineProperty(window,"process",{value:Object.freeze({env:{NODE_ENV:"production"}}),writable:!1,enumerable:!0,configurable:!1})}function OW(i){if(!Ng()){if(kO)switch(i){case ue.German:G(()=>import("./de-5d4a5256.js"),[]);break;case ue.English:G(()=>import("./en-d265ad8d.js"),[]);break;case ue.Spanish:G(()=>import("./es-fd2f35f4.js"),[]);break;case ue.French:G(()=>import("./fr-23e50d95.js"),[]);break;case ue.Italian:G(()=>import("./it-08f76780.js"),[]);break;case ue.Japanese:G(()=>import("./ja-abb1af27.js"),[]);break;case ue.Korean:G(()=>import("./ko-ef9a93f5.js"),[]);break;case ue.Polish:G(()=>import("./pl-ab15c7ea.js"),[]);break;case ue.Portugese:case ue.BrazilianPortugese:G(()=>import("./pt-227fd344.js"),[]);break;case ue.Russian:G(()=>import("./ru-88ac27ef.js"),[]);break;case ue.SimplifiedChinese:case ue.TraditionalChinese:G(()=>import("./zh-4775ba45.js"),[]);break;case ue.Ukrainian:G(()=>import("./uk-5ad006ab.js"),[]);break;default:G(()=>import("./en-d265ad8d.js"),[]);break}if(WO)switch(i){case ue.German:G(()=>import("./de-57bcfe51.js"),[]);break;case ue.English:G(()=>import("./en-d7d9a604.js"),[]);break;case ue.Spanish:G(()=>import("./es-d81a94f9.js"),[]);break;case ue.French:G(()=>import("./fr-e992ad34.js"),[]);break;case ue.Italian:G(()=>import("./it-de3a3d8d.js"),[]);break;case ue.Japanese:G(()=>import("./ja-ba72d331.js"),[]);break;case ue.Korean:G(()=>import("./ko-2b34de25.js"),[]);break;case ue.Polish:G(()=>import("./pl-c24901d0.js"),[]);break;case ue.Portugese:case ue.BrazilianPortugese:G(()=>import("./pt-9ec1c62c.js"),[]);break;case ue.Russian:G(()=>import("./ru-71779b49.js"),[]);break;case ue.SimplifiedChinese:case ue.TraditionalChinese:G(()=>import("./zh-fdab924b.js"),[]);break;case ue.Ukrainian:G(()=>import("./uk-2b984b1e.js"),[]);break;default:G(()=>import("./en-d7d9a604.js"),[]);break}}}const gf={locale:"en-US",language:ue.English};class Tg{constructor(e,t,s){this._logger=e,this._httpClient=t,this._defaultMessages=s}static async initializeLocalization(e,t,s){try{const n=await new Tg(t,s,V7).applyLocalization(e);return t.debug("Loaded localization: ".concat(e),{playerLocale:e,logCategory:f.initialization}),n.locale}catch(a){const n="Fail to load localization";return t.warn(n,{error:a,playerLocale:e,logCategory:f.initialization,errorCode:g.FailedLoadLocalizationWarning}),e}}async applyLocalization(e){let t=this.getSupportedLocale(e),s=await this.getMessages(t.language);return s||(this._logger.warn("Unable to load messages for language: ".concat(t.language),{logCategory:f.initialization,errorCode:g.LocalizationProviderCantLoadMessagesForLanguageWarning}),t=gf,s=this._defaultMessages),OW(t.language),K.setLocale(t.language),this.setLanguageAttribute(t.language),K.registerMessages(t.language,s),t}getSupportedLocale(e){const t=pf.get(e);if(t)return t;const s=e.split("-")[0],a=pf.get(s);return a||(this._logger.warn("Unsupported language code was provided for localization",{languageCode:s,locale:e,logCategory:f.configuration,errorCode:g.LocalizationProviderUnsupportedLanguageCodeWarning}),gf)}async getMessages(e){if(e===ue.English)return this._defaultMessages;let t;try{t=await q(bi,this._httpClient.getJson("localizations/".concat(e,".json")))}catch(s){this._logger.warn("Failed to fetch localization file: ".concat(e,".json. Reverting to English"),{error:s,logCategory:f.initialization,errorCode:g.Jellyfish_004})}return t}setLanguageAttribute(e){document.documentElement.setAttribute("lang",e)}}class FW{static initialize(e){this.lifeguardService=e}static getMicroAppDescriptions(){var e;return((e=this.lifeguardService)==null?void 0:e.getLoadedMicroAppDescriptions())||[]}}function LW(){const i="icon-solid-ps4-x",e="icon-solid-ps4-circle",t=document.getElementById(i),s=document.getElementById(e);t&&s&&(t.id=e,s.id=i)}class GW{static switchIconsIfNeeded(e){e.platformType===m.PS4&&e.psEnterButton===ln.Circle&&LW()}}class VO extends d("[Shell] Update breakpoint"){constructor(e){super(),this.breakpoint=e}}class pu extends d("[Shell] Observe Custom Resize On Micro App Container"){constructor(e,t,s){super(),this.appConfig=e,this.callback=t,this.enumVariable=s}}class uu extends d("[Shell] Observe Custom Resize By Frequecy On Micro App Container"){constructor(e,t,s){super(),this.appConfig=e,this.frequency=t,this.callback=s}}class hn extends d("[Shell] Unobserve Resize On Micro App Container"){constructor(e){super(),this.appConfig=e}}class $O extends d("[Shell] Observe Resize On Shell Container"){constructor(e){super(),this.callback=e}}class xW extends d("[Shell] Unobserve Resize On Shell Container"){}class li{}class EW{constructor(e){this._logger=e,this._subject=new Fr,this._subscribers=new Map}subscribe(e){const t=this.createObserver(e);this.setSubscription(e,t)}createObserver(e){return{next:t=>{try{const s=e(t);s instanceof Promise&&s.catch(a=>{this.logCallbackError(a)})}catch(s){this.logCallbackError(s)}}}}logCallbackError(e){this._logger.warn("Error in player notification event callback",{moreInfo:{},error:e,logCategory:f.playerNotification,errorCode:g.PlayerNotificationObserverCallbackWarning})}setSubscription(e,t){var a;this._subscribers.has(e)&&((a=this._subscribers.get(e))==null||a.subscription.unsubscribe(),this._subscribers.delete(e));const s=this._subject.subscribe(t);this._subscribers.set(e,{observer:t,subscription:s})}unsubscribe(e){var t;this._subscribers.has(e)&&((t=this._subscribers.get(e))==null||t.subscription.unsubscribe(),this._subscribers.delete(e))}notifyPlayerNotificationReceived(e){this._subject.next(e)}}class UW{constructor(){this._lifeGuards=[],this._lifeGuardFactory=null}set lifeGuardFactory(e){this._lifeGuardFactory=e}async activate(e,t){const s=this.getOrCreateLifeGuard(e);try{return!s.mounted&&!await s.mountMicroApp()?{isActive:!1}:{isActive:await s.activateMicroApp(t)}}catch(a){return{isActive:!1,error:a}}}async loadMicroApps(e){await Promise.all(e.map(t=>this.getOrCreateLifeGuard(t)).filter(t=>!t.mounted).map(t=>t.mountMicroApp(!1).catch(()=>{})))}getOrCreateLifeGuard(e){const t=this.getLifeGuard(e);if(t!==null)return t;if(this._lifeGuardFactory==null)throw Error("Life guard factory not set");const s=this._lifeGuardFactory.create(e);return this._lifeGuards.push({lifeGuard:s,config:e}),s}async requestDeactivation(e,t){const s=this.getLifeGuard(e);if(s===null)throw new Error("Can not deactivate a micro app which does not exist.");return s.requestDeactivation(t)}deactivate(e){const t=this.getLifeGuard(e);t==null||t.deactivate()}async unmountAll(){await Promise.all(this.lifeGuards.map(e=>e.unmountMicroApp())),this._lifeGuards.length=0}async unmount(e){const t=this.getLifeGuard(e);t&&await t.unmountMicroApp()}async focus(e){var s;const t=this.getLifeGuard(e);return(s=t==null?void 0:t.focusApp())!=null?s:!1}async blur(e){var s;const t=this.getLifeGuard(e);return(s=t==null?void 0:t.blurApp())!=null?s:!0}hasLifeGuard(e){return!!this.getLifeGuard(e)}getLifeGuard(e){var t,s;return(s=(t=this._lifeGuards.find(a=>a.config.spaceId===e.spaceId&&a.config.placement===e.placement))==null?void 0:t.lifeGuard)!=null?s:null}get lifeGuards(){return this._lifeGuards.map(e=>e.lifeGuard)}getLoadedMicroAppDescriptions(){return this._lifeGuards.map(e=>e.lifeGuard.getDescription())}getApplicationId(e){const t=this.getLifeGuard(e);return t==null?void 0:t.getAppApplicationId()}async scrollAppContent(e,t){const s=this.getLifeGuard(e);return s?s.scrollAppContent(t):!1}async appIsAvailable(e,t){const s=this.getOrCreateLifeGuard(e);return s?s.appIsAvailable(t):!0}async updateApi(){await Promise.all(this._lifeGuards.map(e=>e.lifeGuard.updateApi()))}}function kW(){return rE(cE(i=>i!=null))}const bc=class bc{constructor(e){this._logger=e,this._runtimeSubject=new Uo(void 0),this._subscriptions=new Map,this._debouncedNotify=I2(t=>{this._logger.debug("RuntimeContext update notify",{logCategory:f.shell,body:t}),this._runtimeSubject.next(t)},bc.notifyDebounceDelayInMs,{trailing:!0}),this._runtimeContextObservable=this._runtimeSubject.asObservable().pipe(kW()).pipe(aE({connector:()=>new oE(1)}),nE(t=>RS(t)))}subscribe(e){const t=this._runtimeContextObservable.subscribe(e),s=this._subscriptions.get(e)||[];s.push(t),this._subscriptions.set(e,s)}unsubscribe(e){e.forEach(t=>{(this._subscriptions.get(t)||[]).forEach(a=>a.unsubscribe()),this._subscriptions.delete(t)})}runtimeContextContentHasChanged(e,t){return!ba(e,t)}notifyRuntimeContextUpdate(e,t=!1){this._debouncedNotify(e),t&&this._debouncedNotify.flush()}};bc.notifyDebounceDelayInMs=100;let du=bc;class WW{constructor(){this._beforeUnloadListeners=[]}addBeforeUnloadListener(e){this._beforeUnloadListeners.push(e),window.addEventListener("beforeunload",e)}removeBeforeUnloadListener(e){const t=this._beforeUnloadListeners.indexOf(e);if(t>-1){const s=this._beforeUnloadListeners[t];this._beforeUnloadListeners.splice(t,1),window.removeEventListener("beforeunload",s)}}dispose(){this._beforeUnloadListeners.forEach(e=>window.removeEventListener("beforeunload",e))}}class VW{constructor(e,t){this._logger=e,this._applicationConfig=t,this._remoteLogsTransport=this._logger.getDefaultTransport(ir),this.setQueueApplicationConfig()}async initializeQueueServices(e,t,s,a){try{this._remoteLogsTransport.config.session=e,this.configureRemoteLogsQueue(t,s,a)}catch(n){this._logger.warn("Fail to configure remote logs queue.",{error:n,errorCode:g.RemoteLogsQueueFailedToConfigureWarning})}}updateSession(e){this._remoteLogsTransport.config.session=e}setQueueApplicationConfig(){const e=this._logger.applicationQueueId,t=this._remoteLogsTransport.getQueue(e)||this._remoteLogsTransport.createQueue(e);t.applicationConfig=this._applicationConfig}configureRemoteLogsQueue(e,t,s){if(!t){this._logger.warn("Can not configure remote logs queue, since output parameters are missing.",{logCategory:f.configuration,errorCode:g.RemoteLogsQueueFailedToConfigureMissingOutputParamsWarning});return}const a=this._logger.applicationQueueId,n=this._logger.getDefaultTransport(ir),r=n.getQueue(a)||n.createQueue(a);let{url:o}=t;if(!o)if(s!=null&&s.remoteLogs){const l=e==="prod"?"":"".concat(e,"-");o=s.remoteLogs.replace("{env}",l).replace("{version}","v1")}else{this._logger.warn("Can not configure remote logs queue, since output url is missing.",{logCategory:f.configuration,errorCode:g.RemoteLogsQueueFailedToConfigureMissingOutputUrlWarning});return}r.outputParameters=Object.assign({},t,{url:o}),this._logger.info("Shell remote logs output parameters are configured",{logCategory:f.configuration,remoteLogsOutputParameters:t})}}class $W{constructor(e){this._logger=e,this._subject=new Fr,this._subscribers=new Map}subscribe(e,t){const s=this.createObserver(e,t);this.setSubscription(e,s)}createObserver(e,t){return{next:s=>{try{const a=t(s);a instanceof Promise&&a.catch(n=>{this.logCallbackError(e,n)})}catch(a){this.logCallbackError(e,a)}}}}logCallbackError(e,t){this._logger.warn("Error in game invites event callback",{moreInfo:{applicationInfo:e},error:t,logCategory:f.api,errorCode:g.GameInvitesEventCallbackErrorWarning})}setSubscription(e,t){var a;this._subscribers.has(e)&&((a=this._subscribers.get(e))==null||a.subscription.unsubscribe(),this._subscribers.delete(e));const s=this._subject.subscribe(t);this._subscribers.set(e,{observer:t,subscription:s})}unsubscribe(e){var t;this._subscribers.has(e)&&((t=this._subscribers.get(e))==null||t.subscription.unsubscribe(),this._subscribers.delete(e))}notifyGameInvite(e){this._subject.next(e)}}class BW{constructor(e,t){this._urlOverrideMethods=[],this._overlayUrl=new URL(t),e===ie.Dev||e===ie.Local||e===ie.Uat?this._urlOverrideMethods.push(s=>this.getQueryParam("".concat(s.toLowerCase(),"-bundle-url"))):delete window.__esm_loader__}getBundleConfig(e,t){let s=!0,a=t;for(const n of this._urlOverrideMethods){const r=n(e);if(r){console.log('[AppBaseUrlOverrideHelper] found override for app bundle url: \napp: "'.concat(e,'" \nnew url: "').concat(r,'"')),a=r,s=!1;break}}return{bundleUrl:a,integrityHashRequired:s}}getQueryParam(e){var t;return(t=this._overlayUrl.searchParams.get(e))!=null?t:void 0}}class BO extends d("[Shell] Process shell reload message"){}class HO extends d("[Shell] Update configuration data"){constructor(e){super(),this.data=e}}class QO extends d("[Shell] Request plugins configuration intent"){}var xi=(i=>(i.CreateNewWindow="Create new child window",i.FocusChildWindow="Focus child window",i.RegisterAsChild="Window should register as child",i.RegisteredAsChild="Child window has been registered",i.UnregisterChild="Child window has been unregistered",i.RuntimeContextSync="Got RuntimeContext Synchronization Notification",i.NavigationRequest="Got Navigation request",i.InitialSync="Got Initial Data Synchronization Notification",i.RemoveChild="Remove child window",i.RemoveAllChildren="Removing all child windows",i))(xi||{});class jO extends Ss("ShellNotification.RegisterChild"){}class qO extends Fc("HostNotification.RuntimeContextUpdate"){}class zO extends Fc("HostNotification.InitialChildSync"){}class hu extends Ss("ShellNotification.UnregisterChild"){}const Cc=class Cc extends xc{constructor(){super(...arguments),this.hostResponseName=Cc.type}};Cc.type="HostGame.GetGameEntitlementResponse";let Zo=Cc;const Ic=class Ic extends Cd{constructor(){super(...arguments),this.shellRequestName=Ic.type,this.responseType=Zo}};Ic.type="ShellGame.GetGameEntitlement";let ec=Ic;const Mc=class Mc extends xc{constructor(){super(...arguments),this.hostResponseName=Mc.type}};Mc.type="HostNavigation.ParentNavigateResponse";let gr=Mc;const Ac=class Ac extends xc{constructor(){super(...arguments),this.hostResponseName=Ac.type}};Ac.type="HostNavigation.NewWindowResponse";let tc=Ac;const Pc=class Pc extends Cd{constructor(){super(...arguments),this.shellRequestName=Pc.type,this.responseType=gr}};Pc.type="ShellNavigation.ParentNavigate";let ic=Pc;const Nc=class Nc extends Cd{constructor(){super(...arguments),this.shellRequestName=Nc.type,this.responseType=tc}};Nc.type="ShellNavigation.NewWindow";let sc=Nc;function ac(i){return!!i.requestId}function nc(i,e=qt.newId()){return i.requestId=e,i}function nn(i){let e;try{e=JSON.parse(JSON.stringify(i))}catch(t){throw new Error(wi.Sanitize)}return e}var HW=Object.defineProperty,QW=Object.getOwnPropertyDescriptor,jW=(i,e,t,s)=>{for(var a=s>1?void 0:s?QW(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&HW(e,t,a),a};class KO extends Lc{constructor(e){if(super(),this._logger=e,!this.isAvailable()){this._logger.warn(wi.NotAvailable,{logCategory:f.hostCommunication,errorCode:g.FailedCommunicationSetupWarning});return}this.connect()}connect(){var e;(e=this.receiverAccessor)==null||e.addEventListener("message",this.onMessage)}disconnect(){var e;(e=this.receiverAccessor)==null||e.removeEventListener("message",this.onMessage)}async sendNotification(e){const t=nn(e);this.sendData(t)}async sendRequest(e){const t=nc(e),s=nn(t);return this.sendData(s),t.requestId}sendResponse(e,t){const s=nc(e,t),a=nn(s);return this.sendData(a),Promise.resolve()}cancelRequest(e){throw new Error(wi.NotSupported)}canSendNotification(){return this.isAvailable()}canSendRequest(){return this.isAvailable()}canSendResponse(){return this.isAvailable()}canCancelRequest(){return!1}onMessage(e){const{data:t}=e;if(t)if(qW(t)){this.onNotification(t);return}else{zW(t)&&ac(t)?this.onRequest(t,t.requestId):KW(t)&&ac(t)&&this.onResponse(t,t.requestId);return}}}jW([_()],KO.prototype,"onMessage",1);function qW(i){const e=i;return!!e.hostNotificationName&&typeof e.hostNotificationName=="string"}function zW(i){const e=i;return!!e.hostRequestName&&typeof e.hostRequestName=="string"}function KW(i){const e=i;return!!e.hostResponseName&&typeof e.hostResponseName=="string"}class Rg extends KO{sendData(e){window.postMessage(e,window.location.origin)}static isAvailable(){return!!window.opener&&!window.closed&&!!window.addEventListener&&!!window.postMessage}isAvailable(){return Rg.isAvailable()}get receiverAccessor(){return window}}class XW{constructor(e,t,s){this.spaceId=e,this.name=t,this.logoUrl=s}}var JW=Object.defineProperty,YW=Object.getOwnPropertyDescriptor,ZW=(i,e,t,s)=>{for(var a=s>1?void 0:s?YW(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&JW(e,t,a),a};class ws extends oe("[State] Game"){constructor(){super(...arguments),this._games=[]}addGame(e){if(!this.hasGame(e.spaceId)){const t=new XW(e.spaceId,e.displayName,e.logoUrl);this._games.push(t)}}hasGame(e){return this._games.find(t=>t.spaceId===e)!==void 0}get getGame(){return e=>this._games.find(t=>t.spaceId===e)}getAllLoadedGamesPayloads(){return this._games.map(e=>({spaceId:e.spaceId,displayName:e.name,logoUrl:e.logoUrl}))}}ZW([P],ws.prototype,"addGame",1);var eV=Object.defineProperty,tV=Object.getOwnPropertyDescriptor,iV=(i,e,t,s)=>{for(var a=s>1?void 0:s?tV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&eV(e,t,a),a};class An extends oe("[State] Entitlement"){constructor(){super(...arguments),this._gameEntitlements=new Map}addGameEntitlements(e){e.forEach(t=>{this._gameEntitlements.set(t.productId.toString(),{...t})})}get getGameEntitlement(){return e=>this._gameEntitlements.get(e)}}iV([P],An.prototype,"addGameEntitlements",1);var sV=Object.defineProperty,aV=Object.getOwnPropertyDescriptor,nV=(i,e,t,s)=>{for(var a=s>1?void 0:s?aV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&sV(e,t,a),a};const XO=class Kn extends lE{constructor(e,t){if(super(),this._logger=e,this._targetWindow=t,!Kn.isAvailable(t)){this._logger.warn(wi.NotAvailable,{targetWindow:t,logCategory:f.kinderGarden,errorCode:g.FailedChildWindowCommunicationWarning});return}t.addEventListener("message",this.onMessage)}static isAvailable(e){return!e.closed&&!!e.addEventListener&&!!e.postMessage}disconnect(){this._targetWindow.removeEventListener("message",this.onMessage)}async sendNotification(e){const t=nn(e);this._targetWindow.closed?this._logger.warn(wi.WindowClosed,{window:this._targetWindow,notification:e,logCategory:f.kinderGarden,errorCode:g.FailedChildWindowCommunicationChildClosedWarning}):this._targetWindow.postMessage(t,window.location.origin)}async sendRequest(e){const t=nc(e),s=nn(t);if(!this._targetWindow.closed)this._targetWindow.postMessage(s,window.location.origin);else{const a=wi.WindowClosed;this._logger.warn(a,{logCategory:f.kinderGarden,errorCode:g.FailedChildWindowCommunicationChildClosedWarning})}return t.requestId}async sendResponse(e,t){const s=nc(e,t),a=nn(s);if(!this._targetWindow.closed)this._targetWindow.postMessage(a,window.location.origin);else{const n=wi.WindowClosed;this._logger.warn(n,{logCategory:f.kinderGarden,errorCode:g.FailedChildWindowCommunicationChildClosedWarning})}}cancelRequest(e){throw new Error(wi.NotSupported)}canSendNotification(){return Kn.isAvailable(this._targetWindow)}canSendRequest(){return Kn.isAvailable(this._targetWindow)}canSendResponse(){return Kn.isAvailable(this._targetWindow)}canCancelRequest(){return!1}onMessage(e){const{data:t}=e;if(t)if(oV(t)){this.onNotification(t);return}else{cV(t)&&ac(t)?this.onRequest(t,t.requestId):lV(t)&&ac(t)&&this.onResponse(t,t.requestId);return}}};nV([_()],XO.prototype,"onMessage",1);let rV=XO;function oV(i){const e=i;return!!e.shellNotificationName&&typeof e.shellNotificationName=="string"}function cV(i){const e=i;return!!e.shellRequestName&&typeof e.shellRequestName=="string"}function lV(i){const e=i;return!!e.shellResponseName&&typeof e.shellResponseName=="string"}const gu={width:940,height:500,resizable:!1,scrollbars:!1};var pV=Object.defineProperty,uV=Object.getOwnPropertyDescriptor,Al=(i,e,t,s)=>{for(var a=s>1?void 0:s?uV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&pV(e,t,a),a};class Qr{constructor(e,t,s,a,n,r,o,l,u){this._childId=t,this._logger=s,this._store=a,this._runtimeParametersService=n,this._hostPlatformType=r,this._trackingService=l,this._anonymousTrackingService=u,this.window=this.createChildWindow(e,o),this._communication=this.createChildCommunicationService(this.window),this._deferred=new yt}async ready(){return this._deferred.promise}async requestNavigation(e){const t=await this._communication.service.sendRequest(new Cn({navigationContext:e}));return t?t.response.isSuccessful:!1}disconnect(){this._runtimeContextObserver&&this._store.dispatchIntent(new Rd([this._runtimeContextObserver])),this._logger.debug(xi.UnregisterChild,{childId:this._childId}),this._communication.transport.disconnect()}createChildWindow(e,t){const s=this.getChildUrl(),a=this.getAppLabelByAppName(e);this._runtimeParametersService.saveForChild(this._childId);const n=window.open(s,a,this.getChildWindowFeatures(t));if(!n){const r=Ha.WindowNotCreated;throw this._logger.error(r,{childId:this._childId,appName:e,errorCode:g.ChildWindowCreateError}),new De(r)}return n}getAppLabelByAppName(e){var s;return((s=this._store.getReadonlyState(M).findMicroAppConfig(e,null))==null?void 0:s.meta.label)||e}windowIsOpened(){return this.window&&!this.window.closed}addUnregisterListener(e){var t,s;(t=this._communication)!=null&&t.service&&((s=this._communication)==null||s.service.registerNotificationListener(hu,a=>e(a)))}createChildCommunicationService(e){const t=new rV(this._logger,e),s=new pE(this._logger,t);s.registerNotificationListener(jO,async()=>{this._logger.debug(xi.RegisteredAsChild,{childId:this._childId}),await this.processRegisterChildNotification(s)}),s.registerNotificationListener(hu,()=>this.disconnect()),s.registerRequestHandler(sc,this.processNewChildWindowRequest),s.registerRequestHandler(ic,this.processParentNavigationRequest),s.registerRequestHandler(ec,this.processGetGameEntitlementRequest),s.registerNotificationListener(kp,a=>{var n,r;if(a.eventName.toLowerCase().startsWith("visitor")){(n=this._anonymousTrackingService)==null||n.sendEvent(a.eventName,a.data,a.moreData);return}(r=this._trackingService)==null||r.sendEvent(a.eventName,a.data,a.moreData)});try{const a=this._logger.getDefaultTransport(ir),n=this._hostPlatformType===p.PCElectronClient?this._logger.getCustomTransport(cr,ds.DesktopAppLogTransport):void 0;s.registerNotificationListener(eS,r=>{const{logEntry:o}=r;a.log(o),n==null||n.log(o)})}catch(a){this._logger.warn(wi.NotAbleToSetupCommunication,{error:a,errorCode:g.FailedChildWindowCommunicationSetupWarning})}return{service:s,transport:t}}async processRegisterChildNotification(e){var v;const t=await this._store.dispatchIntent(new QO),s=this._store.getReadonlyState(Ii),a=this._store.getReadonlyState(S),n=this._store.getReadonlyState(M),r=this._store.getReadonlyState(Q),o=this._store.getReadonlyState(ws),l={serviceUrls:s.serviceUrls,remoteLogs:s.remoteLogs,runtimeContext:a.runtimeContext,shellConfigs:(v=n.shellConfigs)==null?void 0:v.serialize(),spaceConfigs:n.spaceConfigs.map(w=>w.serialize()),notificationPosition:r.notificationPosition,pluginsConfigs:t,games:o.getAllLoadedGamesPayloads()};await e.sendNotification(new zO(l));const u={next:w=>{if(this.window.closed){this.disconnect();return}e.sendNotification(new qO({runtimeContext:w}))}};this._runtimeContextObserver=u,this._store.dispatchIntent(new Er(u)),this._deferred.resolve()}async processNewChildWindowRequest(e){var r;const t=this._store.getReadonlyState(S),s=(r=e.navigationContext.game)!=null?r:t.hostGame,a=await this._store.dispatchIntent(new Xe(e.navigationContext.appName,s));let n=!1;if(a===void 0)this._logger.warn("Unable to navigate to micro app ".concat(e.navigationContext.appName,", because it has been incorrectly configured for space ").concat(s.spaceId),{game:s,navigationContext:e.navigationContext,logCategory:f.kinderGarden,errorCode:g.FailedNavigationIncorrectSpaceConfigurationWarning});else{const o={...e.navigationContext,game:s,parentAppName:a};n=await this._store.dispatchIntent(new Be(o,{shouldFocusWindow:!0}))}return new tc({isSuccessful:n})}async processParentNavigationRequest(e){var r;const t=this._store.getReadonlyState(S);if(!t.initialSessionSet)return this._logger.warn("Unable to parent navigate to micro app ".concat(e.navigationContext.appName,". Runtime context is not yet synced"),{navigationContext:e.navigationContext,logCategory:f.kinderGarden,errorCode:g.FailedParentNavigationRuntimeContextIsNotSynced}),new gr({isSuccessful:!1});const s=(r=e.navigationContext.game)!=null?r:t.hostGame,a=await this._store.dispatchIntent(new Xe(e.navigationContext.appName,s));let n=!1;if(a===void 0)this._logger.warn("Unable to parent navigate to micro app ".concat(e.navigationContext.appName,", because it has been incorrectly configured for space ").concat(s.spaceId),{game:s,navigationContext:e.navigationContext,logCategory:f.kinderGarden,errorCode:g.FailedNavigationIncorrectSpaceConfigurationWarning});else{const o={...e.navigationContext,game:s,parentAppName:a};n=await this._store.dispatchIntent(new Be(o,{shouldFocusWindow:!0}))}return new gr({isSuccessful:n})}getChildUrl(){const e=new URL("".concat(window.location.origin).concat(window.location.pathname));return e.searchParams.append("childId",this._childId),e.toString()}getChildWindowFeatures(e){const{width:t,height:s,scrollbars:a,resizable:n}=e?Object.assign(gu,e):gu,r=a?"yes":"no",o=n?"yes":"no",l=window.screenLeft+(window.innerWidth-t)/2,u=window.screenTop+(window.innerHeight-s)/2;return"menubar=no,location=no,status=no,resizable=".concat(o,",scrollbars=").concat(r,",width=").concat(t,",height=").concat(s,",left=").concat(l,",top=").concat(u)}async processGetGameEntitlementRequest(e){const s=this._store.getReadonlyState(An).getGameEntitlement(e.productId);return new Zo({gameEntitlement:s})}}Al([_()],Qr.prototype,"processRegisterChildNotification",1);Al([_()],Qr.prototype,"processNewChildWindowRequest",1);Al([_()],Qr.prototype,"processParentNavigationRequest",1);Al([_()],Qr.prototype,"processGetGameEntitlementRequest",1);var dV=Object.defineProperty,hV=Object.getOwnPropertyDescriptor,Dg=(i,e,t,s)=>{for(var a=s>1?void 0:s?hV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&dV(e,t,a),a};class Pl{constructor(e,t,s,a,n,r,o,l){this._logger=e,this._store=t,this._lifecycleListener=s,this._hostPlatformType=a,this._runtimeParametersService=n,this._featureHandlerService=r,this._trackingService=o,this._anonymousTrackingService=l,this._children=new Map,this._logger=e.createChild("KinderGarden"),this._logger.settings.logCategory=f.kinderGarden}registerSelfAsHost(){this._logger.info("Window is registered as host"),this._lifecycleListener.addBeforeUnloadListener(()=>this.closeAllChildWindows())}registerSelfAsChild(e){this._logger.info(xi.RegisterAsChild,{id:e}),this._hostCommunicationService=this.createHostCommunicationService(e);const t=this._logger.getCustomTransport(cr,ds.ParentRemoteLogTransport);t.communicationService=this._hostCommunicationService,this._trackingService.setCommunication&&this._trackingService.setCommunication(this._hostCommunicationService)}getChildId(e){return e}async createChildFromConfig(e){return this.createChild(e.appName,this.getWindowConfig(e.multipleWindowsConfig))}getWindowConfig(e){const t=gu;return e&&(e.initialSize&&(t.width=e.initialSize.width,t.height=e.initialSize.height),e.minimumSize&&(t.minWidth=e.minimumSize.width,t.minHeight=e.minimumSize.height)),t}async createChild(e,t){const s=this.getChildId(e),a=this._children.get(s);if(a){if(a.windowIsOpened())return s;this.removeChild(s,a)}await Gs(0);try{this._logger.info(xi.CreateNewWindow,{appName:e,childId:s});const n=new Qr(e,s,this._logger,this._store,this._runtimeParametersService,this._hostPlatformType,t,this._trackingService,this._anonymousTrackingService);this._children.set(s,n),await n.ready(),n.addUnregisterListener(()=>this.removeChild(s,n))}catch(n){return null}return s}async requestChildNavigation(e,t){const s=this._children.get(e);if(!s){const a=Ha.NoChildData;throw this._logger.warn(a,{childId:e,navigation:t.appName,errorCode:g.FailedNavigationChildWindowWarning}),new De(a)}if(!s.windowIsOpened()){this.removeChild(e,s);const a=Ha.NoChildData;throw this._logger.warn(a,{childId:e,navigation:t.appName,errorCode:g.FailedNavigationChildWindowWarning}),new De(a)}return s.requestNavigation(t)}async requestParentNavigation(e){if(!this._hostCommunicationService)return!1;const t=await this._hostCommunicationService.sendRequest(new ic({navigationContext:e}));return t?t.response.isSuccessful:!1}async requestNewChildFromHost(e){if(!this._hostCommunicationService)throw this._logger.warn(Ha.NoHostCommunicationService,{errorCode:g.FailedChildWindowCreationWarning}),new De(Ha.NoHostCommunicationService);const t=await this._hostCommunicationService.sendRequest(new sc({navigationContext:e}));return t?t.response.isSuccessful:!1}async requestGameEntitlement(e){if(!this._hostCommunicationService)return;const t=await this._hostCommunicationService.sendRequest(new ec({productId:e}));return t?t.response.gameEntitlement:void 0}createHostCommunicationService(e){const t=new Wc(this._logger,new Rg(this._logger));return t.sendNotification(new jO({childId:e})),t.registerNotificationListener(qO,this.onRuntimeContextUpdateNotification),t.registerRequestHandler(Cn,this.processNavigateRequest),this._lifecycleListener.addBeforeUnloadListener(()=>{t.sendNotification(new hu({childId:e}))}),t.registerNotificationListener(zO,this.processInitialSyncNotification),t}onRuntimeContextUpdateNotification(e){this._logger.debug(xi.RuntimeContextSync,{notification:e}),this._store.dispatchIntent(new WS(e.runtimeContext)),e.runtimeContext.playerSession&&this._store.dispatchIntent(new yl)}async processInitialSyncNotification(e){await this._store.dispatchIntent(new HO({remoteLogs:e.remoteLogs,serviceUrls:e.serviceUrls,shellConfigs:e.shellConfigs,spaceConfigs:e.spaceConfigs,runtimeContext:e.runtimeContext,notificationPosition:e.notificationPosition,games:e.games})),await this._store.dispatchIntent(new vD(e.runtimeContext.navigationMethod)),await this._store.dispatchIntent(new Ur),this._logger.info(xi.InitialSync,{notification:e})}async processNavigateRequest(e){var r,o;this._logger.debug(xi.NavigationRequest,{request:e});const t=this._store.getReadonlyState(S),s=(r=e.navigationContext.game)!=null?r:t.hostGame,a=await this._store.dispatchIntent(new Xe(e.navigationContext.appName,s));let n=!1;if(a===void 0)this._logger.warn("Unable to navigate to micro app ".concat(e.navigationContext.appName,", because it has been incorrectly configured for space ").concat(s.spaceId),{game:s,navigationContext:e.navigationContext,logCategory:f.kinderGarden,errorCode:g.FailedNavigationIncorrectSpaceConfigurationWarning});else{const l={...e.navigationContext,game:s,parentAppName:a};n=await this._store.dispatchIntent(new Be(l,{shouldFocusWindow:!0}));const v=(o=this._store.getReadonlyState(M).findMicroAppConfig(e.navigationContext.appName,a))==null?void 0:o.meta.label;v&&(document.title=v)}return new xo({isSuccessful:n})}removeChild(e,t){this._logger.debug(xi.RemoveChild,{childId:e}),t.disconnect(),t.window&&!t.window.closed&&t.window.close(),this._children.delete(e)}closeAllChildWindows(){this._logger.debug(xi.RemoveAllChildren),this._children.forEach(e=>{e.disconnect(),e.window.close()}),this._children.clear()}}Dg([_()],Pl.prototype,"onRuntimeContextUpdateNotification",1);Dg([_()],Pl.prototype,"processInitialSyncNotification",1);Dg([_()],Pl.prototype,"processNavigateRequest",1);class Og extends d("[Shell] Send game invite"){constructor(e,t,s){super(),this.profileId=e,this.gameId=t,this.gameSessionReference=s}}class JO extends d("[Shell] Send channel game invite"){constructor(e,t,s){super(),this.channelId=e,this.gameId=t,this.gameSessionReference=s}}class YO extends d("[Shell] Accept game invite"){constructor(e,t,s){super(),this.profileId=e,this.gameId=t,this.gameSessionReference=s}}class ZO extends d("[Shell] decline game invite"){constructor(e,t,s){super(),this.profileId=e,this.gameId=t,this.gameSessionReference=s}}class eF extends d("[Gamepad] Get current Game Invites"){}class tF extends d("[Gamepad] Subscribe to Game Invites Events"){constructor(e,t){super(),this.spaceId=e,this.callback=t}}class iF extends d("[Gamepad] Unsubscribe from Game Invites Events"){constructor(e){super(),this.spaceId=e}}class sF extends d("[Gamepad] Receive Game Invite Notification from Host"){constructor(e){super(),this.notification=e}}class aF extends d("[Gamepad] Receive Game Invite Event from anywhere"){constructor(e){super(),this.gameInvite=e}}class nF extends d("[Shell] Join game"){constructor(e,t,s){super(),this.profileId=e,this.gameId=t,this.gameSessionReference=s}}class rF extends d("[Shell] Get Game Session"){}class oF extends d("[Shell App] Set Micro App Hot Keys"){constructor(e,t){super(),this.appConfig=e,this.buttons=t}}class mu extends d("[Shell App] Set Shell Hot Keys"){constructor(e){super(),this.buttons=e}}class cF extends d("[Shell App] Remove Shell Hot Keys"){constructor(e){super(),this.buttons=e}}class lF extends d("[Shell App] Set Micro App Legend Items"){constructor(e,t){super(),this.appConfig=e,this.items=t}}class pF extends d("[Shell App] Set Shell Legend Items"){constructor(e){super(),this.items=e}}class uF extends d("[Shell App] Set Global Shell Legend Items"){constructor(e){super(),this.items=e}}class dF extends d("[Shell] Get streaming host status"){}class hF extends d("[Shell] Kick guest streaming"){constructor(e){super(),this.guestId=e}}class gF extends d("[Shell] Set streaming guest settings"){constructor(e,t){super(),this.guestId=e,this.settings=t}}class mF extends d("[Shell] Set streaming session settings"){constructor(e){super(),this.settings=e}}class fF extends d("[Shell] Start streaming"){}class yF extends d("[Shell] Stop streaming"){}class vF extends d("[Shell] Create streaming token"){constructor(e){super(),this.tokenSettings=e}}class _F extends d("[Shell] Generate invite link"){constructor(e){super(),this.token=e}}class SF extends d("[Shell] Subscribe to streaming host status update"){constructor(e,t){super(),this.spaceId=e,this.callback=t}}class wF extends d("[Shell] Receive streaming host status update"){constructor(e){super(),this.streamingHostStatus=e}}class Fg extends d("[Shell] Unsubscribe from streaming host status update"){constructor(e){super(),this.spaceId=e}}class bF extends d("[Shell] Subscribe to streaming host metrics update"){constructor(e,t){super(),this.spaceId=e,this.callback=t}}class CF extends d("[Shell] Receive streaming host metrics update"){constructor(e){super(),this.streamingHostMetrics=e}}class IF extends d("[Shell] Unsubscribe from streaming host metrics update"){constructor(e){super(),this.spaceId=e}}class MF extends d("[Shell] Subscribe to streaming guest status update"){constructor(e,t){super(),this.spaceId=e,this.callback=t}}class AF extends d("[Shell] Receive streaming guest status update"){constructor(e){super(),this.streamingGuestStatus=e}}class PF extends d("[Shell] Unsubscribe from streaming guest status update"){constructor(e){super(),this.spaceId=e}}class NF extends d("[Shell] Subscribe to streaming guest metrics update"){constructor(e,t){super(),this.spaceId=e,this.callback=t}}class TF extends d("[Shell] Receive streaming metrics update"){constructor(e){super(),this.streamingGuestMetrics=e}}class RF extends d("[Shell] Unsubscribe from streaming metrics update"){constructor(e){super(),this.spaceId=e}}class DF extends d("[Shell] Get streaming guest status"){}class OF extends d("[Shell] Join streaming"){constructor(e,t){super(),this.inviteToken=e,this.useCaseContext=t}}class FF extends d("[Shell] Leave streaming"){}class gV extends d("[Shell] Get guests avatars"){constructor(e){super(),this.guestsProfileIds=e}}class Lg extends d("[Shell App] Set Title Bar Title"){constructor(e,t){super(),this.appConfig=e,this.title=t}}class LF extends d("[Shell App] Set Subtitle Bar Title"){constructor(e,t){super(),this.appConfig=e,this.subtitle=t}}class Gg extends d("[ShellApp]ResetTitleBarTitleToAppLabel"){constructor(e){super(),this.appConfig=e}}class Nl extends d("[Shell] Scroll Title Bar Intent"){constructor(e){super(),this.event=e}}var jr=(i=>(i.Navigation="Navigation",i.Api="Api",i.Backdrop="Backdrop",i.Shortcut="Shortcut",i))(jr||{});const mV=i=>{switch(i){case"Navigation":return Qn.Navigation;case"Api":return Qn.ModalApiClosing;case"Backdrop":return Qn.ModalBackdropClosing;case"Shortcut":return Qn.ModalShortcutClosing}};class xg{constructor(e,t){this.v1=new fV(e,t)}}class fV{constructor(e,t){this._store=e,this._spaceId=t}getGameSession(){return this._store.dispatchIntent(new rF)}sendGameInvite(e,t,s){return this._store.dispatchIntent(new Og(e,t,s))}sendChannelGameInvite(e,t,s){return this._store.dispatchIntent(new JO(e,t,s))}acceptGameInvite(e,t,s){return this._store.dispatchIntent(new YO(e,t,s))}declineGameInvite(e,t,s){return this._store.dispatchIntent(new ZO(e,t,s))}getCurrentGameInvites(){return this._store.dispatchIntent(new eF)}observeGameInvites(e){return this._store.dispatchIntent(new tF(this._spaceId,e))}joinGame(e,t,s){return this._store.dispatchIntent(new nF(e,t,s))}}class na extends De{constructor(e,t){super("API Validation Error: "+e),this.appName=t}}var yV=Object.defineProperty,vV=Object.getOwnPropertyDescriptor,_V=(i,e,t,s)=>{for(var a=s>1?void 0:s?vV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&yV(e,t,a),a};class ye extends oe("[Shell] Focus"){constructor(){super(...arguments),this._isFocusSystemActive=!1,this._isContainerNavigationInProgress=!1,this._currentlyFocusedContainerId=null,this._previouslyFocusedContainerId=null,this._placementMap={}}get isFocusSystemActive(){return this._isFocusSystemActive}set isFocusSystemActive(e){this._isFocusSystemActive=e}get isContainerNavigationInProgress(){return this._isContainerNavigationInProgress}set isContainerNavigationInProgress(e){this._isContainerNavigationInProgress=e}get currentlyFocusedContainerId(){return this._currentlyFocusedContainerId}set currentlyFocusedContainerId(e){this._currentlyFocusedContainerId!==e&&(this._currentlyFocusedContainerId&&(this._previouslyFocusedContainerId=this._currentlyFocusedContainerId),this._currentlyFocusedContainerId=e)}get previouslyFocusedContainerId(){return this._previouslyFocusedContainerId}set previouslyFocusedContainerId(e){this._previouslyFocusedContainerId=e}getFocusableContainerId(e){return this._placementMap[e]}registerFocusableContainer(e){const{placement:t,value:s}=e;this._placementMap[t]=s,this._placementMap={...this._placementMap}}}_V([P],ye.prototype,"registerFocusableContainer",1);class SV{constructor(e,t,s){this._config=e,this._logger=t,this._store=s}async validate(e,t,s,a){await Promise.all(a.map(n=>n(e,t,s)))}async validateDispose(e,t,s){if(s={appConfig:this._config,...s},!!e.isDisposed())throw this._logger.warn("".concat(t," call from ").concat(this._config.appName," after dispose"),{data:s,logCategory:f.api,errorCode:g.FailedCallFromMicroappAfterAPIDisposedWarning}),new na("Object disposed",this._config.appName)}async validateMicroAppInPlacement(e,t,s,a){if(this._config.placement!==t)throw this._logger.warn("".concat(s," call from ").concat(this._config.appName," is not allowed from ").concat(this._config.placement," placement"),{data:a,logCategory:f.api}),new na("Method is not allowed for current placement",this._config.appName)}async validateMicroAppActive(e,t,s){var n,r;const a=this._store.getReadonlyState(M);if(![(n=a.getActiveMicroApp(this._config.placement))==null?void 0:n.appName,(r=a.getActivatingMicroApp(this._config.placement))==null?void 0:r.appName].includes(this._config.appName))throw this._logger.warn("".concat(t," call from ").concat(this._config.appName," when deactivated"),{data:s,logCategory:f.api,errorCode:g.FailedCallFromMicroappAfterDeactivationWarning}),new na("Microapp inactive",this._config.appName)}async validateContainerNavigationNotInProgress(e,t,s){if(this._store.getReadonlyState(ye).isContainerNavigationInProgress)throw this._logger.warn("".concat(t," call from ").concat(this._config.appName," during another container navigation"),{data:s,logCategory:f.api,errorCode:g.FailedCallFromMicroappDuringNavigationWarning}),new na("Container navigation is in progress",this._config.appName)}async validatePlatformType(e,t,s,a){const n=this._store.getReadonlyState(S);if(!t.includes(n.hostPlatformType))throw this._logger.warn("".concat(s," call from ").concat(this._config.appName," is not allowed on ").concat(n.hostPlatformType),{data:a,currentPlatform:n.hostPlatformType,validPlatforms:t,logCategory:f.api,errorCode:g.FailedCallFromMicroappNotAllowedOnHostPlatformWarning}),new na("Method is not allowed on current platform",this._config.appName)}}class Et{constructor(){this._isDisposed=!1}dispose(){this._isDisposed=!0}isDisposed(){return this._isDisposed}}class Tl extends Et{constructor(){super(),this._featuresByHandlerNameMap=this.constructor.featuresByHandlerNameMap}reduce(e){if(!this._featuresByHandlerNameMap)return;let t=!1,s=bd(this);for(const[a,n]of this._featuresByHandlerNameMap.entries())n.every(r=>e.includes(r))?t||(t=!0):s=Object.assign(s,{[a]:void 0});return t?s:void 0}}class Eg extends Et{reduce(e){let t=!1,s=bd(this);for(const[a,n]of Object.entries(this))if(n instanceof Tl){const r=n.reduce(e);r?(ba(n,r)||(s=Object.assign(s,{[a]:r})),t||(t=!0)):s=Object.assign(s,{[a]:void 0})}return t?s:void 0}}function bs(i){return function(e,t){if(i.length>0){const s=e.constructor;s.featuresByHandlerNameMap=s.featuresByHandlerNameMap||new Map,s.featuresByHandlerNameMap.set(t,i)}}}var wV=Object.defineProperty,bV=Object.getOwnPropertyDescriptor,CV=(i,e,t,s)=>{for(var a=s>1?void 0:s?bV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&wV(e,t,a),a};class IV extends Eg{constructor(e,t){super(),this.v1=new GF(e,t)}dispose(){var e;super.dispose(),(e=this.v1)==null||e.dispose()}}class GF extends Tl{constructor(e,t){super(),this._store=e,this._apiValidatorService=t}async hide(){var e;return await ((e=this._apiValidatorService)==null?void 0:e.validate(this,"hide",{},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService),this.isOverlayValidator.bind(this._apiValidatorService)])),this._store.dispatchIntent(new Gt(_e.MicroAppRequested))}async isOverlayValidator(e,t,s){return this.validatePlatformType(e,[p.PCWebOverlay,p.PCLegacyOverlay,p.PCElectronOverlay,p.SteamOverlay],t,s)}}CV([bs([c.HideOverlay])],GF.prototype,"hide",1);class xF extends d("[Shell] Browser View Create"){constructor(e,t,s,a,n){super(),this.url=e,this.onNavigateHandler=t,this.onCloseHandler=s,this.appConfig=a,this.cookies=n}}class Ug extends d("[Shell] Browser View Destroy"){constructor(e){super(),this.appName=e}}class EF extends d("[Shell] Browser View On Navigate Notification"){constructor(e){super(),this.notification=e}}class UF extends d("[Shell] Browser View On Closed Notification"){constructor(e){super(),this.notification=e}}class fu extends d("[Shell] Micro App Browser View Container Resized"){constructor(e){super(),this.target=e}}class kF extends d("[Shell] Browser View Microapp Deactivated"){constructor(e){super(),this.appConfig=e}}class WF extends d("[Shell] Browser View Microapp Activated"){constructor(e){super(),this.appConfig=e}}class VF extends d("[Shell] Browser View Microapp Unmounted"){constructor(e){super(),this.appName=e}}class kg extends d("[Shell] Browser View Toggle Visibility"){constructor(e,t){super(),this.appName=e,this.toggle=t}}class $F extends d("[Shell] Browser View Set Url"){constructor(e,t){super(),this.appName=e,this.url=t}}class BF extends d("[Shell] Browser View Get Url"){constructor(e){super(),this.appName=e}}class HF extends d("[Shell] Browser View Post Message"){constructor(e,t){super(),this.appName=e,this.message=t}}class QF extends d("[Shell] Browser View On Message Notification"){constructor(e){super(),this.notification=e}}class jF extends d("[Shell] Browser View Subscribe To Message"){constructor(e,t){super(),this.appName=e,this.callback=t}}class qF extends d("[Shell] Browser View Add Cookies"){constructor(e,t){super(),this.appName=e,this.cookies=t}}var MV=Object.defineProperty,AV=Object.getOwnPropertyDescriptor,Ia=(i,e,t,s)=>{for(var a=s>1?void 0:s?AV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&MV(e,t,a),a};class js extends Tl{constructor(e,t,s){super(),this._store=e,this._appConfig=t,this._apiValidationService=s}async destroy(){var e;return await ((e=this._apiValidationService)==null?void 0:e.validate(this,"destroy",{},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new Ug(this._appConfig.appName))}async create(e,t,s,a=[]){var n;return await ((n=this._apiValidationService)==null?void 0:n.validate(this,"create",{url:e,onNavigateHandler:t,onCloseHandler:s},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new xF(e,t,s,this._appConfig,a))}async setCookies(e){return this._store.dispatchIntent(new qF(this._appConfig.appName,e))}async toggleVisibility(e){var t;return await ((t=this._apiValidationService)==null?void 0:t.validate(this,"toggleVisibility",{toggle:e},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new kg(this._appConfig.appName,e))}async setUrl(e){var t;return await ((t=this._apiValidationService)==null?void 0:t.validate(this,"setUrl",{url:e},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new $F(this._appConfig.appName,e))}async getUrl(){var e;return await ((e=this._apiValidationService)==null?void 0:e.validate(this,"getUrl",{},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new BF(this._appConfig.appName))}async postMessage(e){var t;return await ((t=this._apiValidationService)==null?void 0:t.validate(this,"postMessage",{message:e},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new HF(this._appConfig.appName,e))}async onMessage(e){var t;return await ((t=this._apiValidationService)==null?void 0:t.validate(this,"onMessage",{callback:e},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new jF(this._appConfig.appName,e))}}Ia([bs([c.BrowserViewDestroy])],js.prototype,"destroy",1);Ia([bs([c.BrowserViewCreate])],js.prototype,"create",1);Ia([bs([c.BrowserViewShow,c.BrowserViewHide])],js.prototype,"toggleVisibility",1);Ia([bs([c.BrowserViewSetUrl])],js.prototype,"setUrl",1);Ia([bs([c.BrowserViewGetUrl])],js.prototype,"getUrl",1);Ia([bs([c.BrowserViewPostMessage])],js.prototype,"postMessage",1);Ia([bs([c.BrowserViewOnMessage])],js.prototype,"onMessage",1);class PV extends Eg{constructor(e,t,s){super(),this.v1=new js(e,t,s)}dispose(){var e;super.dispose(),(e=this.v1)==null||e.dispose()}}class Wg{constructor(e,t){this.v1=new NV(e,t)}}class NV{constructor(e,t){this._store=e,this._spaceId=t}async getCache(e,t=Wp.ApolloV3,s=!1){return this._store.dispatchIntent(new wO(this._spaceId,t,s))}}class zF extends d("[Shell] Get Focus System"){constructor(e){super(),this.appName=e}}class TV extends Et{constructor(e,t){super(),this.wip=new RV(e,t)}}class RV extends Et{constructor(e,t){super(),this._store=e,this._appName=t}async getFocusSystem(){return this._focusSystem||(this._focusSystem=await this._store.dispatchIntent(new zF(this._appName)))}async enableSupportForSingleInstance(e){return this._store.dispatchIntent(new JD(e))}}const DV=Ht;class OV extends Et{constructor(e,t,s){super(),this._store=e,this._appName=t,this._apiValidationService=s}async getAvailableMicroApps(e){var a;await ((a=this._apiValidationService)==null?void 0:a.validate(this,"getAvailableMicroApps",{options:e},[this._apiValidationService.validateDispose.bind(this._apiValidationService)]));const t=await this._store.dispatchIntent(new dO(e));return this._store.getReadonlyState(S).isExclusiveMode?t.filter(n=>n.appName===this._appName):t}async isMicroAppAvailable(e){var s,a;await ((s=this._apiValidationService)==null?void 0:s.validate(this,"isMicroAppAvailable",{options:e},[this._apiValidationService.validateDispose.bind(this._apiValidationService)]));const t=this._store.getReadonlyState(S);return t.isExclusiveMode&&this._appName!==e.appName?!1:this._store.dispatchIntent(new Ci(e.appName,(a=e.game)!=null?a:t.activeGame,e.parentAppName))}async navigate(e,t){var r;if(t!=null&&t.afterDefaultNavigation)try{await q(DV,this._store.getReadonlyState(M).defaultNavigationCompleted)}catch(o){return Promise.reject("Micro app navigation failed because navigation to default micro apps has timed out")}const s=this._store.getReadonlyState(S),a=e.game!==void 0?e.game:s.activeGame,n={appName:e.appName,game:a,applicationData:e.applicationData,parentAppName:e.parentAppName};if(s.isExclusiveMode&&e.appName!==this._appName)return Promise.reject("Navigation to another micro application is not allowed in exclusive mode.");try{return await ((r=this._apiValidationService)==null?void 0:r.validate(this,"navigate",{navigationContext:e},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new Be(n,{direction:ci.forwards,callerMicroAppName:this._appName,...t}))}catch(o){return!1}}}class Vg extends Et{constructor(e,t,s){super(),this.v1=new OV(e,t,s)}dispose(){super.dispose(),this.v1.dispose()}}class qr extends d("[Shell] Show Modal"){constructor(e,t){super(),this.appName=e,this.config=t}}class qi extends d("[Shell] Close Modal"){}class $g extends d("[Shell] Modal Backdrop Click"){}class KF extends d("[Shell] Modal Viewport Position"){constructor(e){super(),this.viewportPosition=e}}class FV extends Et{constructor(e,t,s){super(),this.v1=new LV(e,t,s),this.v2=new GV(e,t,s)}}class LV extends Et{constructor(e,t,s){super(),this._store=e,this._apiValidatorService=t,this._appConfig=s}async showModal(e,t){return await this._apiValidatorService.validate(this,"showModal",{closeModalCallback:e,shouldCloseOnClickBackdrop:t},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService)]),this._store.dispatchIntent(new qr(this._appConfig.appName,{onModalClose:e,shouldCloseOnClickBackdrop:t}))}async closeModal(){await this._apiValidatorService.validate(this,"closeModal",{},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService)]),this._store.dispatchIntent(new qi)}}class GV extends Et{constructor(e,t,s){super(),this._store=e,this._apiValidatorService=t,this._appConfig=s}async showModal(e){return await this._apiValidatorService.validate(this,"showModal",e!=null?e:{},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService)]),this._store.dispatchIntent(new qr(this._appConfig.appName,e))}async closeModal(){await this._apiValidatorService.validate(this,"closeModal",{},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService)]),this._store.dispatchIntent(new qi)}}class xV{constructor(e){this.v1=new EV(e)}}class EV{constructor(e){this._store=e}async openExternalLink(e){return this._store.dispatchIntent(new sO(e))}}class Bg{constructor(e,t){this.v1=new UV(e,t)}}class UV{constructor(e,t){this._store=e,this._uniqueSubscriberId="".concat(t,"-").concat(qt.newId())}async renewPlayerNotificationWebSocketConnection(){return this._store.dispatchIntent(new ID)}async observe(e){return this._store.dispatchIntent(new ur(e,this._uniqueSubscriberId))}async unobserve(e){return this._store.dispatchIntent(new pg(e))}async configure(e){return this._store.dispatchIntent(new pr(this._uniqueSubscriberId,e))}}class Hg{constructor(e,t,s){this.v1=new kV(e,t,s)}}class kV{constructor(e,t,s){this._store=e,this._featureHandlerService=t,this._spaceId=s}async getItem(e,t){var a;const s=await this._featureHandlerService.handleFeature(c.GetSecureStorageData,{key:e,callerSpaceId:this._spaceId,bucketSpaceId:t!=null?t:this._spaceId});return(a=s==null?void 0:s.response)==null?void 0:a.value}async setItem(e,t,s={isPrivate:!0,expirationTime:0}){var n;const a=await this._featureHandlerService.handleFeature(c.SetSecureStorageData,{key:e,callerSpaceId:this._spaceId,value:t,isPrivate:s.isPrivate,expirationTime:s.expirationTime});return((n=a==null?void 0:a.response)==null?void 0:n.isSuccessful)||!1}async deleteItem(e){var s;const t=await this._featureHandlerService.handleFeature(c.DeleteSecureStorageData,{key:e,callerSpaceId:this._spaceId});return((s=t==null?void 0:t.response)==null?void 0:s.isSuccessful)||!1}}class WV{constructor(e,t){this._store=e,this._spaceId=t}async join(e,t){return this._store.dispatchIntent(new OF(e,t||uE.SharePlay))}async leave(){return this._store.dispatchIntent(new FF)}async getStatusUpdate(){return this._store.dispatchIntent(new DF)}async observeStatusUpdate(e){return this._store.dispatchIntent(new MF(this._spaceId,e))}async unobserveStatusUpdate(){return this._store.dispatchIntent(new PF(this._spaceId))}async observeMetricsUpdate(e){return this._store.dispatchIntent(new NF(this._spaceId,e))}async unobserveMetricsUpdate(){return this._store.dispatchIntent(new RF(this._spaceId))}}const VV=5,$V=3;class BV{constructor(e,t){this._store=e,this._spaceId=t}async start(){return this._store.dispatchIntent(new fF)}async stop(){return this._store.dispatchIntent(new yF)}async createToken(e){return this._store.dispatchIntent(new vF({tokenExpirationDuration:(e==null?void 0:e.tokenExpirationDuration)||VV,tokenMaxUsageCount:(e==null?void 0:e.tokenMaxUsageCount)||$V}))}async generateInviteLink(e){return this._store.dispatchIntent(new _F(e))}async getStatusUpdate(){return this._store.dispatchIntent(new dF)}async kick(e){return this._store.dispatchIntent(new hF(e))}async observeStatusUpdate(e){return this._store.dispatchIntent(new SF(this._spaceId,e))}async unobserveStatusUpdate(){return this._store.dispatchIntent(new Fg(this._spaceId))}async observeMetricsUpdate(e){return this._store.dispatchIntent(new bF(this._spaceId,e))}async unobserveMetricsUpdate(){return this._store.dispatchIntent(new IF(this._spaceId))}setGuestSettings(e,t){return this._store.dispatchIntent(new gF(e,t))}setSessionSettings(e){return this._store.dispatchIntent(new mF(e))}}class Qg{constructor(e,t,s){this.v1=new HV(e,t,s)}}class HV{constructor(e,t,s){this.host=s?new BV(e,t):void 0,this.client=new WV(e,t)}}var QV=Object.defineProperty,jV=Object.getOwnPropertyDescriptor,qV=(i,e,t,s)=>{for(var a=s>1?void 0:s?jV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&QV(e,t,a),a};class zV extends Eg{constructor(e,t){super(),this.v1=new XF(e,t)}dispose(){var e;super.dispose(),(e=this.v1)==null||e.dispose()}}class XF extends Tl{constructor(e,t){super(),this._store=e,this._apiValidationService=t}async sendTrackingData(e,t){var s;await ((s=this._apiValidationService)==null?void 0:s.validate(this,"sendTrackingData",{eventName:e,eventData:t},[this._apiValidationService.validateDispose.bind(this._apiValidationService),this._apiValidationService.validateMicroAppActive.bind(this._apiValidationService)])),this._store.dispatchIntent(new SO(e,t))}}qV([bs([c.SendAdobeAnalyticData])],XF.prototype,"sendTrackingData",1);class it extends oe("ViewModeState"){constructor(){super(...arguments),this._viewportMode=xs.sideView,this._navigationBarViewMode=sS.visible,this._sidebarViewMode=aS.breakpoints,this._sidebarViewState=dE.expanded,this._titleBarViewMode=Ja.expanded}get viewportMode(){return this._viewportMode}set viewportMode(e){this._viewportMode=e}get navigationBarViewMode(){return this._navigationBarViewMode}set navigationBarViewMode(e){this._navigationBarViewMode=e}get titleBarViewMode(){return this._titleBarViewMode}set titleBarViewMode(e){this._titleBarViewMode=e}get sidebarViewMode(){return this._sidebarViewMode}set sidebarViewMode(e){this._sidebarViewMode=e}get sidebarViewState(){return this._sidebarViewState}set sidebarViewState(e){this._sidebarViewState=e}}class KV extends Et{constructor(e,t,s){super(),this.v1=new XV(e,t,s)}dispose(){super.dispose(),this.v1.dispose()}}class XV extends Et{constructor(e,t,s){super(),this._store=e,this._appConfig=t,this._apiValidatorService=s}getMicroAppViewMode(){const e=this._store.getReadonlyState(it);return Promise.resolve(e.viewportMode)}async updateMicroAppViewMode(e){var t;return await ((t=this._apiValidatorService)==null?void 0:t.validate(this,"updateMicroAppViewMode",{mode:e},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService)])),this._store.dispatchIntent(new vl(e))}getTitleBarViewMode(){const e=this._store.getReadonlyState(it);return Promise.resolve(e.titleBarViewMode)}async updateTitleBarViewMode(e){var t;return await ((t=this._apiValidatorService)==null?void 0:t.validate(this,"updateTitleBarViewMode",{mode:e},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService)])),this._store.dispatchIntent(new hg(e))}getNavigationBarViewMode(){const e=this._store.getReadonlyState(it);return Promise.resolve(e.navigationBarViewMode)}async updateNavigationBarViewMode(e){var t;return await ((t=this._apiValidatorService)==null?void 0:t.validate(this,"updateNavigationBarVisibility",{mode:e},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService)])),this._store.dispatchIntent(new dg(e))}async observeResizeOnMicroAppContainer(e){var t;return await ((t=this._apiValidatorService)==null?void 0:t.validate(this,"observeResizeOnMicroAppContainer",{callback:e},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService)])),this._store.dispatchIntent(new pu(this._appConfig,e))}async genericObserveResizeOnMicroAppContainer(e,t){var s;return await ((s=this._apiValidatorService)==null?void 0:s.validate(this,"genericObserveResizeOnMicroAppContainer",{callback:t,enumVariable:e},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService)])),this._store.dispatchIntent(new pu(this._appConfig,t,e))}async unobserveResizeOnMicroAppContainer(){var e;return await ((e=this._apiValidatorService)==null?void 0:e.validate(this,"unobserveResizeOnMicroAppContainer",{},[this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService)])),this._store.dispatchIntent(new hn(this._appConfig))}async getSidebarViewMode(){var t;return await ((t=this._apiValidatorService)==null?void 0:t.validate(this,"getSidebarViewMode",{},[this.validatePCClientPlatformType.bind(this._apiValidatorService)])),this._store.getReadonlyState(it).sidebarViewMode}async setSidebarViewMode(e){var t;return await ((t=this._apiValidatorService)==null?void 0:t.validate(this,"setSidebarViewMode",{mode:e},[this.validatePCClientPlatformType.bind(this._apiValidatorService),this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService),this.validateSidePlacement.bind(this._apiValidatorService)])),this._store.dispatchIntent(new LD(e))}async getSidebarViewState(){var t;return await ((t=this._apiValidatorService)==null?void 0:t.validate(this,"getSidebarViewState",{},[this.validatePCClientPlatformType.bind(this._apiValidatorService)])),this._store.getReadonlyState(it).sidebarViewState}async setSidebarViewState(e){var t;return await ((t=this._apiValidatorService)==null?void 0:t.validate(this,"setSidebarViewState",{state:e},[this.validatePCClientPlatformType.bind(this._apiValidatorService),this._apiValidatorService.validateDispose.bind(this._apiValidatorService),this._apiValidatorService.validateMicroAppActive.bind(this._apiValidatorService),this.validateSidePlacement.bind(this._apiValidatorService)])),this._store.dispatchIntent(new GD(e))}async validateSidePlacement(e,t,s){return this.validateMicroAppInPlacement(e,B.side,t,s)}async validatePCClientPlatformType(e,t,s){return this.validatePlatformType(e,[p.PCWebClient,p.PCElectronClient,p.PCLegacyClient,p.SteamClient],t,s)}}var JV=Object.defineProperty,YV=Object.getOwnPropertyDescriptor,Jt=(i,e,t,s)=>{for(var a=s>1?void 0:s?YV(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&JV(e,t,a),a};const mf=["playerNotificationsConnectionState","playerSession","isOnline","isOverlayVisible"];class It extends Et{constructor(e,t,s,a,n,r,o=new SV(t,s,e)){var w,b;super(),this._store=e,this._appConfig=t,this._logger=s,this._pluginsService=a,this._featureHandlerService=n,this._pcClientWrapper=r,this._microAppApiValidationService=o,this._observers=[],this._ubiServices=null,this._unusedGameSessionId="unused",this._playerNotificationCallbacks=new Set,this._runtimeContextUpdateRevision=0,this._uniqueSubscriberId="".concat(this._appConfig.appName,"-").concat(qt.newId()),this._pcClientWrapper&&(this._pcClientProxy=pe.new(this._pcClientWrapper),this._gameInvitesProxy=pe.new(new xg(e,t.spaceId))),this._applicationProxy=pe.new(new IV(e,this._microAppApiValidationService)),this._streamingProxy=pe.new(new Qg(e,t.spaceId,((w=this._pcClientProxy)==null?void 0:w.proxy)!==void 0)),this._cachesApiProxy=pe.new(new Wg(e,t.spaceId)),this._playerNotificationsApiProxy=pe.new(new Bg(e,t.appName)),this._secureStorageApiProxy=pe.new(new Hg(e,n,this._appConfig.spaceId)),this._modalProxy=pe.new(new FV(e,this._microAppApiValidationService,t)),this._focusSystemProxy=pe.new(new TV(e,t.appName));const l=new KV(e,t,this._microAppApiValidationService);this._viewModeProxy=pe.new(l);const u=new Vg(e,t.appName,this._microAppApiValidationService);this._microAppsProxy=pe.new(u);const v=new xV(e);if(this._navigationApiProxy=pe.new(v),(b=this.hostFeatures)!=null&&b.length){const I=new PV(e,this._appConfig,this._microAppApiValidationService).reduce(this.hostFeatures);I&&(this._browserViewProxy=pe.new(I));const R=new zV(this._store,this._microAppApiValidationService).reduce(this.hostFeatures);R&&(this._adobeTrackingProxy=pe.new(R))}}get hostFeatures(){return this._store.getReadonlyState(Q).hostFeatures}async addCachingEntries(e){return this.validate(this,"addCachingEntries",{definitions:e},this.validateDispose).then(()=>this._store.dispatchIntent(new In(e)))}async removeCachingEntries(e){return this.validate(this,"removeCachingEntries",{definitions:e},this.validateDispose).then(()=>this._store.dispatchIntent(new wl(e)))}set applicationId(e){this._applicationId=e}set applicationBuildId(e){this._applicationBuildId=e}getLogger(){if(this._applicationLogger)return Promise.resolve(this._applicationLogger);const{applicationName:e,applicationId:t}=this.applicationConfig,{context:s}=this._logger.settings,a={logSource:e,logCategory:f.uncategorized};s&&(a.context=s);const n=this._store.getReadonlyState(S);this._applicationLogger=this._logger.createApplicationLogger(e,t,a);const r=!!n.childId,l=[{level:"All",transport:r?ds.ParentRemoteLogTransport:Wt.remoteLogger},{level:[Te.Info,Te.Warning,Te.Error],transport:Wt.persistentQueue},{level:[Te.Info,Te.Warning,Te.Error],transport:Wt.console}];n.hostPlatformType===p.PCElectronClient&&!r&&l.push({level:"All",transport:ds.DesktopAppLogTransport}),this._applicationLogger.setRules(l);const v=this._logger.getDefaultTransport(ir).createQueue(t);return v.shouldFetchOutputParameters=!0,v.applicationConfig=this.applicationConfig,Promise.resolve(this._applicationLogger)}async navigate(e){this._logger.debug("".concat(this._appConfig.appName,": Navigate call to ").concat(e.appName),{navigationContext:e,logCategory:f.api});const t=this._store.getReadonlyState(S),s=e.game!==void 0?e.game:t.activeGame;let a=null;try{a=await this._store.dispatchIntent(new Xe(e.appName,s))}catch(r){this._logger.info("Error thrown trying to get parentAppName for ".concat(e.appName,", spaceId: ").concat(s.spaceId,". Using null as fallback."),{game:s,navigationContext:e,logCategory:f.api,error:r})}if(a===void 0)return this._logger.warn("Unable to navigate to micro app ".concat(e.appName,", because it has been incorrectly configured for space ").concat(s.spaceId,". Please use the microApps.v1.navigate api call instead."),{game:s,navigationContext:e,logCategory:f.api,errorCode:g.FailedNavigationIncorrectSpaceConfigurationWarning}),!1;const n={appName:e.appName,game:s,applicationData:e.applicationData,parentAppName:a};return t.isExclusiveMode&&e.appName!==this._appConfig.appName?(this._logger.warn("Navigation to another micro application is not allowed in exclusive mode",{errorCode:g.CannotNavigateToMicroappInExclusiveModeWarning}),!1):this.validate(this,"navigate",{navigationContext:e},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new Be(n,{direction:ci.forwards,callerMicroAppName:this._appConfig.appName}))).catch(()=>!1)}navigateBack(){return this._logger.debug("".concat(this._appConfig.appName,": Navigate back call"),{logCategory:f.api}),this.validate(this,"navigateBack",{},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new gs(this._appConfig.placement)))}addToNavigationHistory(e){return this._logger.debug("".concat(this._appConfig.appName,": Add to navigation history call"),{item:e.applicationData,logCategory:f.api}),this.validate(this,"addToNavigationHistory",{historyEntry:e},this.validateDispose,this.validateMicroAppActive).then(()=>{const t=this._store.getReadonlyState(S),s={appName:this._appConfig.appName,game:t.activeGame,applicationData:e.applicationData,parentAppName:this._appConfig.parentAppName};return this._store.dispatchIntent(new yg(this._appConfig,s))})}pushToNavigationHistory(e){return this._logger.debug("".concat(this._appConfig.appName,": Push to navigation history call"),{item:e,logCategory:f.api}),this.validate(this,"pushToNavigationHistory",{applicationData:e},this.validateDispose,this.validateMicroAppActive).then(()=>{const t=this._store.getReadonlyState(S),s={appName:this._appConfig.appName,game:t.activeGame,applicationData:e,parentAppName:this._appConfig.parentAppName};this._store.getReadonlyState(M).navigatingMicroApp(this._appConfig.placement)!==void 0?this._store.dispatchIntent(new ZD(this._appConfig,s)):this._store.dispatchIntent(new YD(this._appConfig,s))})}replaceCurrentNavigationHistoryItem(e){return this._logger.debug("".concat(this._appConfig.appName,": Replace current navigation history item call"),{item:e,logCategory:f.api}),this.validate(this,"replaceCurrentNavigationHistoryItem",{applicationData:e},this.validateDispose,this.validateMicroAppActive).then(()=>{const t=this._store.getReadonlyState(S),s={appName:this._appConfig.appName,game:t.activeGame,applicationData:e,parentAppName:this._appConfig.parentAppName};this._store.dispatchIntent(new eO(this._appConfig,s))})}async closeMicroAppModal(){return await this.validateDispose(this,"closeMicroAppModal",{}),await this._store.dispatchIntent(new $r(jr.Api))}async getGameSpecificMicroApps(e){this._logger.debug("".concat(this._appConfig.appName,": Call to get game specific apps"),{game:e,logCategory:f.api}),await this.validateDispose(this,"getGameSpecificMicroApps",{game:e});const t=this._store.getReadonlyState(S),s=await this._store.dispatchIntent(new ms(e));return t.isExclusiveMode?s.filter(a=>a.appName===this._appConfig.appName):s}getTransversalMicroApps(){return this._logger.debug("".concat(this._appConfig.appName,": Call to get transversal apps"),{logCategory:f.api}),this.validateDispose(this,"getTransversalApps",{}).then(()=>{const e=this._store.getReadonlyState(S);return e.isExclusiveMode?this._store.getReadonlyState(M).isTopLevelAppBySpaceId(this._appConfig.spaceId,e.hostGame.spaceId)?[this._appConfig]:[]:this._store.dispatchIntent(new ms)})}isMicroAppAvailable(e,t){this._logger.debug("".concat(this._appConfig.appName,": Call to check if ").concat(e," is available"),{logCategory:f.api});const s=this._store.getReadonlyState(S);return this.validateDispose(this,"isMicroAppAvailable",{appName:e,game:t}).then(async()=>{if(s.isExclusiveMode&&this._appConfig.appName!==e)return Promise.resolve(!1);const a=t!=null?t:s.activeGame,n=await this._store.dispatchIntent(new Xe(e,a));return n!==void 0&&await this._store.dispatchIntent(new Ci(e,a,n))})}observeRuntimeContext(e){const t=this.createObserver(e,this._store.getReadonlyState(M));return this.validateDispose(this,"observeRuntimeContext",{}).then(()=>this._store.dispatchIntent(new Er(t))).then(()=>{this._observers.push(t)})}observeGamepad(e){return this.validateDispose(this,"observeGamepad",{}).then(()=>this._store.dispatchIntent(new gD(this._appConfig.spaceId,e)))}setInputLegend(e){return this._logger.debug("".concat(this._appConfig.appName,": Set input legend items call"),{items:e,logCategory:f.api}),e.some(s=>!s.button||!s.label)?(this._logger.warn("".concat(this._appConfig.appName,": Unable to set input legend containing invalid items"),{items:e,logCategory:f.api}),Promise.reject(new na("Unable to set input legend containing invalid items",this._appConfig.appName))):this.validate(this,"setInputLegend",{items:e},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new lF(this._appConfig,e)))}setHotKeys(e){return this._logger.debug("".concat(this._appConfig.appName,": Set hotkeys call"),{buttons:e,logCategory:f.api}),this.validate(this,"setHotKeys",{buttons:e},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new oF(this._appConfig,e)))}notifyInternalFocusChanged(){return this._logger.debug("".concat(this._appConfig.appName,": Notify internal focus changed call"),{logCategory:f.api}),this.validate(this,"notifyInternalFocusChanged",{},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new kr))}notifyComponentIsSelected(e){return this._logger.debug("".concat(this._appConfig.appName,": Notify component is selected call"),{componentType:e,logCategory:f.api}),this.validate(this,"notifyComponentIsSelected",{componentType:e},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new lr(e)))}releaseFocus(e="left"){return this._logger.debug("".concat(this._appConfig.appName,": Release focus call in ").concat(e," direction"),{logCategory:f.api}),this.validate(this,"releaseFocus",{direction:e},this.validateDispose,this.validateMicroAppActive,this.validateContainerNavigationNotInProgress).then(()=>this._store.dispatchIntent(new hO(this._appConfig,e)))}setTitle(e){return this._logger.debug("".concat(this._appConfig.appName,": Set title ").concat(e," call"),{logCategory:f.api}),this.validate(this,"setTitle",{title:e},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new Lg(this._appConfig,e)))}setSubtitle(e){return this._logger.debug("".concat(this._appConfig.appName,": Set subtitle ").concat(e," call"),{logCategory:f.api}),this.validate(this,"setSubtitle",{subtitle:e},this.validateDispose,this.validateMicroAppActive,this.validatePCClientPlatformType).then(()=>this._store.dispatchIntent(new LF(this._appConfig,e)))}resetTitle(){return this._logger.debug("".concat(this._appConfig.appName,": Reset title call"),{logCategory:f.api}),this.validate(this,"resetTitle",{},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new Gg(this._appConfig)))}reportFatalError(e){return this._logger.debug("".concat(this._appConfig.appName,": Report fatal error call"),{error:e,logCategory:f.api}),this.validateDispose(this,"reportFatalError",{}).then(()=>this._store.dispatchIntent(new gO(this._appConfig,e)))}_observePlayerNotifications(e){return this.validateDispose(this,"observePlayerNotifications",{}).then(()=>(this._playerNotificationCallbacks.add(e),this._store.dispatchIntent(new ur(e,this._uniqueSubscriberId))))}_configurePlayerNotifications(e){if((e==null?void 0:e.notificationTypes)==null||(e==null?void 0:e.spaceIds)==null){const t="Invalid player notifications configuration";throw this._logger.warn(t,{config:e,errorCode:g.InvalidPlayerNotificationsConfigurationWarning}),new De(t)}return this.validateDispose(this,"configurePlayerNotifications",{}).then(async()=>{await this._store.dispatchIntent(new pr(this._uniqueSubscriberId,e))})}softDispose(){var e,t,s,a,n,r,o,l,u,v,w,b,I;return this._logger.debug("".concat(this._appConfig.appName,": Soft dispose call"),{logCategory:f.api}),super.dispose(),(e=this._ubiServices)==null||e.revoke(),(t=this._pcClientProxy)==null||t.revoke(),(s=this._gameInvitesProxy)==null||s.revoke(),(a=this._applicationProxy)==null||a.revoke(),(n=this._streamingProxy)==null||n.revoke(),this.isDisposable((r=this._viewModeProxy)==null?void 0:r.proxy)&&this._viewModeProxy.proxy.dispose(),(o=this._viewModeProxy)==null||o.revoke(),this.isDisposable((l=this._gameManagementProxy)==null?void 0:l.proxy)&&this._gameManagementProxy.proxy.dispose(),(u=this._gameManagementProxy)==null||u.revoke(),this.isDisposable(this.microApps)&&this.microApps.dispose(),this._microAppsProxy.revoke(),(v=this._browserViewProxy)==null||v.revoke(),(w=this._adobeTrackingProxy)==null||w.revoke(),(b=this._secureStorageApiProxy)==null||b.revoke(),(I=this._pcGameRuntimeApiProxy)==null||I.revoke(),this._ubiServices=null,this._observers}unsubscribeAll(){const e=this._observers;this._observers=[],this._store.dispatchIntent(new Rd(e)),this._store.dispatchIntent(new mD(this._appConfig.spaceId)),this._store.dispatchIntent(new iF(this._appConfig.spaceId)),this._playerNotificationCallbacks.forEach(t=>{this._store.dispatchIntent(new pg(t))}),this._playerNotificationCallbacks.clear(),this._store.dispatchIntent(new Fg(this._appConfig.spaceId))}mergeObservers(e){this._observers=[...this._observers,...e]}dispose(){this.unsubscribeAll(),this.softDispose()}isDisposable(e){return e==null?!1:typeof e=="object"&&"dispose"in e}isNonCriticalUpdate(e,t,s){return e.map(a=>t[a]&&ba(t[a],s[a])).every(Boolean)}createObserver(e,t){const s={};let a=!1;return{next:n=>{const r=(l,u=!1)=>{try{if(!("platformType"in n)||l<this._runtimeContextUpdateRevision)return;const v=t.getMicroAppStateData(this._appConfig).activeGame,w=v?{...n,activeGame:v}:n;if(u&&a&&this.isNonCriticalUpdate(mf,s,w))return;a=u,mf.forEach(I=>{s[I]=w[I]});const b=e(w);b instanceof Promise&&b.catch(I=>{this.logCallbackError(I)})}catch(v){this.logCallbackError(v)}};this._runtimeContextUpdateRevision+=1;const o=this._runtimeContextUpdateRevision.valueOf();t.isMicroAppActiveAnywhere(this._appConfig.appName)?(this._logger.debug("Running sync runtime update for ".concat(this._appConfig.appName)),r(o)):(this._logger.debug("Running async runtime update for ".concat(this._appConfig.appName)),requestIdleCallback(()=>r(o,!0)))}}}logCallbackError(e){this._logger.warn("RuntimeContext observer callback error for ".concat(this._appConfig.appName),{error:e,appConfig:this._appConfig,logCategory:f.api,errorCode:g.RuntimeContextCallbackErrorForMicroappWarning})}async validate(e,t,s,...a){return this._microAppApiValidationService.validate(e,t,s,a)}async validateDispose(e,t,s){return this._microAppApiValidationService.validateDispose(e,t,s)}async validateMicroAppActive(e,t,s){return this._microAppApiValidationService.validateMicroAppActive(e,t,s)}async validateContainerNavigationNotInProgress(e,t,s){return this._microAppApiValidationService.validateContainerNavigationNotInProgress(e,t,s)}async validatePCClientPlatformType(e,t,s){return this._microAppApiValidationService.validatePlatformType(e,[p.PCWebClient,p.PCElectronClient,p.PCLegacyClient,p.SteamClient],t,s)}async getUbiServices(){return this._ubiServices?this._ubiServices.proxy:(this._ubiServices=await this._store.dispatchIntent(new yO(this._appConfig)),this._ubiServices.proxy)}getPcClientInterface(){var e;return(e=this._pcClientProxy)==null?void 0:e.proxy}async gameInvitesEnabled(){return this.gameInvites!==void 0}async sendGameInvite(e){return this.validateDispose(this,"sendGameInvite",{profileId:e}).then(()=>{const t=this._store.getReadonlyState(S);return this._store.dispatchIntent(new Og(e,t.hostGame,this._unusedGameSessionId))})}async acceptGameInvite(e,t,s,a){var n;return((n=this.gameInvites)==null?void 0:n.v1.acceptGameInvite(e,{applicationId:t,spaceId:s},a))||!1}async declineGameInvite(e,t,s,a){var n;return((n=this.gameInvites)==null?void 0:n.v1.declineGameInvite(e,{applicationId:t,spaceId:s},a))||!1}async getCurrentGameInvites(){var s;const e=await ((s=this.gameInvites)==null?void 0:s.v1.getCurrentGameInvites());return(e==null?void 0:e.map(a=>({profileId:a.profileId,state:a.state,gameAppId:a.gameId.applicationId,gameSpaceId:a.gameId.spaceId,gameSessionId:a.gameSessionReference})))||[]}async observeGameInvites(e){var s;const t=a=>{const n={profileId:a.profileId,state:a.state,gameAppId:a.gameId.applicationId,gameSpaceId:a.gameId.spaceId,gameSessionId:a.gameSessionReference};e(n)};return(s=this.gameInvites)==null?void 0:s.v1.observeGameInvites(t)}async joinGame(e,t,s,a){var n;return(n=this.gameInvites)==null?void 0:n.v1.joinGame(e,{applicationId:t,spaceId:s},a)}async sendDnaEvent(e,t){return this.validateDispose(this,"sendDnaEvent",{eventName:e,eventData:t}).then(()=>this._store.dispatchIntent(new _O(this.applicationConfig,e,t)))}async setMicroAppViewMode(e){return this.validate(this,"setMicroAppViewMode",{mode:e},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new vl(e)))}async getImageData(e){return await this.validate(this,"getImageData",{imageType:e},this.validateDispose,this.validateMicroAppActive),this._store.dispatchIntent(new bO(e))}get gameInvites(){var e;return(e=this._gameInvitesProxy)==null?void 0:e.proxy}get application(){var e;return this._applicationProxy?(e=this._applicationProxy)==null?void 0:e.proxy:void 0}get streaming(){var e;return this._streamingProxy?(e=this._streamingProxy)==null?void 0:e.proxy:void 0}get viewMode(){return this._viewModeProxy?this._viewModeProxy.proxy:void 0}get modal(){return this._modalProxy?this._modalProxy.proxy:void 0}get gameManagement(){return this._gameManagementProxy?this._gameManagementProxy.proxy:void 0}get microApps(){return this._microAppsProxy.proxy}get applicationConfig(){if(this._applicationConfig)return this._applicationConfig;if(!this._applicationId||!this._applicationBuildId){const s="Can't create application config for ".concat(this._appConfig.appName," since its applicationId or applicationBuildId were not defined.");throw this._logger.warn(s,{logCategory:f.api,applicationId:this._applicationId,applicationBuildId:this._applicationBuildId,errorCode:g.FailedToCreateMicroappMissingAppIDWarning}),new De(s)}const{appName:e,spaceId:t}=this._appConfig;return this._applicationConfig={applicationId:this._applicationId,applicationBuildId:this._applicationBuildId,applicationName:e,spaceId:t},this._applicationConfig}get playerNotificationsApi(){return this._playerNotificationsApiProxy?this._playerNotificationsApiProxy.proxy:void 0}get secureStorageApi(){return this._secureStorageApiProxy?this._secureStorageApiProxy.proxy:void 0}get cacheApi(){return this._cachesApiProxy?this._cachesApiProxy.proxy:void 0}get browserView(){var e;return(e=this._browserViewProxy)==null?void 0:e.proxy}get adobeTracking(){var e;return(e=this._adobeTrackingProxy)==null?void 0:e.proxy}get focusSystemApi(){return this._focusSystemProxy?this._focusSystemProxy.proxy:void 0}get navigationApi(){return this._navigationApiProxy?this._navigationApiProxy.proxy:void 0}get pcGameRuntimeApi(){return this._pcGameRuntimeApiProxy?this._pcGameRuntimeApiProxy.proxy:void 0}notifyContentScrolled(e){return this._logger.debug("".concat(this._appConfig.appName,": Notify content scrolled call"),{event:e,logCategory:f.api}),this.validate(this,"notifyContentScrolled",{event:e},this.validateDispose,this.validateMicroAppActive).then(()=>this._store.dispatchIntent(new Nl(e)))}}Jt([_()],It.prototype,"validate",1);Jt([_()],It.prototype,"validateDispose",1);Jt([_()],It.prototype,"validateMicroAppActive",1);Jt([_()],It.prototype,"validateContainerNavigationNotInProgress",1);Jt([_()],It.prototype,"validatePCClientPlatformType",1);Jt([Bs({info:"Do not use."})],It.prototype,"getPcClientInterface",1);Jt([Bs({info:"Check existence of gameInvites instead."})],It.prototype,"gameInvitesEnabled",1);Jt([Bs({info:"Use gameInvites instead."})],It.prototype,"sendGameInvite",1);Jt([Bs({info:"Use gameInvites instead. Don't forget to close overlay while switching to the new api"})],It.prototype,"acceptGameInvite",1);Jt([Bs({info:"Use gameInvites instead."})],It.prototype,"declineGameInvite",1);Jt([Bs({info:"Use gameInvites instead."})],It.prototype,"getCurrentGameInvites",1);Jt([Bs({info:"Use gameInvites instead."})],It.prototype,"observeGameInvites",1);Jt([Bs({info:"Use gameInvites instead. Don't forget to close overlay while switching to the new api"})],It.prototype,"joinGame",1);class mr{constructor(e){this._pluginService=e,this._subApiMap=new Map,this._cacheEnabled=!0}get(e,t){var n;const s=e[t];if(s!==void 0)return s;const a=this._cacheEnabled?this._subApiMap.get(t):void 0;if(a)return a.proxy;if(this.isKeyOfMap(t,ff)){const r=ff[t],o=r(this._pluginService);if(o){const l=pe.new(o);return this._subApiMap.set(t,l),(n=this._subApiMap.get(t))==null?void 0:n.proxy}}}isKeyOfMap(e,t){return e in t}revokeAll(){for(const e of this._subApiMap.values())e.revoke()}enableCache(e){this._cacheEnabled=e}clearCache(){this._subApiMap.clear()}}const ff={microApps:i=>{const e=i.getApi(ee.MicroAppsV1);return e?{v1:e}:void 0},gameInvites:i=>{const e=i.getApi(ee.GameInvitesV1);return e?{v1:e}:void 0},streaming:i=>{const e=i.getApi(ee.StreamingV1);if(e)return{v1:e};const t=i.getApi(ee.StreamingV1Client),s=i.getApi(ee.StreamingV1Host);if(t||s)return{v1:{client:t,host:s}}},viewMode:i=>{const e=i.getApi(ee.ViewModeV1);return e?{v1:e}:void 0},gameManagement:i=>{const e=i.getApi(ee.GameManagementV1),t=i.getApi(ee.GameManagementWip);return e||t?{v1:e,wip:t}:void 0},pcGameManagement:i=>{const e=i.getApi(ee.PcGameManagementV1);return e?{v1:e}:void 0},playerNotificationsApi:i=>{const e=i.getApi(ee.PlayerNotificationsV1);return e?{v1:e}:void 0},cacheApi:()=>{},modal:()=>{},entitlementApi:i=>{const e=i.getApi(ee.EntitlementApiV1);if(e)return{v1:e}},userInterfaceManagementApi:i=>{const e=i.getApi(ee.UserInterfaceManagementApiV1);if(e)return{v1:e}},ubisoftPlusApi:i=>{const e=i.getApi(ee.UbisoftPlusApiV1);if(e)return{v1:e}},socialApi:i=>{const e=i.getApi(ee.SocialApiV1);if(e)return{v1:e}},richPresenceApi:i=>{const e=i.getApi(ee.RichPresenceApiV1);if(e)return{v1:e}},webEmbedderApi:i=>{const e=i.getApi(ee.WebEmbedderApiV1);if(e)return{v1:e}},settingsApi:i=>{const e=i.getApi(ee.SettingsApiV1);if(e)return{v1:e}},browserView:()=>{},adobeTracking:()=>{},application:i=>{const e=i.getApi(ee.ApplicationApiV1);if(e)return{v1:e}},hostSystemDialogsApi:i=>{const e=i.getApi(ee.HostSystemDialogsApiWip);if(e)return{wip:e}},storeApi:i=>{const e=i.getApi(ee.StoreApiV1);if(e)return{v1:e}},performance:()=>{},secureStorageApi:i=>{const e=i.getApi(ee.SecureStorageApiV1);if(e)return{v1:e}},focusSystemApi:()=>{},authenticationApi:i=>{const e=i.getApi(ee.AuthenticationApi);if(e)return{v1:e}},partnerApi:i=>{const e=i.getApi(ee.PartnerApiV1);return e?{v1:e}:void 0},navigationApi:()=>{},quickLaunchApi:i=>{const e=i.getApi(ee.QuickLaunchApiV1);if(e)return{v1:e}},pcGameRuntimeApi:i=>{const e=i.getApi(ee.PcGameRuntimeApiV1),t=i.getApi(ee.PcGameRuntimeApiV2);return e||t?{v1:e,v2:t}:void 0},deeplinkNavigationApi:i=>{const e=i.getApi(ee.DeeplinkNavigationApiV1);return e?{v1:e}:void 0},ipLocationApi:i=>{const e=i.getApi(ee.IpLocationApiV1);return e?{v1:e}:void 0}};class ZV{constructor(e=It){this._defaultApi=e,this._map=new Map}registerApi(e,t){this._map.set(e,t)}unRegisterApi(e){this._map.delete(e)}createAppropriateApi(e,t,s,a,n,r){const o=this._map.get(t.spaceId);if(o){const v=new o(e,t,s,a,n,r),w=new mr(a);return new Proxy(v,w)}const l=new this._defaultApi(e,t,s,a,n,r),u=new mr(a);return new Proxy(l,u)}}var e9=Object.defineProperty,t9=Object.getOwnPropertyDescriptor,i9=(i,e,t,s)=>{for(var a=s>1?void 0:s?t9(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&e9(e,t,a),a};function JF(i){return"apiVersion"in i}function s9(i){return"pluginApiVersion"in i}class Rl{constructor(e,t=new Map){this._typeGuard=e,this._loadedModules=new $R,t.forEach((s,a)=>{this._loadedModules.set(this.getConfigCacheKey(a),s)})}async loadModules(e){await Promise.all([e.map(t=>this.loadModule(t))])}async loadModule(e){return this._loadedModules.getOrCreate(this.getConfigCacheKey(e),()=>this._loadModule(e))}addModule(e,t){this._loadedModules.set(this.getConfigCacheKey(e),t)}async _loadModule(e){if(!e.bundleUrl)throw new Error("Property bundleUrl is missing for ".concat(e.name));const t=new URL(e.bundleUrl),a=!!t.searchParams.get("esm")?await this.loadEsmModule(t):await this.loadUmdModule(t,e.name,e.integrityHash);if(!this._typeGuard(a))throw new Error("Loaded module type is incorrect for ".concat(e.name));return a}async loadEsmModule(e){if(!window.__esm_loader__)return Promise.reject(new Error("The ESM loader is not available."));const t=await window.__esm_loader__(e.toString());return t==null?void 0:t.default}async loadUmdModule(e,t,s){const a=t&&s;if(s&&(!s.startsWith("sha384-")||s.length<8))throw new Error("Integrity hash should start with sha384-");const n=a?await this.getImportMapElement(e,s,t):void 0,r=a?t:e.toString();try{const o=await window.System.import(r);if(o.default)return o.default.default||o.default;throw new Error("Failed to load module from ".concat(e.protocol,"//").concat(e.hostname).concat(e.pathname,". The module has no default export."))}catch(o){throw n==null||n.remove(),window.System.delete(window.System.resolve(e.toString())),o}}async getImportMapElement(e,t,s){const a="system-js-import-map-".concat(s),n=document.getElementById(a),r='\n            {\n                "imports": {\n                    "'.concat(s,'": "').concat(e,'"\n                },\n                "integrity": {\n                    "').concat(e,'": "').concat(t,'"\n                }\n            }');if(this.isScriptElement(n)&&n.innerHTML===r)return n;n&&n.remove();const o=document.createElement("script");return o.id=a,o.type="systemjs-importmap",o.innerHTML=r,document.head.appendChild(o),await window.System.prepareImport(!0),o}isScriptElement(e){return!!(e&&e.nodeName.toLowerCase()==="script")}getConfigCacheKey(e){return e.bundleUrl||this.serializeConfig(e)}serializeConfig(e){const t=Object.keys(e).sort((s,a)=>s.localeCompare(a)).filter(s=>typeof s<"u");if(!t.length)throw new Error("Misconfigured or empty module config");return t.map(s=>"".concat(s,":").concat(e[s])).join("|")}}i9([_()],Rl.prototype,"_loadModule",1);class YF{constructor(e){var t,s;this._config=e,this._trackedMetrics=new Map,this._marks=new Map,this._entries=[],this._transports=[],this.historyHalfLimit=200,this.markEdgeNames=a=>({start:"".concat(a," [start]"),end:"".concat(a," [end]")}),this._context=e.context,this._transportsProvider=e.transportProvider,this._transports=this._transportsProvider.getTransports(this._context),this._offset=(t=e.timeOffset)!=null?t:performance.now(),this._logger=e.logger,this._persistentMarks=new Set(Object.values((s=e.predefinedMarksMap)!=null?s:{})),this.addMark("start",{timestamp:0}),e.preexistingMarks&&Object.entries(e.preexistingMarks).forEach(([a,n])=>{this.addMark(a,{timestamp:n})}),e.trackedMetrics&&(Array.isArray(e.trackedMetrics)?this.registerAutoTrackedMetrics(e.trackedMetrics):this.registerAutoTrackedMetrics(Object.values(e.trackedMetrics))),this._mark=this.makeMarkMethod()}setStartTimeOffset(e){this._offset=e}get context(){return this._context}set context(e){this._context=e,this._transports=this._transportsProvider.getTransports(this._context,this.getRecentHistory())}get logger(){return this._logger}get mark(){return this._mark}makeMarkMethod(){var s;const e=this.addMark.bind(this),t={};return Object.entries((s=this._config.predefinedMarksMap)!=null?s:{}).forEach(([a,n])=>{Object.defineProperty(e,a,{value:r=>this.addMark(n,r)}),Object.defineProperty(t,a,{value:r=>{const o={...r,unique:!0};return this.addMark(n,o)}})}),Object.defineProperty(e,"once",{value:t}),e}addEntry(e){this._transports.forEach(t=>{t.addEntry(e,this._context,this._offset)}),this._entries.push(e),this.checkEntriesSize()}getRecentHistory(){return this._entries.slice()}checkEntriesSize(){this._entries.length>this.historyHalfLimit*2&&(this._entries=this._entries.slice(this.historyHalfLimit))}registerAutoTrackedMetrics(e){for(const t of e){this._trackedMetrics.set(t.name,{...t,occurred:!1}),this._persistentMarks.add(t.startMark),this._persistentMarks.add(t.endMark);const s=this._marks.has(t.startMark),a=this._marks.has(t.endMark);s&&a&&this.metric(t.name,t)}}now(){var e;return(e=window.performance)!=null&&e.now?window.performance.now()-this._offset:-1}memory(){var e,t;return(e=window.performance)!=null&&e.memory?(t=window.performance)==null?void 0:t.memory.usedJSHeapSize:-1}addMark(e,t){var a;if(t!=null&&t.unique&&this._marks.has(e))return this._marks.get(e);const s={...t,type:"mark",name:e,timestamp:(a=t==null?void 0:t.timestamp)!=null?a:this.now(),memory:this.memory()};return this._marks.set(e,s),this.addEntry(s),this.checkMetricsForEndMark(e),s}getLastMarkFor(e){return this._marks.get(e)}clearMark(e){this._marks.has(e)&&!this._persistentMarks.has(e)&&this._marks.delete(e)}clearAllMarks(e){Object.values(this._mark).forEach(t=>{this._persistentMarks.has(t.name)||e&&RegExp(e).test(t.name)||this._marks.delete(t.name)})}clearTransports(){this._transportsProvider.clearTransports(this._context)}checkMetricsForEndMark(e){this._trackedMetrics.forEach(t=>{t.endMark===e&&(this._marks.has(t.startMark)||this.logger.warn("End mark '".concat(e,"' for metric '").concat(t.name,"' occurred but no start mark '").concat(t.startMark,"' is found!"),{metric:t,errorCode:g.PerformanceMarkOrderWrongWarning}),this.metric(t.name,t))})}metric(e,t){var l,u;if(t&&!this.validateMetricOptions(e,t))return;const s=this._trackedMetrics.get(e),a=s!=null?s:{...t,name:e,startMark:(l=t==null?void 0:t.startMark)!=null?l:"start",endMark:(u=t==null?void 0:t.endMark)!=null?u:this.markEdgeNames(e).end};this.runMetricSafetyChecks(e);const n=this._marks.get(a.startMark),r=this._marks.get(a.endMark)||this.addMark(a.endMark,{edge:"end"});if(!n){this.logger.warn("Start mark '".concat(a.startMark,"' for metric '").concat(a.name,"' is missing!"),{errorCode:g.PerformanceStartMarkMissingWarning});return}const o={...a,type:"metric",startTime:n.timestamp,endTime:r.timestamp,duration:r.timestamp-n.timestamp,memDiff:r.memory-n.memory};if(o.duration<0){this.logger.warn("Metric measured negative time",{measurement:o,errorCode:g.PerformanceNegativeTimingWarning});return}return s&&(s.occurred=!0),this.addEntry(o),o}validateMetricOptions(e,t){return t.endMark&&!this._marks.has(t.endMark)?(this.logger.warn("Specified end-mark for metric not found",{metricName:e,mark:t.endMark,options:t,errorCode:g.PerformanceEndMarkMissingWarning}),!1):t.startMark&&!this._marks.has(t.startMark)?(this.logger.warn("Specified start-mark for metric not found",{metricName:e,mark:t.startMark,options:t,errorCode:g.PerformanceStartMarkMissingWarning}),!1):!0}measure(e,t,s){const a=this.startMeasurement(e,{...s,allowParallel:!0}),n=t();return n&&typeof n=="object"&&"finally"in n?n.finally(()=>{a()}):(n&&typeof n=="object"&&"then"in n&&this.logger.warn("Performance measurement found 'then' in result but not 'finally'. Proper promise polyfill could be missing.",{name:e,errorCode:g.PerformancePromisePolyfillMissingWarning}),a()),n}makeMeasuredClosure(e,t){const s=this.measure.bind(this);return function(...a){var o;const n=e.bind(this,...a),r=(o=t==null?void 0:t(a))!=null?o:{name:"measured-closure '".concat(e.name,"' [").concat(a.join(","),"]"),details:{params:a}};return s(r.name,n,{details:r.details})}}startMeasurement(e,t){const s=this.markEdgeNames(e);if(!(t!=null&&t.allowParallel)&&this._marks.has(s.start))return this._logger.warn("Measurement for '".concat(e,"' already in progress.                 Either end it or add a unique ID to the name or use automatic measurement methods."),{name:e,options:t,errorCode:g.PerformanceMeasurementAlreadyInProgressWarning}),()=>{};const a=this.addMark(s.start,{private:!0,...t,edge:"start"});return()=>this.endMeasurement(e,{...t,startMarkData:a})}endMeasurement(e,t){var l,u,v;const s=this.markEdgeNames(e),a=(t==null?void 0:t.startMarkData)||this._marks.get(s.start);if(!a){this._logger.warn("No active measurement for '".concat(e,"' is in progress."),{errorCode:g.PerformanceMeasurementNoActiveMeasurementWarning});return}const n={details:(l=t==null?void 0:t.details)!=null?l:a==null?void 0:a.details,private:(v=(u=t==null?void 0:t.private)!=null?u:a==null?void 0:a.private)!=null?v:!0},r=this.addMark(s.end,{...n,edge:"end"}),o=this.addMeasurement({...n,name:e,startMark:a,endMark:r});return this.clearMark(s.start),this.clearMark(s.end),o}addMeasurement(e){const t={...e,type:"measurement",startTime:e.startMark.timestamp,endTime:e.endMark.timestamp,duration:e.endMark.timestamp-e.startMark.timestamp,memDiff:e.endMark.memory-e.startMark.memory};return this.addEntry(t),t}runMetricSafetyChecks(e){var s,a;const t=this._trackedMetrics.get(e);t&&(!t.recurring&&t.occurred&&this.logger.warn("Attempting to measure singular metric that was already measured",{metric:t,errorCode:g.PerformanceMeasurementAlreadyMeasuredWarning}),(s=t.follows)==null||s.forEach(n=>{const r=this._trackedMetrics.get(n);r&&!r.occurred&&!r.optional&&this._logger.warn("Metrics order warning: Metric '".concat(t.name,"' should be measured after '").concat(n,"'."),{metric:t,precedingMetric:r,errorCode:g.PerformanceMarkOrderWrongWarning})}),(a=t.precedes)==null||a.forEach(n=>{const r=this._trackedMetrics.get(n);r&&r.occurred&&this._logger.warn("Metrics order warning: Metric '".concat(t.name,"' should be measured before '").concat(n,"'"),{metric:t,followingMetric:r,errorCode:g.PerformanceMarkOrderWrongWarning})}))}}const ZF=(i,e,t)=>({next:s=>{try{const a=i(s);a instanceof Promise&&a.catch(n=>{e.warn("RuntimeContext observer callback error for ".concat(t),{error:n,name:t,logCategory:f.api,errorCode:g.RuntimeContextCallbackErrorForMicroappWarning})})}catch(a){e.warn("RuntimeContext observer callback error for ".concat(t),{error:a,name:t,logCategory:f.api,errorCode:g.RuntimeContextCallbackErrorForMicroappWarning})}}});class eL{constructor(e,t,s,a,n,r,o,l){var v;this._store=e,this._appName=t,this._spaceId=s,this._shellApplicationId=a,this._logger=n,this._pluginsService=r,this._featureHandlerService=o,this._pcClientWrapper=l,this._observers=[],this._ubiServices=null,this._pcClientWrapper&&(this._pcClientProxy=pe.new(this._pcClientWrapper),this._gameInvitesProxy=pe.new(new xg(e,this._spaceId)));const u=new Vg(e,this._appName);this._microAppsProxy=pe.new(u),this._streamingProxy=pe.new(new Qg(e,this._spaceId,((v=this._pcClientProxy)==null?void 0:v.proxy)!==void 0)),this._cachesApiProxy=pe.new(new Wg(e,this._spaceId)),this._playerNotificationsApiProxy=pe.new(new Bg(e,"base-".concat(this._appName))),this._secureStorageApiProxy=pe.new(new Hg(e,o,this._spaceId))}get hostFeatures(){return this._store.getReadonlyState(Q).hostFeatures}async getGameSpecificMicroApps(e){return this._store.dispatchIntent(new ms(e))}async getTransversalMicroApps(){return this._store.dispatchIntent(new ms)}async isMicroAppAvailable(e,t){const s=this._store.getReadonlyState(S),a=t!=null?t:s.activeGame,n=await this._store.dispatchIntent(new Xe(e,a));return n!==void 0&&this._store.dispatchIntent(new Ci(e,a,n))}async observeRuntimeContext(e){const t=ZF(e,this._logger,this._appName);await this._store.dispatchIntent(new Er(t)),this._observers.push(t)}async getUbiServices(){return this._ubiServices?this._ubiServices.proxy:(this._ubiServices=await this._store.dispatchIntent(new wg(this._shellApplicationId)),this._ubiServices.proxy)}getPcClientInterface(){var e;return(e=this._pcClientProxy)==null?void 0:e.proxy}get microApps(){return this._microAppsProxy.proxy}get gameInvites(){var e;return(e=this._gameInvitesProxy)==null?void 0:e.proxy}get streaming(){var e;return this._streamingProxy?(e=this._streamingProxy)==null?void 0:e.proxy:void 0}get gameManagement(){return this._gameManagementProxy?this._gameManagementProxy.proxy:void 0}get cacheApi(){return this._cachesApiProxy?this._cachesApiProxy.proxy:void 0}get playerNotificationsApi(){return this._playerNotificationsApiProxy?this._playerNotificationsApiProxy.proxy:void 0}get secureStorageApi(){return this._secureStorageApiProxy?this._secureStorageApiProxy.proxy:void 0}async sendDnaEvent(e,t){this._store.dispatchIntent(new hr(e,t))}async getLogger(){return this._applicationLogger||(this._applicationLogger=this._logger.createChild(this._appName)),Promise.resolve(this._applicationLogger)}async addCachingEntries(e){return this._store.dispatchIntent(new In(e))}async removeCachingEntries(e){return this._store.dispatchIntent(new wl(e))}}var ca=(i=>(i.BeforeActivate="beforeActivate",i.BeforeDeactivate="beforeDeactivate",i.BundleDownload="bundleDownload",i.AppIsAvailable="appIsAvailable",i.ActivationFailed="activationFailed",i.MountFailed="mountFailed",i))(ca||{});class a9{constructor(e,t){this._microAppObserver=e,this._options=t,this._appConfig=e.microAppDetails.value.config,this._appContainer=this.createAppContainer(this._appConfig.appName),this._subscription=this.subscribeToMicroAppObserver()}get element(){return this._appContainer}destroy(){this._subscription.unsubscribe(),this._appContainer.remove()}hasStateChanged(e,t){var s;return e[t]!==((s=this._previousMicroAppDetails)==null?void 0:s[t])}subscribeToMicroAppObserver(){return this._microAppObserver.microAppDetails.subscribe(t=>{this.hasStateChanged(t,"active")&&(t.active===fi.Active?this.setElementVisibility(this._appContainer,!0):t.active===fi.Inactive&&this.setElementVisibility(this._appContainer,!1)),this.hasStateChanged(t,"mounted")&&(t.mounted===we.Mounting?this.mountMicroApp():t.mounted===we.Unmounting?this.unMountMicroApp():t.mounted===we.Unmounted&&this.resetAppContainer()),this._previousMicroAppDetails=t})}setElementVisibility(e,t){t?(e.hidden=!1,e.setAttribute("data-e2e","active-microapp")):(e.hidden=!0,e.removeAttribute("data-e2e"))}async mountMicroApp(){const e=this._options.getMicroAppInstance();if(!e){console.error("[Renderer] Micro app instance is not set, cannot mount the app"),this._microAppObserver.updateMountStatus(we.Unmounted);return}this._options.parentElement.contains(this._appContainer)||(this._options.parentElement.appendChild(this._appContainer),this._options.onContainerMount&&this._options.onContainerMount(this._appContainer));try{const t=await e.mount(this._appContainer,"");this._microAppObserver.updateMountStatus(t?we.Mounted:we.Unmounted)}catch(t){console.error("".concat(e.appName," mount has failed. app.mount() throws"),t),this._microAppObserver.updateMountStatus(we.Unmounted)}}async unMountMicroApp(){const e=this._options.getMicroAppInstance();if(!e){console.error("[Renderer] Micro app instance is not set, cannot unmount the app"),this._microAppObserver.updateMountStatus(we.Unmounted);return}try{await e.beforeUnmount()}catch(t){console.error("".concat(e.appName," unmount has failed. app.beforeUnmount() throws"),t)}this._options.beforeContainerUnmount&&this._options.beforeContainerUnmount(this._appContainer),this._microAppObserver.updateMountStatus(we.Unmounted)}createAppContainer(e){const t=document.createElement("div");return t.id=e,t.hidden=!0,t}resetAppContainer(){this._appContainer.remove(),this._appContainer=this.createAppContainer(this._appConfig.appName)}}const n9=3e3;class tL{constructor(e,t,s,a){this._appConfig=e,this._store=t,this._logger=s,this._placementContainersService=a,this._appContainer=new yt,this._lifeGuardLogger=s.createChild("LifeGuard"),this._lifeGuardLogger.settings.logCategory=f.microAppLifecycle}setupAppContainer(){this._appContainer=new yt;const e=this._placementContainersService.getMicroAppContainer(this._appConfig.placement);e?this._appContainer.resolve(e):this._placementContainersService.waitForMicroAppContainer(this._appConfig.placement).then(t=>{this._appContainer.resolve(t)})}async getContainerDiv(){try{return this.setupAppContainer(),await q(n9,this._appContainer.promise)}catch(e){throw this.logWarning("Not able to get div for placement ".concat(this._appConfig.placement," when ").concat(this._appConfig.appName),e),e}}logError(e,t,s){this._lifeGuardLogger.error(e,{moreInfo:{appConfig:this._appConfig,...s},error:t,version:this.getAppVersion(),errorCode:"baseLifeGuard.".concat(t||"error")})}logDebug(e,t){this._lifeGuardLogger.debug(e,{moreInfo:{appConfig:this._appConfig,...t},version:this.getAppVersion()})}logInfo(e,t){this._lifeGuardLogger.info(e,{moreInfo:{appConfig:this._appConfig,...t},version:this.getAppVersion()})}logWarning(e,t,s){this._lifeGuardLogger.warn(e,{moreInfo:{appConfig:this._appConfig,...s},error:t,version:this.getAppVersion(),errorCode:g.BaseLifeGuardWarning})}}const Tc=class Tc extends tL{constructor(e,t,s,a,n,r,o,l,u,v,w,b,I,R,x,F,V,ce,Ue,ke,Yi=new Rl(JF)){super(e,t,s,a),this._microAppLifeCycle=n,this._shellConfig=r,this._apiFactory=o,this._microAppLoadTimeoutInMs=l,this._microAppLifeCycleTimeoutInMs=u,this._changeFocusTimeoutInMs=v,this._scrollContentTimeoutInMs=w,this._microAppAvailabilityCheckTimeoutInMs=b,this._featureHandlerService=I,this._pluginsService=R,this._performanceMeter=x,this._metricDefinitions=F,this._cumulativeLayoutShiftInstrument=V,this._interactionToNextPaintInstrument=ce,this._hostCommunicationService=Ue,this._pcClientCommunication=ke,this._bundleLoader=Yi,this._api=void 0,this._focusable=!1,this._failedToLoadBundle=!1,this._shouldUpdateApi=!0,this._instanceLoader=new hE(()=>this.ensureAppLoaded()),this._microAppObserver=this._microAppLifeCycle.registerMicroAppObserverForPlacement(e.placement,e),this.setupRenderer(),this.logDebug("Created new lifeguard for ".concat(e.appName))}async setupRenderer(){const e={microAppVersion:this.getAppVersion(),microAppName:this._appConfig.appName};this._microAppDomRenderer=new a9(this._microAppObserver,{parentElement:await this.getContainerDiv(),getMicroAppInstance:()=>this._appInstance,onContainerMount:t=>{this._cumulativeLayoutShiftInstrument.collectForMicroApp(t,e),this._interactionToNextPaintInstrument.collectForMicroApp(t,e)},beforeContainerUnmount:t=>{this._cumulativeLayoutShiftInstrument.disconnect(t),this._interactionToNextPaintInstrument.disconnect(t)}})}getDescription(){const e=[];return e.push("".concat(this._appConfig.appName,":").concat(this.getAppVersion())),e.push(this.mounted?we.Mounted:we.Unmounted),e.push(this._appConstructor?as.Loaded:as.Unloaded),e.join(": ")}getAppVersion(){var e,t;if((e=this._appInstance)!=null&&e.appVersion)return(t=this._appInstance)==null?void 0:t.appVersion;try{const s=new URL(this._appConfig.bundleUrl).pathname.split("/");return s.length>=3?"from url:"+s[2]:"unknown"}catch(s){return"unknown"}}getAppApplicationId(){var e;return(e=this._appInstance)==null?void 0:e.applicationId}get mounted(){return this._microAppObserver.microAppDetails.value.mounted===we.Mounted}async getOrLoadAppInstance(e,t){var a;const s=this._store.getReadonlyState(S);try{return(a=this._appInstance)!=null?a:await this.loadMicroApp(e,t)}catch(n){if(t&&!s.isOnline&&n instanceof Vc){await this.failedToLoadMicroAppBundle(),this._microAppObserver.updateLoadStatus(as.Unloaded);return}return Promise.reject(n)}}async mountMicroApp(e=!0){var a,n,r;const{appName:t}=this._appConfig;this.logInfo("Mounting ".concat(t)),e&&(this._store.dispatchIntent(new Hi(!0,this._appConfig.placement)),this._failedToLoadBundle&&await this.clearNoConnectionView());const s=await this.getOrLoadAppInstance(t,e);if(this._failedToLoadBundle)return!0;if(!s)return!1;(a=this._metricDefinitions)==null||a.getMetric(Ae.UAppInitializationAttempt).add(1,{appName:this._appConfig.appName}),this._microAppObserver.updateMountStatus(we.Mounting);try{const o=await q(this._microAppLifeCycleTimeoutInMs,this._microAppObserver.waitForStatus(we.Mounted,[we.Mounted,we.Unmounted]));return o===we.Mounted?((n=this._metricDefinitions)==null||n.getMetric(Ae.UAppInitializationSuccess).add(1,{appName:this._appConfig.appName}),!0):(o===we.Unmounted&&((r=this._metricDefinitions)==null||r.getMetric(Ae.UAppInitializationError).add(1,{appName:t,errorCode:ca.MountFailed})),!1)}catch(o){const l=this._store.getReadonlyState(S);return this.logError("".concat(t," mount failed due to not getting the right status in time"),o),this._microAppObserver.updateMountStatus(we.Unmounted),e&&!l.isOnline?(await this.failedToLoadMicroAppBundle(),!0):!1}}async clearNoConnectionView(){this._failedToLoadBundle=!1,await this._store.dispatchIntent(new Kp(!1,this._appConfig.placement))}async failedToLoadMicroAppBundle(){this._failedToLoadBundle=!0,await this._store.dispatchIntent(new Hi(!1,this._appConfig.placement)),await this._store.dispatchIntent(new Kp(!0,this._appConfig.placement))}async loadMicroApp(e,t){var s;try{this._microAppObserver.updateLoadStatus(as.Loading);const a=await this._instanceLoader.value;return this._microAppObserver.updateLoadStatus(as.Loaded),a}catch(a){const n=this._store.getReadonlyState(S);return this._microAppObserver.updateLoadStatus(as.Unloaded),!n.isOnline&&t?(await this.failedToLoadMicroAppBundle(),Promise.resolve(void 0)):(this.logWarning("".concat(e," load has failed. Not able to get app bundle."),a),(s=this._metricDefinitions)==null||s.getMetric(Ae.UAppInitializationError).add(1,{appName:e,errorCode:ca.BundleDownload}),Promise.reject(a))}}async activateMicroApp(e){var a,n,r;const{appName:t}=this._appConfig,s=this._store.getReadonlyState(S);if((a=this._api)==null||a.performance.mark.start({timestamp:0}),(n=this._api)==null||n.performance.setStartTimeOffset(performance.now()),this._microAppObserver.updateActivationStatus(fi.Activating),this.logInfo("Activating ".concat(t),{applicationData:e.applicationData}),this._failedToLoadBundle)return this._focusable=!1,!0;if(!this._appInstance)return this.logWarning("Failed to activate ".concat(t,". App is not mounted.")),this._microAppObserver.updateActivationStatus(fi.Inactive),!1;try{if(!await q(this._microAppLifeCycleTimeoutInMs,this._appInstance.beforeActivate(e)))return this.logWarning("Failed to activate ".concat(t,". app.beforeActivate() returns false.")),this._microAppObserver.updateActivationStatus(fi.Inactive),!1;await this.showShellContainerOnNativeHost(e,s.activeGame)}catch(o){return this.logWarning("Failed to activate ".concat(t,". app.beforeActivate() throws."),o),(r=this._metricDefinitions)==null||r.getMetric(Ae.UAppInitializationError).add(1,{appName:t,errorCode:ca.BeforeActivate}),this._microAppObserver.updateActivationStatus(fi.Inactive),!1}return this._focusable=!0,this._microAppObserver.updateActivationStatus(fi.Active),this._store.dispatchIntent(new Hi(!1,this._appConfig.placement)),!0}async showShellContainerOnNativeHost(e,t){var a;if(!this._hostCommunicationService)return;const s=await q(Tc.nativeHostRequestTimeoutInMs,this._featureHandlerService.handleFeature(c.ShowShellContainer,{appName:this._appConfig.appName,applicationData:e.applicationData,game:t}));if(s&&!((a=s.response)!=null&&a.isSuccessful))return Promise.reject("Shell container could not be shown on native host")}async requestDeactivation(e){if(this._failedToLoadBundle)return await this.clearNoConnectionView(),{shouldDeactivate:!0};const{appName:t}=this._appConfig;return this.logInfo("Request deactivation for ".concat(t)),this._microAppObserver.microAppDetails.value.active===fi.Inactive||!this._appInstance?(this.logWarning("Not able to deactivate ".concat(t,". App is inactive.")),Promise.reject("Can not deactivate an inactive micro app")):await q(this._microAppLifeCycleTimeoutInMs,this._appInstance.beforeDeactivate(e))}deactivate(){this.logInfo("Deactivating ".concat(this._appConfig.appName,".")),this._microAppObserver.updateActivationStatus(fi.Inactive),this._focusable=!1}async unmountMicroApp(){if(this.logInfo("Request unmount for ".concat(this._appConfig.appName)),!!this._appInstance){this._microAppObserver.updateMountStatus(we.Unmounting);try{await q(this._microAppLifeCycleTimeoutInMs,this._microAppObserver.waitForStatus(we.Mounted,we.Unmounted))}catch(e){this.logWarning("unmount. beforeUnmount fails",e)}this._performanceMeter.clearTransports(),this._api&&(this._api.dispose(),this._api=void 0),this._instanceLoader.clear(),this._appInstance=void 0}}async focusApp(){this.logInfo("Focusing ".concat(this._appConfig.appName,"."));const e=this._appInstance;let t;if(this._failedToLoadBundle)return!1;if(e){if(!this._focusable)return!1;try{e.focus&&(await Gs(0),t=await q(this._changeFocusTimeoutInMs,e.focus()))}catch(s){return this.logWarning("Failed to focus ".concat(this._appConfig.appName,". app.focus() throws"),s),!1}}else return this.logWarning("Failed to focus app ".concat(this._appConfig.appName,". App is not loaded")),!1;return typeof t=="boolean"?t:!0}async blurApp(){var t;this.logInfo("Blur ".concat(this._appConfig.appName,"."));const e=this._appInstance;if(this._failedToLoadBundle)return!0;if(e)try{return e.blur&&await q(this._changeFocusTimeoutInMs,e.blur()),document.activeElement!=null&&((t=document.activeElement)==null||t.blur()),!0}catch(s){return this.logWarning("Failed to blur app ".concat(this._appConfig.appName,". app.blur() throws"),s),!1}return!0}async tryLoadApp(){try{return await this._instanceLoader.value!==void 0}catch(e){return!1}}async ensureModuleLoaded(){const{appName:e}=this._appConfig;let t=this._appConstructor;if(!t)try{return this.logInfo("Loading module for ".concat(e)),t=await q(this._microAppLoadTimeoutInMs,this._bundleLoader.loadModule({bundleUrl:this._appConfig.bundleUrl,integrityHash:this._appConfig.integrityHash,name:e})),this._appConstructor=t,t}catch(s){return this.logError("Error when loading app module",s),Promise.reject(s)}return t}async ensureAppLoaded(){if(this._appInstance)return this._appInstance;let e=this._appConstructor;this._api=this.createShellApi(),this._api.performance.mark.start({timestamp:0}),this._api.performance.setStartTimeOffset(performance.now());try{this._api.performance.mark.bundleLoadStart(),e=await this.ensureModuleLoaded(),this._api.performance.mark.bundleLoadEnd()}catch(s){return Promise.reject(s)}this._api.performance.mark.constructorInvoked();const t=new e(this._api,this._appConfig);if(this._api.performance.mark.instantiated(),t.appName!==this._appConfig.appName&&t.appName!==this._appConfig.alternativeName){const s="Expected microapp: ".concat(this._appConfig.appName," but received: ").concat(t.appName);return this.logWarning("Incorrect configuration for ".concat(this._appConfig.appName,"."),s),this._api.softDispose(),this._api=void 0,Promise.reject(s)}return this._appInstance=t,this._api.applicationId=t.applicationId,this._api.applicationBuildId=this.getAppVersion(),this._performanceMeter.context={applicationName:this._appConfig.appName,applicationBuildId:this.getAppVersion(),applicationId:t.applicationId,spaceId:this._appConfig.spaceId},this.performVersionDependentActions(),this._appInstance}performVersionDependentActions(){if(!this._appConstructor)return;this.getMicroAppApiVersion(this._appConstructor)==="1"&&(this._shouldUpdateApi=!1)}getMicroAppApiVersion(e){return this.isApiVersion(e)?"".concat(e.apiVersion):""}isApiVersion(e){return"apiVersion"in e}createShellApi(){const e=this._apiFactory.createAppropriateApi(this._store,this._appConfig,this._logger,this._pluginsService,this._featureHandlerService,this._pcClientCommunication);return e.performance=this._performanceMeter,e}getApiBase(){return new Proxy(new eL(this._store,this._appConfig.appName,this._appConfig.spaceId,this._shellConfig.shellApplicationId,this._logger,this._pluginsService,this._featureHandlerService,this._pcClientCommunication),new mr(this._pluginsService))}async updateApi(){this._shouldUpdateApi&&this._appInstance&&this._api&&await this._appInstance.apiUpdated(this._api)}async scrollAppContent(e){const t=this._appInstance;if(t)try{if(this._focusable&&t.scrollContent)return await q(this._scrollContentTimeoutInMs,t.scrollContent(e)),!0}catch(s){this.logWarning("Failed to scroll content for ".concat(this._appConfig.appName),s)}return!1}canCheckAppIsAvailable(e){return"appIsAvailable"in e}async appIsAvailable(e){var t;try{await this.ensureModuleLoaded()}catch(s){return!1}try{const s=this.getApiBase();if(this.canCheckAppIsAvailable(this._appConstructor))return q(this._microAppAvailabilityCheckTimeoutInMs,this._appConstructor.appIsAvailable(e,s))}catch(s){return this.logWarning("Failed to check if ".concat(this._appConfig.appName," is available. app.appIsAvailable throws"),s),(t=this._metricDefinitions)==null||t.getMetric(Ae.UAppInitializationError).add(1,{appName:this._appConfig.appName,errorCode:ca.AppIsAvailable}),!1}return!0}};Tc.nativeHostRequestTimeoutInMs=2e3;let yu=Tc;const Rc=class Rc{constructor(e,t,s,a){this._appConfig=e,this._store=t,this._logger=s,this._featureHandlerService=a,this._mounted=!1,this._activated=!1,this._lifeGuardLogger=s.createChild("NativeLifeGuard"),this._lifeGuardLogger.settings.logCategory=f.microAppLifecycle,this.logDebug("Created new native lifeguard for ".concat(e.appName))}getDescription(){return"".concat(this._appConfig.appName,":").concat(this._mounted?"mounted":"unmounted")}getAppVersion(){return"unknown"}getAppApplicationId(){}get mounted(){return this._mounted}async mountMicroApp(e=!0){return this.logInfo("Mount native micro app ".concat(this._appConfig.appName)),e&&this._store.dispatchIntent(new Hi(!0,this._appConfig.placement)),this._mounted||(this._mounted=!0),this._mounted}async activateMicroApp(e){var t;if(this.logInfo("Activating native ".concat(this._appConfig.appName),e.applicationData),!this._mounted)return this.logWarning("Failed to activate native ".concat(this._appConfig.appName,". App is not mounted."),g.FailedToActivateNativeMicroAppWarning),!1;if(!this._activated){try{const s=await q(Rc.requestTimeoutInMs,this._featureHandlerService.handleFeature(c.ShowNativePart,{appName:this._appConfig.appName,game:e.game,applicationData:e.applicationData}));if(s!==null&&!((t=s==null?void 0:s.response)!=null&&t.isSuccessful))return this.logWarning("Native ".concat(this._appConfig.appName," could not be shown"),g.FailedToShowNativeMicroappWarning),!1}catch(s){return this.logWarning("Showing of native ".concat(this._appConfig.appName," failed with error"),g.FailedToShowNativeMicroappWarning,s),!1}this._store.dispatchIntent(new Hi(!1,this._appConfig.placement)),this._activated=!0}return this._activated}async requestDeactivation(){if(this.logInfo("Hide native ".concat(this._appConfig.appName)),!this._activated)return this.logWarning("Not able to deactivate native ".concat(this._appConfig.appName,". App is inactive."),g.FailedToDeactivateNativeMicroAppWarning),Promise.reject("Can not deactivate an inactive micro app");const t=this._store.getReadonlyState(Y).currentItem(this._appConfig.placement);return{confirmationRequired:!1,applicationData:t==null?void 0:t.applicationData}}deactivate(){this.logInfo("Deactivating native ".concat(this._appConfig.appName,".")),this._activated=!1}async unmountMicroApp(){this.logInfo("Unmounting native ".concat(this._appConfig.appName,".")),this._mounted=!1}async focusApp(){return this.logInfo("Focusing ".concat(this._appConfig.appName,".")),!0}async blurApp(){return this.logInfo("Blur ".concat(this._appConfig.appName,".")),!0}async tryLoadApp(){return!0}async scrollAppContent(e){return!0}logWarning(e,t,s,a){this._lifeGuardLogger.warn(e,{moreInfo:Object.assign({appConfig:this._appConfig},a),error:s,errorCode:t})}logDebug(e,t){this._lifeGuardLogger.debug(e,{appConfig:this._appConfig,data:t})}logInfo(e,t){this._lifeGuardLogger.info(e,{appConfig:this._appConfig,data:t})}async updateApi(){}async appIsAvailable(e){return!0}};Rc.requestTimeoutInMs=2e3;let vu=Rc;var gn=(i=>(i.GameLaunch="gameLaunch",i.ProductUninstall="productUninstall",i))(gn||{});class r9 extends d("[Shell] Initialize Game Launch Window"){constructor(e,t){super(),this.info=e,this.options=t}}class iL extends d("[Shell] Initialize Game Launch"){constructor(e,t){super(),this.info=e,this.options=t}}class sL extends d("[Shell] Launch Game"){constructor(e,t){super(),this.info=e,this.options=t}}class aL extends d("[Shell] Game launched"){constructor(e,t){super(),this.info=e,this.launchState=t}}class nL extends d("[Shell] Close Game Launch Window"){constructor(e){super(),this.closeReason=e}}class rL extends d("[Shell] Get Game Launch Content"){constructor(e,t){super(),this.spaceId=e,this.localeCode=t}}function Yt(i){return Hc(function(e,t){typeof e.inject>"u"&&(e.inject={}),Array.isArray(e.inject)||(e.inject[t]=i||t)})}var o9=typeof Reflect<"u"&&typeof Reflect.getMetadata<"u";function c9(i,e,t){if(o9&&!Array.isArray(i)&&typeof i!="function"&&typeof i.type>"u"){var s=Reflect.getMetadata("design:type",e,t);s!==Object&&(i.type=s)}}function W(i){return i===void 0&&(i={}),function(e,t){c9(i,e,t),Hc(function(s,a){(s.props||(s.props={}))[a]=i})(e,t)}}function Mt(i,e){e===void 0&&(e={});var t=e.deep,s=t===void 0?!1:t,a=e.immediate,n=a===void 0?!1:a;return Hc(function(r,o){typeof r.watch!="object"&&(r.watch=Object.create(null));var l=r.watch;typeof l[i]=="object"&&!Array.isArray(l[i])?l[i]=[l[i]]:typeof l[i]>"u"&&(l[i]=[]),l[i].push({handler:o,deep:s,immediate:n})})}function Dl(i){return Hc(function(e,t){e.computed=e.computed||{},e.computed[t]={cache:!1,get:function(){return this.$refs[i||t]}}})}class cs extends oe("[Shell] Game Launch"){constructor(){super(...arguments),this._gameLaunchInformation=null,this._gameLaunchSpaceCard=null,this._hasError=!1}get gameLaunchInformation(){return this._gameLaunchInformation}set gameLaunchInformation(e){this._gameLaunchInformation=e}get gameLaunchSpaceCard(){return this._gameLaunchSpaceCard}set gameLaunchSpaceCard(e){this._gameLaunchSpaceCard=e}get hasError(){return this._hasError}set hasError(e){this._hasError=e}}var l9=Object.defineProperty,p9=Object.getOwnPropertyDescriptor,u9=(i,e,t,s)=>{for(var a=s>1?void 0:s?p9(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&l9(e,t,a),a};let _u=class extends K{};_u=u9([j({})],_u);var d9=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",[t("svg",{staticClass:"spinner-ubi-logo",attrs:{xmlns:"http://www.w3.org/2000/svg",id:"spinner-logo",version:"1.1",width:"64rem",height:"64rem",viewBox:"0 0 1000 1000"}},[t("path",{staticClass:"animPath",attrs:{id:"outer",d:"M107.465,320.875\n			  		c132.124,-227.934 362.132,-282.694 558.83,-187.228\n			  		c219.943,106.747 291.987,349.056 194.128,563.938\n			  		c-89.729,197.031 -321.623,263.657 -501.978,192.833\n			  		c-247.18,-97.067 -316.925,-398.402 -195.854,-562.145"}}),t("path",{staticClass:"animPath",attrs:{id:"inner",d:"M194.738,352.133\n			  		c-104.621,150.596 -36.537,400.93 149.922,489.826\n			  		c174.734,83.305 399.165,18.623 480.167,-165.814\n			  		c84.089,-191.465 25.558,-408.345 -173.404,-504.591\n			  		c-182.444,-88.256 -380.281,-36.764 -497.852,149.89"}}),t("path",{staticClass:"animPath",attrs:{id:"inner-small",d:"M421.15,550.913c-37.702,49.392 -24.885,115.632\n                    21.801,146.464c50.433,33.307 116.551,13.337 147.353,\n                    -38.585c33.065,-55.738 19.204,-121.397 -29.45,\n                    -156.273c-60.795,-43.579 -137.436,-26.802 -169.606,28.168"}}),t("path",{staticClass:"animPath",attrs:{id:"swirl-big",d:"M184.24,277.894\n			  		c127.832,-193.355 420.915,-209.999 592.564,-21.079\n			  		c135.459,149.09 133.632,423.525 -54.497,557.534\n			  		c-193.031,137.5 -356.895,47.463 -429.001,-46.439\n			  		c-68.703,-89.471 -63.248,-236.917 34.64,-306.439\n			  		c77.014,-54.697 -125.969,108.711 24.172,271.814\n			  		c63.915,69.435 218.001,91.092 315.585,-5.899\n			  		c101.086,-100.472 109.719,-286.922 11.21,-397.098\n			  		c-251.728,-281.541 -530.307,1.504 -494.673,-52.394Z"}}),t("path",{staticClass:"animPath",attrs:{id:"swirl-small",d:"M162.306,644.9\n			  		c-57.804,-109.95 7.921,-288.445 171.603,-344.738\n			  		c167.214,-57.508 304.003,60.023 329.896,152.184\n			  		c21.467,76.405 -107.222,-158.419 -303.954,-91.807\n			  		c-253.891,85.965 -158.553,358.527 -197.545,284.361Z"}})])])},h9=[];function Z(i,e,t,s,a,n,r,o){var l=typeof i=="function"?i.options:i;e&&(l.render=e,l.staticRenderFns=t,l._compiled=!0),s&&(l.functional=!0),n&&(l._scopeId="data-v-"+n);var u;if(r?(u=function(b){b=b||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!b&&typeof __VUE_SSR_CONTEXT__<"u"&&(b=__VUE_SSR_CONTEXT__),a&&a.call(this,b),b&&b._registeredComponents&&b._registeredComponents.add(r)},l._ssrRegister=u):a&&(u=o?function(){a.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:a),u)if(l.functional){l._injectStyles=u;var v=l.render;l.render=function(I,R){return u.call(R),v(I,R)}}else{var w=l.beforeCreate;l.beforeCreate=w?[].concat(w,u):[u]}return{exports:i,options:l}}const yf={};var g9=Z(_u,d9,h9,!1,m9,"6f760877",null,null);function m9(i){for(let e in yf)this[e]=yf[e]}const Ol=function(){return g9.exports}();var f9=Object.defineProperty,y9=Object.getOwnPropertyDescriptor,Pn=(i,e,t,s)=>{for(var a=s>1?void 0:s?y9(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&f9(e,t,a),a};const v9=()=>G(()=>import("./GenericError.component-11f883df.js"),["assets/GenericError.component-11f883df.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/GenericError.component-416a7c77.css"]);let Us=class extends K{constructor(){super(...arguments),this.backgroundImg=null}async stateUpdate(){const e=await this.$dispatch(new rL(this.gameLaunchInformation.info.spaceId,this.playerLocal));e&&(this.backgroundImg=e==null?void 0:e.displayImages.background)}get gameDisplayName(){var e;return((e=this.gameLaunchSpaceCard)==null?void 0:e.displayName)||""}get shouldShowSpinner(){return!this.gameLaunchSpaceCard&&!this.hasError}get shouldShowProgressScreen(){return this.gameLaunchSpaceCard&&!this.hasError}};Pn([C(cs,"gameLaunchInformation")],Us.prototype,"gameLaunchInformation",2);Pn([C(cs,"gameLaunchSpaceCard")],Us.prototype,"gameLaunchSpaceCard",2);Pn([C(S,"playerLocale")],Us.prototype,"playerLocal",2);Pn([C(cs,"hasError")],Us.prototype,"hasError",2);Pn([Mt("gameLaunchInformation")],Us.prototype,"stateUpdate",1);Us=Pn([j({components:{"spinner-ubi-logo":Ol,"generic-error-module":v9}})],Us);var _9=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"game-launch"},[t("img",{ref:"background",staticClass:"background",class:{"background--ready":i.backgroundImg,"background--has-error":i.hasError},attrs:{src:i.backgroundImg,alt:""}}),t("transition",{attrs:{name:"fade",mode:"out-in"}},[i.shouldShowSpinner?t("div",{key:"spinner",staticClass:"spinner"},[t("spinner-ubi-logo")],1):i._e(),i.shouldShowProgressScreen?t("div",{key:"progress",staticClass:"progress-container"},[t("h1",{staticClass:"progress-container-name"},[i._v(" "+i._s(i.gameDisplayName)+" ")])]):i._e(),i.hasError?t("div",{staticClass:"error-container"},[t("generic-error-module")],1):i._e()])],1)},S9=[];const vf={};var w9=Z(Us,_9,S9,!1,b9,"089385bc",null,null);function b9(i){for(let e in vf)this[e]=vf[e]}const C9=function(){return w9.exports}();class oL{constructor(e){this._store=e}mount(e){const t=this.createVueInstance();return t.$mount(),e.append(t.$el),!0}}class I9 extends oL{createVueInstance(){return new C9({store:this._store})}async beforeActivate(e){const t=e.applicationData,s={applicationId:t.applicationId,spaceId:t.spaceId,productId:t.productId,executableId:t.executableId};let a;return t.skipAchievementsSync&&(a={skipAchievementsSync:t.skipAchievementsSync}),this._store.dispatchIntent(new iL(s,a)),!0}}class M9 extends d("[Shell] Initialize Product Uninstall Window Intent"){constructor(e){super(),this.gameInfo=e}}class cL extends d("[Shell] Initialize Product Uninstall Intent"){constructor(e){super(),this.gameInfo=e}}class lL extends d("[Shell] Uninstall Product Intent"){constructor(e){super(),this.gameInfo=e}}class zr extends oe("[Shell] Product Uninstall"){constructor(){super(...arguments),this._gameInfo=null,this._spaceCard=null,this._hasError=!1}get gameInfo(){return this._gameInfo}set gameInfo(e){this._gameInfo=e}get spaceCard(){return this._spaceCard}set spaceCard(e){this._spaceCard=e}get hasError(){return this._hasError}set hasError(e){this._hasError=e}}var A9=Object.defineProperty,P9=Object.getOwnPropertyDescriptor,jg=(i,e,t,s)=>{for(var a=s>1?void 0:s?P9(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&A9(e,t,a),a};class Fl extends K{}jg([C(zr,"gameInfo")],Fl.prototype,"gameInfo",2);jg([C(zr,"spaceCard")],Fl.prototype,"spaceCard",2);jg([C(zr,"hasError")],Fl.prototype,"hasError",2);var N9=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"product-uninstall"})},T9=[];const _f={};var R9=Z(Fl,N9,T9,!1,D9,"7b958b53",null,null);function D9(i){for(let e in _f)this[e]=_f[e]}const O9=function(){return R9.exports}();class F9 extends oL{createVueInstance(){return new O9({store:this._store})}async beforeActivate(e){const t=e.applicationData;return this._store.dispatchIntent(new cL(t)),!0}}class L9{constructor(e){this._store=e}createAppInstance(e){switch(e){case gn.GameLaunch:return new I9(this._store);case gn.ProductUninstall:return new F9(this._store)}}}const G9=2e3;class x9 extends tL{constructor(e,t,s,a,n=new L9(t)){super(e,t,s,a),this._shellMicroAppFactory=n,this._mounted=!1,this._activated=!1,this.logDebug("Created new shell lifeguard for ".concat(e.appName))}getDescription(){return"".concat(this._appConfig.appName,":").concat(this._mounted?"mounted":"unmounted")}getAppVersion(){return"embedded/shell micro app"}getAppApplicationId(){}async makeVisibleAndHideAllOtherMicroApps(){var e;this._appContainerElement&&((e=(await this.getContainerDiv()).childNodes)==null||e.forEach(s=>{if("hidden"in s){const a=s;a.hidden=!0,a.removeAttribute("data-e2e")}}),this._store.dispatchIntent(new Hi(!1,this._appConfig.placement)),this._appContainerElement.hidden=!1,this._appContainerElement.setAttribute("data-e2e","active-microapp"))}async mountMicroApp(e=!0){const{appName:t}=this._appConfig;if(this.logInfo("Mounting ".concat(t)),e&&this._store.dispatchIntent(new Hi(!0,this._appConfig.placement)),!this._appContainerElement)try{const s=await this.getContainerDiv();if(this._appContainerElement=document.createElement("div"),this._appContainerElement.id=this._appConfig.appName,this._appContainerElement.hidden=!0,this._appInstance=this._shellMicroAppFactory.createAppInstance(this._appConfig.appName),this._appInstance)if(this._appInstance.mount(this._appContainerElement))s.appendChild(this._appContainerElement);else return this.logWarning("".concat(t," mount has failed. app.mount() returns false")),!1;else return this.logWarning("".concat(t," mount has failed. Not able to create app instance")),!1}catch(s){return this.logWarning("".concat(t," mount has failed. app.mount() throws"),s),Promise.reject(s)}return this._mounted||(this._mounted=!0),this._mounted}get mounted(){return this._mounted}async activateMicroApp(e){const{appName:t}=this._appConfig;if(this.logInfo("Activating ".concat(t),{applicationData:e.applicationData}),!this._mounted||!this._appInstance)return this.logWarning("Failed to activate ".concat(t,". App is not mounted.")),!1;if(!this._activated){try{if(!await q(G9,this._appInstance.beforeActivate(e)))return this.logWarning("Failed to activate ".concat(t,". app.beforeActivate() returns false.")),!1}catch(s){return this.logWarning("Failed to activate ".concat(t,". app.beforeActivate() throws."),s),!1}this._activated=!0}return await this.makeVisibleAndHideAllOtherMicroApps(),this._activated}async requestDeactivation(){const{appName:e}=this._appConfig;if(this.logInfo("Requesting deactivation for ".concat(e)),!this._activated)return this.logWarning("Not able to deactivate ".concat(e,". App is inactive.")),Promise.reject("Can not deactivate an inactive micro app");const s=this._store.getReadonlyState(Y).currentItem(this._appConfig.placement);return{confirmationRequired:!1,applicationData:s==null?void 0:s.applicationData}}deactivate(){this.logInfo("Deactivating ".concat(this._appConfig.appName,".")),this._activated=!1}async unmountMicroApp(){var e;this.logInfo("Unmounting ".concat(this._appConfig.appName,".")),(e=this._appContainerElement)==null||e.remove(),this._appContainerElement=void 0,this._appInstance=void 0,this._mounted=!1}async focusApp(){return this.logInfo("Focusing ".concat(this._appConfig.appName,".")),!0}async blurApp(){return this.logInfo("Blur ".concat(this._appConfig.appName,".")),!0}async tryLoadApp(){return!0}async scrollAppContent(e){return!0}async updateApi(){}async appIsAvailable(e){return!0}}class E9{constructor(e,t,s,a,n,r,o,l,u,v,w,b,I,R,x,F=6e4,V=2e4,ce=1e3,Ue=1e3,ke=2e4){this._store=e,this._logger=t,this._rootPerformanceLogger=s,this._placementContainersService=a,this._shellConfig=n,this._microAppLifeCycle=r,this._apiFactory=o,this._metricDefinitions=l,this._featureHandlerService=u,this._pluginsService=v,this._performanceMetricTransportsProvider=w,this._cumulativeLayoutShiftInstrument=b,this._interactionToNextPaintInstrument=I,this._hostCommunicationService=R,this._pcClientCommunication=x,this._microAppLoadTimeoutInMs=F,this._microAppLifeCycleTimeoutInMs=V,this._changeFocusTimeoutInMs=ce,this._scrollContentTimeoutInMs=Ue,this._microAppAvailabilityCheckTimeoutInMs=ke,this._loader=new Rl(JF)}create(e){switch(e.microAppType){case dn.ShellApp:return new x9(e,this._store,this._logger,this._placementContainersService);case dn.NativeApp:return new vu(e,this._store,this._logger,this._featureHandlerService);default:{const t=new YF({predefinedMarksMap:gE,trackedMetrics:rs,logger:this._rootPerformanceLogger,context:{applicationName:e.appName,spaceId:e.spaceId},transportProvider:this._performanceMetricTransportsProvider,timeOffset:performance.now()});return new yu(e,this._store,this._logger,this._placementContainersService,this._microAppLifeCycle,this._shellConfig,this._apiFactory,this._microAppLoadTimeoutInMs,this._microAppLifeCycleTimeoutInMs,this._changeFocusTimeoutInMs,this._scrollContentTimeoutInMs,this._microAppAvailabilityCheckTimeoutInMs,this._featureHandlerService,this._pluginsService,t,this._metricDefinitions,this._cumulativeLayoutShiftInstrument,this._interactionToNextPaintInstrument,this._hostCommunicationService,this._pcClientCommunication,this._loader)}}}}const Sf=i=>{let e;const t=new Set,s=(v,w)=>{const b=typeof v=="function"?v(e):v;if(!Object.is(b,e)){const I=e;e=(w!=null?w:typeof b!="object"||b===null)?b:Object.assign({},e,b),t.forEach(R=>R(e,I))}},a=()=>e,l={setState:s,getState:a,getInitialState:()=>u,subscribe:v=>(t.add(v),()=>t.delete(v)),destroy:()=>{t.clear()}},u=e=i(s,a,l);return l},pL=i=>i?Sf(i):Sf;var uL={exports:{}},dL={},hL={exports:{}},gL={};var mn=U;function U9(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var k9=typeof Object.is=="function"?Object.is:U9,W9=mn.useState,V9=mn.useEffect,$9=mn.useLayoutEffect,B9=mn.useDebugValue;function H9(i,e){var t=e(),s=W9({inst:{value:t,getSnapshot:e}}),a=s[0].inst,n=s[1];return $9(function(){a.value=t,a.getSnapshot=e,Ip(a)&&n({inst:a})},[i,t,e]),V9(function(){return Ip(a)&&n({inst:a}),i(function(){Ip(a)&&n({inst:a})})},[i]),B9(t),t}function Ip(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!k9(i,t)}catch(s){return!0}}function Q9(i,e){return e()}var j9=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Q9:H9;gL.useSyncExternalStore=mn.useSyncExternalStore!==void 0?mn.useSyncExternalStore:j9;hL.exports=gL;var q9=hL.exports;var Ll=U,z9=q9;function K9(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var X9=typeof Object.is=="function"?Object.is:K9,J9=z9.useSyncExternalStore,Y9=Ll.useRef,Z9=Ll.useEffect,e$=Ll.useMemo,t$=Ll.useDebugValue;dL.useSyncExternalStoreWithSelector=function(i,e,t,s,a){var n=Y9(null);if(n.current===null){var r={hasValue:!1,value:null};n.current=r}else r=n.current;n=e$(function(){function l(I){if(!u){if(u=!0,v=I,I=s(I),a!==void 0&&r.hasValue){var R=r.value;if(a(R,I))return w=R}return w=I}if(R=w,X9(v,I))return R;var x=s(I);return a!==void 0&&a(R,x)?(v=I,R):(v=I,w=x)}var u=!1,v,w,b=t===void 0?null:t;return[function(){return l(e())},b===null?void 0:function(){return l(b())}]},[e,t,s,a]);var o=J9(i,n[0],n[1]);return Z9(function(){r.hasValue=!0,r.value=o},[o]),t$(o),o};uL.exports=dL;var i$=uL.exports;const s$=DS(i$),{useDebugValue:a$}=OS,{useSyncExternalStoreWithSelector:n$}=s$;const r$=i=>i;function fr(i,e=r$,t){const s=n$(i.subscribe,i.getState,i.getServerState||i.getInitialState,e,t);return a$(s),s}const mL=pL(()=>({microAppLifeCycle:void 0,focusSystem:void 0,logger:void 0,localStorageService:void 0,pluginService:void 0,localizationService:void 0})),yr=pL(()=>({store:void 0,watchers:void 0}));class o${constructor(){this._getters=new Map}get(e){var t;return(t=this._getters.get(e))!=null?t:[]}byKey(e){return this.get(e).reduce((t,s)=>{var a,n;return(n=t[a=s.key])!=null||(t[a]=[]),t[s.key].push(s),t},{})}add(e,t,s,a){this._getters.set(e.moduleName,[...this.get(e.moduleName),{key:t,cb:s,uuid:a}])}remove({moduleName:e},t){const s=this.get(e).filter(a=>a.uuid!==t);if(s.length===0){this._getters.delete(e);return}this._getters.set(e,s)}}class c${constructor(e){this._store=e,this._watchers=[],this._stateGetters=new o$}addWatcher(e,t,s){const a=qt.newId();return this._stateGetters.add(e,t,s,a),this.addStateWatcher(e),()=>{this._stateGetters.remove(e,a),this.cleanup(e)}}cleanup({moduleName:e}){var t,s;((t=this._stateGetters.get(e))==null?void 0:t.length)>0||((s=this._watchers.find(a=>a.stateSlice.moduleName===e))==null||s.unwatch(),this._watchers=this._watchers.filter(a=>a.stateSlice.moduleName!==e))}addStateWatcher(e){const t=this.createStoreWatcher(e),s=this._watchers.find(a=>a.stateSlice.moduleName===e.moduleName);if(!s){this._watchers.push({stateSlice:e,unwatch:t});return}s.unwatch(),s.unwatch=t}createStoreWatcher(e){const s=Object.entries(this._stateGetters.byKey(e.moduleName)).map(([a,n])=>{const r=n;return this._store.watch(()=>this._store.getReadonlyState(e)[a],(o,l)=>r.forEach(u=>u.cb(o,l)),{deep:!0})});return()=>{s.forEach(a=>a())}}}const l$=i=>{yr.setState({store:i,watchers:new c$(i)})},p$=i=>{mL.setState({microAppLifeCycle:i.microAppLifeCycle,focusSystem:i.focusSystemService.focusSystem,logger:i.logger,localStorageService:i.localStorageService,pluginService:i.pluginsService,localizationService:i.localizationService})},Gl=()=>{const i=fr(mL);return U.useMemo(()=>({microAppLifeCycle:i.microAppLifeCycle,focusSystem:i.focusSystem,logger:i.logger,localStorageService:i.localStorageService,pluginService:i.pluginService,localizationService:i.localizationService}),[i])},qg=()=>{const i=fr(yr,t=>t.store);return U.useCallback(t=>i.dispatchIntent(t),[i])},$i=(i,e,t={deep:!0,immediate:!1})=>{const s=fr(yr,r=>r.store),[a,n]=U.useState(()=>e(s.getReadonlyState(i)));return U.useEffect(()=>s.watch(()=>e(s.getReadonlyState(i)),o=>n(o),t),[s]),a},Mi=(i,e)=>{const t=fr(yr,r=>r.store),s=fr(yr,r=>r.watchers),[a,n]=U.useState(()=>t.getReadonlyState(i)[e]);return U.useEffect(()=>s==null?void 0:s.addWatcher(i,e,o=>{n(Array.isArray(o)?structuredClone(o):o)}),[t]),a};class u${constructor(e){this._logger=e,this._cacheProviders=new Map,this._logger=this._logger.createChild("CacheService"),this._logger.settings.logCategory=f.serviceWorker}async getSharedCache(e,t){var s;return(s=await this.getProvider(e))==null?void 0:s.getSharedCache(t)}async getCache(e,t,s){var a;return(a=await this.getProvider(e))==null?void 0:a.getCache(t,s)}async getProvider(e){const t=this._cacheProviders.get(e);if(t===void 0&&e===Wp.ApolloV3)try{const s=new(await le(()=>G(()=>import("./ApolloCacheProvider-ef025ed0.js"),["assets/ApolloCacheProvider-ef025ed0.js","assets/vendor-ff46a377.js","assets/upn-vendor-bf1ed58d.js"]))).ApolloCacheProvider(this._logger);return this._cacheProviders.set(Wp.ApolloV3,s),s}catch(s){this._logger.error("Non-critical subsystem unavailable, ApolloCacheProvider, ".concat(s instanceof Error?s.message:""));return}if(!t){this._logger.warn("Unsupported cache type is requested",{cacheType:e,errorCode:g.CacheServiceUnsupportedRequestWarning});return}return t}}var fL=(i=>(i[i.Click=0]="Click",i[i.Dismiss=1]="Dismiss",i[i.Timeout=2]="Timeout",i))(fL||{});class zg{constructor(e,t,s){this._store=e,this._localizationService=t,this._logger=s,this._hasChatMessageNotification=!1}triggerNotification(e){switch(e.type){case O.FriendInGame:this.triggerDesktopNotification(O.FriendInGame,e.payload.myFriendName,{body:this._localizationService.formatMessage({id:"message.friendPlaying"},{game:e.payload.myGameName,username:e.payload.myFriendName}),icon:e.payload.myFriendAvatarUrl},{appName:J.AppGamerProfile,applicationData:{userId:e.payload.myAccountId}});break;case O.FriendOnline:this.triggerDesktopNotification(O.FriendOnline,e.payload.myFriendName,{body:this._localizationService.formatMessage({id:"message.friendOnline"},{username:e.payload.myFriendName}),icon:e.payload.myFriendAvatarUrl},{appName:J.AppChat,applicationData:{createChatWithParticipants:{members:[e.payload.myAccountId]}}});break;case O.PlayAvailable:this.triggerDesktopNotification(O.PlayAvailable,e.payload.myGameName,{body:this._localizationService.formatMessage({id:"message.gameReadyToPlay"},{game:e.payload.myGameName}),icon:e.payload.myArtUrl},this.getDeeplinkToGame(e.payload.myProductId));break;case O.DownloadCompleted:this.triggerDesktopNotification(O.DownloadCompleted,e.payload.myGameName,{body:this._localizationService.formatMessage({id:"message.downloadComplete"},{game:e.payload.myGameName}),icon:e.payload.myArtUrl},this.getDeeplinkToGame(e.payload.myProductId));break;case O.FriendRequest:this.triggerDesktopNotification(O.FriendRequest,e.payload.myFriendName,{body:this._localizationService.formatMessage({id:"message.friendInvite"},{username:e.payload.myFriendName}),icon:e.payload.myFriendAvatarUrl},{appName:J.AppGamerProfile,applicationData:{userId:e.payload.myAccountId}});break;case O.ChatMessage:this.triggerDesktopNotification(O.ChatMessage,e.payload.myFriendName,{body:e.payload.myMessage,icon:e.payload.myFriendAvatarUrl},{appName:J.AppChat,applicationData:{loadChannelById:e.payload.myChannelId}});break;case O.GameInvite:this.triggerDesktopNotification(O.GameInvite,e.payload.myFriendName,{body:this._localizationService.formatMessage({id:"message.friendGameInvite"},{username:e.payload.myFriendName}),icon:e.payload.myFriendAvatarUrl},{appName:J.AppChat,applicationData:{loadChannelById:e.payload.myChannelId}});break;case O.GroupInvite:this.triggerDesktopNotification(O.GroupInvite,e.payload.myFriendName,{body:this._localizationService.formatMessage({id:"message.groupInvite"},{group:e.payload.myGroupName}),icon:e.payload.myInviterAvatarUrl},{appName:J.AppChat,applicationData:{loadChannelById:e.payload.myChannelId}});break}}async navigateToApp(e){const t=e.game!==void 0?e.game:this._store.getReadonlyState(S).activeGame,s=await this._store.dispatchIntent(new Xe(e.appName,t));if(s===void 0)return;const a={appName:e.appName,game:t,applicationData:e.applicationData,parentAppName:s};this._store.dispatchIntent(new Be(a,{direction:ci.forwards,callerMicroAppName:"DesktopNotificationService"}))}triggerDesktopNotification(e,t,s,a){if(e===O.ChatMessage){if(this._hasChatMessageNotification)return;this._hasChatMessageNotification=!0}const n=new window.Notification(t,s);if(!n){this._logger.warn("Fail to trigger desktop notification of type",{notificationType:O[e],title:t,options:s,deeplink:a,errorCode:g.FailedToTriggerDesktopNotification});return}n.addEventListener("click",()=>{e===O.ChatMessage&&(this._hasChatMessageNotification=!1),this._store.dispatchIntent(new hr("shellDesktopNotificationAction",{notificationType:e,act:fL.Click})),a&&this.navigateToApp(a)}),e===O.ChatMessage&&(n.addEventListener("close",()=>{this._hasChatMessageNotification=!1}),n.addEventListener("error",()=>{this._hasChatMessageNotification=!1})),this._store.dispatchIntent(new hr("shellDesktopNotificationDisplayed",{notificationType:e}))}getDeeplinkToGame(e){const s=this._store.getReadonlyState(An).getGameEntitlement(e.toString());return s?{appName:J.ProductDetails,game:{spaceId:s.spaceId,applicationId:s.applicationId},applicationData:{productId:e}}:{appName:J.Library}}static createIfSupported(e,t,s,a,n){if([p.PCLegacyClient,p.SteamClient].includes(t)&&!e&&"Notification"in window)return new zg(s,a,n)}}class d${constructor(e,t){this._logger=e,this._store=t,this._featureHandlerMap=new Map}registerFeatureWithPayloadHandler(e,t){this.registerFeatureHandler(e,t)}registerFeatureWithoutPayloadHandler(e,t){this.registerFeatureHandler(e,t)}registerFeatureHandler(e,t){this.canDispatchFeature(e)?this._logger.warn("Feature handler has already been registered.",{featureId:e,logCategory:f.hostCommunication,errorCode:g.FeatureHandlerAlreadyRegisteredWarning}):(this._store.dispatchIntent(new uD(e)),this._featureHandlerMap.set(e,t))}canDispatchFeature(e){return this._featureHandlerMap.has(e)}async dispatch(e,t){const s=this._featureHandlerMap.get(e);return s?this._logger.debug("Dispatching feature ".concat(e),{featureId:e,debugEntryType:pn.FeatureDispatched,logCategory:f.hostCommunication}):this._logger.warn("Unable to handle feature.",{featureId:e,logCategory:f.hostCommunication,errorCode:g.UnableToHandleFeaturedWarning}),s?s(t):void 0}}class h${constructor(e){this._store=e}async reportFatalError(e){this._store.dispatchIntent(new mO(e==null?void 0:e.appConfig))}}class g${constructor(e,t,s=new h$(e)){this._store=e,this._hostFeatureDispatcherService=t,this._standardFeatureService=s}set pluginService(e){this._pluginService=e}async handleFeatureWithoutPayload(e){return this.handleFeature(e,void 0)}async handleFeature(e,t){var a;if((a=this._store.getReadonlyState(Q).hostFeatures)!=null&&a.includes(e)&&this._hostFeatureDispatcherService.canDispatchFeature(e))return this._hostFeatureDispatcherService.dispatch(e,t).then(n=>{var r;return(r=this._pluginService)==null||r.executeSpyEventHandlers(e,t,n),n});if(this._standardFeatureService[e])return this._standardFeatureService[e](t).then(n=>{var r;return(r=this._pluginService)==null||r.executeSpyEventHandlers(e,t),n})}}class de{constructor(e){this._hostCommunicationService=e}}var m$=Object.defineProperty,f$=Object.getOwnPropertyDescriptor,y$=(i,e,t,s)=>{for(var a=s>1?void 0:s?f$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&m$(e,t,a),a};class yL extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.GetFirstPartyBlockedPlayers,this.onGetFirstPartyBlockedPlayers)}async onGetFirstPartyBlockedPlayers(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new Fy)}}y$([_()],yL.prototype,"onGetFirstPartyBlockedPlayers",1);var Su=(i=>(i.Cancelled="cancelled",i.Finished="finished",i))(Su||{}),v$=Object.defineProperty,_$=Object.getOwnPropertyDescriptor,xl=(i,e,t,s)=>{for(var a=s>1?void 0:s?_$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&v$(e,t,a),a};class Ma extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.LoginReady,this.loginReady),e.registerFeatureWithoutPayloadHandler(c.LoginFailure,this.loginFailure),e.registerFeatureWithPayloadHandler(c.FirstPartyLogin,this.firstPartyLogin),e.registerFeatureWithPayloadHandler(c.LoginResult,this.loginResult)}async loginReady(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new mE)}async loginFailure(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new fE)}async firstPartyLogin(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new yE(e))}async loginResult(e){var s,a,n;const{loginData:t}=e;if(t&&(this._loginData=t),!this._hostCommunicationService){window.ubisoftConnectLoginData=this._loginData,window.ubisoftConnectLoginStatus=(s=this._loginData)!=null&&s.sessionId?Su.Finished:Su.Cancelled;return}await ((n=this._hostCommunicationService)==null?void 0:n.sendNotification(new Oy({status:(a=this._loginData)!=null&&a.sessionId?Dp.Finished:Dp.Cancelled,loginData:this._loginData})))}}xl([_()],Ma.prototype,"loginReady",1);xl([_()],Ma.prototype,"loginFailure",1);xl([_()],Ma.prototype,"firstPartyLogin",1);xl([_()],Ma.prototype,"loginResult",1);class Nn{constructor(e,t){this._store=e,this._hostCommunicationService=t}}var S$=Object.defineProperty,w$=Object.getOwnPropertyDescriptor,Kg=(i,e,t,s)=>{for(var a=s>1?void 0:s?w$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&S$(e,t,a),a};class Tn extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.OverlayIsReady,this.overlayIsReady),e.registerFeatureWithoutPayloadHandler(c.OverlayIsVisible,this.overlayIsVisible),e.registerFeatureWithoutPayloadHandler(c.OverlayIsHidden,this.overlayIsHidden)}async overlayIsReady(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new br)}async overlayIsVisible(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new hd)}async overlayIsHidden(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new Gc)}}Kg([_()],Tn.prototype,"overlayIsReady",1);Kg([_()],Tn.prototype,"overlayIsVisible",1);Kg([_()],Tn.prototype,"overlayIsHidden",1);class b$ extends Nn{getDelegationServices(){return[new Tn(this._hostCommunicationService),new yL(this._hostCommunicationService),new Ma(this._hostCommunicationService)]}}var C$=Object.defineProperty,I$=Object.getOwnPropertyDescriptor,Rn=(i,e,t,s)=>{for(var a=s>1?void 0:s?I$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&C$(e,t,a),a};class Aa extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.GameLaunch,this.initializeGameLaunch),e.registerFeatureWithPayloadHandler(c.GameDownloadStart,this.gameDownloadStart),e.registerFeatureWithPayloadHandler(c.GetProductActions,this.getProductActions),e.registerFeatureWithPayloadHandler(c.ProductUninstall,this.productUninstall),e.registerFeatureWithoutPayloadHandler(c.GetRunningGames,this.getRunningGames),e.registerFeatureWithPayloadHandler(c.GetProductLicensesToAccept,this.getProductLicensesToAccept)}async initializeGameLaunch(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new vE(e))}async gameDownloadStart(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new _E(e))}async getProductActions(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new SE(e))}async productUninstall(e){var s;const t={gameInfo:e.gameInfo};return(s=this._hostCommunicationService)==null?void 0:s.sendRequest(new wE(t))}async getRunningGames(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new bE)}async getProductLicensesToAccept(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new CE(e))}}Rn([_()],Aa.prototype,"initializeGameLaunch",1);Rn([_()],Aa.prototype,"gameDownloadStart",1);Rn([_()],Aa.prototype,"getProductActions",1);Rn([_()],Aa.prototype,"productUninstall",1);Rn([_()],Aa.prototype,"getRunningGames",1);Rn([_()],Aa.prototype,"getProductLicensesToAccept",1);var M$=Object.defineProperty,A$=Object.getOwnPropertyDescriptor,P$=(i,e,t,s)=>{for(var a=s>1?void 0:s?A$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&M$(e,t,a),a};class vL extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.FocusBrowserWindow,this.focus)}async focus(e){var t,s;window.native&&(e!=null&&e.childId?(t=window.native)==null||t.focusChildWindow(e.childId):(s=window.native)==null||s.focusMainWindow())}}P$([_()],vL.prototype,"focus",1);var N$=Object.defineProperty,T$=Object.getOwnPropertyDescriptor,R$=(i,e,t,s)=>{for(var a=s>1?void 0:s?T$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&N$(e,t,a),a};class _L extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.GetFeatureSupport,this.getFeatureSupport)}async getFeatureSupport(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new IE)}}R$([_()],_L.prototype,"getFeatureSupport",1);class D$ extends Nn{getDelegationServices(){return[new _L(this._hostCommunicationService),new Ma(this._hostCommunicationService),new Aa(this._hostCommunicationService),new vL(this._hostCommunicationService)]}}var O$=Object.defineProperty,F$=Object.getOwnPropertyDescriptor,Xg=(i,e,t,s)=>{for(var a=s>1?void 0:s?F$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&O$(e,t,a),a};class Kr extends de{constructor(e,t){super(t),this._store=e}registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.ReportFatalError,this.reportFatalError),e.registerFeatureWithPayloadHandler(c.SetRecoveryState,this.setRecoveryState),e.registerFeatureWithPayloadHandler(c.ReportAppInitialisationFailure,this.reportAppInitialisationFailure)}async reportFatalError(e){var t;await this._store.dispatchIntent(new _l),await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new ME(e)))}async setRecoveryState(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Hv(e))}async reportAppInitialisationFailure(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new zv(e))}}Xg([_()],Kr.prototype,"reportFatalError",1);Xg([_()],Kr.prototype,"setRecoveryState",1);Xg([_()],Kr.prototype,"reportAppInitialisationFailure",1);var L$=Object.defineProperty,G$=Object.getOwnPropertyDescriptor,Ti=(i,e,t,s)=>{for(var a=s>1?void 0:s?G$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&L$(e,t,a),a};class Zt extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.StreamingStart,this.startStreaming),e.registerFeatureWithoutPayloadHandler(c.StreamingStop,this.stopStreaming),e.registerFeatureWithoutPayloadHandler(c.StreamingGetHostStatus,this.getStreamingHostStatus),e.registerFeatureWithPayloadHandler(c.StreamingKickGuest,this.kickGuest),e.registerFeatureWithPayloadHandler(c.StreamingCreateToken,this.createToken),e.registerFeatureWithPayloadHandler(c.StreamingGenerateInviteLink,this.generateInviteLink),e.registerFeatureWithPayloadHandler(c.StreamingSetGuestSettings,this.setGuestSettingsStreaming),e.registerFeatureWithPayloadHandler(c.StreamingSetSessionSettings,this.setStreamingSessionSettings),e.registerFeatureWithPayloadHandler(c.StreamingJoin,this.joinStreaming),e.registerFeatureWithoutPayloadHandler(c.StreamingLeave,this.leaveStreaming),e.registerFeatureWithoutPayloadHandler(c.StreamingGetGuestStatus,this.getStreamingGuestStatus)}async startStreaming(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new e_)}async stopStreaming(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new t_)}async createToken(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new s_(e))}async generateInviteLink(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new a_(e))}async getStreamingHostStatus(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new n_)}async kickGuest(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new r_(e))}async setGuestSettingsStreaming(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new o_(e))}async setStreamingSessionSettings(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new c_(e))}async joinStreaming(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new i_(e))}async leaveStreaming(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new AE)}async getStreamingGuestStatus(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new PE)}}Ti([_()],Zt.prototype,"startStreaming",1);Ti([_()],Zt.prototype,"stopStreaming",1);Ti([_()],Zt.prototype,"createToken",1);Ti([_()],Zt.prototype,"generateInviteLink",1);Ti([_()],Zt.prototype,"getStreamingHostStatus",1);Ti([_()],Zt.prototype,"kickGuest",1);Ti([_()],Zt.prototype,"setGuestSettingsStreaming",1);Ti([_()],Zt.prototype,"setStreamingSessionSettings",1);Ti([_()],Zt.prototype,"joinStreaming",1);Ti([_()],Zt.prototype,"leaveStreaming",1);Ti([_()],Zt.prototype,"getStreamingGuestStatus",1);class SL extends Nn{getDelegationServices(){return[new Ma(this._hostCommunicationService),new Kr(this._store,this._hostCommunicationService),new Zt(this._hostCommunicationService)]}}var x$=Object.defineProperty,E$=Object.getOwnPropertyDescriptor,U$=(i,e,t,s)=>{for(var a=s>1?void 0:s?E$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&x$(e,t,a),a};class wL extends de{constructor(e,t){super(t),this._store=e}registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.ScrollTitleBar,this.scrollTitleBar)}async scrollTitleBar(e){const t={deltaX:e.deltaX,deltaY:e.deltaY};return this._store.dispatchIntent(new Nl(t))}}U$([_()],wL.prototype,"scrollTitleBar",1);class k$ extends SL{getDelegationServices(){return super.getDelegationServices().concat([new wL(this._store,this._hostCommunicationService)])}}var W$=Object.defineProperty,V$=Object.getOwnPropertyDescriptor,$$=(i,e,t,s)=>{for(var a=s>1?void 0:s?V$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&W$(e,t,a),a};class bL extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.GetImage,this.getImage)}async getImage(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new nS(e),Ht)}}$$([_()],bL.prototype,"getImage",1);var B$=Object.defineProperty,H$=Object.getOwnPropertyDescriptor,Xr=(i,e,t,s)=>{for(var a=s>1?void 0:s?H$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&B$(e,t,a),a};class Dn extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.GetNativeMicroApps,this.getNativeMicroApps),e.registerFeatureWithPayloadHandler(c.GetGameSpecificNativeMicroApps,this.getGameSpecificNativeMicroApps),e.registerFeatureWithPayloadHandler(c.ShowNativePart,this.showNativePart),e.registerFeatureWithPayloadHandler(c.ShowShellContainer,this.showShellContainer),e.registerFeatureWithPayloadHandler(c.SetCurrentParentAppName,this.setCurrentParentAppName)}async getNativeMicroApps(){return this._hostCommunicationService?this._hostCommunicationService.sendRequest(new NE):null}async getGameSpecificNativeMicroApps(e){return this._hostCommunicationService?this._hostCommunicationService.sendRequest(new rS(e)):null}async showNativePart(e){return this._hostCommunicationService?this._hostCommunicationService.sendRequest(new TE(e)):null}async showShellContainer(e){return this._hostCommunicationService?this._hostCommunicationService.sendRequest(new RE(e)):null}async setCurrentParentAppName(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new DE(e)))}}Xr([_()],Dn.prototype,"getNativeMicroApps",1);Xr([_()],Dn.prototype,"getGameSpecificNativeMicroApps",1);Xr([_()],Dn.prototype,"showNativePart",1);Xr([_()],Dn.prototype,"showShellContainer",1);Xr([_()],Dn.prototype,"setCurrentParentAppName",1);var Q$=Object.defineProperty,j$=Object.getOwnPropertyDescriptor,q$=(i,e,t,s)=>{for(var a=s>1?void 0:s?j$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Q$(e,t,a),a};class CL extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.OpenExternalLink,this.openExternalLink)}async openExternalLink(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new OE(e))}}q$([_()],CL.prototype,"openExternalLink",1);var z$=Object.defineProperty,K$=Object.getOwnPropertyDescriptor,Jg=(i,e,t,s)=>{for(var a=s>1?void 0:s?K$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&z$(e,t,a),a};class Jr extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.GetSecureStorageData,this.getSecureStorageData),e.registerFeatureWithPayloadHandler(c.SetSecureStorageData,this.setSecureStorageData),e.registerFeatureWithPayloadHandler(c.DeleteSecureStorageData,this.deleteSecureStorageData)}async getSecureStorageData(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new E_(e))}async setSecureStorageData(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new U_(e))}async deleteSecureStorageData(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new k_(e))}}Jg([_()],Jr.prototype,"getSecureStorageData",1);Jg([_()],Jr.prototype,"setSecureStorageData",1);Jg([_()],Jr.prototype,"deleteSecureStorageData",1);var X$=Object.defineProperty,J$=Object.getOwnPropertyDescriptor,IL=(i,e,t,s)=>{for(var a=s>1?void 0:s?J$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&X$(e,t,a),a};class Yg extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.SetTitle,this.setTitle),e.registerFeatureWithoutPayloadHandler(c.ResetTitle,this.resetTitle)}async setTitle(e){var s;const t={titleName:e.titleName,gameName:e.gameName,title:{title:e.titleName,gameName:e.gameName}};return(s=this._hostCommunicationService)==null?void 0:s.sendNotification(new FE(t))}async resetTitle(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new LE)}}IL([_()],Yg.prototype,"setTitle",1);IL([_()],Yg.prototype,"resetTitle",1);var Y$=Object.defineProperty,Z$=Object.getOwnPropertyDescriptor,eB=(i,e,t,s)=>{for(var a=s>1?void 0:s?Z$(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Y$(e,t,a),a};class ML extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.ManageBackButton,this.notifyManageBackButton)}async notifyManageBackButton(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new GE(e))}}eB([_()],ML.prototype,"notifyManageBackButton",1);var tB=Object.defineProperty,iB=Object.getOwnPropertyDescriptor,sB=(i,e,t,s)=>{for(var a=s>1?void 0:s?iB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&tB(e,t,a),a};class AL extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.UpdateNavigationBarViewMode,this.updateNavigationBarViewMode)}async updateNavigationBarViewMode(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new xE(e))}}sB([_()],AL.prototype,"updateNavigationBarViewMode",1);class aB extends SL{getDelegationServices(){return super.getDelegationServices().concat([new Dn(this._hostCommunicationService),new Yg(this._hostCommunicationService),new AL(this._hostCommunicationService),new bL(this._hostCommunicationService),new ML(this._hostCommunicationService),new Jr(this._hostCommunicationService),new CL(this._hostCommunicationService)])}}class nB extends d("[Shell] Get Running Games"){}class PL extends d("[Shell] Handle Legacy Running Game Update Intent"){}class NL extends d("[Shell] Add Running Game Intent"){constructor(e){super(),this.gameInfo=e}}var rB=Object.defineProperty,oB=Object.getOwnPropertyDescriptor,ne=(i,e,t,s)=>{for(var a=s>1?void 0:s?oB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&rB(e,t,a),a};class ae extends de{constructor(e,t){super(t),this._store=e}registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.LegacyGameDownload,this.legacyDownload),e.registerFeatureWithPayloadHandler(c.LegacyGameLaunch,this.legacyPlay),e.registerFeatureWithPayloadHandler(c.LegacyGameUninstall,this.legacyUninstall),e.registerFeatureWithPayloadHandler(c.LegacyGameVerify,this.legacyVerify),e.registerFeatureWithoutPayloadHandler(c.LegacyGetProducts,this.legacyProducts),e.registerFeatureWithPayloadHandler(c.LegacyDisplayReadme,this.legacyDisplayReadme),e.registerFeatureWithPayloadHandler(c.LegacyGetProduct,this.legacyGetProduct),e.registerFeatureWithPayloadHandler(c.LegacyGetDownloadProgress,this.legacyDownloadProgress),e.registerFeatureWithoutPayloadHandler(c.LegacyGetRunningGame,this.legacyRunningGame),e.registerFeatureWithPayloadHandler(c.LegacyCancelDownload,this.legacyCancelDownload),e.registerFeatureWithoutPayloadHandler(c.LegacyPauseDownload,this.legacyPauseDownload),e.registerFeatureWithoutPayloadHandler(c.LegacyResumeDownload,this.legacyResumeDownload),e.registerFeatureWithPayloadHandler(c.LegacySetActiveDownload,this.legacySetActiveDownload),e.registerFeatureWithoutPayloadHandler(c.LegacyGetDownloadQueue,this.legacyDownloadQueue),e.registerFeatureWithoutPayloadHandler(c.LegacyGetDownloadServiceConnectionStatus,this.legacyDownloadServiceConnectionStatus),e.registerFeatureWithPayloadHandler(c.LegacyGetGameBranches,this.legacyGameBranches),e.registerFeatureWithPayloadHandler(c.LegacySwitchGameBranch,this.legacySwitchBranch),e.registerFeatureWithPayloadHandler(c.LegacyUnlockGameBranch,this.legacyUnlockBranch),e.registerFeatureWithPayloadHandler(c.LegacySwitchDownloadLanguage,this.legacySwitchLanguage),e.registerFeatureWithPayloadHandler(c.LegacyGetDownloadLanguages,this.legacyGetLanguages),e.registerFeatureWithPayloadHandler(c.LegacyCreateGameShortcut,this.legacyCreateGameShortcut),e.registerFeatureWithPayloadHandler(c.LegacyOpenGameInstallationFolder,this.legacyOpenGameInstallationFolder),e.registerFeatureWithPayloadHandler(c.LegacyLocateGameInstallationFolder,this.legacyLocateGameInstallationFolder),e.registerFeatureWithPayloadHandler(c.LegacyLocateGameInstallationFolderAfterGameStartFailure,this.legacyLocateGameInstallationFolderAfterGameStartFailure),e.registerFeatureWithPayloadHandler(c.LegacyDownloadSetPriorityOrder,this.legacyDownloadSetPriorityOrder),e.registerFeatureWithPayloadHandler(c.LegacyInstallOptionalAddon,this.legacyInstallOptionalAddon),e.registerFeatureWithPayloadHandler(c.LegacyUninstallOptionalAddon,this.legacyUninstallOptionalAddon),e.registerFeatureWithoutPayloadHandler(c.LegacyDeleteGameInstallers,this.legacyDeleteGameInstallers),e.registerFeatureWithoutPayloadHandler(c.LegacyGetGamesWithPendingPatches,this.legacyGetGamesWithPendingPatches),e.registerFeatureWithPayloadHandler(c.LegacyActivateFreeGame,this.legacyActivateFreeGame),e.registerFeatureWithPayloadHandler(c.LegacyActivateProductKey,this.legacyActivateKey),e.registerFeatureWithPayloadHandler(c.GetConnectGameStateInfo,this.getConnectGameStateInfo),e.registerFeatureWithPayloadHandler(c.SwitchGameAutoUpdates,this.setEnableGameAutoUpdate),e.registerFeatureWithPayloadHandler(c.SetGameLaunchArguments,this.setGameLaunchArguments),e.registerFeatureWithoutPayloadHandler(c.GetRunningProduct,this.getRunningProduct),e.registerFeatureWithPayloadHandler(c.LegacyInstallerLaunch,this.launchLegacyInstaller)}async setEnableGameAutoUpdate(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new pv(e)))}async legacyDownload(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new hv(e)))}async legacyPlay(e){this._hostCommunicationService&&(await this._store.dispatchIntent(new NL({applicationId:"",spaceId:"",productId:e.gameId,executableId:e.exeId})),await this._hostCommunicationService.sendNotification(new fv(e)))}async legacyUninstall(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new wv(e)))}async legacyVerify(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new bv(e)))}async legacyProducts(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new l_)}async legacyDisplayReadme(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Cv(e))}async legacyGetProduct(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new p_(e))}async legacyDownloadProgress(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new y_(e))}async legacyRunningGame(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new f_)}async legacyCancelDownload(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new _v(e)))}async legacyPauseDownload(){var e;await ((e=this._hostCommunicationService)==null?void 0:e.sendNotification(new gv))}async legacyResumeDownload(){var e;await ((e=this._hostCommunicationService)==null?void 0:e.sendNotification(new mv))}async legacySetActiveDownload(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Sv(e)))}async legacyDownloadQueue(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new v_)}async legacyDownloadServiceConnectionStatus(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new __)}async legacyDeleteGameInstallers(){var e;await ((e=this._hostCommunicationService)==null?void 0:e.sendNotification(new Nv))}async legacyGameBranches(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new S_(e))}async legacySwitchBranch(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new w_(e))}async legacyUnlockBranch(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new b_(e))}async legacySwitchLanguage(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new M_(e))}async legacyGetLanguages(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new A_(e))}async legacyCreateGameShortcut(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new F_(e))}async legacyInstallOptionalAddon(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new C_(e))}async legacyUninstallOptionalAddon(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new I_(e))}async legacyGetGamesWithPendingPatches(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new P_)}async legacyOpenGameInstallationFolder(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Iv(e)))}async legacyLocateGameInstallationFolder(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Mv(e)))}async legacyLocateGameInstallationFolderAfterGameStartFailure(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Av(e)))}async legacyDownloadSetPriorityOrder(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Pv(e)))}async legacyActivateFreeGame(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new D_(e))}async legacyActivateKey(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new O_(e))}async getConnectGameStateInfo(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new V_(e))}async setGameLaunchArguments(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new vv(e))}async getRunningProduct(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new H_)}async launchLegacyInstaller(e){var t;await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new yv(e)))}}ne([_()],ae.prototype,"setEnableGameAutoUpdate",1);ne([_()],ae.prototype,"legacyDownload",1);ne([_()],ae.prototype,"legacyPlay",1);ne([_()],ae.prototype,"legacyUninstall",1);ne([_()],ae.prototype,"legacyVerify",1);ne([_()],ae.prototype,"legacyProducts",1);ne([_()],ae.prototype,"legacyDisplayReadme",1);ne([_()],ae.prototype,"legacyGetProduct",1);ne([_()],ae.prototype,"legacyDownloadProgress",1);ne([_()],ae.prototype,"legacyRunningGame",1);ne([_()],ae.prototype,"legacyCancelDownload",1);ne([_()],ae.prototype,"legacyPauseDownload",1);ne([_()],ae.prototype,"legacyResumeDownload",1);ne([_()],ae.prototype,"legacySetActiveDownload",1);ne([_()],ae.prototype,"legacyDownloadQueue",1);ne([_()],ae.prototype,"legacyDownloadServiceConnectionStatus",1);ne([_()],ae.prototype,"legacyDeleteGameInstallers",1);ne([_()],ae.prototype,"legacyGameBranches",1);ne([_()],ae.prototype,"legacySwitchBranch",1);ne([_()],ae.prototype,"legacyUnlockBranch",1);ne([_()],ae.prototype,"legacySwitchLanguage",1);ne([_()],ae.prototype,"legacyGetLanguages",1);ne([_()],ae.prototype,"legacyCreateGameShortcut",1);ne([_()],ae.prototype,"legacyInstallOptionalAddon",1);ne([_()],ae.prototype,"legacyUninstallOptionalAddon",1);ne([_()],ae.prototype,"legacyGetGamesWithPendingPatches",1);ne([_()],ae.prototype,"legacyOpenGameInstallationFolder",1);ne([_()],ae.prototype,"legacyLocateGameInstallationFolder",1);ne([_()],ae.prototype,"legacyLocateGameInstallationFolderAfterGameStartFailure",1);ne([_()],ae.prototype,"legacyDownloadSetPriorityOrder",1);ne([_()],ae.prototype,"legacyActivateFreeGame",1);ne([_()],ae.prototype,"legacyActivateKey",1);ne([_()],ae.prototype,"getConnectGameStateInfo",1);ne([_()],ae.prototype,"setGameLaunchArguments",1);ne([_()],ae.prototype,"getRunningProduct",1);ne([_()],ae.prototype,"launchLegacyInstaller",1);var cB=Object.defineProperty,lB=Object.getOwnPropertyDescriptor,qs=(i,e,t,s)=>{for(var a=s>1?void 0:s?lB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&cB(e,t,a),a};class Cs extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.SendGameInviteEvent,this.sendGameInviteEvent),e.registerFeatureWithPayloadHandler(c.SendChannelGameInviteEvent,this.sendChannelGameInviteEvent),e.registerFeatureWithPayloadHandler(c.AcceptGameInviteEvent,this.acceptGameInviteEvent),e.registerFeatureWithPayloadHandler(c.DeclineGameInviteEvent,this.declineGameInviteEvent),e.registerFeatureWithPayloadHandler(c.JoinGame,this.joinGame),e.registerFeatureWithPayloadHandler(c.RespondToGameInvite,this.respondToGameInvite),e.registerFeatureWithoutPayloadHandler(c.GetCurrentGameInviteEvents,this.getCurrentGameInviteEvents),e.registerFeatureWithoutPayloadHandler(c.GetGameSession,this.getGameSession)}async sendGameInviteEvent(e){var t;return await ((t=this._hostCommunicationService)==null?void 0:t.sendNotification(new ld(e))),!0}async sendChannelGameInviteEvent(e){var s;if(!this._hostCommunicationService)return!1;const t=await this._hostCommunicationService.sendRequest(new fd(e));return(s=t==null?void 0:t.response.isSuccessful)!=null?s:!1}async acceptGameInviteEvent(e){var t;return(t=this._hostCommunicationService)==null||t.sendNotification(new pd(e)),!0}async declineGameInviteEvent(e){var t;return(t=this._hostCommunicationService)==null||t.sendNotification(new ud(e)),!0}async joinGame(e){var t;return(t=this._hostCommunicationService)==null||t.sendNotification(new dd(e)),!0}async respondToGameInvite(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new vd(e))}async getCurrentGameInviteEvents(){var t,s;const e=await ((t=this._hostCommunicationService)==null?void 0:t.sendRequest(new yd));return(s=e==null?void 0:e.response.invites)!=null?s:[]}async getGameSession(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new N_)}}qs([_()],Cs.prototype,"sendGameInviteEvent",1);qs([_()],Cs.prototype,"sendChannelGameInviteEvent",1);qs([_()],Cs.prototype,"acceptGameInviteEvent",1);qs([_()],Cs.prototype,"declineGameInviteEvent",1);qs([_()],Cs.prototype,"joinGame",1);qs([_()],Cs.prototype,"respondToGameInvite",1);qs([_()],Cs.prototype,"getCurrentGameInviteEvents",1);qs([_()],Cs.prototype,"getGameSession",1);var pB=Object.defineProperty,uB=Object.getOwnPropertyDescriptor,zs=(i,e,t,s)=>{for(var a=s>1?void 0:s?uB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&pB(e,t,a),a};class Is extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.BrowserViewCreate,this.createBrowserView),e.registerFeatureWithPayloadHandler(c.BrowserViewDestroy,this.destroyBrowserView),e.registerFeatureWithPayloadHandler(c.BrowserViewShow,this.showBrowserView),e.registerFeatureWithPayloadHandler(c.BrowserViewHide,this.hideBrowserView),e.registerFeatureWithPayloadHandler(c.BrowserViewResize,this.resizeBrowserView),e.registerFeatureWithPayloadHandler(c.BrowserViewSetUrl,this.setBrowserViewUrl),e.registerFeatureWithPayloadHandler(c.BrowserViewGetUrl,this.getBrowserViewUrl),e.registerFeatureWithPayloadHandler(c.BrowserViewPostMessage,this.postMessageToBrowserView)}async createBrowserView(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new u_(e))}async destroyBrowserView(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Wv(e))}async showBrowserView(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new h_(e))}async hideBrowserView(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new g_(e))}async resizeBrowserView(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Vv(e))}async setBrowserViewUrl(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new $v(e))}async getBrowserViewUrl(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new d_(e))}async postMessageToBrowserView(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Bv(e))}}zs([_()],Is.prototype,"createBrowserView",1);zs([_()],Is.prototype,"destroyBrowserView",1);zs([_()],Is.prototype,"showBrowserView",1);zs([_()],Is.prototype,"hideBrowserView",1);zs([_()],Is.prototype,"resizeBrowserView",1);zs([_()],Is.prototype,"setBrowserViewUrl",1);zs([_()],Is.prototype,"getBrowserViewUrl",1);zs([_()],Is.prototype,"postMessageToBrowserView",1);var dB=Object.defineProperty,hB=Object.getOwnPropertyDescriptor,gB=(i,e,t,s)=>{for(var a=s>1?void 0:s?hB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&dB(e,t,a),a};class TL extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.GetServiceDegradationState,this.getServiceDegradationState)}async getServiceDegradationState(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new j_)}}gB([_()],TL.prototype,"getServiceDegradationState",1);class RL extends oe("PartnerPlatformOverridesState"){constructor(e){super(),this.partnerPlatform=e.partnerPlatform,this.partnerPlatformAttributes=e.partnerPlatformAttributes}}var mB=Object.defineProperty,fB=Object.getOwnPropertyDescriptor,Zg=(i,e,t,s)=>{for(var a=s>1?void 0:s?fB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&mB(e,t,a),a};const wf="partner-platform-override";class El extends de{constructor(e,t){super(t),this._store=e}registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.GetPartnerInformation,this.getPartnerInformation),e.registerFeatureWithPayloadHandler(c.OpenSteamOverlay,this.openSteamOverlay),e.registerFeatureWithoutPayloadHandler(c.GetClientInstallationType,this.getClientInstallationType)}async getPartnerInformation(){var e;if(this.shouldOverridePartnerInformation()){const t=this._store.getReadonlyState(RL);if(t.partnerPlatform)return{id:wf,response:{platform:t.partnerPlatform,platformAttributes:t.partnerPlatformAttributes,hostResponseName:wf}}}return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new x_)}shouldOverridePartnerInformation(){const e=this._store.getReadonlyState(S);return[ie.Dev,ie.Local,ie.Uat].includes(e.environment)}async openSteamOverlay(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new jv(e))}async getClientInstallationType(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new B_)}}Zg([_()],El.prototype,"getPartnerInformation",1);Zg([_()],El.prototype,"openSteamOverlay",1);Zg([_()],El.prototype,"getClientInstallationType",1);var yB=Object.defineProperty,vB=Object.getOwnPropertyDescriptor,Ut=(i,e,t,s)=>{for(var a=s>1?void 0:s?vB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&yB(e,t,a),a};class At extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.GetDefaultSettings,this.getDefaultSettings),e.registerFeatureWithoutPayloadHandler(c.GetSettings,this.getSettings),e.registerFeatureWithoutPayloadHandler(c.OpenScreenshotFolder,this.openScreenshotFolder),e.registerFeatureWithoutPayloadHandler(c.ResetGameInstallationLocation,this.resetGameInstallationLocation),e.registerFeatureWithoutPayloadHandler(c.ResetGameInstallerCacheLocation,this.resetGameInstallerCacheLocation),e.registerFeatureWithPayloadHandler(c.RestartClient,this.restartClient),e.registerFeatureWithoutPayloadHandler(c.OpenProxySettingsDialog,this.openNetworkPreferences),e.registerFeatureWithPayloadHandler(c.ApplySettings,this.applySettings),e.registerFeatureWithPayloadHandler(c.SelectPathDialog,this.openFileChooser),e.registerFeatureWithoutPayloadHandler(c.GetUPNUserSettings,this.getUPNUserSettings),e.registerFeatureWithPayloadHandler(c.UpdateUPNUserSettings,this.updateUPNUserSettings),e.registerFeatureWithoutPayloadHandler(c.GetRemindMeOfSteamLinking,this.getRemindMeOfSteamLinking),e.registerFeatureWithPayloadHandler(c.SetRemindMeOfSteamLinking,this.setRemindMeOfSteamLinking),e.registerFeatureWithoutPayloadHandler(c.SwitchToOnline,this.switchToOnline)}async getDefaultSettings(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new Zv)}async getSettings(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new Sd)}async openScreenshotFolder(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new Tv)}async resetGameInstallationLocation(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new Rv)}async resetGameInstallerCacheLocation(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new Dv)}async restartClient(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Ov(e))}async openNetworkPreferences(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new Lv)}async applySettings(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Gv(e))}async openFileChooser(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new wd(e))}async getUPNUserSettings(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new T_)}async updateUPNUserSettings(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Uv(e))}async getRemindMeOfSteamLinking(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new R_)}async setRemindMeOfSteamLinking(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new kv(e))}async switchToOnline(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new Fv)}}Ut([_()],At.prototype,"getDefaultSettings",1);Ut([_()],At.prototype,"getSettings",1);Ut([_()],At.prototype,"openScreenshotFolder",1);Ut([_()],At.prototype,"resetGameInstallationLocation",1);Ut([_()],At.prototype,"resetGameInstallerCacheLocation",1);Ut([_()],At.prototype,"restartClient",1);Ut([_()],At.prototype,"openNetworkPreferences",1);Ut([_()],At.prototype,"applySettings",1);Ut([_()],At.prototype,"openFileChooser",1);Ut([_()],At.prototype,"getUPNUserSettings",1);Ut([_()],At.prototype,"updateUPNUserSettings",1);Ut([_()],At.prototype,"getRemindMeOfSteamLinking",1);Ut([_()],At.prototype,"setRemindMeOfSteamLinking",1);Ut([_()],At.prototype,"switchToOnline",1);var _B=Object.defineProperty,SB=Object.getOwnPropertyDescriptor,DL=(i,e,t,s)=>{for(var a=s>1?void 0:s?SB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&_B(e,t,a),a};class em extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.StoreCheckoutStarted,this.storeCheckoutStarted),e.registerFeatureWithPayloadHandler(c.StoreCheckoutFinished,this.storeCheckoutFinished)}async storeCheckoutStarted(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Xv(e))}async storeCheckoutFinished(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Jv(e))}}DL([_()],em.prototype,"storeCheckoutStarted",1);DL([_()],em.prototype,"storeCheckoutFinished",1);var wB=Object.defineProperty,bB=Object.getOwnPropertyDescriptor,CB=(i,e,t,s)=>{for(var a=s>1?void 0:s?bB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&wB(e,t,a),a};class OL extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.ReportAppInformation,this.reportAppInformation)}async reportAppInformation(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Kv(e))}}CB([_()],OL.prototype,"reportAppInformation",1);var IB=Object.defineProperty,MB=Object.getOwnPropertyDescriptor,AB=(i,e,t,s)=>{for(var a=s>1?void 0:s?MB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&IB(e,t,a),a};class FL extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.GetUserActivity,this.getUserActivity)}async getUserActivity(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new _d)}}AB([_()],FL.prototype,"getUserActivity",1);var PB=Object.defineProperty,NB=Object.getOwnPropertyDescriptor,LL=(i,e,t,s)=>{for(var a=s>1?void 0:s?NB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&PB(e,t,a),a};class tm extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.WindowSetState,this.setWindowState),e.registerFeatureWithoutPayloadHandler(c.WindowGetState,this.getWindowState)}async setWindowState(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new L_(e))}async getWindowState(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new G_)}}LL([_()],tm.prototype,"setWindowState",1);LL([_()],tm.prototype,"getWindowState",1);var TB=Object.defineProperty,RB=Object.getOwnPropertyDescriptor,Yr=(i,e,t,s)=>{for(var a=s>1?void 0:s?RB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&TB(e,t,a),a};class On extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.LogOut,this.logOut),e.registerFeatureWithoutPayloadHandler(c.Quit,this.quit),e.registerFeatureWithPayloadHandler(c.PassAuthentication,this.passAuthentication),e.registerFeatureWithPayloadHandler(c.VerifyUserCredentials,this.verifyUserCredentials),e.registerFeatureWithoutPayloadHandler(c.GetConnectPlatformAuthToken,this.getConnectPlatformAuthToken)}async logOut(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new xv)}async quit(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new gd)}async passAuthentication(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new W_(e),2*Ht)}async verifyUserCredentials(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendRequest(new $_(e))}async getConnectPlatformAuthToken(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendRequest(new Q_)}}Yr([_()],On.prototype,"logOut",1);Yr([_()],On.prototype,"quit",1);Yr([_()],On.prototype,"passAuthentication",1);Yr([_()],On.prototype,"verifyUserCredentials",1);Yr([_()],On.prototype,"getConnectPlatformAuthToken",1);var DB=Object.defineProperty,OB=Object.getOwnPropertyDescriptor,FB=(i,e,t,s)=>{for(var a=s>1?void 0:s?OB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&DB(e,t,a),a};class GL extends Tn{async overlayIsReady(){var e,t;await Promise.all([(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new br),(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new uv)])}}FB([_()],GL.prototype,"overlayIsReady",1);var LB=Object.defineProperty,GB=Object.getOwnPropertyDescriptor,xL=(i,e,t,s)=>{for(var a=s>1?void 0:s?GB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&LB(e,t,a),a};class im extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.FocusBrowserWindow,this.focus),e.registerFeatureWithPayloadHandler(c.RefreshView,this.refreshView)}async focus(e){var t;(t=this._hostCommunicationService)==null||t.sendNotification(new Ev({childId:e.childId}))}async refreshView(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new Qv(e))}}xL([_()],im.prototype,"focus",1);xL([_()],im.prototype,"refreshView",1);var xB=Object.defineProperty,EB=Object.getOwnPropertyDescriptor,UB=(i,e,t,s)=>{for(var a=s>1?void 0:s?EB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&xB(e,t,a),a};class EL extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.ReloadClientUI,this.reloadClientUI)}async reloadClientUI(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new dv)}}UB([_()],EL.prototype,"reloadClientUI",1);class bf extends Nn{getDelegationServices(){const e=this._store.getReadonlyState(S),t=[p.PCLegacyClient,p.SteamClient].includes(e.hostPlatformType),s=[p.PCLegacyOverlay,p.SteamOverlay,p.PCWebOverlay,p.Luna].includes(e.hostPlatformType),a=[new Cs(this._hostCommunicationService),new Zt(this._hostCommunicationService),new At(this._hostCommunicationService),t?new GL(this._hostCommunicationService):new Tn(this._hostCommunicationService),new FL(this._hostCommunicationService),new em(this._hostCommunicationService)];return t&&(a.push(new EL(this._hostCommunicationService)),a.push(new On(this._hostCommunicationService)),a.push(new im(this._hostCommunicationService)),a.push(new tm(this._hostCommunicationService)),a.push(new Jr(this._hostCommunicationService))),(t||s)&&(a.push(new ae(this._store,this._hostCommunicationService)),a.push(new Is(this._hostCommunicationService)),a.push(new Kr(this._store,this._hostCommunicationService)),a.push(new OL(this._hostCommunicationService)),a.push(new El(this._store,this._hostCommunicationService)),a.push(new TL(this._hostCommunicationService))),a}}var kB=Object.defineProperty,WB=Object.getOwnPropertyDescriptor,Fn=(i,e,t,s)=>{for(var a=s>1?void 0:s?WB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&kB(e,t,a),a};class Pa extends de{registerFeatureHandlers(e){e.registerFeatureWithPayloadHandler(c.UpdateNavigationHistory,this.updateNavigationNotification),e.registerFeatureWithPayloadHandler(c.UpdateApplicationHeight,this.updateApplicationHeight),e.registerFeatureWithPayloadHandler(c.UpdateApplicationScrollPosition,this.updateApplicationScrollPosition),e.registerFeatureWithPayloadHandler(c.ModalOpened,this.sendModalOpened),e.registerFeatureWithoutPayloadHandler(c.ModalClosed,this.sendModalClosed),e.registerFeatureWithPayloadHandler(c.SendAdobeAnalyticData,this.sendAdobeAnalyticData)}async sendAdobeAnalyticData(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new EE(e))}async updateApplicationHeight(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new UE(e))}async updateNavigationNotification(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new kE(e))}async updateApplicationScrollPosition(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new WE(e))}async sendModalOpened(e){var t;return(t=this._hostCommunicationService)==null?void 0:t.sendNotification(new VE(e))}async sendModalClosed(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new $E)}}Fn([_()],Pa.prototype,"sendAdobeAnalyticData",1);Fn([_()],Pa.prototype,"updateApplicationHeight",1);Fn([_()],Pa.prototype,"updateNavigationNotification",1);Fn([_()],Pa.prototype,"updateApplicationScrollPosition",1);Fn([_()],Pa.prototype,"sendModalOpened",1);Fn([_()],Pa.prototype,"sendModalClosed",1);class VB extends Nn{getDelegationServices(){return[new Pa(this._hostCommunicationService)]}}var $B=Object.defineProperty,BB=Object.getOwnPropertyDescriptor,HB=(i,e,t,s)=>{for(var a=s>1?void 0:s?BB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&$B(e,t,a),a};class UL extends de{registerFeatureHandlers(e){e.registerFeatureWithoutPayloadHandler(c.Quit,this.quit)}async quit(){var e;return(e=this._hostCommunicationService)==null?void 0:e.sendNotification(new gd)}}HB([_()],UL.prototype,"quit",1);class QB extends Nn{getDelegationServices(){return[new UL(this._hostCommunicationService)]}}class Zr{constructor(e,t,s,a){this._store=e,this._logger=t,this._pluginService=s,this._hostCommunicationService=a}}class je{constructor(e,t,s,a){this._store=e,this._pluginService=t,this._logger=s,this._hostCommunicationService=a}registerNotificationListener(e,t,s,a){var o;const n=this.wrapNotificationListenerWithFeatureCheck(e,s,a);let r=!1;return this._hostCommunicationService&&(r=(o=this._hostCommunicationService)==null?void 0:o.registerNotificationListener(t,n.bind(this)),r&&this._store.dispatchIntent(new Yp(e,t))),r}wrapNotificationListenerWithFeatureCheck(e,t,s){return a=>{var n;if(this.isFeatureSupported(e)){try{t(a)}catch(r){s&&s(r)}this._logger.debug("Handling feature ".concat(e),{featureId:e,debugEntryType:pn.FeatureListener,logCategory:f.hostCommunication}),(n=this._pluginService)==null||n.executeSpyEventHandlers(e,a)}}}registerRequestHandler(e,t,s,a){const n=this.wrapRequestHandlerWithFeatureCheck(e,s,a);let r=!1;return this._hostCommunicationService&&(r=this._hostCommunicationService.registerRequestHandler(t,n.bind(this)),r&&this._store.dispatchIntent(new Yp(e,t))),r}wrapRequestHandlerWithFeatureCheck(e,t,s){return(a,n)=>{if(this.isFeatureSupported(e))return t(a,n).then(o=>{var l;return this._logger.debug("Handling feature ".concat(e),{featureId:e,debugEntryType:pn.FeatureListener,logCategory:f.hostCommunication}),(l=this._pluginService)==null||l.executeSpyIncomingRequestEventHandlers(e,a,o),o}).catch(o=>(s&&s(o),o));const r="Unable to handle ".concat(a.hostRequestName,", because feature ").concat(e," is not supported");return Promise.reject(r)}}isFeatureSupported(e){var s,a;return(a=(s=this._store.getReadonlyState(Q).hostFeatures)==null?void 0:s.includes(e))!=null?a:!1}}var jB=Object.defineProperty,qB=Object.getOwnPropertyDescriptor,Ks=(i,e,t,s)=>{for(var a=s>1?void 0:s?qB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&jB(e,t,a),a};class pi extends je{constructor(e,t,s,a){super(e,s,t,a)}registerFeatureListeners(){this.registerNotificationListener(c.AddToNavigationHistory,oS,this.onAddToNavigationHistoryNotification),this.registerRequestHandler(c.Navigate,Cn,this.onNavigateRequest),this.registerRequestHandler(c.TabNavigate,cS,this.onTabNavigateRequest),this.registerRequestHandler(c.NavigateBack,lS,this.onNavigateBackRequest),this.registerRequestHandler(c.IsNavigationBackAvailable,pS,this.onIsNavigationBackAvailableRequest),this.registerRequestHandler(c.NavigateDeepLink,Ju,this.onNavigateDeepLinkRequest),this.registerRequestHandler(c.SwitchToExclusiveMode,uS,this.onSwitchToExclusiveModeRequest),this.registerRequestHandler(c.ExitExclusiveMode,dS,this.onExitExclusiveModeRequest)}async onAddToNavigationHistoryNotification(e){var l;const t=this._store.getReadonlyState(S),s=(l=e.navigationContext.game)!=null?l:t.activeGame,a=await this._store.dispatchIntent(new Xe(e.navigationContext.appName,s));if(a===void 0){const u="Unable to add history record for micro app ".concat(e.navigationContext.appName,", because it has been incorrectly configured for space ").concat(s.spaceId);throw this._logger.warn(u,{logCategory:f.hostCommunication,errorCode:g.UnableToAddHistoryRecordWarning}),new De(u)}const n={appName:e.navigationContext.appName,game:s,applicationData:e.navigationContext.applicationData,parentAppName:a},o=this._store.getReadonlyState(M).findMicroAppConfig(n.appName,a,n.game.spaceId);if(!o){const u="No configuration was found for micro app: ".concat(n.appName,", gameSpaceId: ").concat(n.game.spaceId);throw this._logger.warn(u,{logCategory:f.hostCommunication,errorCode:g.UnableToAddHistoryRecordMissingCfgWarning}),new De(u)}await this._store.dispatchIntent(new yg(o,n))}async onNavigateRequest(e){var n,r;this._store.dispatchIntent(new Za);let t=!1;const s=this._store.getReadonlyState(S);try{await this.waitForAuthIfNeeded(e.navigationContext.appName),await s.readyToAcceptNavigationRequest.promise}catch(o){return this._logger.error("Unable to navigate to micro app ".concat(e.navigationContext.appName,", because session is not set"),{game:(n=e.navigationContext.game)!=null?n:s.activeGame,navigationContext:e.navigationContext,logCategory:f.hostCommunication,errorCode:g.UnableToNavigateToAppNoSessionError}),new xo({isSuccessful:t})}const a=await this.getNormalizedNavigationContextWithParentName(e.navigationContext);if(a!==void 0)t=await this._store.dispatchIntent(new Be(a,{callerMicroAppName:"HostNavigationListenerService.onNavigateRequest"}));else{const o=(r=e.navigationContext.game)!=null?r:s.activeGame;this._logger.warn("Unable to navigate to micro app ".concat(e.navigationContext.appName,", because it has been incorrectly configured for space ").concat(o.spaceId),{game:o,navigationContext:e.navigationContext,logCategory:f.hostCommunication,errorCode:g.UnableToNavigateToAppMissingCfgWarning})}return new xo({isSuccessful:t})}async getNormalizedNavigationContextWithParentName(e){var n;const t=this._store.getReadonlyState(S),s=(n=e.game)!=null?n:t.activeGame,a=await this._store.dispatchIntent(new Xe(e.appName,s));if(a!==void 0)return{...e,game:s,parentAppName:a}}async onTabNavigateRequest(e){var r;const t=this._store.getReadonlyState(S);let s=!1;const a=(r=e.navigationContext.game)!=null?r:t.activeGame;try{await this.waitForAuthIfNeeded(e.navigationContext.appName)}catch(o){return this._logger.error("Unable to navigate to micro app ".concat(e.navigationContext.appName,", because session is not set"),{game:a,navigationContext:e.navigationContext,logCategory:f.hostCommunication,errorCode:g.UnableToNavigateToAppNoSessionError}),new Bm({isSuccessful:s})}const n=await this.getNormalizedNavigationContextWithParentName(e.navigationContext);if(n!==void 0){const o=this._store.getReadonlyState(Y);o.preserveDefaultStack(),await this._store.dispatchIntent(new Jo),s=await this._store.dispatchIntent(new Be(n,{direction:ci.forwards,forceReactivation:!0,saveOnDeactivation:!1,callerMicroAppName:"HostNavigationListenerService.onTabNavigateRequest"})),s?o.clearPreservedDefaultStack():o.restoreDefaultStack()}else this._logger.warn("Unable to navigate to micro app ".concat(e.navigationContext.appName,", because it has been incorrectly configured for space ").concat(a.spaceId),{game:a,navigationContext:e.navigationContext,logCategory:f.hostCommunication,errorCode:g.UnableToNavigateToAppMissingCfgWarning});return new Bm({isSuccessful:s})}async onNavigateBackRequest(){const e=this._store.getReadonlyState(M),t=await this._store.dispatchIntent(new gs(e.defaultPlacement));return new BE({isSuccessful:t})}async onIsNavigationBackAvailableRequest(){const e=this._store.getReadonlyState(M),t=await this._store.dispatchIntent(new iO(e.defaultPlacement));return new HE({isAvailable:t})}async onNavigateDeepLinkRequest(e){const t=this._store.getReadonlyState(S);this._store.dispatchIntent(new Za);let s=!1;try{await this.waitForAuthIfNeeded(e.navigationContext.appName)}catch(a){return this._logger.error("Unable to deep link navigate to micro app ".concat(e.navigationContext.appName,", because session is not set"),{game:t.hostGame,navigationContext:e.navigationContext,logCategory:f.hostCommunication,errorCode:g.UnableToDeepLinkNavigateToAppNoSession}),new xp({isSuccessful:s,requestId:e.requestId,senderId:e.senderId})}try{const a=await this._store.dispatchIntent(new Xe(e.navigationContext.appName,t.hostGame));a!==void 0?s=await this._store.dispatchIntent(new Be({appName:e.navigationContext.appName,game:t.hostGame,applicationData:e.navigationContext.applicationData,parentAppName:a},{callerMicroAppName:"HostNavigationListenerService.onNavigateDeepLinkRequest"})):this._logger.warn("Unable to deep link navigate to micro app ".concat(e.navigationContext.appName,", because it has been incorrectly configured for space ").concat(t.hostGame.spaceId),{game:t.hostGame,navigationContext:e.navigationContext,logCategory:f.hostCommunication,errorCode:g.UnableToDeepLinkNavigateToAppMissingCfgWarning})}catch(a){this._logger.warn("Error navigating to requested micro app",{logCategory:f.hostCommunication,error:a,moreInfo:{request:e},errorCode:g.UnableToNavigateToAppWarning})}return new xp({isSuccessful:s,requestId:e.requestId,senderId:e.senderId})}isAuthApp(e){return[J.AppAuth,J.AppAuthentication].includes(e)}async waitForAuthIfNeeded(e){if(this.isAuthApp(e))return;const t=this._store.getReadonlyState(S);await q(bi,t.authIsDone)}async onSwitchToExclusiveModeRequest(e){const t=this._store.getReadonlyState(S);this._store.dispatchIntent(new Za);let s=!1;try{await this.waitForAuthIfNeeded(e.navigationContext.appName)}catch(a){return this._logger.error("Error switching to exclusive mode. Unauthenticated.",{error:a,request:e,logCategory:f.hostCommunication,errorCode:g.NavigationListenerSwitchExclusiveModeNotAuthenticatedError}),new Hm({isSuccessful:s})}try{const a=await this._store.dispatchIntent(new Xe(e.navigationContext.appName,t.hostGame));a!==void 0?s=await this._store.dispatchIntent(new Fd({appName:e.navigationContext.appName,game:t.hostGame,applicationData:e.navigationContext.applicationData,parentAppName:a})):this._logger.error("Unable to deep link navigate to micro app ".concat(e.navigationContext.appName,", because session is not set"),{game:t.hostGame,navigationContext:e.navigationContext,logCategory:f.hostCommunication,errorCode:g.UnableToSwitchToExlusiveModeMissingCfgWarning})}catch(a){this._logger.error("Error switching to exclusive mode",{error:a,request:e,logCategory:f.hostCommunication,errorCode:g.NavigationListenerSwitchExclusiveModeError})}return new Hm({isSuccessful:s})}async onExitExclusiveModeRequest(){let e=!1;try{e=await this._store.dispatchIntent(new Ld)}catch(t){this._logger.error("Error exiting exclusive mode",{error:t,logCategory:f.hostCommunication,errorCode:g.NavigationListenerExitExclusiveModeError})}return new QE({isSuccessful:e})}}Ks([_()],pi.prototype,"onAddToNavigationHistoryNotification",1);Ks([_()],pi.prototype,"onNavigateRequest",1);Ks([_()],pi.prototype,"onTabNavigateRequest",1);Ks([_()],pi.prototype,"onNavigateBackRequest",1);Ks([_()],pi.prototype,"onIsNavigationBackAvailableRequest",1);Ks([_()],pi.prototype,"onNavigateDeepLinkRequest",1);Ks([_()],pi.prototype,"onSwitchToExclusiveModeRequest",1);Ks([_()],pi.prototype,"onExitExclusiveModeRequest",1);class kL extends d("[Notifications] PcClient Notification added"){constructor(e){super(),this.notification=e}}class WL extends d("[Notifications] PcClient Notification state updated"){constructor(e,t){super(),this.id=e,this.state=t}}class Ul extends d("[Notifications] PcClient Notification dismissed"){constructor(e){super(),this.id=e}}class VL extends d("[Notifications] Sen Invite Action to Client"){constructor(e,t){super(),this.accepted=e,this.inviteId=t}}class $L extends d("[Notifications] Update Settings"){constructor(e){super(),this.settings=e}}class BL extends d("[Notifications] Notification Redirect"){}var zB=Object.defineProperty,KB=Object.getOwnPropertyDescriptor,HL=(i,e,t,s)=>{for(var a=s>1?void 0:s?KB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&zB(e,t,a),a};class kl extends je{registerFeatureListeners(){this.registerNotificationListener(c.ShowOverlay,Cr,this.onShowOverlayNotification),this.registerNotificationListener(c.HideOverlay,bn,this.onHideOverlayNotification)}async onShowOverlayNotification(){await this._store.dispatchIntent(new Za)&&(await this._store.dispatchIntent(new zR),await this._store.dispatchIntent(new BL))}async onHideOverlayNotification(){await this._store.dispatchIntent(new Gt(_e.User))}}HL([_()],kl.prototype,"onShowOverlayNotification",1);HL([_()],kl.prototype,"onHideOverlayNotification",1);class XB extends Zr{getListenerServices(){return[new kl(this._store,this._pluginService,this._logger,this._hostCommunicationService),new pi(this._store,this._logger,this._pluginService,this._hostCommunicationService)]}}var JB=Object.defineProperty,YB=Object.getOwnPropertyDescriptor,ZB=(i,e,t,s)=>{for(var a=s>1?void 0:s?YB(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&JB(e,t,a),a};class QL extends je{registerFeatureListeners(){this.registerNotificationListener(c.MonitorGameLaunchProgress,hS,this.onGameLaunchProgressNotification)}async onGameLaunchProgressNotification(e){await this._store.dispatchIntent(new aL(e.gameInfo,e.launchState))}}ZB([_()],QL.prototype,"onGameLaunchProgressNotification",1);class wu extends d("[Shell] Initialize Host Features"){}class rc extends d("[Shell] Update Host Features"){constructor(e){super(),this.features=e}}var eH=Object.defineProperty,tH=Object.getOwnPropertyDescriptor,iH=(i,e,t,s)=>{for(var a=s>1?void 0:s?tH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&eH(e,t,a),a};class jL extends je{registerFeatureListeners(){this.registerNotificationListener(c.UpdateFeatureSupport,gS,this.onFeatureSupportUpdateNotification)}async onFeatureSupportUpdateNotification(e){await this._store.dispatchIntent(new rc(e.features))}}iH([_()],jL.prototype,"onFeatureSupportUpdateNotification",1);class sH extends Zr{getListenerServices(){return[new jL(this._store,this._pluginService,this._logger,this._hostCommunicationService),new QL(this._store,this._pluginService,this._logger,this._hostCommunicationService)]}}var aH=Object.defineProperty,nH=Object.getOwnPropertyDescriptor,Wl=(i,e,t,s)=>{for(var a=s>1?void 0:s?nH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&aH(e,t,a),a};class Ln extends je{registerFeatureListeners(){this.registerNotificationListener(c.StreamingHostUpdateStatus,Yu,this.onHostStatusUpdateNotification),this.registerNotificationListener(c.StreamingHostUpdateMetrics,Zu,this.onHostMetricsUpdateNotification),this.registerNotificationListener(c.StreamingGuestUpdateStatus,mS,this.onGuestStatusUpdateNotification),this.registerNotificationListener(c.StreamingGuestUpdateMetrics,fS,this.onGuestMetricsUpdateNotification)}async onHostStatusUpdateNotification(e){await this._store.dispatchIntent(new wF(e))}async onHostMetricsUpdateNotification(e){await this._store.dispatchIntent(new CF(e.metrics))}async onGuestStatusUpdateNotification(e){await this._store.dispatchIntent(new AF(e))}async onGuestMetricsUpdateNotification(e){await this._store.dispatchIntent(new TF(e.metrics))}}Wl([_()],Ln.prototype,"onHostStatusUpdateNotification",1);Wl([_()],Ln.prototype,"onHostMetricsUpdateNotification",1);Wl([_()],Ln.prototype,"onGuestStatusUpdateNotification",1);Wl([_()],Ln.prototype,"onGuestMetricsUpdateNotification",1);class qL extends Zr{getListenerServices(){return[new pi(this._store,this._logger,this._pluginService,this._hostCommunicationService),new Ln(this._store,this._pluginService,this._logger,this._hostCommunicationService)]}}var rH=Object.defineProperty,oH=Object.getOwnPropertyDescriptor,sm=(i,e,t,s)=>{for(var a=s>1?void 0:s?oH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&rH(e,t,a),a};class Vl extends je{registerFeatureListeners(){this.registerRequestHandler(c.IsMicroAppAvailable,yS,this.onIsMicroAppAvailableRequest),this.registerRequestHandler(c.GetTransversalMicroApps,vS,this.onGetTransversalMicroAppsRequest),this.registerRequestHandler(c.GetGameSpecificMicroApps,_S,this.onGetGameSpecificMicroAppsRequest)}async onIsMicroAppAvailableRequest(e){var r;const t=this._store.getReadonlyState(S),s=(r=e.game)!=null?r:t.activeGame,a=await this._store.dispatchIntent(new Xe(e.appName,s)),n=a!==void 0&&await this._store.dispatchIntent(new Ci(e.appName,s,a));return new jE({isAvailable:n})}async onGetTransversalMicroAppsRequest(){const e=await this._store.dispatchIntent(new ms);return new qE({transversalMicroApps:e})}async onGetGameSpecificMicroAppsRequest(e){const t=await this._store.dispatchIntent(new ms(e.game));return new zE({gameSpecificMicroApps:t})}}sm([_()],Vl.prototype,"onIsMicroAppAvailableRequest",1);sm([_()],Vl.prototype,"onGetTransversalMicroAppsRequest",1);sm([_()],Vl.prototype,"onGetGameSpecificMicroAppsRequest",1);var cH=Object.defineProperty,lH=Object.getOwnPropertyDescriptor,pH=(i,e,t,s)=>{for(var a=s>1?void 0:s?lH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&cH(e,t,a),a};class zL extends je{registerFeatureListeners(){this.registerRequestHandler(c.ScrollMicroApp,SS,this.onScrollMicroAppRequest)}async onScrollMicroAppRequest(e){const t={horizontalAlignment:e.horizontalAlignment,verticalAlignment:e.verticalAlignment},s=await this._store.dispatchIntent(new KD(B.main,t));return new KE({isSuccessful:s})}}pH([_()],zL.prototype,"onScrollMicroAppRequest",1);var uH=Object.defineProperty,dH=Object.getOwnPropertyDescriptor,hH=(i,e,t,s)=>{for(var a=s>1?void 0:s?dH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&uH(e,t,a),a};class am extends je{registerFeatureListeners(){this.registerNotificationListener(c.UpdateUbisoftTicket,Ir,this.onUpdateUbisoftTicketNotification)}async onUpdateUbisoftTicketNotification(e){var t;if((t=e.ticket)!=null&&t.trim())return this._store.dispatchIntent(new jR(e.ticket));this._logger.warn("Unable to update session with invalid ticket: ".concat(e.ticket),{ticket:e.ticket,logCategory:f.authentication,errorCode:g.UnableToUpdateSessionInvalidTicketWarning})}}hH([_()],am.prototype,"onUpdateUbisoftTicketNotification",1);class gH extends qL{getListenerServices(){return super.getListenerServices().concat([new Vl(this._store,this._pluginService,this._logger,this._hostCommunicationService),new zL(this._store,this._pluginService,this._logger,this._hostCommunicationService),new am(this._store,this._pluginService,this._logger,this._hostCommunicationService)])}}var mH=Object.defineProperty,fH=Object.getOwnPropertyDescriptor,yH=(i,e,t,s)=>{for(var a=s>1?void 0:s?fH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&mH(e,t,a),a};class KL extends je{registerFeatureListeners(){this.registerNotificationListener(c.UpdateGameSessionInvite,Rr,this.onGameSessionUpdateNotification)}async onGameSessionUpdateNotification(e){await this._store.dispatchIntent(new sF(e))}}yH([_()],KL.prototype,"onGameSessionUpdateNotification",1);var vH=Object.defineProperty,_H=Object.getOwnPropertyDescriptor,XL=(i,e,t,s)=>{for(var a=s>1?void 0:s?_H(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&vH(e,t,a),a};class nm extends je{registerFeatureListeners(){this.registerNotificationListener(c.RefreshUbisoftTicket,nd,this.onUbiTicketRefreshRequest),this.registerRequestHandler(c.HostShutdown,rd,this.onHostShutdownRequest)}async onUbiTicketRefreshRequest(){return this._store.dispatchIntent(new TD)}async onHostShutdownRequest(){const e=await this._store.dispatchIntent(new RD);return new qv(e)}}XL([_()],nm.prototype,"onUbiTicketRefreshRequest",1);XL([_()],nm.prototype,"onHostShutdownRequest",1);var SH=Object.defineProperty,wH=Object.getOwnPropertyDescriptor,rm=(i,e,t,s)=>{for(var a=s>1?void 0:s?wH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&SH(e,t,a),a};class $l extends je{registerFeatureListeners(){this.registerNotificationListener(c.BrowserViewOnNavigate,ed,this.onBrowserViewOnNavigateNotification),this.registerNotificationListener(c.BrowserViewOnClosed,td,this.onBrowserViewOnClosedNotification),this.registerNotificationListener(c.BrowserViewOnMessage,id,this.onBrowserViewOnMessageNotification)}async onBrowserViewOnNavigateNotification(e){await this._store.dispatchIntent(new EF(e))}async onBrowserViewOnClosedNotification(e){await this._store.dispatchIntent(new UF(e))}async onBrowserViewOnMessageNotification(e){return this._store.dispatchIntent(new QF(e))}}rm([_()],$l.prototype,"onBrowserViewOnNavigateNotification",1);rm([_()],$l.prototype,"onBrowserViewOnClosedNotification",1);rm([_()],$l.prototype,"onBrowserViewOnMessageNotification",1);var bH=Object.defineProperty,CH=Object.getOwnPropertyDescriptor,om=(i,e,t,s)=>{for(var a=s>1?void 0:s?CH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&bH(e,t,a),a};class Bl extends je{registerFeatureListeners(){this.registerNotificationListener(c.LegacyClientPatchAvailable,sd,this.onLegacyClientPatchAvailableNotification),this.registerNotificationListener(c.PrepareRefreshView,od,this.onPrepareRefreshConnectViewNotification),this.registerNotificationListener(c.SetServiceDegradationState,cd,this.onSetServiceDegradationState)}async onSetServiceDegradationState(e){await this._store.dispatchIntent(new eD(e.isDegraded))}async onLegacyClientPatchAvailableNotification(e){await this._store.dispatchIntent(new sD(!0))}async onPrepareRefreshConnectViewNotification(e){await this._store.dispatchIntent(new lg({source:A7}))}}om([_()],Bl.prototype,"onSetServiceDegradationState",1);om([_()],Bl.prototype,"onLegacyClientPatchAvailableNotification",1);om([_()],Bl.prototype,"onPrepareRefreshConnectViewNotification",1);class bu extends d("[Settings] PC Game Settings update"){constructor(e){super(),this.data=e}}class JL extends d("[Settings] PC Game Settings load"){}class IH extends d("[Settings] PC Crash Report Settings"){constructor(e){super(),this.data=e}}class MH extends d("[Settings] PC Remind Me Of Steam Linking"){constructor(e){super(),this.data=e}}var AH=Object.defineProperty,PH=Object.getOwnPropertyDescriptor,Hl=(i,e,t,s)=>{for(var a=s>1?void 0:s?PH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&AH(e,t,a),a};class eo extends je{registerFeatureListeners(){this.registerNotificationListener(c.UpdateSettings,Dr,this.onUpdateSettingsNotification),this.registerNotificationListener(c.SettingsUpdated,Or,this.onSettingsUpdatedNotification),this.registerNotificationListener(c.DontUploadCrashReportsUpdated,Ec,this.onDontUploadCrashReportsUpdatedNotification),this.registerNotificationListener(c.UpdatedRemindMeOfSteamLinking,Uc,this.onUpdatedRemindMeOfSteamLinkingNotification)}async onUpdateSettingsNotification(e){await this._store.dispatchIntent(new bu(e.settings))}async onSettingsUpdatedNotification(e){await this._store.dispatchIntent(new bu(e.settings))}async onDontUploadCrashReportsUpdatedNotification(e){await this._store.dispatchIntent(new IH(e))}async onUpdatedRemindMeOfSteamLinkingNotification(e){await this._store.dispatchIntent(new MH(e))}}Hl([_()],eo.prototype,"onUpdateSettingsNotification",1);Hl([_()],eo.prototype,"onSettingsUpdatedNotification",1);Hl([_()],eo.prototype,"onDontUploadCrashReportsUpdatedNotification",1);Hl([_()],eo.prototype,"onUpdatedRemindMeOfSteamLinkingNotification",1);class YL extends d("[FPS] PcClient FPS update"){constructor(e){super(),this.fps=e}}var NH=Object.defineProperty,TH=Object.getOwnPropertyDescriptor,Ql=(i,e,t,s)=>{for(var a=s>1?void 0:s?TH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&NH(e,t,a),a};class to extends je{registerFeatureListeners(){this.registerNotificationListener(c.UINotificationAdded,Mr,this.onAddUiNotification),this.registerNotificationListener(c.UINotificationStateUpdated,Ar,this.onUpdateUiNotificationStateNotification),this.registerNotificationListener(c.UINotificationDismissed,Pr,this.onDismissUiNotification),this.registerNotificationListener(c.UpdateFPS,Nr,this.onUpdateFpsNotification)}async onAddUiNotification(e){await this._store.dispatchIntent(new kL(e.uiNotification))}async onUpdateUiNotificationStateNotification(e){await this._store.dispatchIntent(new WL(e.id,e.state))}async onDismissUiNotification(e){await this._store.dispatchIntent(new Ul(e.id))}async onUpdateFpsNotification(e){await this._store.dispatchIntent(new YL(e.fpsUpdate))}}Ql([_()],to.prototype,"onAddUiNotification",1);Ql([_()],to.prototype,"onUpdateUiNotificationStateNotification",1);Ql([_()],to.prototype,"onDismissUiNotification",1);Ql([_()],to.prototype,"onUpdateFpsNotification",1);var RH=Object.defineProperty,DH=Object.getOwnPropertyDescriptor,OH=(i,e,t,s)=>{for(var a=s>1?void 0:s?DH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&RH(e,t,a),a};class ZL extends je{registerFeatureListeners(){this.registerNotificationListener(c.UpdateUserActivity,Tr,this.onUpdateUserActivityNotification)}async onUpdateUserActivityNotification(e){await this._store.dispatchIntent(new bg(e.userActivityStatus))}}OH([_()],ZL.prototype,"onUpdateUserActivityNotification",1);class oc extends d("[Shell] Update Window State Intent"){constructor(e){super(),this.state=e}}class eG extends d("[Shell] Load Window State Intent"){}class Cu extends d("[Shell] Set Window State Intent"){constructor(e){super(),this.state=e}}var FH=Object.defineProperty,LH=Object.getOwnPropertyDescriptor,GH=(i,e,t,s)=>{for(var a=s>1?void 0:s?LH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&FH(e,t,a),a};class tG extends je{registerFeatureListeners(){this.registerNotificationListener(c.MonitorWindowStateUpdate,ad,this.onWindowStateUpdateNotification)}async onWindowStateUpdateNotification(e){await this._store.dispatchIntent(new oc(e.newState))}}GH([_()],tG.prototype,"onWindowStateUpdateNotification",1);class iG extends je{constructor(){super(...arguments),this._requestClassesMap={[c.IsMicroAppAvailable]:yS,[c.GetTransversalMicroApps]:vS,[c.GetGameSpecificMicroApps]:_S,[c.Navigate]:Cn,[c.TabNavigate]:cS,[c.NavigateBack]:lS,[c.IsNavigationBackAvailable]:pS,[c.NavigateDeepLink]:Ju,[c.SwitchToExclusiveMode]:uS,[c.ExitExclusiveMode]:dS,[c.ScrollMicroApp]:SS,[c.HostShutdown]:rd},this._notificationClassesMap={[c.UpdateUserActivity]:Tr,[c.UpdateGameSessionInvite]:Rr,[c.UpdateUbisoftTicket]:Ir,[c.AddToNavigationHistory]:oS,[c.UpdateSettings]:Dr,[c.UINotificationAdded]:Mr,[c.UINotificationStateUpdated]:Ar,[c.UINotificationDismissed]:Pr,[c.UpdateFPS]:Nr,[c.ShowOverlay]:Cr,[c.HideOverlay]:bn,[c.UpdateFeatureSupport]:gS,[c.StreamingHostUpdateStatus]:Yu,[c.StreamingHostUpdateMetrics]:Zu,[c.StreamingGuestUpdateStatus]:mS,[c.StreamingGuestUpdateMetrics]:fS,[c.MonitorGameLaunchProgress]:hS,[c.MonitorGameDependencyInstallation]:XE,[c.LegacyAddOnStateUpdate]:Wy,[c.LegacyGameStateUpdate]:Uy,[c.BrowserViewOnNavigate]:ed,[c.BrowserViewOnClosed]:td,[c.BrowserViewOnMessage]:id,[c.LegacyPlayStart]:$y,[c.LegacyPlayEnd]:By,[c.LegacyGameDownloadProgressUpdate]:Qy,[c.LegacyGameDownloadFailedUpdate]:Hy,[c.LegacyDownloadQueueUpdated]:Jy,[c.LegacyGameInstallationFolderUpdate]:Zy,[c.LegacyDownloadStateUpdate]:zy,[c.LegacyDownloadLanguageUpdate]:Yy,[c.LegacyDownloadVerifyGameProgress]:jy,[c.LegacyDownloadAllocatingDiskProgress]:qy,[c.NavigateToGamePage]:Vy,[c.LegacyGamePatchInformationUpdate]:ky,[c.MonitorGameDownloadProgress]:JE,[c.MonitorProductActionsUpdate]:YE,[c.LegacyGameDownloadActiveChanged]:Ky,[c.LegacyGameDownloadAdded]:Xy,[c.LegacyGameDownloadConnectionStatusUpdated]:Gp,[c.SettingsUpdated]:Or,[c.DontUploadCrashReportsUpdated]:Ec,[c.LegacyClientPatchAvailable]:sd,[c.MonitorWindowStateUpdate]:ad,[c.UpdatedRemindMeOfSteamLinking]:Uc,[c.LegacyProductsAdded]:ev,[c.LegacyProductsUpdated]:tv,[c.LegacyInstallerInProgress]:iv,[c.LegacyInstallerFailed]:sv,[c.LegacyInstallerCancelled]:av,[c.LegacyInstallerCompleted]:nv,[c.LegacyRetailInstallerCompleted]:rv,[c.RefreshUbisoftTicket]:nd,[c.ModalBackdropClick]:wS,[c.ModalViewportPosition]:bS,[c.StoreOnCheckoutCancel]:ov,[c.DeeplinkNavigation]:cv,[c.PrepareRefreshView]:od,[c.MonitorRunningProductUpdate]:lv,[c.SetServiceDegradationState]:cd}}registerFeatureListeners(){}registerHostRequestHandler(e,t,s){const a=this._requestClassesMap[e];return!a||!this.isRequestConstructor(a)?!1:this.registerRequestHandler(e,a,t,s)}isRequestConstructor(e){return e&&e.name}registerHostListenerHandler(e,t,s){const a=this._notificationClassesMap[e];return!a||!this.isNotificationConstructor(a)?!1:this.registerNotificationListener(e,a,t,s)}isNotificationConstructor(e){return e&&e.name}}class Cf extends Zr{getListenerServices(){return[new KL(this._store,this._pluginService,this._logger,this._hostCommunicationService),new ZL(this._store,this._pluginService,this._logger,this._hostCommunicationService),new am(this._store,this._pluginService,this._logger,this._hostCommunicationService),new pi(this._store,this._logger,this._pluginService,this._hostCommunicationService),new kl(this._store,this._pluginService,this._logger,this._hostCommunicationService),new to(this._store,this._pluginService,this._logger,this._hostCommunicationService),new eo(this._store,this._pluginService,this._logger,this._hostCommunicationService),new Ln(this._store,this._pluginService,this._logger,this._hostCommunicationService),new iG(this._store,this._pluginService,this._logger,this._hostCommunicationService),new $l(this._store,this._pluginService,this._logger,this._hostCommunicationService),new Bl(this._store,this._pluginService,this._logger,this._hostCommunicationService),new tG(this._store,this._pluginService,this._logger,this._hostCommunicationService),new nm(this._store,this._pluginService,this._logger,this._hostCommunicationService)]}}var xH=Object.defineProperty,EH=Object.getOwnPropertyDescriptor,sG=(i,e,t,s)=>{for(var a=s>1?void 0:s?EH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&xH(e,t,a),a};class cm extends je{registerFeatureListeners(){this.registerNotificationListener(c.ModalViewportPosition,bS,this.onModalViewportPositionNotification),this.registerNotificationListener(c.ModalBackdropClick,wS,this.onModalBackdropClickedNotification)}async onModalViewportPositionNotification(e){await this._store.dispatchIntent(new KF(e))}async onModalBackdropClickedNotification(){await this._store.dispatchIntent(new $g)}}sG([_()],cm.prototype,"onModalViewportPositionNotification",1);sG([_()],cm.prototype,"onModalBackdropClickedNotification",1);class UH extends Zr{getListenerServices(){return[new pi(this._store,this._logger,this._pluginService,this._hostCommunicationService),new cm(this._store,this._pluginService,this._logger,this._hostCommunicationService)]}}class kH{constructor(e,t,s,a){this._store=e,this._logger=t,this._pluginService=s,this._hostCommunicationService=a}getFeatureServiceFactories(e){if(e.platformVariant===gt.Aegir)return{delegationServiceFactory:new b$(this._store,this._hostCommunicationService),listenerServiceFactory:new XB(this._store,this._logger,this._pluginService,this._hostCommunicationService)};if([p.ScarlettUWPWebView2,p.XoneUWPWebView2].includes(e.hostPlatformType))return{delegationServiceFactory:new QB(this._store,this._hostCommunicationService)};switch(e.platformType){case m.IOS:case m.Android:case m.Mobile:{const t=e.mobileCompanionAppType===Bi.CompanionApp?aB:k$,s=e.mobileCompanionAppType===Bi.CompanionApp?gH:qL;return{delegationServiceFactory:new t(this._store,this._hostCommunicationService),listenerServiceFactory:new s(this._store,this._logger,this._pluginService,this._hostCommunicationService)}}case m.PC:{const t=[p.PCElectronClient,p.PCWebClient].includes(e.hostPlatformType),s=t?D$:bf,a=t?sH:Cf;return{delegationServiceFactory:new s(this._store,this._hostCommunicationService),listenerServiceFactory:new a(this._store,this._logger,this._pluginService,this._hostCommunicationService)}}case m.Luna:case m.Steam:return{delegationServiceFactory:new bf(this._store,this._hostCommunicationService),listenerServiceFactory:new Cf(this._store,this._logger,this._pluginService,this._hostCommunicationService)};case m.Web:return e.hostPlatformType===p.WebEmbedded?{delegationServiceFactory:new VB(this._store,this._hostCommunicationService),listenerServiceFactory:new UH(this._store,this._logger,this._pluginService,this._hostCommunicationService)}:{};default:return{}}}}class WH{constructor(e,t,s,a,n,r=new kH(e,t,a,n)){this._hostFeatureDispatcherService=s,this._hostCommunicationService=n,this._featureServiceFactoryProvider=r}registerFeatureListenersAndHandlers(e){const t=this._featureServiceFactoryProvider.getFeatureServiceFactories(e);this.registerFeatureListeners(t.listenerServiceFactory),this.registerFeatureHandlers(t.delegationServiceFactory)}registerFeatureListeners(e){e==null||e.getListenerServices().forEach(t=>t.registerFeatureListeners())}registerFeatureHandlers(e){e==null||e.getDelegationServices().forEach(t=>t.registerFeatureHandlers(this._hostFeatureDispatcherService))}}class VH{constructor(){this._microAppContainers=new Uo({})}get microAppContainers(){return this._microAppContainers.getValue()}getMicroAppContainer(e){return this._microAppContainers.getValue()[e]}setMicroAppContainer(e){const{value:t,placement:s}=e;this._microAppContainers.next({...this._microAppContainers.getValue(),[s]:t})}removeMicroAppContainer(e){this._microAppContainers.next({...this._microAppContainers.getValue(),[e]:void 0})}waitForMicroAppContainer(e){return new Promise(t=>{const s=this.getMicroAppContainer(e);if(s)t(s);else{const a=this._microAppContainers.subscribe(n=>{const r=n[e];r&&(t(r),a.unsubscribe())})}})}}var $H=Object.defineProperty,BH=Object.getOwnPropertyDescriptor,jl=(i,e,t,s)=>{for(var a=s>1?void 0:s?BH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&$H(e,t,a),a};const HH=10;class io{constructor(e){this._logger=e,this._connection=null,this._messageHandlers=[],this._pendingClose=!1,this._closeDeferred=new yt,this._openDeferred=new yt,this._retryCount=0,this._lastRetryTimestamp=0,this._connectionStateEventListeners=[]}addConnectionStateEventListener(e){this._connectionStateEventListeners.push(e)}removeConnectionStateEventListener(e){this._connectionStateEventListeners=this._connectionStateEventListeners.filter(t=>t!==e)}getOpenDeferred(){return this._openDeferred.promise}addMessageHandler(e){this._messageHandlers.push(e)}retryConnection(){const e=this.getUrl();e&&this.openConnection(e,this._protocols)}clearTimeout(){this._retryTimeoutId&&(clearTimeout(this._retryTimeoutId),this._retryTimeoutId=void 0)}onMessageHandler(e){for(const t of this._messageHandlers)t(e)}onOpenHandler(e){this._openDeferred.resolve(),this.clearTimeout(),this._retryCount=0,this._connectionStateEventListeners.forEach(t=>{t({status:Vi.Opened})})}onErrorHandler(e){this._connectionStateEventListeners.forEach(t=>{t({status:Vi.Closed})}),this._logger.warn("Received WebSocket error event",{event:e,logCategory:f.webSocket,errorCode:g.WebsocketErrorEventWarning})}onCloseHandler(e){if(this._closeDeferred.resolve(),this._openDeferred.resolve(),this._connection=null,this._forceCloseTimeout&&(window.clearTimeout(this._forceCloseTimeout),this._forceCloseTimeout=void 0),this._pendingClose)this._connectionStateEventListeners.forEach(t=>{t({status:Vi.Closed})});else{this._logger.warn("WebSocket closed unexpectedly. Code: ".concat(e.code,". Reason: ").concat(e.reason),{logCategory:f.webSocket,errorCode:g.WebsocketClosedUnexpectedlyWarning});const t=Date.now();t-this._lastRetryTimestamp>Vo&&(this._retryCount=0),this._retryCount++,this._lastRetryTimestamp=t;let s=Vp*this._retryCount;this._retryCount>HH&&(this._logger.warn("WebSocket reopening max retry attempt reached.",{logCategory:f.webSocket,errorCode:g.WebsocketMaxRetryAttemptsReachedWarning}),s=Vo),this._connectionStateEventListeners.forEach(a=>{a({status:Vi.RetryNext,retryNext:s})}),this._retryTimeoutId=window.setTimeout(this.retryConnection.bind(this),s)}}async openConnection(e,t){try{if(this._url===e&&(this.connectionIsOpened||this.connectionIsPending))return this._openDeferred.promise;this._protocols=t,await this.closeConnection("overlay.open.other"),this._openDeferred.resolve(),this._closeDeferred.resolve(),this._openDeferred=new yt,this._closeDeferred=new yt,this._pendingClose=!1,this._connection=new WebSocket(e,t),this._url=e,this._connection.onmessage=this.onMessageHandler,this._connection.onerror=this.onErrorHandler,this._connection.onopen=this.onOpenHandler,this._connection.onclose=this.onCloseHandler}catch(s){this._logger.warn("Error happened while initializing WebSocket connection",{error:s,logCategory:f.webSocket,errorCode:g.WebsocketUnableToInitializeConnectionWarning}),this._openDeferred.reject(s),this._closeDeferred.resolve()}return this._openDeferred.promise}async closeConnection(e,t=1e3){if(this.clearTimeout(),!(this._connection===null||this.connectionIsClosed)){if(this.connectionIsClosing){this.deferedForceClosing();return}return this._pendingClose=!0,this._connection.close(t,e),this.deferedForceClosing(),this._closeDeferred.promise}}deferedForceClosing(){this._forceCloseTimeout||(this._forceCloseTimeout=window.setTimeout(()=>{this.onCloseHandler(new CloseEvent("close",{code:1e3,reason:"closed.forcefully",wasClean:!1}))},2e3))}get connectionIsOpened(){return this.connectionHasState(WebSocket.OPEN)}get connectionIsPending(){return this.connectionHasState(WebSocket.CONNECTING)}get connectionIsClosing(){return this.connectionHasState(WebSocket.CLOSING)}get connectionIsClosed(){return this.connectionHasState(WebSocket.CLOSED)}connectionHasState(e){var t;return((t=this._connection)==null?void 0:t.readyState)===e}}jl([_()],io.prototype,"onMessageHandler",1);jl([_()],io.prototype,"onOpenHandler",1);jl([_()],io.prototype,"onErrorHandler",1);jl([_()],io.prototype,"onCloseHandler",1);var ta=(i=>(i.AppId="Ubi-AppId",i.Authorization="Authorization",i.SessionId="Ubi-SessionId",i.SpaceIds="SpaceIds",i.NotificationTypes="NotificationTypes",i.Obj="obj",i))(ta||{});class QH extends io{constructor(e,t,s,a,n,r,o=new ZE){super(a),this._spaceId=e,this._applicationId=t,this._environment=s,this._ubiservices=n,this._store=r,this._updateConnectionDebounceDelay=1e3,this._uniqueId=qt.newId(),this._httpUrlGenerator=o,this.addMessageHandler(async l=>{const u=l.data&&JSON.parse(l.data);u.notificationType===PO&&(this._logger.debug("Websocket closing soon",{notification:u,logCategory:f.playerNotification}),await this.closeConnection("overlay.open.other"),await this.openConnectionForSession()),u.notificationType===NO&&this._logger.debug("Concurrent websocket connection",{notification:u,logCategory:f.playerNotification})}),this.addConnectionStateEventListener(l=>{this._store.dispatchIntent(new MD(l))})}getUrl(){var u;const t=(u=this._store.getReadonlyState(Ii).serviceUrls)==null?void 0:u.websocketNotifications;if(!t)return this._logger.warn("Missing service url",{logCategory:f.playerNotification,errorCode:g.FailedWebsocketNotificationsUrlConfigurationWarning}),"";const s=this._store.getReadonlyState(S);if(!s.playerSession)return this._logger.warn("Missing session",{logCategory:f.playerNotification,errorCode:g.UnableToGetWebsocketUrlMissingSessionWarning}),"";const a=this._store.getReadonlyState(da),n=FS.replaceToken(this._environment,t),r=n==null?void 0:n.replace("{version}","v2"),o={[ta.AppId]:this._applicationId,[ta.Authorization]:"ubi_v1 t=".concat(s.playerSession.ticket),[ta.SessionId]:s.playerSession.sessionId,[ta.SpaceIds]:[this._spaceId],[ta.NotificationTypes]:a.baseNotificationTypes,[ta.Obj]:{id:this._uniqueId}},l=this._httpUrlGenerator.constructFullUrl(r,o);return l==null?(this._logger.warn("WebSocket URL could not be constructed",{logCategory:f.playerNotification,queryParameters:o,errorCode:g.UnableToContructWebsocketUrlWarning}),""):l}retryConnection(){this.openConnectionForSession()}async openConnectionForSession(){const e=this.getUrl();e&&(await this.openConnection(e),this.updateConnection())}updateConnection(){if(this._store.getReadonlyState(oa).playerNotificationsConnectionState.status!==Vi.Opened){this._logger.debug("Skip updateConnection for player notification websocket because the connection is not opened yet.");return}if(this._updateConnectionDebounce){this._logger.debug("Skip updateConnection for player notification websocket because there is already a scheduled update.");return}this._logger.debug("Schedule updateConnection for player notification websocket."),this._updateConnectionDebounce=window.setTimeout(()=>{this._updateConnectionDebounce=void 0,(async()=>{const t=this._store.getReadonlyState(S);if(!t.playerSession){this._logger.warn("No player session when running updateConnection.",{errorCode:g.WebsocketConnectionUpdateMissingSessionWarning});return}this._logger.debug("Running updateConnection for player notification websocket.");const s=t.playerSession.profileId,n=(await this._ubiservices.connectionsService.v1.getProfileConnections(s,{})).connections.filter(r=>"id"in r.obj?r.obj.id===this._uniqueId:!1);if(n.length===0){this._logger.warn("no pnot connection with unique id: ".concat(this._uniqueId),{errorCode:g.WebsocketConnectionUpdateConnectionNotFoundError});return}for(const r of n){if(!r)return;const o=this._store.getReadonlyState(da),l={notificationType:o.spaceDependentNotificationTypes,spaceIndependentNotificationTypes:o.spaceIndependentNotificationTypes,spaceIds:o.spaceIds,obj:{id:this._uniqueId}};try{await this._ubiservices.connectionsService.v2.updateWebsocketConnection(r.contactUrl,l)}catch(u){this._logger.error("Failed to update websocket connection",{errorCode:g.WebsocketConnectionUpdateError,error:u,moreInfo:{payload:l}})}}})()},this._updateConnectionDebounceDelay)}}class aG extends d("[Shell] Blur Shell"){}class rn extends d("[Shell] Navigate from Navigation Bar"){constructor(e,t=!1,s){super(),this.microAppConfig=e,this.isPopup=t,this.inputButton=s}}class lm extends d("[Shell] Notify Shortcuts Updated"){constructor(e){super(),this.shortcuts=e}}class nG extends d("[Shell] Notify Global Shortcuts Updated"){constructor(e){super(),this.shortcuts=e}}class us extends d("[Shell] Activate Shell Focus System"){constructor(e=Rt.ACTIVE){super(),this.focusMode=e}}class rG extends d("[Shell] Deactivate Shell Focus System"){}class oG extends d("[Shell] Move Container Focus"){constructor(e){super(),this.direction=e}}class cG extends d("[Shell] Can Move Container Focus In Direction"){constructor(e){super(),this.direction=e}}class lG extends d("[Shell] Can Move Focus In Order"){constructor(e){super(),this.order=e}}class pG extends d("[Shell] Move Container Focus In Direction"){constructor(e){super(),this.direction=e}}class uG extends d("[Shell] Move Focus In Order"){constructor(e){super(),this.order=e}}class ha extends d("[Shell] Focus Micro Application Container"){constructor(e){super(),this.focusId=e}}class so extends d("[Shell] Focus Placement"){constructor(e){super(),this.placement=e}}class dG extends d("[Shell] Register Focusable Container Entry"){constructor(e,t,s){super(),this.focusableId=e,this.container=t,this.placement=s}}class Ro extends d("[Shell] Focus Micro Application In Container"){constructor(e){super(),this.placement=e}}class pm extends d("[Shell] Focus Navigation Bar Container"){}class ss extends d("[Shell] Set Container Navigation In Progress Status"){constructor(e){super(),this.isNavigationInProgress=e}}class hG extends d("[Shell] Set Currently Focused Container"){constructor(e){super(),this.focusableId=e}}class gG extends d("[Shell] Set Previously Focused Container"){constructor(e){super(),this.focusableId=e}}class um extends d("[Shell] Focus Previous Container"){}class jH extends Et{constructor(e,t){super(),this.v2=new qH(e,t)}}class qH extends Et{constructor(e,t){super(),this._store=e,this._pluginName=t}async showModal(e){return this._store.dispatchIntent(new Mn),this._store.dispatchIntent(new us),this._store.dispatchIntent(new qr(this._pluginName,e))}async closeModal(){this._store.dispatchIntent(new qi)}}class zH{constructor(e,t,s,a,n,r,o,l){this._store=e,this._pluginConfig=t,this._shellConfig=s,this._logger=a,this._pluginsService=n,this._featureHandlerService=r,this._hostFeatureListenerService=o,this._pcClientWrapper=l,this._observers=[],this._ubiServices=null,this._connectServices=null;const u=new Vg(e,this._pluginConfig.name);this._microAppsProxy=pe.new(u),l&&(this._gameInvitesProxy=pe.new(new xg(e,s.shellCrossPlatformSpaceId))),this._streamingProxy=pe.new(new Qg(e,s.shellCrossPlatformSpaceId,!!this._pcClientWrapper)),this._playerNotificationsApiProxy=pe.new(new Bg(e,t.name)),this._cachesApiProxy=pe.new(new Wg(e,s.shellCrossPlatformSpaceId)),this._secureStorageApiProxy=pe.new(new Hg(e,r,s.shellCrossPlatformSpaceId)),this._modalApiProxy=pe.new(new jH(e,this._pluginConfig.name))}sendFeatureMessageWithoutPayload(e){return this._featureHandlerService.handleFeatureWithoutPayload(e)}sendFeatureMessage(e,t){return this._featureHandlerService.handleFeature(e,t)}spyHostFeatureEvent(e,t){this._pluginsService.addHostFeatureWatcher(e,t),this._store.dispatchIntent(new oD(this._pluginConfig,e))}registerRequestHandler(e,t){return this._store.dispatchIntent(new cD(this._pluginConfig,e)),this._hostFeatureListenerService.registerHostRequestHandler(e,t,s=>{this._logger.warn("Error in request handler in ".concat(this._pluginConfig.name," - ").concat(s.message),{pluginConfig:this._pluginConfig,error:s,logCategory:f.shellPlugin,errorCode:g.ErrorInRequestHandlerInPluginWarning})})}registerNotificationListener(e,t){return this._store.dispatchIntent(new lD(this._pluginConfig,e)),this._hostFeatureListenerService.registerHostListenerHandler(e,t,s=>{this._logger.warn("Error in request handler in ".concat(this._pluginConfig.name," - ").concat(s.message),{pluginConfig:this._pluginConfig,error:s,logCategory:f.shellPlugin,errorCode:g.ErrorInRequestHandlerInPluginWarning})})}async getGameSpecificMicroApps(e){return this._store.dispatchIntent(new ms(e))}async getTransversalMicroApps(){return this._store.dispatchIntent(new ms)}async isMicroAppAvailable(e,t){const s=this._store.getReadonlyState(S),a=t!=null?t:s.activeGame,n=await this._store.dispatchIntent(new Xe(e,a));return n!==void 0&&await this._store.dispatchIntent(new Ci(e,a,n))}async reportFatalError(e){this._store.dispatchIntent(new fO(this._pluginConfig,e))}async getUbiServices(){return this._ubiServices?this._ubiServices.proxy:(this._ubiServices=await this._store.dispatchIntent(new wg(this._shellConfig.shellApplicationId)),this._ubiServices.proxy)}async getConnectServices(){return this._connectServices?this._connectServices.proxy:(this._connectServices=pe.new(await this._store.dispatchIntent(new vO)),this._connectServices.proxy)}get microApps(){return this._microAppsProxy.proxy}get gameInvites(){var e;return(e=this._gameInvitesProxy)==null?void 0:e.proxy}get streaming(){var e;return this._streamingProxy?(e=this._streamingProxy)==null?void 0:e.proxy:void 0}get gameManagement(){return this._gameManagementProxy?this._gameManagementProxy.proxy:void 0}get playerNotificationsApi(){return this._playerNotificationsApiProxy?this._playerNotificationsApiProxy.proxy:void 0}get cacheApi(){return this._cachesApiProxy?this._cachesApiProxy.proxy:void 0}get secureStorageApi(){return this._secureStorageApiProxy?this._secureStorageApiProxy.proxy:void 0}get hostFeatures(){var t;return(t=this._store.getReadonlyState(Q).hostFeatures)!=null?t:[]}get modal(){return this._modalApiProxy?this._modalApiProxy.proxy:void 0}isFeatureRegistered(e){const t=this.hostFeatures;return(Array.isArray(e)?e:[e]).every(a=>t.includes(a))}async sendDnaEvent(e,t){this._store.dispatchIntent(new hr(e,t))}async getLogger(){return this._pluginLogger||(this._pluginLogger=this._logger.createChild(this._pluginConfig.name),this._pluginLogger.settings.logCategory=f.shellPlugin),Promise.resolve(this._pluginLogger)}async addCachingEntries(e){return this._store.dispatchIntent(new In(e))}async removeCachingEntries(e){return this._store.dispatchIntent(new wl(e))}getPcClientInterface(){}}const KH=3e3;class XH{constructor(e,t,s,a,n,r,o,l,u){this.pluginConfig=e,this._shellConfig=t,this._store=s,this._logger=a,this._httpClientFactory=n,this._pluginService=r,this._featureHandlerService=o,this._hostFeatureListenerService=l,this._moduleLoader=u,this._registrations=[],this._registering=!1,this._observer=ZF(w=>this.onRuntimeContextUpdate(w),this._logger,this.pluginConfig.name),this._store.dispatchIntent(new Er(this._observer));const v=new zH(this._store,this.pluginConfig,this._shellConfig,this._logger,this._pluginService,this._featureHandlerService,this._hostFeatureListenerService);this._handler=new mr(this._pluginService),this._pluginApi=Proxy.revocable(v,this._handler),this._handlerRegistrationApi={registerApiHandler:w=>this.registerApiHandler(w)},this._runtimeContext=this._store.getReadonlyState(S).runtimeContext}async onRuntimeContextUpdate(e){var t;this._runtimeContext=e,await ((t=this._pluginInstance)==null?void 0:t.onRuntimeContextUpdated(e))}registerApiHandler(e){const t=this.pluginConfig,s=this._store;this._pluginService.registerNamedApi(e),this._registrations.push(e.__name),s.dispatchIntent(new pD(t,e.__name))}async instantiate(){await this.getInstance(),await this.onApiUpdate()}async getInstance(){if(this._pluginInstance)return this._pluginInstance;let e;try{e=await q(KH,this._moduleLoader.loadModule(this.pluginConfig))}catch(s){return this._logger.warn("Not able to load requested module ".concat(this.pluginConfig.name),{error:s,logCategory:f.shellPlugin,errorCode:"UnableToLoadRequestedPlugin.".concat(this.pluginConfig.name)}),Promise.reject(s)}const t=new e(this._pluginApi.proxy,this._runtimeContext,this._httpClientFactory);if(!this.isValidInstance(t)){const s="Incorrect plugin configuration for ".concat(this.pluginConfig.name," version: ").concat(this.pluginConfig.version);return this._logger.warn(s,{received:{name:t.name,version:t.version,logCategory:f.shellPlugin},expected:{name:this.pluginConfig.name,version:this.pluginConfig.version,logCategory:f.shellPlugin},errorCode:"IncorrectPluginConfiguration.".concat(this.pluginConfig.name)}),Promise.reject(s)}return this._pluginInstance=t,this._pluginInstance}isValidInstance(e){return e.name===this.pluginConfig.name}async onApiUpdate(){var t;if(this._registering)return;this._registering=!0,this._handler.clearCache(),this._handler.enableCache(!1);const e=this._registrations.length;try{await ((t=this._pluginInstance)==null?void 0:t.registerApiHandler(this._handlerRegistrationApi))}catch(s){this._logger.warn("Error while registering plugin api",{error:s,errorCode:"PluginApiRegistrationError:".concat(this.pluginConfig.name),moreInfo:{pluginConfig:this.pluginConfig}})}this._registrations.length>e&&(this._handler.enableCache(!0),await this._store.dispatchIntent(new Ur)),this._registering=!1}getInstanceVersion(){var e;return(e=this._pluginInstance)==null?void 0:e.version}}class JH{constructor(e,t,s,a,n,r,o,l=new Map){this._logger=e,this._runtimeApplicationParameters=t,this._store=s,this._httpClientFactory=a,this._featureHandlerService=n,this._shellConfig=r,this._pluginLifeguards=new Map,this._apis=new Map,this._hostFeaturesWatchers=new Map,this.onApiRegistered=new e2,this._moduleLoader=new Rl(s9,l),this._pluginHostFeatureListenerService=new iG(s,this,e,o)}async initializePlugins(){const e=this.getPluginsForHostPlatform();await this.loadModules(e),await Promise.all([...e.keys()].map(async t=>{await this.loadPlugin(t)}))}async loadModules(e){await Promise.all([...e.entries()].map(async([t,s])=>{try{this._moduleLoader.addModule(t,(await s()).default)}catch(a){throw Ao(this._logger,a,t.name)}}))}async loadAuthPluginModule(){return await le(()=>G(()=>import("./upn-vendor-bf1ed58d.js").then(e=>e.h0),["assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadSocialPluginModule(){return await le(()=>G(()=>import("./index.es-5a3b2d8a.js"),["assets/index.es-5a3b2d8a.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadUbisoftPlusPluginModule(){return await le(()=>G(()=>import("./upn-vendor-bf1ed58d.js").then(e=>e.h1),["assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadSettingsPluginModule(){return await le(()=>G(()=>import("./index.es-6d6561de.js"),["assets/index.es-6d6561de.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadStorePluginModule(){return await le(()=>G(()=>import("./index.es-f2716145.js"),["assets/index.es-f2716145.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadEntitlementPluginModule(){return await le(()=>G(()=>import("./index.es-89e04be7.js"),["assets/index.es-89e04be7.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadPartnerPluginModule(){return await le(()=>G(()=>import("./index.es-373e4f30.js"),["assets/index.es-373e4f30.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadQuicklaunchPluginModule(){return await le(()=>G(()=>import("./index.es-05c45323.js"),["assets/index.es-05c45323.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadPcGameRuntimePluginModule(){return await le(()=>G(()=>import("./index.es-3d5ac2c1.js"),["assets/index.es-3d5ac2c1.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadIpLocationPluginModule(){return await le(()=>G(()=>import("./upn-vendor-bf1ed58d.js").then(e=>e.h2),["assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadUserInterfaceManagementPluginModule(){return await le(()=>G(()=>import("./index.es-d0328ec0.js"),["assets/index.es-d0328ec0.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadSpotlightLauncherPluginModule(){return await le(()=>G(()=>import("./index.es-fa1089a6.js"),["assets/index.es-fa1089a6.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadSplashScreenLauncherPluginModule(){return await le(()=>G(()=>import("./index.es-755a033b.js"),["assets/index.es-755a033b.js","assets/vendor-ff46a377.js","assets/upn-vendor-bf1ed58d.js"]))}async loadLegacyGameManagementPluginModule(){return await le(()=>G(()=>import("./index.es-8652fed5.js"),["assets/index.es-8652fed5.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadPcGameManagementPluginModule(){return await le(()=>G(()=>import("./index.es-fc661086.js"),["assets/index.es-fc661086.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadDeeplinkNavigationPluginModule(){return await le(()=>G(()=>import("./index.es-059d663f.js"),["assets/index.es-059d663f.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadGameManagementPluginModule(){return await le(()=>G(()=>import("./index.es-810e4ed1.js"),["assets/index.es-810e4ed1.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadWebEmbedderPluginModule(){return await le(()=>G(()=>import("./index.es-a5d59d29.js"),["assets/index.es-a5d59d29.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}async loadRichPresencePluginModule(){return await le(()=>G(()=>import("./index.es-1d001ab8.js"),["assets/index.es-1d001ab8.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))}getPluginsForHostPlatform(){let e=new Map([[{name:"UbisoftPlusPlugin"},this.loadUbisoftPlusPluginModule],[{name:"AuthPlugin"},this.loadAuthPluginModule],[{name:"IpLocationPlugin"},this.loadIpLocationPluginModule]]);if(this.isLinking()||e.set({name:"RichPresencePlugin"},this.loadRichPresencePluginModule),this.isAegir()&&e.set({name:"SocialPlugin"},this.loadSocialPluginModule),this.isPC()){const t=new Map([[{name:"SettingsPlugin"},this.loadSettingsPluginModule],[{name:"StorePlugin"},this.loadStorePluginModule],[{name:"EntitlementPlugin"},this.loadEntitlementPluginModule],[{name:"PartnerPlugin"},this.loadPartnerPluginModule],[{name:"QuickLaunchPlugin"},this.loadQuicklaunchPluginModule],[{name:"PcGameRuntimePlugin"},this.loadPcGameRuntimePluginModule]]);e=new Map([...e,...t])}if(this.isMobileGameOverlay()&&e.set({name:"UserInterfaceManagementPlugin"},this.loadUserInterfaceManagementPluginModule),this.isDesktopClient()||this.isLegacyClient()){const t=new Map([[{name:"SpotlightLauncherPlugin"},this.loadSpotlightLauncherPluginModule]]);this._runtimeApplicationParameters.childId||t.set({name:"SplashScreenLauncherPlugin"},this.loadSplashScreenLauncherPluginModule),e=new Map([...e,...t]),this.isLegacyClient()?(e.set({name:"LegacyGameManagementPlugin"},this.loadLegacyGameManagementPluginModule),e.set({name:"PcGameManagementPlugin"},this.loadPcGameManagementPluginModule),e.set({name:"DeeplinkNavigationPlugin"},this.loadDeeplinkNavigationPluginModule)):e.set({name:"GameManagementPlugin"},this.loadGameManagementPluginModule)}return this.isWebEmbedded()&&e.set({name:"WebEmbedderPlugin"},this.loadWebEmbedderPluginModule),e}isAegir(){return[p.PS4Aegir,p.PS4AegirNative,p.PS5Aegir,p.PS5AegirNative,p.XOneAegir,p.XOneAegirNative,p.ScarlettAegir,p.ScarlettAegirNative,p.MacOSAegir,p.MacOSAegirNative].includes(this._runtimeApplicationParameters.hostPlatformType)}isLinking(){return Br(this._runtimeApplicationParameters)}isLegacyClient(){return[p.PCLegacyClient,p.SteamClient].includes(this._runtimeApplicationParameters.hostPlatformType)}isDesktopClient(){return[p.PCElectronClient,p.PCWebClient].includes(this._runtimeApplicationParameters.hostPlatformType)}isPCOverlay(){return[p.PCWebOverlay,p.PCLegacyOverlay,p.PCElectronOverlay,p.SteamOverlay,p.Luna].includes(this._runtimeApplicationParameters.hostPlatformType)}isPC(){return this.isLegacyClient()||this.isDesktopClient()||this.isPCOverlay()}isMobileGameOverlay(){return[p.Mobile,p.IOS,p.Android].includes(this._runtimeApplicationParameters.hostPlatformType)}isWebEmbedded(){return this._runtimeApplicationParameters.hostPlatformType===p.WebEmbedded}async loadPlugin(e){if(this._pluginLifeguards.has(e))this._logger.warn("Plugin ".concat(e.name," ").concat(e.version," is already loaded"),{pluginConfig:e,logCategory:f.shellPlugin,errorCode:"PluginAlreadyLoaded.".concat(e.name)});else{const t=this.createLifeguard(e);if(t)try{await t.instantiate(),this._pluginLifeguards.set(e,t),await this._store.dispatchIntent(new rD({name:e.name,version:t.getInstanceVersion(),bundleUrl:e.bundleUrl}))}catch(s){this._logger.warn("Could not instantiate plugin ".concat(e.name," ").concat(e.version),{error:s,pluginConfig:e,logCategory:f.shellPlugin,errorCode:"UnableToInstatiatePlugin.".concat(e.name)})}}}createLifeguard(e){return new XH(e,this._shellConfig,this._store,this._logger,this._httpClientFactory,this,this._featureHandlerService,this._pluginHostFeatureListenerService,this._moduleLoader)}getPluginsConfiguration(){return Array.from(this._pluginLifeguards.keys()).filter(e=>!!e.bundleUrl)}registerNamedApi(e){if(this._apis.has(e.__name))throw new Error("Incorrect plugins configuration. Api ".concat(e.__name," is already registered"));this._apis.set(e.__name,e),this.onApiRegistered.emit(e.__name)}updateApi(){for(const e of this._pluginLifeguards.values())e.onApiUpdate()}getApi(e){return this._apis.get(e)}addHostFeatureWatcher(e,t){const s=this._hostFeaturesWatchers.get(e)||[];s.push(t),this._hostFeaturesWatchers.set(e,s)}executeSpyEventHandlers(e,t,s){(this._hostFeaturesWatchers.get(e)||[]).forEach(n=>{n(e,t,s)})}executeSpyIncomingRequestEventHandlers(e,t,s){(this._hostFeaturesWatchers.get(e)||[]).forEach(n=>{n(e,t,s)})}}var YH=Object.defineProperty,ZH=Object.getOwnPropertyDescriptor,eQ=(i,e,t,s)=>{for(var a=s>1?void 0:s?ZH(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&YH(e,t,a),a};class mG{constructor(e){this._reporter=e,this._sessionEntries=[],this._sessionValue=0,this._maxSessionValue=0}layoutShiftEventHandler(e){const t=this._sessionEntries[0],s=this._sessionEntries[this._sessionEntries.length-1];this._sessionValue&&e.startTime-s.startTime<1e3&&e.startTime-t.startTime<5e3?(this._sessionValue+=e.value,this._sessionEntries.push(e)):(this._sessionValue=e.value,this._sessionEntries=[e]),this._sessionValue>this._maxSessionValue&&(this._maxSessionValue=this._sessionValue,this._reporter(this._sessionValue*1e3))}}eQ([_()],mG.prototype,"layoutShiftEventHandler",1);function tQ(i){const e=i;return e.entryType==="layout-shift"&&e.sources!=null}class iQ{constructor(e,t){this._trackingService=e,this._metricDefinitions=t,this._eventHandlers=new WeakMap,this.isAvailable()&&(this._performanceObserver=new PerformanceObserver(this.performanceEntryHandler.bind(this)),this._performanceObserver.observe({type:"layout-shift",buffered:!0}))}collectForMicroApp(e,t){const s=a=>{var n;this._trackingService.sendEvent("performance.cls",{score:Math.round(a),...t}),(n=this._metricDefinitions)==null||n.getMetric(Ae.CumulativeLayoutShift).record(a,{appName:t.microAppName})};this.observe(e,s)}observe(e,t){const s=new mG(t).layoutShiftEventHandler;this._eventHandlers.set(e,a=>s(a))}disconnect(e){this._eventHandlers.delete(e)}performanceEntryHandler(e){var t;for(const s of e.getEntries())if(!(!tQ(s)||s.hadRecentInput))for(const a of s.sources){const n=(t=a.node)==null?void 0:t.parentElement;if(!n)break;const r=this.getParentEventHandler(n);if(r){r(s);break}}}getParentEventHandler(e){let t=e;for(;t;){const s=this._eventHandlers.get(t);if(s)return s;t=t.parentElement}}isAvailable(){return"PerformanceObserver"in window&&"PerformanceEventTiming"in window&&PerformanceObserver.supportedEntryTypes.includes("layout-shift")}}var sQ=Object.defineProperty,aQ=Object.getOwnPropertyDescriptor,nQ=(i,e,t,s)=>{for(var a=s>1?void 0:s?aQ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&sQ(e,t,a),a};class fG{constructor(e){this._reporter=e,this._longestInteraction=0}eventHandler(e){e.duration>this._longestInteraction&&(this._longestInteraction=e.duration,this._reporter(e.duration))}}nQ([_()],fG.prototype,"eventHandler",1);class rQ{constructor(e,t){this._trackingService=e,this._metricDefinitions=t,this._eventHandlers=new Map,this.isAvailable()&&(this._performanceObserver=new PerformanceObserver(this.performanceEntryHandler.bind(this)),this._performanceObserver.observe({type:"first-input",buffered:!0}),this._performanceObserver.observe({type:"event",buffered:!0}))}collectForMicroApp(e,t){const s=a=>{var n;this._trackingService.sendEvent("performance.inp",{score:Math.round(a),...t}),(n=this._metricDefinitions)==null||n.getMetric(Ae.InteractionToNextPaint).record(a,{appName:t.microAppName})};this.observe(e,s)}observe(e,t){const s=new fG(t).eventHandler;this._eventHandlers.set(e,a=>s(a))}disconnect(e){this._eventHandlers.delete(e)}performanceEntryHandler(e){for(const t of e.getEntries())if(this.isInteractionPerformanceEventTiming(t)){for(const[s,a]of this._eventHandlers)if(s.contains(t.target)){a(t);break}}}isInteractionPerformanceEventTiming(e){return e.interactionId!=null}dispose(){var e;(e=this._performanceObserver)==null||e.disconnect(),this._performanceObserver=void 0}isAvailable(){return"PerformanceObserver"in window&&"PerformanceEventTiming"in window&&PerformanceObserver.supportedEntryTypes.includes("event")&&"interactionId"in PerformanceEventTiming.prototype}}class Ka extends d("[Shell] Toggle Tooltip Visibility"){constructor(e,t,s,a){super(),this.isVisible=e,this.microAppConfig=t,this.shouldShowTooltipOnAppTileFocus=s,this.label=a}}class Iu extends d("[Shell] Set Tooltip Position"){constructor(e){super(),this.isPositioned=e}}class yG extends d("[Shell] Application List Is Scrolling"){}class vG extends d("[Shell] Application List Is Ready"){}class _G extends d("[Shell] Hide Tooltip On App Tile Focus"){}class SG extends d("[Shell] Show Context Menu"){constructor(e){super(),this.microAppConfig=e}}class wG extends d("[Shell] Hide Context Menu"){}class dm extends d("[Shell App] Set currently focused tile"){constructor(e){super(),this.focusableId=e}}var oQ=Object.defineProperty,cQ=Object.getOwnPropertyDescriptor,ui=(i,e,t,s)=>{for(var a=s>1?void 0:s?cQ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&oQ(e,t,a),a};let nt=class extends We($c){constructor(){super(...arguments),this.tileId=""}async onNavigationMethodChange(){await this.$dispatch(new Ka(this.showTooltip,this.microAppConfig,void 0,this.tileLabel))}async onActiveChange(){this.isActive&&!this.isInViewport(this.$el)&&this.$el.scrollIntoView()}isInViewport(i){const e=i.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}async onFocusChanged(){await this.$dispatch(new Ka(this.showTooltip,this.microAppConfig,!0,this.tileLabel)),this.isFocused&&(this.logger.debug("Tile ".concat(this.microAppConfig.appName," is focused"),{logCategory:f.focus}),this.$dispatch(new dm(this.focusId)))}get shouldShowTileLabel(){return this.layoutType===_t.pcClient}async mounted(){this.microAppConfig&&(this.tileId="app-list-".concat(this.microAppConfig.appName)),await this.$dispatch(new _D({element:this.$el,callback:this.mouseInElement})),await this.$dispatch(new wD({element:this.$el,callback:this.mouseOutElement}))}async mouseInElement(){this.navigationMethod===E.mouse&&await this.$dispatch(new Ka(!0,this.microAppConfig,void 0,this.tileLabel))}async mouseOutElement(){this.navigationMethod===E.mouse&&await this.$dispatch(new Ka(!1,this.microAppConfig,void 0,this.tileLabel))}async beforeDestroy(){await this.$dispatch(new SD({element:this.$el,callback:this.mouseInElement})),await this.$dispatch(new bD({element:this.$el,callback:this.mouseOutElement}))}get tileLabel(){return this.microAppConfig.meta.label}get showTooltip(){return this.navigationMethod===E.directional&&this.isFocused}};ui([C(S,"isMobileGameOverlay")],nt.prototype,"isMobileGameOverlay",2);ui([C(S,"layoutType")],nt.prototype,"layoutType",2);ui([C(S,"navigationMethod")],nt.prototype,"navigationMethod",2);ui([W({type:Object,required:!0})],nt.prototype,"microAppConfig",2);ui([W({type:Boolean,required:!1,default:!1})],nt.prototype,"isActive",2);ui([Mt("navigationMethod")],nt.prototype,"onNavigationMethodChange",1);ui([Mt("isActive")],nt.prototype,"onActiveChange",1);ui([Yt("$logger")],nt.prototype,"logger",2);ui([Mt("isFocused")],nt.prototype,"onFocusChanged",1);ui([_()],nt.prototype,"mouseInElement",1);ui([_()],nt.prototype,"mouseOutElement",1);nt=ui([j],nt);var lQ=Object.defineProperty,pQ=Object.getOwnPropertyDescriptor,Gn=(i,e,t,s)=>{for(var a=s>1?void 0:s?pQ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&lQ(e,t,a),a};let ks=class extends We(nt){async navigateFromNavigationTile(){await this.$dispatch(new rn(this.microAppConfig))}get shortcutDefinitions(){return{[oi.A]:{text:this.$formatMessage({id:"legend.label.select"}),handler:()=>this.navigateFromNavigationTile()}}}get gameSpaceIcon(){var t;const e=this.getGame(this.hostGame.spaceId);return(t=e==null?void 0:e.logoUrl)!=null?t:""}get tileLabel(){var t;const e=this.getGame(this.hostGame.spaceId);return(t=e==null?void 0:e.name)!=null?t:this.microAppConfig.meta.label}};Gn([W({type:Object,required:!0})],ks.prototype,"microAppConfig",2);Gn([C(S,"hostGame")],ks.prototype,"hostGame",2);Gn([C(ws,"getGame")],ks.prototype,"getGame",2);Gn([C(S,"completelyOffline")],ks.prototype,"isOffline",2);Gn([_()],ks.prototype,"navigateFromNavigationTile",1);ks=Gn([j({components:{"upn-picture":CS}})],ks);var uQ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"game-page-tile",attrs:{"data-top-level-micro-app-tile":"game-page",id:i.tileId,"data-e2e":"game-page-tile"},on:{click:function(s){return i.navigateFromNavigationTile()}}},[i.gameSpaceIcon?t("upn-picture",{staticClass:"app-icon",attrs:{src:i.gameSpaceIcon,enableCDNResizing:!0,alt:i.tileLabel,baseSize:48}}):t("div",{staticClass:"placeholder app-icon"}),i.shouldShowTileLabel?t("div",{staticClass:"game-page-tile-label"},[i._v(" "+i._s(i.microAppConfig.meta.label)+" ")]):i._e()],1)},dQ=[];const If={};var hQ=Z(ks,uQ,dQ,!1,gQ,"b6c6e34c",null,null);function gQ(i){for(let e in If)this[e]=If[e]}const mQ=function(){return hQ.exports}();class ao extends oe("[Shell] Layout"){constructor(){super(...arguments),this._breakpoint=yi.Large}get breakpoint(){return this._breakpoint}set breakpoint(e){this._breakpoint=e}get isResolutionSmallerThanFHD(){return this._breakpoint<yi.XXLarge}}class Wi extends oe("OverlayUserState"){constructor(){super(...arguments),this._activity=hs.Normal,this._walletStatus=IS,this._isSubscribed=!0,this._level=0,this._avatarUrl=""}get activity(){return this._activity}set activity(e){this._activity=e}get isSubscribed(){return this._isSubscribed}set isSubscribed(e){this._isSubscribed=e}get walletStatus(){return this._walletStatus}set walletStatus(e){this._walletStatus=e}get level(){return this._level}set level(e){this._level=e}get avatarUrl(){return this._avatarUrl}set avatarUrl(e){this._avatarUrl=e}}class Ke extends oe("[Shell] Application list"){constructor(){super(...arguments),this._tooltipLabel="",this._isTooltipVisible=!1,this._isTooltipPositioned=!1,this._tileId="",this._shouldShowTooltipOnAppTileFocus=!1,this._applicationListIsReady=!0,this._visibleContextMenu=void 0}get tooltipLabel(){return this._tooltipLabel}set tooltipLabel(e){this._tooltipLabel=e}get isTooltipVisible(){return this._isTooltipVisible}set isTooltipVisible(e){this._isTooltipVisible=e}get isTooltipPositioned(){return this._isTooltipPositioned}set isTooltipPositioned(e){this._isTooltipPositioned=e}get tileId(){return this._tileId}set tileId(e){this._tileId=e}get applicationListIsReady(){return this._applicationListIsReady}set applicationListIsReady(e){this._applicationListIsReady=e}get shouldShowTooltipOnAppTileFocus(){return this._shouldShowTooltipOnAppTileFocus}set shouldShowTooltipOnAppTileFocus(e){this._shouldShowTooltipOnAppTileFocus=e}get visibleContextMenu(){return this._visibleContextMenu}set visibleContextMenu(e){this._visibleContextMenu=e}}const bG={[vt.PortraitPrimary]:"orientation-portrait",[vt.PortraitSecondary]:"orientation-portrait",[vt.LandscapePrimary]:"orientation-landscape",[vt.LandscapeSecondary]:"orientation-landscape"},CG={[m.Mobile]:"platform-mobile",[m.Android]:"platform-mobile",[m.IOS]:"platform-mobile",[m.PC]:"platform-pc",[m.Luna]:"platform-pc",[m.Steam]:"platform-pc",[m.PS4]:"platform-ps4",[m.PS5]:"platform-ps5",[m.XONE]:"platform-xone",[m.Scarlett]:"platform-scarlett",[m.ScarlettUWP]:"platform-scarlett",[m.Web]:"platform-web",[m.MacOS]:"platform-mac",[m.Switch]:"platform-switch"},IG=[m.PS4,m.PS5,m.XONE,m.Scarlett,m.ScarlettUWP,m.Switch],fQ={[D.keyboard]:"input-device-type-keyboard",[D.xbox]:"input-device-type-xbox",[D.playstation]:"input-device-type-playstation",[D.nintendo]:"input-device-type-nintendo"},Xs={[E.directional]:"navigation-method-directional",[E.mouse]:"navigation-method-mouse",[E.touch]:"navigation-method-touch"},yQ={[Xn.Dark]:"theme-dark",[Xn.Light]:"theme-light"},Mu={[xs.sideView]:"viewport-side-view",[xs.fullView]:"viewport-full-view"};var vQ=Object.defineProperty,_Q=Object.getOwnPropertyDescriptor,SQ=(i,e,t,s)=>{for(var a=s>1?void 0:s?_Q(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&vQ(e,t,a),a};let Au=class extends K{};Au=SQ([j],Au);var wQ=function(){var i=this,e=i.$createElement;return i._self._c,i._m(0)},bQ=[function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"context-menu-separator-container"},[t("div",{staticClass:"context-menu-separator-container-item"})])}];const Mf={};var CQ=Z(Au,wQ,bQ,!1,IQ,"0a07da00",null,null);function IQ(i){for(let e in Mf)this[e]=Mf[e]}const MQ=function(){return CQ.exports}();var AQ=Object.defineProperty,PQ=Object.getOwnPropertyDescriptor,ql=(i,e,t,s)=>{for(var a=s>1?void 0:s?PQ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&AQ(e,t,a),a};let va=class extends We($c){get shortcutDefinitions(){return{[L.A]:{text:this.$formatMessage({id:"legend.label.select"}),handler:this.selectItem},[L.B]:{text:this.$formatMessage({id:"legend.label.exit"}),handler:this.closeMenu}}}get isVisible(){var i;return(i=this.menuItem.isVisible)!=null?i:!0}get isDisabled(){var i;return(i=this.menuItem.isDisabled)!=null?i:!1}selectItem(){this.menuItem.handler&&this.menuItem.handler(),this.closeMenu()}closeMenu(){this.$emit("close")}};ql([W({type:Object,required:!0})],va.prototype,"menuItem",2);ql([_()],va.prototype,"selectItem",1);ql([_()],va.prototype,"closeMenu",1);va=ql([j],va);var NQ=Object.defineProperty,TQ=Object.getOwnPropertyDescriptor,RQ=(i,e,t,s)=>{for(var a=s>1?void 0:s?TQ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&NQ(e,t,a),a};let Pu=class extends We(va){};Pu=RQ([j],Pu);var DQ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return i.isVisible?t("div",{staticClass:"context-menu-standard-item",class:{disabled:i.isDisabled},on:{click:function(s){return s.preventDefault(),i.selectItem(s)}}},[i._v(" "+i._s(i.menuItem.label)+" ")]):i._e()},OQ=[];const Af={};var FQ=Z(Pu,DQ,OQ,!1,LQ,"b3c661b8",null,null);function LQ(i){for(let e in Af)this[e]=Af[e]}const GQ=function(){return FQ.exports}();var xQ=Object.defineProperty,EQ=Object.getOwnPropertyDescriptor,xn=(i,e,t,s)=>{for(var a=s>1?void 0:s?EQ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&xQ(e,t,a),a};let Ws=class extends We(va){get balance(){return this.walletStatus.formattedBalance}get isVisible(){const e=this.getTopLevelMicroAppConfigByName(J.Store,this.hostGame.spaceId);return e!==void 0&&!e.isHidden&&this.walletStatus.isEligible}async selectItem(){var a;const e=await this.$dispatch(new Xe(J.Store,this.activeGame)),t={appName:J.Store,game:this.activeGame,applicationData:{subdirectory:"walletmanage"},parentAppName:e||null},s=this.accessMenu.find(n=>{var r;return(r=n.contextMenuItems)==null?void 0:r.some(o=>o.type===Ns.Wallet)});this.closeMenu(),await this.$dispatch(new Be(t,{trackingData:{section:Id.contextMenu,button:Ns.Wallet.toUpperCase(),contextParent:((a=s==null?void 0:s.name)==null?void 0:a.toUpperCase())||"PROFILE"},callerMicroAppName:"WalletContextMenuItemComponent.selectItem"}))}};xn([C(Wi,"walletStatus")],Ws.prototype,"walletStatus",2);xn([C(S,"activeGame")],Ws.prototype,"activeGame",2);xn([C(S,"hostGame")],Ws.prototype,"hostGame",2);xn([C(M,"getTopLevelMicroAppConfigByName")],Ws.prototype,"getTopLevelMicroAppConfigByName",2);xn([C(M,"accessMenu")],Ws.prototype,"accessMenu",2);Ws=xn([j],Ws);var UQ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return i.isVisible?t("div",{staticClass:"context-menu-wallet-item",on:{click:function(s){return s.preventDefault(),i.selectItem(s)}}},[t("div",{staticClass:"context-menu-wallet-item-inner"},[i._v(" "+i._s(i.menuItem.label)+" "),i.balance?t("span",{staticClass:"balance"},[i._v(i._s(i.balance))]):i._e()])]):i._e()},kQ=[];const Pf={};var WQ=Z(Ws,UQ,kQ,!1,VQ,"b6279fb4",null,null);function VQ(i){for(let e in Pf)this[e]=Pf[e]}const $Q=function(){return WQ.exports}();var BQ=Object.defineProperty,HQ=Object.getOwnPropertyDescriptor,qe=(i,e,t,s)=>{for(var a=s>1?void 0:s?HQ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&BQ(e,t,a),a};let Ge=class extends K{constructor(){super(...arguments),this.tippyInstance=null}onMenuItemChange(e){var t;(!e||e.length===0)&&((t=this.tippyInstance)==null||t.hide())}onvisibleContextMenuChange(e){var t,s;(e==null?void 0:e.appName)===this.microAppConfig.appName?(t=this.tippyInstance)==null||t.show():e||(s=this.tippyInstance)==null||s.hide()}onOffsetChange(){var e;(e=this.tippyInstance)==null||e.setProps({offset:this.offset})}mounted(){this.setupTippy()}setupTippy(){const e=this.$refs.menuTrigger,t=this.$refs.contextMenuList;this.tippyInstance=M2(e,{arrow:!1,content:t,duration:[0,0],interactive:!0,offset:this.offset,placement:this.placement,trigger:"manual",maxWidth:this.maxWidth,onShow:this.onShow,onHide:this.onHide,onClickOutside:this.closeMenu.bind(this),hideOnClick:!1,appendTo:this.$root.$el,sticky:this.sticky,plugins:[A2]}),this.$on("hook:beforeDestroy",()=>{var s;(s=this.tippyInstance)==null||s.destroy()})}onShow(){if(this.logger.debug("Showing context menu",{logCategory:f.shell}),!this.menuItems.length)return!1;this.$dispatch(new eu),this.$dispatch(new us(Rt.PASSIVE)),this.$dispatch(new lr(pa.contextMenu)),this.$dispatch(new Mn),this.$nextTick(()=>{this.focusSystem.tryFocus(this.menuItemsGroupId),this.$dispatch(new tu),this.focusSystem.setFocusMode(Rt.ACTIVE)})}onHide(){this.logger.debug("Hiding context menu",{logCategory:f.shell}),this.$dispatch(new eu),this.$nextTick(()=>{this.$dispatch(new lr(null)),this.$dispatch(new tu)})}closeMenu(){this.isMenuVisible()&&this.$dispatch(new wG)}openMenu(){this.menuItems.length&&this.tippyInstance&&!this.isMenuVisible()&&this.$dispatch(new SG(this.microAppConfig))}isMenuVisible(){var e;return!!((e=this.tippyInstance)!=null&&e.state.isVisible)}get classList(){return[Xs[this.navigationMethod]]}};qe([W()],Ge.prototype,"menuItems",2);qe([W({default:"bottom-end",type:String})],Ge.prototype,"placement",2);qe([W({type:[Number,String],default:"none"})],Ge.prototype,"maxWidth",2);qe([W({type:Array,default:()=>[0,0]})],Ge.prototype,"offset",2);qe([W({type:[Boolean,String],default:!1})],Ge.prototype,"sticky",2);qe([W({type:Object,required:!0})],Ge.prototype,"microAppConfig",2);qe([Yt("$focusSystem")],Ge.prototype,"focusSystem",2);qe([C(S,"navigationMethod")],Ge.prototype,"navigationMethod",2);qe([W({type:String,default:()=>"items-"+qt.newId()})],Ge.prototype,"menuItemsGroupId",2);qe([W({type:String,default:()=>"menu-"+qt.newId()})],Ge.prototype,"menuGroupId",2);qe([Yt("$logger")],Ge.prototype,"logger",2);qe([Mt("menuItems")],Ge.prototype,"onMenuItemChange",1);qe([C(Ke,"visibleContextMenu")],Ge.prototype,"visibleContextMenu",2);qe([Mt("visibleContextMenu")],Ge.prototype,"onvisibleContextMenuChange",1);qe([Mt("offset")],Ge.prototype,"onOffsetChange",1);qe([_()],Ge.prototype,"onShow",1);qe([_()],Ge.prototype,"onHide",1);Ge=qe([j({components:{SeparatorContextMenuItemComponent:MQ,StandardContextMenuItemComponent:GQ,WalletContextMenuItemComponent:$Q,FocusGroupComponent:Hs}})],Ge);var QQ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("FocusGroupComponent",{staticClass:"context-menu-container",attrs:{focusId:i.menuGroupId,isFocusable:!1}},[t("div",{ref:"menuTrigger",staticClass:"context-menu-trigger",attrs:{"data-context-menu-trigger":"","data-e2e":"context-menu-trigger"}},[i._t("default",[i._v("_unnamed_")])],2),t("div",{ref:"contextMenuList",staticClass:"context-menu-list",class:i.classList},[t("FocusGroupComponent",{attrs:{focusId:i.menuItemsGroupId,isFocusTrap:!0}},i._l(i.menuItems,function(s){return t("div",{key:s.label,staticClass:"context-menu-list-item"},[t(s.componentType,{tag:"component",attrs:{isFocusable:i.isMenuVisible(),menuItem:s,"data-e2e":i.$e2eFormat(s.dataE2e),"data-e2e-component":"context-menu-item"},on:{close:i.closeMenu}})],1)}),0)],1)])},jQ=[];const Nf={};var qQ=Z(Ge,QQ,jQ,!1,zQ,"4f85ac1c",null,null);function zQ(i){for(let e in Nf)this[e]=Nf[e]}const KQ=function(){return qQ.exports}();var ia=(i=>(i.Standard="StandardContextMenuItemComponent",i.Separator="SeparatorContextMenuItemComponent",i.Wallet="WalletContextMenuItemComponent",i))(ia||{}),XQ=Object.defineProperty,JQ=Object.getOwnPropertyDescriptor,ei=(i,e,t,s)=>{for(var a=s>1?void 0:s?JQ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&XQ(e,t,a),a};let wt=class extends K{constructor(){super(...arguments),this.placement="right-start",this.sticky="reference"}get hasContextMenu(){return this.isMenuEnabled&&this.menuItems.length>0}get menuItems(){return this.isMenuEnabled?this.configuredMenuItems:[]}get configuredMenuItems(){const e=this.accessMenu.find(t=>t.spaceId===this.microAppConfig.spaceId);if(e!=null&&e.contextMenuItems){const s=e.contextMenuItems.some(n=>[Ns.MicroApp,ia.Wallet].includes(n.type))?this.findMicroAppConfigsByGameSpace(this.hostGame.spaceId,null).filter(n=>!this.nonAvailableMicroApps.some(r=>r.appName===n.appName)):[],a=[];return e.contextMenuItems.forEach(n=>{switch(n.type){case Ns.MicroApp:{const r=s.find(o=>o.spaceId===n.spaceId);r&&a.push({componentType:ia.Standard,label:this.$formatMessage({id:r.meta.label}),handler:()=>this.navigateToMicroApp(r),dataE2e:r.appName})}break;case Ns.Wallet:{const r=s.find(o=>o.appName===J.Store);r&&a.push({componentType:ia.Wallet,label:this.$formatMessage({id:"profile.menu.myWallet"}),handler:()=>this.navigateToMicroApp(r),dataE2e:"wallet"})}break;case Ns.Separator:a.push({componentType:ia.Separator,dataE2e:"separator"});break;case Ns.Logout:a.push({componentType:ia.Standard,label:this.$formatMessage({id:"profile.menu.logOut"}),handler:()=>{this.$dispatch(new tD)},dataE2e:"log-out"});break;case Ns.Quit:a.push({componentType:ia.Standard,label:this.$formatMessage({id:"profile.menu.quit"}),handler:()=>{this.$dispatch(new iD)},dataE2e:"quit"});break}}),a}return[]}async onClick(){this.logger.debug("Handle click on tile ".concat(this.microAppConfig.appName),{logCategory:f.navigation}),this.hasContextMenu?this.navigateOrTogglenMenu():await this.$dispatch(new rn(this.microAppConfig))}async navigateToMicroApp(e){var s;const t=this.accessMenu.find(a=>a.spaceId===this.microAppConfig.spaceId);await this.$dispatch(new rn(e,void 0,{section:Id.contextMenu,button:e.appName,contextParent:((s=t==null?void 0:t.name)==null?void 0:s.toUpperCase())||null}))}openMenu(){var e;(e=this.contextMenu)==null||e.openMenu()}closeMenu(){var e;(e=this.contextMenu)==null||e.closeMenu()}navigateOrTogglenMenu(){var e;this.hasContextMenu?(e=this.contextMenu)!=null&&e.isMenuVisible()?this.closeMenu():this.openMenu():this.$dispatch(new rn(this.microAppConfig))}};ei([Yt("$showModal")],wt.prototype,"_showModal",2);ei([W({type:Array,default:()=>[0,42]})],wt.prototype,"offset",2);ei([W({type:Object,required:!0})],wt.prototype,"microAppConfig",2);ei([W({type:Boolean,default:!1})],wt.prototype,"isMenuEnabled",2);ei([Yt("$logger")],wt.prototype,"logger",2);ei([Dl()],wt.prototype,"contextMenu",2);ei([C(M,"findMicroAppConfigsByGameSpace")],wt.prototype,"findMicroAppConfigsByGameSpace",2);ei([C(M,"nonAvailableMicroApps")],wt.prototype,"nonAvailableMicroApps",2);ei([C(S,"hostGame")],wt.prototype,"hostGame",2);ei([C(M,"accessMenu")],wt.prototype,"accessMenu",2);ei([_()],wt.prototype,"onClick",1);ei([_()],wt.prototype,"navigateToMicroApp",1);wt=ei([j({components:{ContextMenuComponent:KQ}})],wt);var YQ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"access-menu-tile-container",attrs:{"data-e2e":i.$e2eFormat(i.microAppConfig.appName)},on:{click:function(s){return i.onClick()}}},[i.hasContextMenu?t("ContextMenuComponent",{ref:"contextMenu",attrs:{menuItems:i.menuItems,placement:i.placement,offset:i.offset,sticky:i.sticky,microAppConfig:i.microAppConfig}},[i._t("default",[i._v("_unnamed_")])],2):i._t("default",[i._v("_unnamed_")])],2)},ZQ=[];const Tf={};var ej=Z(wt,YQ,ZQ,!1,tj,null,null,null);function tj(i){for(let e in Tf)this[e]=Tf[e]}const MG=function(){return ej.exports}();var ij=Object.defineProperty,sj=Object.getOwnPropertyDescriptor,ti=(i,e,t,s)=>{for(var a=s>1?void 0:s?sj(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&ij(e,t,a),a};let bt=class extends We(nt){constructor(){super(...arguments),this.iconName=Fs,this.iconType=Mo}async navigateFromNavigationTile(){await this.$dispatch(new rn(this.microAppConfig))}get shortcutDefinitions(){return{[oi.A]:{text:this.$formatMessage({id:"legend.label.select"}),handler:this.navigateOrToggleMenu}}}get levelLabel(){return this.$formatMessage({id:"access.level"},{value:this.level})}get playerName(){return this.playerSession?this.playerSession.nameOnPlatform:""}get shouldShowProfileDetails(){return this.microAppConfig&&this.isOnPcClient}get offset(){return this.isCompact?[0,16]:[0,24]}get isOnPcClient(){return this.layoutType===_t.pcClient}onAvatarClick(e){this.logger.debug("Handle click on avatar for ".concat(this.microAppConfig.appName),{logCategory:f.navigation}),this.isOnPcClient&&this.breakpoint>=yi.XLarge&&(this.navigateFromNavigationTile(),e.stopPropagation(),this.menuTile.closeMenu())}navigateOrToggleMenu(){this.logger.debug("Handle interaction on tile ".concat(this.microAppConfig.appName),{logCategory:f.navigation}),this.menuTile.navigateOrTogglenMenu()}};ti([W({type:Boolean,required:!1,default:!1})],bt.prototype,"isCompact",2);ti([C(S,"completelyOffline")],bt.prototype,"isOffline",2);ti([C(Q,"appId")],bt.prototype,"shellAppId",2);ti([C(S,"profileId")],bt.prototype,"profileId",2);ti([C(Wi,"level")],bt.prototype,"level",2);ti([C(Wi,"avatarUrl")],bt.prototype,"avatarUrl",2);ti([C(S,"playerSession")],bt.prototype,"playerSession",2);ti([C(S,"isMobileGameOverlay")],bt.prototype,"isMobileGameOverlay",2);ti([C(ao,"breakpoint")],bt.prototype,"breakpoint",2);ti([_()],bt.prototype,"navigateFromNavigationTile",1);ti([Dl()],bt.prototype,"menuTile",2);ti([_()],bt.prototype,"navigateOrToggleMenu",1);bt=ti([j({components:{AvatarComponent:MS,IconComponent:Bc,AccessMenuTileComponent:MG}})],bt);var aj=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("AccessMenuTileComponent",{ref:"menuTile",staticClass:"profile-tile",attrs:{"data-top-level-micro-app-tile":"profile-tile",id:"app-list-gamer-profile","data-e2e":"profile-tile",isMenuEnabled:i.isOnPcClient,microAppConfig:i.microAppConfig,offset:i.offset}},[t("div",{staticClass:"profile-tile-container"},[t("AvatarComponent",{staticClass:"profile-avatar",attrs:{"data-e2e":"avatar",alt:i.microAppConfig.meta.label,src:i.avatarUrl,color:"#005DB2"},on:{click:i.onAvatarClick}}),i.shouldShowProfileDetails?t("div",{staticClass:"profile-info"},[t("div",{staticClass:"profile-details"},[t("div",{staticClass:"player-name",attrs:{"data-e2e":"player-name"}},[i._v(" "+i._s(i.playerName)+" ")]),t("div",{staticClass:"profile-label",attrs:{"data-e2e":"player-level"}},[i._v(i._s(i.levelLabel))])]),t("IconComponent",{staticClass:"context-menu-icon",attrs:{name:i.iconName.AngleRight,type:i.iconType.Outline}})],1):i._e()],1)])},nj=[];const Rf={};var rj=Z(bt,aj,nj,!1,oj,"6f2ee0fe",null,null);function oj(i){for(let e in Rf)this[e]=Rf[e]}const cj=function(){return rj.exports}();var lj=Object.defineProperty,pj=Object.getOwnPropertyDescriptor,no=(i,e,t,s)=>{for(var a=s>1?void 0:s?pj(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&lj(e,t,a),a};let _a=class extends We(nt){get shortcutDefinitions(){return{[oi.A]:{text:this.$formatMessage({id:"legend.label.select"}),handler:this.navigateOrToggleMenu}}}get isOnPcClient(){return this.layoutType===_t.pcClient}navigateOrToggleMenu(){this.logger.debug("Handle interaction on tile ".concat(this.microAppConfig.appName),{logCategory:f.navigation}),this.menuTile.navigateOrTogglenMenu()}};no([C(S,"completelyOffline")],_a.prototype,"isOffline",2);no([C(S,"isMobileGameOverlay")],_a.prototype,"isMobileGameOverlay",2);no([Dl()],_a.prototype,"menuTile",2);no([_()],_a.prototype,"navigateOrToggleMenu",1);_a=no([j({components:{AccessMenuTileComponent:MG}})],_a);var uj=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("AccessMenuTileComponent",{ref:"menuTile",staticClass:"top-level-micro-app-tile",attrs:{"data-top-level-micro-app-tile":i.microAppConfig.appName,id:i.tileId,isMenuEnabled:i.isOnPcClient,microAppConfig:i.microAppConfig}},[t("div",{staticClass:"inner-content",class:{active:i.isActive}},[t("div",{staticClass:"tile-content"},[t("img",{staticClass:"app-icon",class:{mobile:i.isMobileGameOverlay},attrs:{crossorigin:"anonymous",src:i.microAppConfig.meta.iconUrl,alt:i.microAppConfig.meta.label}})]),i.shouldShowTileLabel?t("div",{staticClass:"top-level-micro-app-tile-label"},[i._v(" "+i._s(i.microAppConfig.meta.label)+" ")]):i._e()])])},dj=[];const Df={};var hj=Z(_a,uj,dj,!1,gj,"79f4102a",null,null);function gj(i){for(let e in Df)this[e]=Df[e]}const mj=function(){return hj.exports}();class hm extends oe("[Shell] Navigation bar"){constructor(){super(...arguments),this._currentlyFocusedTileId=null}get currentlyFocusedTileId(){return this._currentlyFocusedTileId}set currentlyFocusedTileId(e){this._currentlyFocusedTileId=e}}var Nu=(i=>(i.Active="active",i.Inactive="inactive",i))(Nu||{}),fj=Object.defineProperty,yj=Object.getOwnPropertyDescriptor,ze=(i,e,t,s)=>{for(var a=s>1?void 0:s?yj(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&fj(e,t,a),a};const vj={[J.AppGamerProfile]:"ProfileTileComponent",[J.AppGamePage]:"GamePageTileComponent",[J.ProductDetails]:"GamePageTileComponent"};let Of,Ie=class extends We($c){async onFocusChange(e){this.logger.debug("Applist got focused: ".concat(e),{logCategory:f.focus}),e?await this.onFocus():this.onBlur()}async onFocus(){if(this.$dispatch(new hG(this.focusId)),this.$dispatch(new ss(!1)),this.currentlyFocusedTileId)return this.$dispatch(new ha(this.currentlyFocusedTileId));let e=this.visibleTopLevelApps[0];if(this.activeTopLevelAppSpaceId){const t=this.visibleTopLevelApps.find(s=>s.spaceId===this.activeTopLevelAppSpaceId);t&&(e=t)}if(e){const t=this.getTileFocusableId(e);return this.$dispatch(new dm(t)),this.$dispatch(new ha(t))}}get visibleTopLevelApps(){let e=this.findMicroAppConfigsByGameSpace(this.hostGame.spaceId,null).filter(t=>!t.isHidden).filter(t=>!this.nonAvailableMicroApps.find(s=>s.appName===t.appName));return e=this.removeAppFromListForFullNavigationLayout(e,J.DownloadManager),e}async onBlur(){await this.$dispatch(new _G)}mounted(){this.$el.addEventListener("scroll",this.onApplicationListScroll)}beforeDestroy(){this.$el.removeEventListener("scroll",this.onApplicationListScroll)}get activeMicroAppSpaceId(){var e;return(e=this.getActiveMicroApp(this.defaultPlacement))==null?void 0:e.spaceId}get shouldShowFullNavigationLayout(){return this.layoutType===_t.pcClient}onApplicationListScroll(){this.applicationListIsBusy(),clearTimeout(Of),Of=setTimeout(this.applicationListIsReady,Ie.applicationListTimer)}applicationListIsBusy(){this.$dispatch(new yG)}applicationListIsReady(){this.$dispatch(new vG)}get gamerProfileApp(){return this.visibleTopLevelApps.find(e=>e.appName===J.AppGamerProfile)}get gamePageApp(){return this.visibleTopLevelApps.find(e=>e.appName===J.AppGamePage)}get filteredTopLevelApps(){let e=this.removeAppFromList(this.visibleTopLevelApps,J.AppGamerProfile);return e=this.removeAppFromListForFullNavigationLayout(e,J.DownloadManager),e}removeAppFromList(e,t){return e.filter(s=>s.appName!==t)}removeAppFromListForFullNavigationLayout(e,t){return this.shouldShowFullNavigationLayout?this.removeAppFromList(e,t):e}get activeTopLevelAppSpaceId(){return this.activeMicroAppSpaceId&&!this.isTopLevelApp(this.activeMicroAppSpaceId,this.hostGame.spaceId)&&this.gamePageApp?this.gamePageApp.spaceId:this.lastActiveTopLevelAppSpaceId}get isActiveAppTopLevel(){return!!this.activeMicroAppSpaceId&&this.isTopLevelApp(this.activeMicroAppSpaceId,this.hostGame.spaceId)}isActive(e){return e?e.spaceId===this.activeTopLevelAppSpaceId||this.visibleContextMenu===e:!1}getMicroAppStatus(e){return this.isActive(e)?Nu.Active:Nu.Inactive}getTileComponentName(e){const t=e.appName;return vj[t]||"TopLevelMicroAppTileComponent"}getTileFocusableId(e){return"app-list-tile-"+e.appName}getProfileTileFocusableId(){return this.gamerProfileApp?this.getTileFocusableId(this.gamerProfileApp):null}};Ie.appListFocusId="app-list";Ie.applicationListTimer=200;ze([W({type:String,required:!1,default:()=>Ie.appListFocusId})],Ie.prototype,"focusId",2);ze([W({type:Boolean,required:!1,default:!0})],Ie.prototype,"isFocusGroup",2);ze([W({type:String,required:!1,default:()=>AS.VERTICAL_LIST})],Ie.prototype,"layout",2);ze([W({type:Boolean,required:!1,default:!1})],Ie.prototype,"isCompact",2);ze([C(hm,"currentlyFocusedTileId")],Ie.prototype,"currentlyFocusedTileId",2);ze([C(M,"getActiveMicroApp")],Ie.prototype,"getActiveMicroApp",2);ze([C(S,"isMobileGameOverlay")],Ie.prototype,"isMobileGameOverlay",2);ze([C(M,"lastActiveTopLevelAppSpaceId")],Ie.prototype,"lastActiveTopLevelAppSpaceId",2);ze([C(M,"isTopLevelAppBySpaceId")],Ie.prototype,"isTopLevelApp",2);ze([C(M,"findMicroAppConfigsByGameSpace")],Ie.prototype,"findMicroAppConfigsByGameSpace",2);ze([C(M,"defaultPlacement")],Ie.prototype,"defaultPlacement",2);ze([C(S,"layoutType")],Ie.prototype,"layoutType",2);ze([C(S,"hostGame")],Ie.prototype,"hostGame",2);ze([C(M,"nonAvailableMicroApps")],Ie.prototype,"nonAvailableMicroApps",2);ze([C(Ke,"visibleContextMenu")],Ie.prototype,"visibleContextMenu",2);ze([Yt("$logger")],Ie.prototype,"logger",2);ze([Mt("isFocused")],Ie.prototype,"onFocusChange",1);Ie=ze([j({components:{ProfileTileComponent:cj,TopLevelMicroAppTileComponent:mj,GamePageTileComponent:mQ,"upn-focus-group":Hs}})],Ie);var _j=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"app-list",class:{full:i.shouldShowFullNavigationLayout,isCompact:i.isCompact},attrs:{id:"app-list","data-e2e":"app-list"}},[i.gamerProfileApp?t("upn-focus-group",{staticClass:"list-tile-container",class:{profile:i.gamerProfileApp,"disabled-profile":!i.gamerProfileApp,active:i.isActive(i.gamerProfileApp)},attrs:{focusId:"app-list-profile-tile-group"}},[t("ProfileTileComponent",{staticClass:"list-tile",class:{isCompact:i.isCompact},attrs:{"data-e2e-component":"transversal-app","data-e2e-state":i.getMicroAppStatus(i.gamerProfileApp),isCompact:i.isCompact,disabled:!i.gamerProfileApp,microAppConfig:i.gamerProfileApp,focusId:i.getProfileTileFocusableId(),isActive:i.isActive(i.gamerProfileApp)}})],1):i._e(),i._l(i.filteredTopLevelApps,function(s){return t("div",{key:s.appName,staticClass:"list-tile-container",class:{active:i.isActive(s),"active-is-not-top-level":!i.isActiveAppTopLevel}},[t(i.getTileComponentName(s),{tag:"component",staticClass:"list-tile",class:{isCompact:i.isCompact},attrs:{"data-e2e-component":"transversal-app","data-e2e-state":i.getMicroAppStatus(s),microAppConfig:s,focusId:i.getTileFocusableId(s),isActive:i.isActive(s)}})],1)})],2)},Sj=[];const Ff={};var wj=Z(Ie,_j,Sj,!1,bj,"5116d36a",null,null);function bj(i){for(let e in Ff)this[e]=Ff[e]}const on=function(){return wj.exports}();var Cj=Object.defineProperty,Ij=Object.getOwnPropertyDescriptor,AG=(i,e,t,s)=>{for(var a=s>1?void 0:s?Ij(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Cj(e,t,a),a};class gm{constructor(e,t){this._rootElement=e,this._store=t,this._rootElement.addEventListener(Qm,this.notifyInternalFocusChange),this._rootElement.addEventListener(jm,this.shortcutsUpdated)}dispose(){this._rootElement.removeEventListener(Qm,this.notifyInternalFocusChange),this._rootElement.removeEventListener(jm,this.shortcutsUpdated)}notifyInternalFocusChange(){this._store.dispatchIntent(new kr)}shortcutsUpdated(e){const t=e;this._store.dispatchIntent(new lm(t.detail))}}AG([_()],gm.prototype,"notifyInternalFocusChange",1);AG([_()],gm.prototype,"shortcutsUpdated",1);var Mj=Object.defineProperty,Aj=Object.getOwnPropertyDescriptor,PG=(i,e,t,s)=>{for(var a=s>1?void 0:s?Aj(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Mj(e,t,a),a};class mm{constructor(e,t,s,a,n){this._rootElement=e,this._rootGroupElement=t,this._store=s,this._initialNavigationMethod=a,this._hostPlatformType=n,this._rootGroupId=t.id,this.focusSystem=new t2(this._rootElement,{enableTabNavigationSupport:this.isTabNavigationSupported(),getScaleFactor:()=>$o.currentScalingFactor,enableArrowKeyNavigation:this._hostPlatformType!==p.WebEmbedded,enableShortcuts:this._hostPlatformType!==p.WebEmbedded}),this.focusSystem.updateNavigationMethod(this._initialNavigationMethod),this.focusSystem.createNode(this.rootGroupId),this.focusSystem.setElement(this.rootGroupId,this._rootGroupElement),this.focusSystem.setLayout(this.rootGroupId),this._legacyFocusSystemListener=new gm(this._rootElement,this._store)}isTabNavigationSupported(){return this._hostPlatformType!==p.Switch}get rootGroupId(){return this._rootGroupId}initializeListeners(){var e,t;(e=this.focusSystem)==null||e.observeActiveShortcuts(this.observeShortcuts),(t=this.focusSystem)==null||t.onFocusChanged(this.notifyInternalFocusChanged)}notifyInternalFocusChanged(){const e=this._store.getReadonlyState(S);e.focusedMicroApp&&this._store.dispatchIntent(new kr(e.focusedMicroApp))}observeShortcuts(e){if(this.isFocused(on.appListFocusId))return;if(this._store.getReadonlyState(te).isDebugPanelFocused){const a=Object.entries(e).map(([n])=>n);this._store.dispatchIntent(new dD(a))}const s=Object.entries(e).filter(([,a])=>a.text).map(([a,n])=>({button:a,text:n.text}));this._store.dispatchIntent(new lm(s))}isFocused(e){var t,s;return((t=this.focusSystem)==null?void 0:t.containsFocus(e))&&!((s=this.focusSystem)!=null&&s.hasInnerFocus(e))}}PG([_()],mm.prototype,"notifyInternalFocusChanged",1);PG([_()],mm.prototype,"observeShortcuts",1);const Pj=1,Tu=Pt(L.A,["Enter",13,"Space",32]),Nj=Pt(L.A,["Enter",13]),Ru=Pt(L.B,["Backspace",8]),Du=Pt(L.Y,["Escape",27]),Tj=Pt(L.X,["KeyX",88]),Rj=Pt(L.DpadLeft,["ArrowLeft",37]),Ou=Pt(L.DpadUp,["ArrowUp",38]),Dj=Pt(L.DpadRight,["ArrowRight",39]),Fu=Pt(L.DpadDown,["ArrowDown",40]),Oj=Pt(L.LeftShoulder,["KeyQ",81]),Fj=Pt(L.RightShoulder,["KeyE",69]),Lj=Pt(L.LeftTrigger,["KeyF",70]),Gj=Pt(L.RightTrigger,["KeyG",71]),xj=Pt(L.LeftStickPress,["KeyT",84]),Ej=Pt(L.RightStickPress,["KeyR",82]);function Pt(i,e){return{button:i,buttonValue:Pj,keyboardKeys:new Set(e)}}const Lf=[Tu,Ru,Du,Tj,Rj,Ou,Dj,Fu,Oj,Fj,Lj,Gj,xj,Ej],Uj={[pa.textInput]:[Du,Nj],[pa.dropdownSelect]:[Tu,Ru,Du,Ou,Fu],[pa.contextMenu]:[Tu,Ru,Ou,Fu]};class kj{constructor(){this._keyListeners=[]}addKeyPressListener(e){this._keyListeners.push(["keypress",e]),window.addEventListener("keypress",e)}addKeyDownListener(e){this._keyListeners.push(["keydown",e]),window.addEventListener("keydown",e)}dispose(){this._keyListeners.forEach(([e,t])=>window.removeEventListener(e,t))}}class Wj{constructor(){this._mouseDownListeners=[],this._mouseUpListeners=[],this._mouseMoveListeners=[],this._mouseWheelListeners=[],this._mouseOverElementListeners=[],this._mouseOutElementListeners=[]}addMouseDownListener(e){this._mouseDownListeners.push(e),window.addEventListener("mousedown",e)}addMouseMoveListener(e){this._mouseMoveListeners.push(e),window.addEventListener("mousemove",e)}addMouseUpListener(e){this._mouseUpListeners.push(e),window.addEventListener("mouseup",e)}addMouseWheelListener(e){this._mouseWheelListeners.push(e),window.addEventListener("wheel",e)}addMouseOverElementListener({element:e,callback:t}){this._mouseOverElementListeners.push({element:e,callback:t}),e.addEventListener("mouseover",t,!0)}removeMouseOverElementListener(e){const t=this._mouseOverElementListeners.findIndex(s=>s.element===e.element);t!==-1&&(e.element.removeEventListener("mouseover",e.callback,!0),this._mouseOverElementListeners.splice(t,1))}addMouseOutElementListener({element:e,callback:t}){this._mouseOutElementListeners.push({element:e,callback:t}),e.addEventListener("mouseout",t,!0)}removeMouseOutElementListener(e){const t=this._mouseOutElementListeners.findIndex(s=>s.element===e.element);t!==-1&&(e.element.removeEventListener("mouseout",e.callback,!0),this._mouseOutElementListeners.splice(t,1))}dispose(){this._mouseDownListeners.forEach(e=>window.removeEventListener("mousedown",e)),this._mouseUpListeners.forEach(e=>window.removeEventListener("mouseup",e)),this._mouseMoveListeners.forEach(e=>window.removeEventListener("mousemove",e)),this._mouseWheelListeners.forEach(e=>window.removeEventListener("wheel",e)),this._mouseOverElementListeners.forEach(({element:e,callback:t})=>{e.removeEventListener("mouseover",t)}),this._mouseOutElementListeners.forEach(({element:e,callback:t})=>{e.removeEventListener("mouseout",t)})}}var Vj=Object.defineProperty,$j=Object.getOwnPropertyDescriptor,ii=(i,e,t,s)=>{for(var a=s>1?void 0:s?$j(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Vj(e,t,a),a},ma;const kt=(ma=class{constructor(e,t,s,a=ln.Cross,n=new Wj,r=new kj,o=new i2){switch(this._logger=t,this._intentDispatcher=s,this._mouseListener=n,this._keyboardListener=r,this._mouseX=0,this._mouseY=0,this._shouldListenMouseWheelEvent=!1,this._shouldSwapButtons=!1,this._windowFocused=document.hasFocus(),[p.PS4Aegir,p.PS4AegirNative].includes(e)&&a===ln.Circle&&(this._shouldSwapButtons=!0),e){case p.PS4:case p.PS5:this._logger.debug("Added playstation controller support",{logCategory:f.input}),o.addPlaystationSupport();break;case p.PS4Aegir:case p.PS4AegirNative:case p.PS5Aegir:case p.PS5AegirNative:case p.XONE:case p.XoneUWP:case p.XoneUWPWebView2:case p.XOneAegir:case p.XOneAegirNative:case p.Scarlett:case p.ScarlettUWP:case p.ScarlettUWPWebView2:case p.ScarlettAegir:case p.ScarlettAegirNative:case p.Switch:this._logger.debug("Added gamepad support",{logCategory:f.input}),o.addGamepadApiSupport();break;case p.WebEmbedded:this._logger.debug("Not enabling gamepad for embedded web platform",{logCategory:f.input});return;default:this._logger.debug("Added gamepad and keyboard support",{logCategory:f.input}),o.addGamepadApiSupport(),this._keyboardRemapper=o.addKeyboardSupport(Lf),this._shouldListenMouseWheelEvent=!0;break}this._gamepadManager=o.assemble(this.onGamepadConnected,this.onGamepadDisconnected,this.onGamepadButtonEvents,this.onErrorCallback)}start(){var e;window.addEventListener("focus",this.onFocus),window.addEventListener("blur",this.onBlur),this._mouseListener.addMouseDownListener(this.onMouseDownEvent),this._mouseListener.addMouseMoveListener(this.onMouseMoveEvent),this._mouseListener.addMouseUpListener(this.onMouseUpEvent),window.addEventListener("popstate",this.onHistoryPop),this._shouldListenMouseWheelEvent&&this._mouseListener.addMouseWheelListener(this.onMouseWheelEvent),this._keyboardListener.addKeyPressListener(this.onKeyPress),this._keyboardListener.addKeyDownListener(this.onKeyDown),this._logger.debug("Register window focus, blur, mouse and keyboard listeners",{listenMouseWheelEvent:this._shouldListenMouseWheelEvent,logCategory:f.input}),(e=this._gamepadManager)==null||e.start()}onFocus(){this._windowFocused=!0}onBlur(){this._windowFocused=!1}onMouseDownEvent(){this._intentDispatcher.dispatchIntent(new ja(H.mouse))}onMouseUpEvent(e){e.button===3&&(e.preventDefault(),this._intentDispatcher.dispatchIntent(new nu)),e.button===4&&e.preventDefault()}onHistoryPop(e){var t;(t=e.state)!=null&&t.path&&(window.history.pushState({path:e.state.path},"",e.state.path),this._intentDispatcher.dispatchIntent(new nu))}onMouseMoveEvent(e){const t=Math.abs(e.x-this._mouseX),s=Math.abs(e.y-this._mouseY);(t>ma.threshold||s>ma.threshold)&&this._intentDispatcher.dispatchIntent(new ja(H.mouse)),this._mouseX=e.x,this._mouseY=e.y}onMouseWheelEvent(){this._intentDispatcher.dispatchIntent(new ja(H.mouse))}async onKeyPress(e){this._intentDispatcher.dispatchIntent(new er(Up.Keyboard)),this._intentDispatcher.dispatchIntent(new ja(H.keyboard))}async onKeyDown(e){if(!this._windowFocused||e.key!=="Tab")return;e.repeat||await this.onKeyPress(e);const t=e.shiftKey?qm.BACKWARD:qm.FORWARD;if(!await this._intentDispatcher.dispatchIntent(new lG(t))){e.preventDefault();return}if(await this._intentDispatcher.dispatchIntent(new uG(t))){e.preventDefault();return}}onGamepadConnected(e){this._intentDispatcher.dispatchIntent(new fD(e))}onGamepadDisconnected(e){this._intentDispatcher.dispatchIntent(new yD(e))}onGamepadButtonEvents(e,t){if(this._logger.debug("Input event from ".concat(e," : ").concat(t.map(s=>s.button+" "+s.type)),{logCategory:f.input}),t.length>0&&this._windowFocused){if(this._shouldSwapButtons){const s=t.map(a=>a.button===L.A?{button:L.B,type:a.type,value:a.value}:a.button===L.B?{button:L.A,type:a.type,value:a.value}:a);this._intentDispatcher.dispatchIntent(new Zp(e,s));return}this._intentDispatcher.dispatchIntent(new Zp(e,t))}else this._logger.debug("Input event ignored. Window is not focused.",{logCategory:f.input})}onErrorCallback(e,t){this._logger.warn("Error in gamepad manager: ".concat(t),{error:e,logCategory:f.input,errorCode:g.GamepadManagerErrorWarning})}addMouseOverElementListener(e){this._mouseListener.addMouseOverElementListener(e)}removeMouseOverElementListener(e){this._mouseListener.removeMouseOverElementListener(e)}addMouseOutElementListener(e){this._mouseListener.addMouseOutElementListener(e)}removeMouseOutElementListener(e){this._mouseListener.removeMouseOutElementListener(e)}notifyFocusChange(){var e;(e=this._gamepadManager)==null||e.focusChanged()}notifySelectionChange(e){var t,s;if(e===null)(t=this._keyboardRemapper)==null||t.updateMapping(Lf);else{const a=Uj[e];(s=this._keyboardRemapper)==null||s.updateMapping(a)}}dispose(){var e;(e=this._gamepadManager)==null||e.dispose(),this._mouseListener.dispose(),this._keyboardListener.dispose()}},ma.threshold=3,ma);ii([_()],kt.prototype,"onFocus",1);ii([_()],kt.prototype,"onBlur",1);ii([_()],kt.prototype,"onMouseDownEvent",1);ii([_()],kt.prototype,"onMouseUpEvent",1);ii([_()],kt.prototype,"onHistoryPop",1);ii([_()],kt.prototype,"onMouseMoveEvent",1);ii([_()],kt.prototype,"onMouseWheelEvent",1);ii([_()],kt.prototype,"onKeyPress",1);ii([_()],kt.prototype,"onKeyDown",1);ii([_()],kt.prototype,"onGamepadConnected",1);ii([_()],kt.prototype,"onGamepadDisconnected",1);ii([_()],kt.prototype,"onGamepadButtonEvents",1);ii([_()],kt.prototype,"onErrorCallback",1);let Bj=kt;class Hj{translate(e){return this._formatMessage?this._formatMessage({id:e}):e}get formatMessage(){return this._formatMessage}set formatMessage(e){this._formatMessage=e}}class fm{constructor(e){this._logger=e,this._logger=e.createChild("ExeptionHandler"),this._logger.settings.logCategory=f.unexpected,this.registerListeners()}static create(e){return new fm(e)}registerListeners(){window.addEventListener("error",e=>this.handleEvent(e)),window.addEventListener("unhandledrejection",e=>this.handleEvent(e)),K.config.errorHandler=(e,t,s)=>{this._logger.error("Vue error handler",{moreInfo:{info:s},error:e})}}handleEvent(e){const t=e instanceof ErrorEvent?e.error:e.reason;if(this.handleKnownEvents(t)){e.preventDefault(),e.stopPropagation();return}if(e instanceof ErrorEvent){this._logger.error("window onerror: ".concat(e.message),{event:e,error:t});return}if(t){let s="window unhandledrejection";typeof t=="string"?s+=": ".concat(t):t instanceof Error&&(s+=": ".concat(t.message)),this._logger.error(s,{error:t})}}handleKnownEvents(e){return e instanceof na?(this._logger.error("".concat(e.message," for ").concat(e.appName),{logCategory:f.apiValidation,error:e,appName:e.appName,errorCode:"apiValidationError.".concat(e.appName)}),!0):e instanceof De}}const Qj={[yi.XSmall]:4,[yi.Small]:6,[yi.Medium]:8,[yi.Large]:12,[yi.XLarge]:12,[yi.XXLarge]:12};function jj(i){return Qj[i]||12}function qj(i,e){return e.reduce((s,a)=>a>i?s:a>s?a:s)}function bo(i){return Object.values(i).filter(e=>!isNaN(Number(e))).sort((e,t)=>e>t?1:-1)}function zj(i){return"breakpoints"in i}function Kj(i){return"frequency"in i}class Xj extends Map{}class Jj{constructor(){this._elementObserverCallbackStateMap=new Map,this._resizeObserver=new ResizeObserver(e=>{for(const t of e)this.onEntryResize(t)})}observeElement(e,t,s){this._resizeObserver.observe(e);const a=this.getObserverState(e,t);zj(s)&&(a.breakpoint=s,this.invokeBreakpointResizeCallback(e,e.getBoundingClientRect(),s)),Kj(s)&&(a.frequency=s,this.invokeFrequencyResizeCallback(e,s))}getObserverState(e,t){this._elementObserverCallbackStateMap.has(e)||this._elementObserverCallbackStateMap.set(e,new Xj);const s=this._elementObserverCallbackStateMap.get(e);return s.has(t)||s.set(t,{}),s.get(t)}unobserveElement(e,t){if(this._elementObserverCallbackStateMap.has(e)){const s=this._elementObserverCallbackStateMap.get(e);s==null||s.delete(t),(s==null?void 0:s.size)===0&&(this._resizeObserver.unobserve(e),this._elementObserverCallbackStateMap.delete(e))}}disconnect(){this._resizeObserver.disconnect(),this._elementObserverCallbackStateMap.forEach(e=>{e.clear()}),this._elementObserverCallbackStateMap.clear()}invokeFrequencyResizeCallback(e,t){if(t){const s=Date.now();if(t.lastExecutionTimeInMs&&s<t.lastExecutionTimeInMs+t.frequency){t.timer||(t.timer=setTimeout(()=>{t.callback(e)},t.frequency));return}t.timer=void 0,t.lastExecutionTimeInMs=s,t.callback(e)}}invokeBreakpointResizeCallback(e,t,s){const a=s.callback,n=qj(t.width,s.breakpoints),r=jj(n);s.currentBreakpoint!==n&&(s.currentBreakpoint=n,a({breakpoint:n,target:e,columnsCount:r}))}onEntryResize(e){const t=this._elementObserverCallbackStateMap.get(e.target);t==null||t.forEach(s=>{s.breakpoint&&this.invokeBreakpointResizeCallback(e.target,e.contentRect,s.breakpoint),s.frequency&&this.invokeFrequencyResizeCallback(e.target,s.frequency)})}}class Gf{constructor(e,t,s,a){this._runtimeParameters=e,this._sessionProviderService=t,this._credentialsProvider=s,this._options={...v7,...a}}get name(){return"DefaultAuthentication"}async processAuthentication(){const e=y7(this._runtimeParameters),t=await this._credentialsProvider.getCredentials();if(!this._options.shouldLoginWithCredentials(t,this._runtimeParameters))return new Ai(this._options.defaultAuthenticationData,e);const s=await this._sessionProviderService.loginWithThirdPartyCredentials(t.ticket,t.token);return s.session.sessionId&&!s.errorData&&!e?new at(s.session):(this._options.skipErrorData===!0&&(s.errorData=void 0),new Ai(s,e))}shouldCloseOverlay(){return this._options.shouldCloseOverlay(this._runtimeParameters)}}class Yj{constructor(e,t,s){this._runtimeParameters=e,this._sessionProviderService=t,this._credentialsProvider=s}get name(){return"LegacyPcClientAuthentication"}async processAuthentication(){var t;const e=await this._credentialsProvider.getCredentials();if(!e.ticket){const s=await this._credentialsProvider.getHostTicket();if(s)e.ticket=s;else return new Qt({errorCode:g.Dolphin_25,message:ge.MissingTicket})}try{const s=await le(()=>this._sessionProviderService.loginWithTicket(e.ticket));return this._sessionProviderService.saveOfflineSession(s),new at(s)}catch(s){const a=await Yo(s,this._runtimeParameters,!1);return new Qt({message:"error.generic",errorCode:(t=a.error.code)!=null?t:""})}}shouldCloseOverlay(){return!1}}class Zj{constructor(e,t,s){this._logger=e,this._runtimeParameters=t,this._sessionProviderService=s}get name(){return"OfflineLegacyPcClientAuthentication"}async processAuthentication(){const e=await this._sessionProviderService.getOfflineSession();if(this._runtimeParameters.profileId&&(e==null?void 0:e.profileId)===this._runtimeParameters.profileId)return new qc(e);const t={code:g.Jellyfish_033,message:ge.OfflineProfileMissMatch};return this._logger.error(ge.OfflineProfileMissMatch,{parameters:this._runtimeParameters,logCategory:f.authentication,errorCode:t.code,message:t.message}),new Qt({message:"error.loginOffline",errorCode:t.code})}shouldCloseOverlay(){return!1}}class eq{constructor(e,t,s,a,n,r,o){this._logger=e,this._runtimeParameters=t,this._sessionProviderService=s,this._credentialsProvider=a,this._store=n,this._featureFlagsService=r,this._featureFlags=o,this._hostplatformToInterfaceMap={[p.CompanionAppAndroid]:this.createCompanionAppMobile.bind(this),[p.CompanionAppIOS]:this.createCompanionAppMobile.bind(this),[p.CompanionAppMobile]:this.createCompanionAppMobile.bind(this),[p.Android]:this.createOverlay.bind(this),[p.IOS]:this.createOverlay.bind(this),[p.Luna]:this.createPc.bind(this),[p.Mobile]:this.createOverlay.bind(this),[p.PCElectronClient]:()=>{},[p.PCElectronOverlay]:this.createPc.bind(this),[p.PCLegacyClient]:this.createPc.bind(this),[p.PCLegacyOverlay]:this.createPc.bind(this),[p.PCWebClient]:()=>{},[p.PCWebOverlay]:()=>{},[p.PS4]:this.createDefault.bind(this),[p.PS4Aegir]:this.createDefault.bind(this),[p.PS4AegirNative]:this.createDefault.bind(this),[p.PS5]:this.createDefault.bind(this),[p.PS5Aegir]:this.createDefault.bind(this),[p.PS5AegirNative]:this.createDefault.bind(this),[p.Scarlett]:this.createDefault.bind(this),[p.ScarlettAegir]:this.createDefault.bind(this),[p.ScarlettAegirNative]:this.createDefault.bind(this),[p.ScarlettUWP]:this.createDefault.bind(this),[p.ScarlettUWPWebView2]:this.createDefault.bind(this),[p.SteamClient]:this.createPc.bind(this),[p.SteamOverlay]:this.createPc.bind(this),[p.Web]:()=>{},[p.WebEmbedded]:()=>{},[p.XONE]:this.createDefault.bind(this),[p.XOneAegir]:this.createDefault.bind(this),[p.XOneAegirNative]:this.createDefault.bind(this),[p.XoneUWP]:this.createDefault.bind(this),[p.XoneUWPWebView2]:this.createDefault.bind(this),[p.MacOSAegir]:this.createDefault.bind(this),[p.MacOSAegirNative]:this.createDefault.bind(this),[p.MacOS]:this.createOverlay.bind(this),[p.Switch]:this.createDefault.bind(this)}}create(){const e=this._runtimeParameters.hostPlatformType;return this._hostplatformToInterfaceMap[e]()}createDefault(e){return new Gf(this._runtimeParameters,this._sessionProviderService,this._credentialsProvider,e)}createCompanionAppMobile(){return new Gf(this._runtimeParameters,this._sessionProviderService,this._credentialsProvider,{shouldCloseOverlay:d7})}createPc(){var e;return(e=window.upn)!=null&&e.enableAuthAppPc?this._featureFlagsService.isFeatureEnabled(this._featureFlags,fa.PCClientWebAuthentication)?this.createDefault({shouldLoginWithCredentials:f7(this._store),skipErrorData:!0}):void 0:this._runtimeParameters.isOffline?new Zj(this._logger,this._runtimeParameters,this._sessionProviderService):new Yj(this._runtimeParameters,this._sessionProviderService,this._credentialsProvider)}createOverlay(){const e=this.getAuthenticationOptions();return e?this.createDefault(e):void 0}getAuthenticationOptions(){const e=_g(this._runtimeParameters),t={...dr,ubiMobileV2Ticket:this._runtimeParameters.ticket,authenticationFlow:e};switch(e){case ve.LateSignOn:case ve.LoginOnly:case ve.Full:return{defaultAuthenticationData:t,shouldCloseOverlay:h7(e),shouldLoginWithCredentials:m7};default:return}}}class Mp extends Error{constructor(e){super(e.message),this.info=e}}class tq{constructor(e,t,s,a){this._logger=e,this._runtimeParameters=t,this._profilesService=s,this._tokenService=a}async getRoamingProfile(e,t){try{return await this._profilesService.v3.getRoamingProfile(e,t,this._runtimeParameters.hostSpaceId)}catch(s){this._logger.warn("Failed to get roaming profile with profile service",{error:s,logCategory:f.authentication});const a=await this.getErrorInfo("Profile service error",s,"GET","/v3/users/me/roamingProfiles");throw new Mp(a)}}async getTicketProfileId(e){try{return(await this._profilesService.v3.getProfile("",e)).profileId}catch(t){this._logger.warn("Failed to get profile id from ticket with profile service",{error:t,logCategory:f.authentication});const s=await this.getErrorInfo("Profile service error",t,"GET","/v3/profiles/me");throw new Mp(s)}}async generateToken(e,t,s,a){try{const n=JSON.stringify(s);return(await this._tokenService.v1.generateToken(e,n,t,a)).token}catch(n){this._logger.warn("Failed to generate token with token service",{error:n,logCategory:f.authentication,errorCode:g.FailedTokenGenerationWarning});const r=await this.getErrorInfo("Token service error",n,"POST","/v1/profiles/".concat(e,"/tokens"));throw new Mp(r)}}async getErrorInfo(e,t,s,a){const n={httpMethod:s,endpoint:a};let r="";if("response"in t&&(n.httpStatusCode=t.response.status,r=t.response.status.toString(),t.response.body))try{n.serviceErrorCode=(await t.response.json()).errorCode}catch(o){this._logger.warn("Failed to parse error response body",{error:o,logCategory:f.authentication})}return{code:r,message:e,context:n}}}class iq{constructor(e,t,s,a){this._logger=e,this._runtimeParameters=t,this._platformInterface=s,this._hostCommunicationService=a}async getCredentials(){let e=this._runtimeParameters.token;if([p.XoneUWP,p.ScarlettUWP].includes(this._runtimeParameters.hostPlatformType))try{e=await this._platformInterface.getFirstPartyToken(this._runtimeParameters.nonRoamableId,this._runtimeParameters.environment)}catch(t){this._logger.error("Error retrieving xbox token",{error:t,logCategory:f.authentication,errorCode:g.FailedRetrieveTokenWarning})}return{ticket:this._runtimeParameters.ticket,token:e}}async getHostTicket(){var e;try{const t=await ((e=this._hostCommunicationService)==null?void 0:e.sendRequest(new kc));if(!(t!=null&&t.response.ticket)){this._logger.warn("Ubiticket missing from GetUbisoftTicketRequest result, failed to retrieve ticket.",{logCategory:f.authentication,errorCode:g.FetchTicketFromHostFailedWarning});return}return t.response.ticket}catch(t){this._logger.warn("Failed to retrieve ticket from host.",{logCategory:f.authentication,errorCode:g.FetchTicketFromHostFailedWarning});return}}}class sq{constructor(e,t,s,a,n,r){this._logger=e,this._runtimeParameters=t,this._pluginsService=s,this._authenticationService=a,this._shellApplicationId=n,this._hostCommunicationService=r}async loginWithThirdPartyCredentials(e,t,s=dr){const a=this.getAuthApi();if(!a)return this._logger.error("AuthenticationApiV1 is not available",{errorCode:g.MissingAuthenticationApiError}),s;try{return await a.authenticateAndValidate({ubiNonUplayPlatformTicket:e,thirdPartyAuthToken:t})}catch(n){this._logger.error("[Authentication api] returned an error for [authenticateAndValidate]",{parameters:this._runtimeParameters,error:n,logCategory:f.authentication,errorCode:g.FailedAuthenticationWithAuthenticationSDKWarning})}return s}async renewSession(e,t){return this._authenticationService.v3.renewSession(e,t)}async loginWithTicket(e){const t=US(this._runtimeParameters.region);return await this._authenticationService.v3.ubiTicketLogin(e,this._shellApplicationId,t,!1)}async loginWithHostTicket(){var t;if(![p.PCLegacyClient,p.PCLegacyOverlay,p.PCElectronOverlay,p.Luna,p.SteamOverlay,p.SteamClient].includes(this._runtimeParameters.hostPlatformType))return;const e=await ((t=this._hostCommunicationService)==null?void 0:t.sendRequest(new kc));if(e!=null&&e.response.ticket)return await this.loginWithTicket(e==null?void 0:e.response.ticket)}async saveOfflineSession(e){const t=this.getAuthApi();if(!t){this._logger.error("AuthenticationApiV1 is not available",{errorCode:g.MissingAuthenticationApiError});return}await t.storage.session.save(e)}async getOfflineSession(){const e=this.getAuthApi();if(!e){this._logger.error("AuthenticationApiV1 is not available",{errorCode:g.MissingAuthenticationApiError});return}const t=await e.storage.session.get();if(!(!this._runtimeParameters.profileId||(t==null?void 0:t.profileId)!==this._runtimeParameters.profileId))return await e.storage.session.get()}getAuthApi(){return this._pluginsService.getApi(ee.AuthenticationApi)}async renewSessionByRememberMeTicket(e){const{platformType:t,rememberMeTicket:s}=e;return s?await this._authenticationService.v3.rememberMeTicketLogin(s,this._shellApplicationId,t,!0):void 0}}class NG{constructor(){this._parentToChildCommunication=void 0,this._data=[]}setCommunication(e){this._parentToChildCommunication=e,e&&(this._data.forEach(t=>e.sendNotification(new kp(t))),this._data.length=0)}sendEvent(e,t,s){this._parentToChildCommunication?this._parentToChildCommunication.sendNotification(new kp({eventName:e,data:{...t},moreData:s})):this._data.push({eventName:e,data:{...t},moreData:s})}async flush(){}}function aq(i,e,t,s,a){const n=i.getRuntimeParameters();t.isInitialized||(t.trackingConfiguration={default:(r,o)=>{const l={deviceType:n.deviceType,platformType:n.platformType,gameAppId:n.hostAppId,gameSpaceId:n.hostSpaceId,gameSessionId:n.gameSessionId,platformVariant:n.platformVariant,seqId:r.data.seqId};return n.childId&&(l.isChildWindow=!0),l}},t.outputConfiguration={outputUrl:e+"/v5/spaces/".concat(s,"/serviceEvents"),request:()=>({authentication:a})},t.initialize())}class nq{create(e,t,s,a,n,r){if(e)return new NG;const o=t.createChild("AnonymousTrackingService"),l=new s2({applicationId:a.shellApplicationId,applicationName:a.applicationName,spaceId:a.shellCrossPlatformSpaceId,applicationBuildId:"8.86.3"},s,o,a.shellApplicationId);return l.queueOutputConfiguration=a.statisticsConfig,aq(n,r,l,a.anonymousTrackingSpaceId,n.getVisitorId(t)),l}}class rq extends Hr{get name(){return"DefaultAuthenticationStrategy"}isApplicable(){return!0}async authenticate(){return this._authData}}class ro extends Hr{constructor(e,t,s,a,n){super(e,t,s,a,n),this._platform=US(t.region)}async authenticate(e){if(this._runtimeParameters.ticket)try{await le(()=>this.loginWithTicket(this._runtimeParameters.ticket))}catch(t){await this.handleUbiservicesErrorRsp(t,e)}else this._authenticationError={code:g.Dolphin_21,message:ge.MissingTicket},this._logger.error(ge.MissingTicket,{parameters:this._runtimeParameters,logCategory:f.authentication,errorCode:this._authenticationError.code,message:this._authenticationError.message});return this._authData}async loginWithTicket(e){const t=await this._authenticationService.v3.ubiTicketLogin(e,this._appId,this._platform,!1);this._authData={session:t,errorData:void 0,user:void 0}}shouldCloseOverlay(){return!1}}class oq extends ro{constructor(e,t,s,a,n,r){super(e,t,s,a,n),this._featureHandlerService=r}get name(){return"DesktopAppAuthenticationStrategy"}isApplicable(){return[p.PCElectronClient].includes(this._runtimeParameters.hostPlatformType)}}async function cq(i,e){if({}.VUE_APP_DEV_AUTH_USERNAME&&{}.VUE_APP_DEV_AUTH_PASSWORD){const t={}.VUE_APP_DEV_AUTH_USERNAME,s={}.VUE_APP_DEV_AUTH_PASSWORD;try{return await e.v3.uplayLogin(t,s,i,!0)}catch(a){return null}}return null}class lq extends Hr{get name(){return"DevAuthenticationStrategy"}isApplicable(){return!1}async authenticate(){const e=await cq(this._appId,this._authenticationService);return{session:e||{ticket:""},errorData:void 0,user:void 0}}hasQueryParamFlag(e){var a;return(a=window==null?void 0:window.location)!=null&&a.href?new URL(window.location.href).searchParams.has(e):!1}}class pq extends Hr{constructor(e,t,s,a,n,r){super(e,t,s,a,n),this.environment=r}async getToken(){return this._runtimeParameters.token}async authenticate(){const e=await this.getToken();try{return await (await this.getAuthApi()).authenticateAndValidate({ubiNonUplayPlatformTicket:this._runtimeParameters.ticket,thirdPartyAuthToken:e})}catch(t){this._logger.warn("Failed to authenticate with authentication-plugin",{parameters:this._runtimeParameters,error:t,logCategory:f.authentication,errorCode:g.FailedAuthenticationWithAuthenticationSDKWarning})}return this._authData}shouldProcessAuthentication(){return!!this._runtimeParameters.profileId&&!!this._runtimeParameters.hostSpaceId}async processAuthentication(){return this.shouldProcessAuthentication()?super.processAuthentication():new Ai(this._authData,this._authAdditionalParameters)}needsTwoPhaseAuthentication(){return!this._runtimeParameters.hostSpaceId}}class TG extends pq{constructor(e,t,s,a,n,r,o,l,u){super(e,t,s,a,n,u),this._tokenService=r,this._profilesService=o,this._platformInterface=l,!this._runtimeParameters.profileId&&this._runtimeParameters.ticket&&[ve.Default,ve.LateSignOn].includes(this._runtimeParameters.authFlow)?this._authenticationFlow=ve.LateSignOn:this._runtimeParameters.profileId?this._authenticationFlow=ve.Full:this._authenticationFlow=ve.LoginOnly,this._platformInterface.authenticationFlow=this._authenticationFlow}get name(){return"InGameMobileAuthenticationStrategy"}async setAuthError(e,t,s,a){const n={httpMethod:s,endpoint:a};let r="";if("response"in t&&(n.httpStatusCode=t.response.status,r=t.response.status.toString(),t.response.body))try{n.serviceErrorCode=(await t.response.json()).errorCode}catch(o){this._logger.warn("Failed to parse error response body",{error:o,logCategory:f.authentication})}this._platformInterface.setAuthError(r,e),this._platformInterface.setAuthErrorContext(n)}isApplicable(){return[m.IOS,m.Android,m.Mobile].includes(this._runtimeParameters.platformType)&&!this._runtimeParameters.isStandalone}shouldCloseOverlay(){return this._authenticationFlow!==ve.Full}shouldProcessAuthentication(){return!!this._runtimeParameters.profileId&&!!this._runtimeParameters.ticket}async processAuthentication(){return this._authData={...this._authData,ubiMobileV2Ticket:this._runtimeParameters.ticket,authenticationFlow:this._authenticationFlow},super.processAuthentication()}async doPostAuthenticationActions(e){if(!this._runtimeParameters.profileId){if(this._authenticationFlow===ve.LateSignOn){await this.lateSignOnFlow(e);return}await this.authFlow(e)}}async setAuthenticationError(e,t){var s;e?this._platformInterface.setAuthError(((s=t==null?void 0:t.httpStatusCode)==null?void 0:s.toString())||"",e):this._platformInterface.clearAuthError(),t?this._platformInterface.setAuthErrorContext(t):this._platformInterface.clearAuthErrorContext()}async authFlow(e){this._platformInterface.setProfileId(e.profileId),await this.tokenizePayload(e.profileId,this._runtimeParameters.ticket||e.ticket,{profileId:e.profileId,rememberMeTicket:e.rememberMeTicket,ticket:e.ticket,nameOnPlatform:e.nameOnPlatform},this._authenticationFlow===ve.LoginOnly?PS.Limited:void 0)}async getRoamingProfile(e,t){try{return await this._profilesService.v3.getRoamingProfile(e,t,this._runtimeParameters.hostSpaceId)}catch(s){const a=s;this._logger.warn("Failed to get roaming profile with profile service",{error:a,logCategory:f.authentication}),await this.setAuthError("Profile service error",a,"GET","/v3/users/me/roamingProfiles");return}}async getTicketProfileId(e){try{return(await this._profilesService.v3.getProfile("",e)).profileId}catch(t){const s=t;this._logger.warn("Failed to get profile id from ticket with profile service",{error:s,logCategory:f.authentication}),await this.setAuthError("Profile service error",s,"GET","/v3/profiles/me");return}}async lateSignOnFlow(e){const t=await this.getRoamingProfile(e.ticket,e.sessionId);if(t){if(t.roamingProfiles.length===0||!t.roamingProfiles[0])return this._authenticationFlow=ve.LoginOnly,this._platformInterface.authenticationFlow=ve.LoginOnly,this.authFlow(e);const s=t.roamingProfiles[0].profileId,a=await this.getTicketProfileId(this._runtimeParameters.ticket);a&&await this.tokenizePayload(a,this._runtimeParameters.ticket,{profileId:s,rememberMeTicket:e.rememberMeTicket})}}async tokenizePayload(e,t,s,a){const n=JSON.stringify(s);try{const r=await this._tokenService.v1.generateToken(e,n,t,a);this._platformInterface.setAuthToken(r.token)}catch(r){const o=r;this._logger.warn("Failed to generate token with token service",{error:o,logCategory:f.authentication,errorCode:g.FailedTokenGenerationWarning}),await this.setAuthError("Token service error",o,"POST","/v1/profiles/".concat(e,"/tokens"))}}}class uq extends TG{constructor(e,t,s,a,n,r,o,l,u){super(e,t,s,a,n,r,o,l,u),this._platformInterface.authenticationFlow=ve.LoginOnly}isApplicable(){return this._runtimeParameters.hostPlatformType===p.MacOS}get name(){return"MacOSAuthenticationStrategy"}}var dq=Object.defineProperty,hq=Object.getOwnPropertyDescriptor,RG=(i,e,t,s)=>{for(var a=s>1?void 0:s?hq(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&dq(e,t,a),a};class zi extends oe("[State] GameManagement"){constructor(){super(...arguments),this._runningGames=null}get runningGames(){return this._runningGames?[...this._runningGames]:void 0}set runningGames(e){this._runningGames=e!=null?e:null}get hasRunningGames(){return!this._runningGames||this._runningGames.length>0}addRunningGame(e){var a;const t=(a=this._runningGames)!=null?a:[],s=this.findRunningGameIndex(e);if(s>-1){const n=t[s];n.applicationId.length===0&&n.spaceId.length===0&&(t[s]={...t[s],...e})}else t.push(e);this.runningGames=[...t]}removeRunningGame(e){const t=this._runningGames;if(t){const s=this.findRunningGameIndex(e);s>-1&&(t.splice(s,1),this._runningGames=[...t])}}findRunningGameIndex(e){const t=this._runningGames;return t?t.findIndex(s=>s.spaceId===e.spaceId&&s.applicationId===e.applicationId||s.productId&&e.productId&&s.productId===e.productId):-1}}RG([P],zi.prototype,"addRunningGame",1);RG([P],zi.prototype,"removeRunningGame",1);function DG(i,e){if(Object.values(i).includes(e))return e}var fs=(i=>(i.Logout="logOutModal",i.Reload="reloadModal",i.SwitchClient="switchClientModal",i.Quit="quitModal",i.Restart="restartModal",i.RestartWhenRunningGame="restartWhenRunningGameModal",i))(fs||{});const Dc=class Dc extends ro{constructor(e,t,s,a,n,r,o,l,u){super(e,t,s,a,n),this._localizationService=r,this._featureHandlerService=o,this._runtimeParametersService=l,this._hostCommunicationService=u,this._refreshUbisoftTicketReceived=!1,this._refreshSessionInProgress=!1}get name(){return"PcBetaClientAuthenticationStrategy"}isApplicable(){return[p.PCLegacyClient,p.Luna,p.SteamClient].includes(this._runtimeParameters.hostPlatformType)}handleAuthenticationFailure(e,t){return this._logger.warn("User authentication was unsuccessful",{authData:e,additionalData:t,logCategory:f.authentication,errorCode:g.FailedUserAuthenticationWarning}),this.reportInitialisationFailureIntent()}async processAuthentication(){var t;const{isOnline:e}=this._store.getReadonlyState(S);if(!e)return this._logger.info("Proceed authentication in offline",{logCategory:f.authentication}),new Ai;try{const a=await (await this.getAuthApi()).authenticateAndValidate({ubiNonUplayPlatformTicket:this._runtimeParameters.ticket});if(a&&!a.errorData&&((t=a.session)!=null&&t.ticket))return this._store.dispatchIntent(new fg),new at(a.session)}catch(s){this._logger.warn("Authentication plug-in is not able to authenticateAndValidate",{error:s,logCategory:f.authentication,errorCode:g.AuthenticationPluginNotAvailableWarning})}return new Ai(this._authData,this._authAdditionalParameters)}async handleSessionCloseExpiration(e){return this._authenticationError=void 0,await this.refreshSession(e),this._authenticationError}async validateLoginSession(e,t,s){var r;const a=this._store.getReadonlyState(S);let n;try{n=await this._featureHandlerService.handleFeature(c.PassAuthentication,{loginData:e,isOfflineSession:a.isOfflineSession,password:t,email:s})}catch(o){const l=o instanceof Vc?g.Dolphin_34:g.Dolphin_35;return this._authenticationError={code:l,message:ge.ValidateLoginSessionError},this._logger.error(ge.ValidateLoginSessionError,{error:o,logCategory:f.authentication,errorCode:l}),await this._store.dispatchIntent(this.reportInitialisationFailureIntent(l)),!1}return n!=null&&n.response.isSuccess||await this.handleClientAuthenticationFailure(n==null?void 0:n.response.errorCode),this.overrideOwnershipGroup(n==null?void 0:n.response,e.ticket,a.isOnline),(r=n==null?void 0:n.response.isSuccess)!=null?r:!1}async overrideOwnershipGroup(e,t,s){if(!(e!=null&&e.ownershipGroup))return;const a=DG(la,e.ownershipGroup);if(a&&(await this._store.dispatchIntent(new Gd(a)),this._runtimeParametersService.overrideParameter("ownershipGroup",a),a===la.Steam&&this._runtimeParameters.platformType===m.PC&&s)){const n=new URL(this._runtimeParameters.fullUrl);n.searchParams.set("platform",m.Steam),n.searchParams.set("ticket",t),n.searchParams.set("ownershipGroup",la.Steam),await this._store.dispatchIntent(new ar(_e.PlatformTypeChanged)),window.location.href=n.href}}async handleClientAuthenticationFailure(e){const t={code:e===Dc.clientInvalidParameterErrorCode?g.Dolphin_31:g.Dolphin_28,message:ge.ClientAuthError};this._authenticationError=t,this._logger.error(ge.ClientAuthError,{parameters:this._runtimeParameters,logCategory:f.authentication,errorCode:t.code,message:"".concat(t.message," (client error code: ").concat(e,")")}),await this._store.dispatchIntent(this.reportInitialisationFailureIntent(g.Dolphin_28))}async refreshSession(e){const t=this._store.getReadonlyState(S);if(this._refreshSessionInProgress)return;if(!t.isOnline){this._authenticationError={code:g.HttpClientNetworkError,message:ge.NetworkError};return}const s=e;if(!s)return;this._refreshSessionInProgress=!0;let a;if(a=await this.renew(s),!a)try{a=await this.getNewSessionByRememberMeTicket(s)}catch(n){if(await this.handleUbiservicesErrorRsp(n),n instanceof TypeError){this._refreshSessionInProgress=!1;return}}a?(this._authenticationError=void 0,await this._store.dispatchIntent(new at(a)),this._refreshUbisoftTicketReceived&&(this._refreshUbisoftTicketReceived=!1,await this.processUbiTicketRefreshResponse(a))):Date.parse(s.expiration)<Date.now()&&await this.handleRefreshSessionFailed(),this._refreshSessionInProgress=!1}async ubiTicketRefreshRequest(){const e=this._store.getReadonlyState(S),t=e.playerSession;t&&e.isPlayerSessionValidAfterThirtyMinutes?this.processUbiTicketRefreshResponse(t):(this._refreshUbisoftTicketReceived=!0,this.refreshSession(t))}reportInitialisationFailureIntent(e){var s;const t=((s=this._authenticationError)==null?void 0:s.code)||e;return new Qt({message:"error.generic",errorCode:t})}async renew(e){const{profileId:t}=e;try{const s=await this._authenticationService.v3.renewSession(e,!0);if(this.isNewSessionValid(t,s))return s}catch(s){await this.handleUbiservicesErrorRsp(s)}}async getNewSessionByRememberMeTicket(e){const{platformType:t,rememberMeTicket:s,profileId:a}=e;if(s){const n=await this._authenticationService.v3.rememberMeTicketLogin(s,this._appId,t,!0);if(this.isNewSessionValid(a,n))return n}}isNewSessionValid(e,t){return!!t&&!!t.sessionId&&e===t.profileId}async processUbiTicketRefreshResponse(e){var o;const{ticket:t,spaceId:s,sessionId:a,profileId:n,expiration:r}=e;await ((o=this._hostCommunicationService)==null?void 0:o.sendNotification(new md({ubiTicket:t,spaceId:s,sessionId:a,profileId:n,expiration:r})))}handleRefreshSessionFailed(){const{hasRunningGames:e}=this._store.getReadonlyState(zi);e?this._store.dispatchIntent(new un(fs.RestartWhenRunningGame)):this._store.dispatchIntent(new un(fs.Restart))}};Dc.clientInvalidParameterErrorCode=2;let Lu=Dc;class gq extends ro{get name(){return"PcBrowserAuthenticationStrategy"}async processAuthentication(){return this._runtimeParameters.ticket?super.processAuthentication():new Ai(this._authData)}isApplicable(){return[p.PCWebClient].includes(this._runtimeParameters.hostPlatformType)}}class mq extends ro{constructor(e,t,s,a,n,r,o){super(e,t,s,a,n),this._localizationService=r,this._hostCommunicationService=o,this.authenticationTimeoutInMs=3600*24*7*1e3}get name(){return"PcClientAuthenticationStrategy"}isApplicable(){return[p.PCLegacyClient,p.PCLegacyOverlay,p.PCElectronOverlay,p.Luna,p.SteamOverlay,p.SteamClient].includes(this._runtimeParameters.hostPlatformType)}handleAuthenticationFailure(e,t){return this._logger.warn("User authentication was unsuccessful",{authData:e,additionalData:t,logCategory:f.authentication,errorCode:g.FailedUserAuthenticationWarning}),this.reportInitialisationFailureIntent()}async handleSessionCloseExpiration(e){var t;this._authenticationError=void 0;try{const s=await this._authenticationService.v3.renewSession(e,!!e.rememberMeTicket);this._store.dispatchIntent(new at(s));return}catch(s){this._authenticationError=await this.handleUbiservicesErrorRsp(s,!0,!1)}if(((t=this._authenticationError)==null?void 0:t.code)===g.Jellyfish_001)return this._authenticationError;try{const s=await this.requestHostTicket();if(!s)return this._authenticationError;const a=await this._authenticationService.v3.ubiTicketLogin(s,this._appId,this._platform,!1);this._store.dispatchIntent(new at(a))}catch(s){return this._authenticationError=await this.handleUbiservicesErrorRsp(s,!0),this._authenticationError}}async refreshSession(e,t){}async processAuthentication(){const{isOffline:e,profileId:t}=this._runtimeParameters;if(e){const a=await (await this.getAuthApi()).storage.session.get();return t&&(a==null?void 0:a.profileId)===t?new qc(a):(await this._store.dispatchIntent(new Re(!1)),this.handleOfflineAuthenticationFailure())}else return super.processAuthentication()}async authenticate(e){return this._runtimeParameters.ticket?await this.authenticateWithTicket(e):await this.authenticateWhenTicketIsMissing(e),this._authData.session.sessionId&&!this._authData.errorData&&!this._authAdditionalParameters&&await (await this.getAuthApi()).storage.session.save(this._authData.session),this._authData}async authenticateWhenTicketIsMissing(e){await this._store.dispatchIntent(new Re(!0)),this._authenticationError={code:g.Dolphin_21,message:ge.MissingTicket},this._logger.warn(ge.MissingTicket+" Fetching from client.",{parameters:this._runtimeParameters,logCategory:f.authentication,errorCode:g.Dolphin_21,message:this._authenticationError.message});const t=await this.fetchHostTicketDuringAuthentication(Vp);t&&(this._runtimeParameters.ticket=t,this._authenticationError=void 0,await this._store.dispatchIntent(new Re(!1)),await super.authenticate(e))}async authenticateWithTicket(e){try{await le(()=>this.loginWithTicket(this._runtimeParameters.ticket))}catch(t){this._logger.warn(ge.UbiservicesError,{parameters:this._runtimeParameters,logCategory:f.authentication,errorCode:g.FailedUserAuthenticationWarning,error:t}),await this._store.dispatchIntent(new Re(!0));const s=await this.fetchHostTicketDuringAuthentication(Vp);if(!s)await this.handleUbiservicesErrorRsp(t,e);else{await this._store.dispatchIntent(new Re(!1));try{await this.loginWithTicket(s)}catch(a){await this.handleUbiservicesErrorRsp(a,e)}}}}async fetchHostTicketDuringAuthentication(e=Ht){await this._store.dispatchIntent(new en(!0)),await this._store.dispatchIntent(new Qo);const t=await this.requestHostTicket(e);return await this._store.dispatchIntent(new en(!1)),t}async requestHostTicket(e=Ht){var s;let t;for(;!t;)try{const a=await ((s=this._hostCommunicationService)==null?void 0:s.sendRequest(new kc));if(a!=null&&a.response.ticket)t=a.response.ticket;else{this._authenticationError={code:g.Dolphin_25,message:ge.MissingTicket},this._logger.warn("Ubiticket missing from RequestUbisoftTicketIntent result, failed to renew ticket.",{logCategory:f.authentication,errorCode:g.FetchTicketFromHostFailedWarning});return}}catch(a){this._logger.warn("Failed to refresh ticket from host. Retrying...",{logCategory:f.authentication,errorCode:g.FetchTicketFromHostFailedWarning}),await Gs(e)}return t}reportInitialisationFailureIntent(e){var s;const t=((s=this._authenticationError)==null?void 0:s.code)||e;return new Qt({message:"error.generic",errorCode:t})}handleOfflineAuthenticationFailure(){const e={code:g.Jellyfish_033,message:ge.OfflineProfileMissMatch};return this._logger.error(ge.OfflineProfileMissMatch,{parameters:this._runtimeParameters,logCategory:f.authentication,errorCode:e.code,message:e.message}),new Qt({message:this._localizationService.formatMessage({id:"error.loginOffline",defaultMessage:"If this is your first time using Ubisoft Connect on this computer, you'll need to log in online at least once before you can use offline mode."}),errorCode:e.code})}}class fq extends ro{get name(){return"PcOverlayAuthenticationStrategy"}isApplicable(){return!!this._runtimeParameters.ticket&&[p.PCWebOverlay,p.Luna,p.WebEmbedded].includes(this._runtimeParameters.hostPlatformType)}}class yq{constructor(e,t,s,a,n,r,o,l,u,v,w){this._logger=e,this._runtimeParameters=t,this._store=s,this._ubiServices=a,this._featureHandlerService=n,this._applicationId=r,this._environment=o,this._localizationService=l,this._runtimeParametersService=u,this._hostCommunicationService=v,this._platformInterface=w,this._defaults=[this.getDevStrategy.bind(this),this.getDefaultStrategy.bind(this)],this._pcAuth=[this.getPcClient.bind(this),this.getPcOverlay.bind(this),this.getPcBrowser.bind(this)],this._authStrategies={[p.CompanionAppAndroid]:[this.getMobileStrategy.bind(this)],[p.CompanionAppIOS]:[this.getMobileStrategy.bind(this)],[p.CompanionAppMobile]:[this.getMobileStrategy.bind(this)],[p.Android]:[this.getMobileStrategy.bind(this)],[p.IOS]:[this.getMobileStrategy.bind(this)],[p.Luna]:this._pcAuth,[p.Mobile]:[this.getMobileStrategy.bind(this)],[p.PCElectronClient]:[this.getDesktopStrategy.bind(this)],[p.PCElectronOverlay]:this._pcAuth,[p.PCLegacyClient]:this._pcAuth,[p.PCLegacyOverlay]:this._pcAuth,[p.PCWebClient]:this._pcAuth,[p.PCWebOverlay]:this._pcAuth,[p.PS4]:this._defaults,[p.PS4Aegir]:this._defaults,[p.PS4AegirNative]:this._defaults,[p.PS5]:this._defaults,[p.PS5Aegir]:this._defaults,[p.PS5AegirNative]:this._defaults,[p.Scarlett]:this._defaults,[p.ScarlettAegir]:this._defaults,[p.ScarlettAegirNative]:this._defaults,[p.ScarlettUWP]:this._defaults,[p.ScarlettUWPWebView2]:this._defaults,[p.SteamClient]:this._pcAuth,[p.SteamOverlay]:this._pcAuth,[p.Web]:this._pcAuth,[p.WebEmbedded]:this._pcAuth,[p.XONE]:this._defaults,[p.XOneAegir]:this._defaults,[p.XOneAegirNative]:this._defaults,[p.XoneUWP]:this._defaults,[p.XoneUWPWebView2]:this._defaults,[p.MacOSAegir]:this._defaults,[p.MacOSAegirNative]:this._defaults,[p.MacOS]:[this.getMacOS.bind(this)],[p.Switch]:this._defaults}}getDefaultStrategy(){return new rq(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store)}getDevStrategy(){return new lq(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store)}getMobileStrategy(){return new TG(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store,this._ubiServices.tokenService,this._ubiServices.profilesService,this._platformInterface,this._environment)}getDesktopStrategy(){return new oq(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store,this._featureHandlerService)}getPcBrowser(){return new gq(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store)}getPcOverlay(){return new fq(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store)}getPcClient(){var e;return(e=window.upn)!=null&&e.enableAuthAppPc?new Lu(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store,this._localizationService,this._featureHandlerService,this._runtimeParametersService,this._hostCommunicationService):new mq(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store,this._localizationService,this._hostCommunicationService)}getMacOS(){return new uq(this._logger,this._runtimeParameters,this._applicationId,this._ubiServices.authenticationService,this._store,this._ubiServices.tokenService,this._ubiServices.profilesService,this._platformInterface,this._environment)}create(){var t;return(t=[this.getDevStrategy.bind(this),...this._authStrategies[this._runtimeParameters.hostPlatformType]].map(s=>s()).find(s=>s.isApplicable()))!=null?t:this.getDefaultStrategy()}}class Ms{constructor(e,t){this._logger=e,this._pluginsService=t}requiresDeactivation(){return!0}}class vq extends Ms{constructor(e,t,s){super(e,t),this._featureHandlerService=s}get name(){return"AegirInterface"}async closeOverlay(){this._featureHandlerService.handleFeatureWithoutPayload(c.OverlayIsHidden)}}class _q extends Ms{constructor(e,t,s){super(e,t),this._store=s}get name(){return"DesktopAppInterface"}async closeOverlay(){var t;const e=this._store.getReadonlyState(S);(t=window.native)==null||t.close(e.childId)}}class Sq extends Ms{constructor(e,t,s){super(e,t),this._featureHandlerService=s}get name(){return"MobileInterface"}async closeOverlay(){await this._featureHandlerService.handleFeature(c.LoginResult,{})}}class cc extends oe("[Shell] Tokenized Authentication"){constructor(){super(...arguments),this._errorInfo=null,this._updatedAuthenticationFlow=null}get profileId(){return this._profileId}set profileId(e){this._profileId=e}get token(){return this._token}set token(e){this._token=e}get errorInfo(){return this._errorInfo}set errorInfo(e){this._errorInfo=e}get updatedAuthenticationFlow(){return this._updatedAuthenticationFlow}set updatedAuthenticationFlow(e){this._updatedAuthenticationFlow=e}}const xf="ubisoftConnectScheme:";var Do=(i=>(i.Success="success",i.Cancelled="cancelled",i.Error="error",i))(Do||{});class wq extends Ms{constructor(e,t,s,a,n){super(e,t),this._initialAuthenticationFlow=s,this._runtimeParametersService=a,this._store=n}get name(){return"UbiservicesSdkInterface"}async closeOverlay(){var a;this._runtimeParametersService.clearTicket();const e=this._store.getReadonlyState(cc),t=this.getExitPayload(e);((a=e.updatedAuthenticationFlow)!=null?a:this._initialAuthenticationFlow)===ve.LateSignOn?window.location.assign(xf+JSON.stringify({lateSignOnLoginResult:t})):window.location.assign(xf+JSON.stringify({loginResult:t}))}getExitPayload(e){return e.errorInfo?{status:Do.Error,errorMessage:e.errorInfo.message,errorCode:e.errorInfo.code,errorContext:{...e.errorInfo.context}}:e.token?{status:Do.Success,token:e.token,profileId:e.profileId}:{status:Do.Cancelled}}}class bq extends Ms{constructor(e,t,s){super(e,t),this._featureHandlerService=s}get name(){return"DefaultPcClientInterface"}async closeOverlay(){this._featureHandlerService.handleFeatureWithoutPayload(c.OverlayIsHidden)}}class Cq extends Ms{get name(){return"PlayStationInterface"}async closeOverlay(){window.document.body.className="closed",await Gs(350),window.document.body.innerHTML="",await Gs(16),window.location.href="uplayscheme:"}}class Iq extends Ms{get name(){return"SwitchInterface"}async closeOverlay(){window.document.body.className="closed",await Gs(350),window.document.body.innerHTML="",await Gs(16),window.location.href="uplayscheme:"}}class Mq extends Ms{constructor(e,t,s){super(e,t),this._featureHandlerService=s}get name(){return"WebView2Interface"}async closeOverlay(){await this._featureHandlerService.handleFeatureWithoutPayload(c.Quit)}}var Gu=(i=>(i.ClientUplay="us-sdkClientUplay",i))(Gu||{});const Aq={[ie.Local]:"uat-",[ie.Dev]:"uat-",[ie.Uat]:"uat-",[ie.Cert]:"cert2-",[ie.Prod]:""};class Pq{static replaceToken(e,t){return t.replace("{env}",Aq[e])}}const Oc=class Oc extends Ms{constructor(e,t,s,a,n){super(e,t),this._hostApplicationId=s,this._parameterService=a,this._isUWP=n,this.ensureGamePadNavigation()}get name(){return"XboxInterface"}requiresDeactivation(){var e,t,s;return((s=(t=(e=window.Windows)==null?void 0:e.UI)==null?void 0:t.WebUI)==null?void 0:s.WebUIApplication)===void 0||!this._isUWP}ensureGamePadNavigation(){setInterval(()=>{navigator.getGamepads()},Oc.timeToForceActivateGamepad)}async closeOverlay(){if(!this._isUWP)return this.redirect();try{await window.Windows.Xbox.System.Launcher.navigateBackAsync()}catch(e){try{await window.Windows.UI.ViewManagement.ApplicationView.getForCurrentView().tryConsolidateAsync()}catch(t){let s="";t instanceof Error?s=t.message:typeof t=="string"&&(s=t),window.MSApp.terminateApp(new Error(s))}}}async redirect(){let e=await this.getCompletionUrl(this._hostApplicationId);e||(e="./upnexit.html"),window.location.href=e}async getCompletionUrl(e){var t;try{return(t=(await this._parameterService.v1.getApplicationParameters(null,null,e,[Gu.ClientUplay])).parameters[Gu.ClientUplay].fields.scarlettUplayWebCompletionUrl)!=null?t:""}catch(s){return this._logger.error("Error fetching completion url configuration",{error:s,logCategory:f.configuration,errorCode:g.XboxInterfaceCompletionUrlError}),""}}async getFirstPartyToken(e,t){const s=window.Windows.System.User.getFromId(e);this._logger.debug("Getting first party token for user",{user:s,logCategory:f.authentication});const a=Pq.replaceToken(t,"https://{env}public-ubiservices.ubi.com/v2/profiles/sessions"),n=await window.Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.findAccountProviderAsync("https://xsts.auth.xboxlive.com","",s),r=new window.Windows.Security.Authentication.Web.Core.WebTokenRequest(n);r.properties.insert("Url",a),r.properties.insert("Target","xboxlive.signin"),r.properties.insert("Policy","DELEGATION");let o=await window.Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.getTokenSilentlyAsync(r);if(this._logger.debug("Getting token silently. ResponseStatus: ".concat(o.responseStatus),{tokenResultStatus:o.responseStatus,logCategory:f.authentication}),o.responseStatus===3&&(o=await window.Windows.Security.Authentication.Web.Core.WebAuthenticationCoreManager.requestTokenAsync(r)),this._logger.debug("Getting token after user interaction. ResponseStatus: ".concat(o.responseStatus),{tokenResultStatus:o.responseStatus,logCategory:f.authentication}),o.responseStatus===1){const l="The user cancelled the request while generating a token.";throw this._logger.error(l,{logCategory:f.authentication,errorCode:g.XboxInterfaceFirstPartyTokenCancelled}),window.MSApp.terminateApp(new Error(l)),new De("The user cancelled the request while generating a token.")}else if(o.responseStatus!==0){const l="An error occurred while generating a token at stage 2.";throw this._logger.error(l,{logCategory:f.authentication,errorCode:g.XboxInterfaceFirstPartyTokenError}),new De(l)}return o.responseData[0].token||""}};Oc.timeToForceActivateGamepad=300;let xu=Oc;class Nq{constructor(e,t,s,a,n,r,o){this._logger=e,this._runtimeParameters=t,this._store=s,this._ubiServices=a,this._pluginsService=n,this._featureHandlerService=r,this._runtimeParametersService=o,this._platfromInterfaces={[p.CompanionAppMobile]:this.makeCompanionAppInterface.bind(this),[p.CompanionAppIOS]:this.makeCompanionAppInterface.bind(this),[p.CompanionAppAndroid]:this.makeCompanionAppInterface.bind(this),[p.Android]:this.makeUbiservicesSdkInterface.bind(this),[p.IOS]:this.makeUbiservicesSdkInterface.bind(this),[p.Luna]:this.makeDefaultPcClientInterface.bind(this),[p.Mobile]:this.makeUbiservicesSdkInterface.bind(this),[p.PCElectronClient]:this.makeDesktopInterface.bind(this),[p.PCElectronOverlay]:this.makeDefaultPcClientInterface.bind(this),[p.PCLegacyClient]:this.makeDefaultPcClientInterface.bind(this),[p.PCLegacyOverlay]:this.makeDefaultPcClientInterface.bind(this),[p.PCWebClient]:this.makeDefaultPcClientInterface.bind(this),[p.PCWebOverlay]:this.makeDefaultPcClientInterface.bind(this),[p.PS4]:this.makePlayStationInterface.bind(this),[p.PS4Aegir]:this.makeAegirInterface.bind(this),[p.PS4AegirNative]:this.makeAegirInterface.bind(this),[p.PS5]:this.makePlayStationInterface.bind(this),[p.PS5Aegir]:this.makeAegirInterface.bind(this),[p.PS5AegirNative]:this.makeAegirInterface.bind(this),[p.Scarlett]:this.makeXboxInterface.bind(this),[p.ScarlettAegir]:this.makeAegirInterface.bind(this),[p.ScarlettAegirNative]:this.makeAegirInterface.bind(this),[p.ScarlettUWP]:this.makeXboxInterface.bind(this),[p.ScarlettUWPWebView2]:this.makeWebView2Interface.bind(this),[p.XoneUWPWebView2]:this.makeWebView2Interface.bind(this),[p.SteamClient]:this.makeDefaultPcClientInterface.bind(this),[p.SteamOverlay]:this.makeDefaultPcClientInterface.bind(this),[p.Web]:this.makeDefaultPcClientInterface.bind(this),[p.WebEmbedded]:this.makeDefaultPcClientInterface.bind(this),[p.XONE]:this.makeXboxInterface.bind(this),[p.XOneAegir]:this.makeAegirInterface.bind(this),[p.XOneAegirNative]:this.makeAegirInterface.bind(this),[p.XoneUWP]:this.makeXboxInterface.bind(this),[p.MacOSAegir]:this.makeAegirInterface.bind(this),[p.MacOSAegirNative]:this.makeAegirInterface.bind(this),[p.MacOS]:this.makeUbiservicesSdkInterface.bind(this),[p.Switch]:this.makeSwitchInterface.bind(this)}}makeCompanionAppInterface(){return new Sq(this._logger,this._pluginsService,this._featureHandlerService)}makeUbiservicesSdkInterface(){const e=_g(this._runtimeParameters);return new wq(this._logger,this._pluginsService,e,this._runtimeParametersService,this._store)}makeAegirInterface(){return new vq(this._logger,this._pluginsService,this._featureHandlerService)}makePlayStationInterface(){return new Cq(this._logger,this._pluginsService)}makeXboxInterface(){return new xu(this._logger,this._pluginsService,this._runtimeParameters.hostAppId,this._ubiServices.parametersService,this._runtimeParameters.isUWP)}makeDesktopInterface(){return new _q(this._logger,this._pluginsService,this._store)}makeWebView2Interface(){return new Mq(this._logger,this._pluginsService,this._featureHandlerService)}makeDefaultPcClientInterface(){return new bq(this._logger,this._pluginsService,this._featureHandlerService)}getPlatformInterface(){return this._platfromInterfaces[this._runtimeParameters.hostPlatformType]()}makeSwitchInterface(){return new Iq(this._logger,this._pluginsService)}}function Tq(i,e,t,s,a,n){const r=i.getRuntimeParameters();let o,l,u,v;const w=()=>({default:(b,I)=>{const R={deviceType:r.deviceType,platformType:r.platformType,platformVariant:r.platformVariant,country:l.clientIpCountry,shellSessionId:l.sessionId,gameSpaceId:u.hostGame.spaceId,gameSessionId:r.gameSessionId,seqId:b.data.seqId,partner:v};return r.childId&&(R.isChildWindow=!0),R},shellStart:()=>({machineId:"",launchMicroApp:r.microApp,launchParams:r.microAppParams}),shellQuit:()=>({}),shellNav:()=>({inputDeviceBrand:u.inputDeviceType,inputDeviceType:u.inputDeviceType===D.keyboard?"KEYBOARD":"GAMEPAD"}),shellNavError:()=>({inputDeviceBrand:u.inputDeviceType,inputDeviceType:u.inputDeviceType===D.keyboard?"KEYBOARD":"GAMEPAD"}),authNav:()=>({gameAppId:u.hostGame.applicationId}),statsNav:()=>({targetGameAppId:o}),gamePageNav:()=>({targetGameAppId:o}),microAppNav:(b,I)=>{var R;return I.applicationName===J.AppGamePage?{targetGameAppId:(R=u.activeGame)==null?void 0:R.applicationId}:{}},challengeDisplayed:()=>({targetGameAppId:o}),challengesNav:()=>({targetGameAppId:o}),rewardDisplayed:()=>({targetGameAppId:o}),rewardDetailOpen:()=>({targetGameAppId:o}),rewardsNav:()=>({targetGameAppId:o}),rewardUserAction:()=>({targetGameAppId:o}),friendAction:(b,I)=>({inputSource:I.applicationName}),groupAction:(b,I)=>({inputSource:I.applicationName})});e.subscribe({next:b=>{(async()=>{var I,R;if(b&&(u=b),b!=null&&b.playerSession&&(l=b.playerSession),(I=b==null?void 0:b.activeGame)!=null&&I.applicationId&&(o=b.activeGame.applicationId),!v){const x=await ((R=a.getApi(ee.PartnerApiV1))==null?void 0:R.getPartnerInformation().catch(F=>{n.info(F.message)}));v=x==null?void 0:x.platform}!s.isInitialized&&l&&o&&(s.trackingConfiguration=w(),s.outputConfiguration={outputUrl:t+"/v3/profiles/me/events",request:()=>({authentication:l})},s.initialize())})()}})}class Rq{create(e,t,s,a,n,r,o,l){if(e)return new NG;const u=t.createChild("TrackingService"),v=new a2({applicationId:a.shellApplicationId,applicationName:a.applicationName,spaceId:a.shellCrossPlatformSpaceId,applicationBuildId:"8.86.3"},s,u,a.shellApplicationId);return v.queueOutputConfiguration=a.statisticsConfig,Tq(n,r,o,v,l,t),v}}class Dq{constructor(e){var n;this.lifeGuardService=new UW,this.documentLifecycleListener=new WW,this.localizationService=new Hj,this.resizeObserverService=new Jj,this.apiFactory=new ZV,this.performanceMeter=e.performanceMeter,this.performanceLogger=e.performanceLogger,this.logger=e.logger,this.runtimeParameterService=e.runtimeParameterService,this.shellConfig=e.shellConfig,this.httpClientFactory=e.httpClientFactory,this.ubiServicesService=e.ubiServicesService,this.connectServices=e.connectServices,this.localStorageService=e.localStorageService,this.runtimeParameters=e.runtimeParameters,this.appElement=e.appElement,this.focusSystemRootElement=e.focusSystemRootElement,this.focusSystemRootGroupElement=e.focusSystemRootGroupElement,this.featureFlagsService=e.featureFlagsService,this.features=e.features,this.metricDefinitions=e.metricDefinitions,this.telemetrySDK=e.telemetrySDK,this.performanceMeterTransportsProvider=e.performanceMeterTransportsProvider,this.lazyStore=e.lazyStore,this.store=this.lazyStore.get(),this.hostCommunicationService=e.hostCommunicationService,this.microAppLifeCycle=e.microAppLifeCycle,l$(this.store),this.performanceMeter.mark.appInitiation(),fm.create(this.logger),this.navigationMethodCalculator=new ml(this.logger);const t=new d$(this.logger,this.store);this.featureHandlerService=new g$(this.store,t),this.pluginsService=new JH(this.logger,this.runtimeParameters,this.store,this.httpClientFactory,this.featureHandlerService,this.shellConfig,this.hostCommunicationService),this.featureHandlerService.pluginService=this.pluginsService,this.runtimeRxService=new du(this.logger),this.trackingService=new Rq().create(this.runtimeParameters.childId,this.logger,this.httpClientFactory.getUbiHttpClient(),this.shellConfig,this.runtimeParameterService,this.runtimeRxService,this.shellConfig.ubiservicesApiBaseUrl,this.pluginsService),this.featureFlagsService.isFeatureEnabled(this.features,fa.AnonymousTracking)&&(this.logger.info("Anonymous tracking enabled"),this.anonymousTrackingService=new nq().create(this.runtimeParameters.childId,this.logger,this.httpClientFactory.getUbiHttpClient(),this.shellConfig,this.runtimeParameterService,this.shellConfig.ubiservicesApiBaseUrl)),this.performanceMeterTransportsProvider.trackingService=this.trackingService,this.performanceMeterTransportsProvider.metricDefinitions=this.metricDefinitions,this.kinderGarden=new Pl(this.logger,this.store,this.documentLifecycleListener,this.runtimeParameters.hostPlatformType,this.runtimeParameterService,this.featureHandlerService,this.trackingService,this.anonymousTrackingService),this.hostFeatureConfigurationService=new WH(this.store,this.logger,t,this.pluginsService,this.hostCommunicationService),this.logger.debug("Initializing focus system",{logCategory:f.initialization}),this.focusSystemService=new mm(this.focusSystemRootElement,this.focusSystemRootGroupElement,this.store,this.navigationMethodCalculator.calculate(this.runtimeParameters.platformType),this.runtimeParameters.hostPlatformType),this.appBundleUrlOverrideHelper=new BW(this.runtimeParameters.environment,(n=window==null?void 0:window.location)==null?void 0:n.href),this.playerNotificationWebSocketService=new QH(this.shellConfig.shellCrossPlatformSpaceId,this.shellConfig.shellApplicationId,this.shellConfig.ubiservicesEnvironment,this.logger,this.ubiServicesService.ubiServices,this.store),this.playerNotificationService=new n2(this.shellConfig.shellApplicationId,this.httpClientFactory),this.cacheService=new u$(this.logger),this.desktopNotificationService=zg.createIfSupported(this.runtimeParameters.childId,this.runtimeParameters.hostPlatformType,this.store,this.localizationService,this.logger),this.remoteLogsQueueInitializer=new VW(this.logger,{applicationId:this.shellConfig.shellApplicationId,applicationName:this.shellConfig.applicationName,spaceId:this.shellConfig.shellCrossPlatformSpaceId,applicationBuildId:"8.86.3"}),this.playerNotificationSubject=new EW(this.logger),this.gameInvitesSubject=new $W(this.logger),this.platformInterface=new Nq(this.logger,this.runtimeParameters,this.store,this.ubiServicesService.ubiServices,this.pluginsService,this.featureHandlerService,this.runtimeParameterService).getPlatformInterface(),this.authenticationStrategy=new yq(this.logger,this.runtimeParameters,this.store,this.ubiServicesService.ubiServices,this.featureHandlerService,this.shellConfig.shellApplicationId,this.shellConfig.connectEnvironment,this.localizationService,this.runtimeParameterService,this.hostCommunicationService,this.platformInterface).create(),this.sessionProviderService=new sq(this.logger,this.runtimeParameters,this.pluginsService,this.ubiServicesService.ubiServices.authenticationService,this.shellConfig.shellApplicationId,this.hostCommunicationService);const a=new eq(this.logger,this.runtimeParameters,this.sessionProviderService,new iq(this.logger,this.runtimeParameters,this.platformInterface,this.hostCommunicationService),this.store,this.featureFlagsService,this.features).create();a&&(this.authenticationStrategy=new an(this.logger,this.runtimeParameters,this.shellConfig.shellApplicationId,this.ubiServicesService.ubiServices.authenticationService,this.store,a)),this.placementContainersService=new VH,this.shellConfigService=new r2(this.httpClientFactory.getUbiHttpClient(),this.shellConfig.shellCrossPlatformSpaceId,this.shellConfig.shellApplicationId,this.shellConfig.configServiceEnvironment,this.shellConfig.bundleOverrideEnvironment),this.inputAggregator=new Bj(this.runtimeParameters.hostPlatformType,this.logger,this.store,this.runtimeParameters.psEnterButton),this.cumulativeLayoutShiftInstrument=new iQ(this.trackingService,this.metricDefinitions),this.interactionToNextPaintInstrument=new rQ(this.trackingService,this.metricDefinitions),this.lifeGuardService.lifeGuardFactory=new E9(this.store,this.logger,this.performanceLogger,this.placementContainersService,this.shellConfig,this.microAppLifeCycle,this.apiFactory,this.metricDefinitions,this.featureHandlerService,this.pluginsService,this.performanceMeterTransportsProvider,this.cumulativeLayoutShiftInstrument,this.interactionToNextPaintInstrument,this.hostCommunicationService,e.pcClientCommunication),this.authenticationTokenProvider=new tq(this.logger,this.runtimeParameters,this.ubiServicesService.ubiServices.profilesService,this.ubiServicesService.ubiServices.tokenService)}}var ts=(i=>(i.xbox360="360",i.xboxOne="DURANGO",i.xboxScarlett="XboxScarlett",i.ps3="PS3",i.ps4="ORBIS",i.ps5="PS5",i.switch="Switch",i.switchStreaming="Switch Streaming",i.pc="PC",i.android="Android",i))(ts||{});const Oq=["PS3","ORBIS","PS5"],Fq=["360","DURANGO","XboxScarlett"];var Lq=Object.defineProperty,Gq=Object.getOwnPropertyDescriptor,xq=(i,e,t,s)=>{for(var a=s>1?void 0:s?Gq(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Lq(e,t,a),a};const Eq=10;let OG=class extends z{constructor(e,t,s,a){super(),this._logger=e,this._gamesPlayedService=t,this._gamesService=s,this._featureHandlerService=a}async setLastPlayedGameAsHostGame(e){const t=this.getMutableState(e,S),s=this.getMutableState(e,ws),a=(await this._gamesPlayedService.v1.getMyGamesPlayed()).gamesPlayed.map((u,v)=>({playedGame:u,playOrder:v}));if(a.length===0)return;const n=a.slice(0,Eq).map(u=>u.playedGame.spaceId),r=(await this._gamesService.v1.getGamesInformation(n,t.playerLocale)).map(u=>{const v=a.find(b=>b.playedGame.spaceId===u.spaceId);return{playOrder:v?v.playOrder:1e3,...u}}),o=this.getAllowedPlatformsForLastPlayedGames(t.platformType),l=this.selectHostGame(o,t.platformType,r,a.map(u=>u.playedGame));if(l&&(await this.dispatch(e,new zo(l.spaceId)),s.hasGame(l.spaceId))){this._logger.debug("Setting last played game as host game ".concat(l.spaceId),{selectedGame:l,logCategory:f.shell});const u={applicationId:l.applicationId,spaceId:l.spaceId};t.hostGame=u,t.activeGame=u}}getAllowedPlatformsForLastPlayedGames(e){switch(e){case m.PS4:case m.PS5:return Oq;case m.XONE:case m.Scarlett:return Fq;default:return Object.values(ts)}}selectHostGame(e,t,s,a){const n=w=>e.includes(w.type),r=s.filter(w=>{var I;return w.platforms.some(n)?!0:(I=w.siblingGames)!=null&&I.length?w.siblingGames.flatMap(R=>R.platforms).some(n):!1}),o=this.getCurrentSpacePlatformType(t),l=r.flatMap(w=>{var I;let b=w.platforms.map(R=>({applicationId:R.applicationId,spaceId:w.spaceId,installmentSpaceId:w.installmentSpaceId,platformCode:R.type,played:a.some(x=>x.spaceId===w.spaceId),playOrder:w.playOrder}));return(I=w.siblingGames)!=null&&I.length&&(b=b.concat(w.siblingGames.flatMap(R=>R.platforms.map(x=>({applicationId:x.applicationId,spaceId:w.spaceId,installmentSpaceId:w.installmentSpaceId,platformCode:x.type,played:a.some(F=>F.spaceId===R.spaceId),playOrder:w.playOrder}))))),b}).filter(w=>w.played);if(!l.length)return;l.sort((w,b)=>w.playOrder-b.playOrder);const u=l.find(w=>w.platformCode===o);if(u)return{applicationId:u.applicationId,spaceId:u.spaceId};const v=l.find(w=>e.some(b=>w.platformCode===b));return v||l[0]}getCurrentSpacePlatformType(e){var s;const t={[m.PC]:ts.pc,[m.Luna]:ts.pc,[m.Steam]:ts.pc,[m.PS4]:ts.ps4,[m.PS5]:ts.ps5,[m.XONE]:ts.xboxOne,[m.Scarlett]:ts.xboxScarlett};return(s=t[e])!=null?s:t[m.PC]}};xq([h(BD)],OG.prototype,"setLastPlayedGameAsHostGame",1);var Uq=Object.defineProperty,kq=Object.getOwnPropertyDescriptor,Wq=(i,e,t,s)=>{for(var a=s>1?void 0:s?kq(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Uq(e,t,a),a};class FG extends z{constructor(e,t){super(),this._logger=e,this._gamesService=t,this._logger=e.createChild("Game.reducer"),this._logger.settings.logCategory=f.shell}async loadGameData(e,t){var r;const s=t.spaceId,a=this.getMutableState(e,ws);if(a.hasGame(s))return;const n=this.getReadOnlyState(e,S);try{const o=n.playerLocale,l=await this._gamesService.v1.getGamesInformation([s],o),u=l?l.find(w=>w.spaceId===s):void 0,v={spaceId:s,displayName:(u==null?void 0:u.displayName)||"",logoUrl:((r=u==null?void 0:u.imageUrls)==null?void 0:r.gameAvatar)||""};this._logger.debug("Loaded game info for ".concat(t.spaceId," as ").concat(v.displayName),{gameData:v,logCategory:f.configuration}),a.addGame(v)}catch(o){this._logger.warn("Failed to load game for ".concat(t.spaceId),{errorCode:g.FailedToLoadGameForSpaceIDWarning,error:o})}}}Wq([h(zo)],FG.prototype,"loadGameData",1);const Um=class Um{};Um.gameLaunch="gameLaunch";let Eu=Um;var Vq=Object.defineProperty,$q=Object.getOwnPropertyDescriptor,En=(i,e,t,s)=>{for(var a=s>1?void 0:s?$q(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Vq(e,t,a),a};const Bq=15e3;class Na extends z{constructor(e,t,s,a){super(),this._logger=e,this._spacesService=t,this._featureHandlerService=s,this._kinderGarden=a,this._gamelaunchTimeoutId=void 0,this._logger=this._logger.createChild("GameLaunch.reducer"),this._logger.settings.logCategory=Eu.gameLaunch}async initializeGameLaunchWindow(e,t){const s=this.getReadOnlyState(e,S),a=gn.GameLaunch,n=s.hostGame,r=null;try{if(await this.dispatch(e,new Ci(a,n,r))){const l={...t.info,...t.options};return await this.dispatch(e,new Be({appName:a,game:n,parentAppName:r,applicationData:l}))?!0:(this._logger.warn("Could not navigate to game launch window for game ".concat(n.spaceId),{errorCode:g.FailedNavigationForGameLaunchWarning,game:n}),!1)}else return this._logger.warn("Game launch window is not available for game ".concat(n.spaceId),{errorCode:g.GameLunchWindowUnavailableWarning,game:n}),!1}catch(o){return this._logger.warn("Failed to navigate to shell app: ".concat(a),{errorCode:g.FailedNavigationWarning,error:o}),!1}}async initializeGameLaunch(e,t){const s=this.getMutableState(e,cs);if(s.gameLaunchInformation){this._logger.warn("There is already a game launching with id: ".concat(s.gameLaunchInformation.info.productId),{errorCode:g.GameAlreadyRunningWarning});return}const a=RS(t);if(!a.info.applicationId||!a.info.spaceId){if(!a.info.productId){this._logger.warn("Game launch aborted, because product id is missing in: ".concat(JSON.stringify(a.info)),{errorCode:g.GameLaunchMissingProductIDWarning}),s.hasError=!0;return}const n=await this._kinderGarden.requestGameEntitlement(a.info.productId);if(!n){this._logger.warn("Game launch aborted, because the user does not have entitlement for product with id: ".concat(a.info.productId,"."),{gameEntitlement:n,errorCode:g.GameLaunchMissingEntitlementWarning}),s.hasError=!0;return}a.info=Object.assign(a.info,{applicationId:n.applicationId,spaceId:n.spaceId})}return s.gameLaunchInformation=a,this.dispatch(e,new sL(a.info,a.options))}async launchGame(e,t){var n;const s=await this._featureHandlerService.handleFeature(c.GameLaunch,t),a=((n=s==null?void 0:s.response)==null?void 0:n.isSuccessful)===!0;if(a)this.startGameLaunchTimer(e);else{const r=this.getMutableState(e,cs);r.hasError=!0}return a}async closeLaunchGameWindow(e,t){this.getReadOnlyState(e,S).childId&&this.dispatch(e,new Gt(t.closeReason)),clearTimeout(this._gamelaunchTimeoutId)}async getGameLaunchContent(e,t){const s=this.getMutableState(e,cs);if(!s.gameLaunchSpaceCard||s.gameLaunchSpaceCard.spaceId!==t.spaceId){const a=await this._spacesService.v1.getSpaceCard(t.spaceId,t.localeCode);return s.gameLaunchSpaceCard=a,a}return s.gameLaunchSpaceCard}async gameLaunched(e,t){var a;clearTimeout(this._gamelaunchTimeoutId);const s=this.getReadOnlyState(e,cs);if(s.gameLaunchInformation&&((a=s.gameLaunchInformation)==null?void 0:a.info.productId)===t.info.productId)switch(t.launchState){case zm.Launched:case zm.GameEnd:return this.dispatch(e,new nL(_e.GameLaunched));default:this.startGameLaunchTimer(e)}}startGameLaunchTimer(e){clearTimeout(this._gamelaunchTimeoutId),this._gamelaunchTimeoutId=window.setTimeout(()=>{const t=this.getMutableState(e,cs);t.hasError=!0},Bq)}}En([h(r9)],Na.prototype,"initializeGameLaunchWindow",1);En([h(iL)],Na.prototype,"initializeGameLaunch",1);En([h(sL)],Na.prototype,"launchGame",1);En([h(nL)],Na.prototype,"closeLaunchGameWindow",1);En([h(rL)],Na.prototype,"getGameLaunchContent",1);En([h(aL)],Na.prototype,"gameLaunched",1);var Hq=Object.defineProperty,Qq=Object.getOwnPropertyDescriptor,ym=(i,e,t,s)=>{for(var a=s>1?void 0:s?Qq(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Hq(e,t,a),a};class zl extends z{constructor(e,t){super(),this._featureHandlerService=e,this._pluginsService=t}async getRunningGames(e,t){const s=await this._featureHandlerService.handleFeatureWithoutPayload(c.GetRunningGames),a=s==null?void 0:s.response.productIds;if(a!=null&&a.length){const n=this.getReadOnlyState(e,An);return a.map(r=>{const o=n.getGameEntitlement(r);if(o)return{applicationId:o.applicationId,spaceId:o.spaceId,productId:r}}).filter(ft)}}async handleLegacyRunningGameUpdate(e){const t=this._pluginsService.getApi(ee.GameManagementWip);if(t){const s=this.getMutableState(e,zi);s.runningGames=await t.getRunningGames(),t.onRunningGameUpdate.subscribe(async a=>{a.isRunning?s.addRunningGame(a.gameInfo):s.removeRunningGame(a.gameInfo)})}}async addRunningGame(e,t){this.getMutableState(e,zi).addRunningGame(t.gameInfo)}}ym([h(nB)],zl.prototype,"getRunningGames",1);ym([h(PL)],zl.prototype,"handleLegacyRunningGameUpdate",1);ym([h(NL)],zl.prototype,"addRunningGame",1);var jq=Object.defineProperty,qq=Object.getOwnPropertyDescriptor,vm=(i,e,t,s)=>{for(var a=s>1?void 0:s?qq(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&jq(e,t,a),a};class Kl extends z{constructor(e,t){super(),this._logger=e,this._featureHandlerService=t}async initializeProductUninstallWindow(e,t){return!0}async initializeProductUninstall(e,t){const s=this.getMutableState(e,zr);return s.gameInfo=t.gameInfo,this.dispatch(e,new lL(t.gameInfo)),!0}async productUninstall(e,t){var a;const s=await this._featureHandlerService.handleFeature(c.ProductUninstall,t);return((a=s==null?void 0:s.response)==null?void 0:a.isSuccessful)===!0}}vm([h(M9)],Kl.prototype,"initializeProductUninstallWindow",1);vm([h(cL)],Kl.prototype,"initializeProductUninstall",1);vm([h(lL)],Kl.prototype,"productUninstall",1);var zq=Object.defineProperty,Kq=Object.getOwnPropertyDescriptor,LG=(i,e,t,s)=>{for(var a=s>1?void 0:s?Kq(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&zq(e,t,a),a};class _m extends z{constructor(e,t){super(),this._runtimeParameters=e,this._tokenProvider=t}async setTokenizedCredentials(e,t){const s=this.getMutableState(e,cc),a=_g(this._runtimeParameters);try{switch(a){case ve.LateSignOn:await this.setLateSignOnCredentials(s,t.session);break;case ve.LoginOnly:await this.setLoginOnlyCredentials(s,t.session);break;default:return}}catch(n){const r=n.info;return this.dispatch(e,new Sg(r))}}async setLoginOnlyCredentials(e,t){e.profileId=t.profileId;const s=await this._tokenProvider.generateToken(t.profileId,this._runtimeParameters.ticket||t.ticket,{profileId:t.profileId,rememberMeTicket:t.rememberMeTicket,ticket:t.ticket,nameOnPlatform:t.nameOnPlatform},PS.Limited);this.setToken(e,s)}async setLateSignOnCredentials(e,t){const s=await this._tokenProvider.getRoamingProfile(t.ticket,t.sessionId);if(s.roamingProfiles.length===0||!s.roamingProfiles[0])return e.updatedAuthenticationFlow=ve.LoginOnly,this.setLoginOnlyCredentials(e,t);const a=s.roamingProfiles[0].profileId,n=await this._tokenProvider.getTicketProfileId(this._runtimeParameters.ticket),r=await this._tokenProvider.generateToken(n,this._runtimeParameters.ticket,{profileId:a,rememberMeTicket:t.rememberMeTicket});this.setToken(e,r)}setToken(e,t){e.token=t,e.errorInfo=null}async setAuthenticationErrorInfo(e,t){const s=this.getMutableState(e,cc);s.errorInfo=t.errorInfo}}LG([h(pO)],_m.prototype,"setTokenizedCredentials",1);LG([h(Sg)],_m.prototype,"setAuthenticationErrorInfo",1);var Xq=Object.defineProperty,Jq=Object.getOwnPropertyDescriptor,Ri=(i,e,t,s)=>{for(var a=s>1?void 0:s?Jq(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Xq(e,t,a),a};class di extends z{constructor(e,t,s){super(),this._gameInviteSubject=e,this._featureHandlerService=t,this._runtimeParameters=s}async sendGameInviteEvent(e,t){var a;const s={profileIdsToInvite:[t.profileId],gameSession:{gameSpaceId:t.gameId.spaceId,applicationId:t.gameId.applicationId,gameSessionId:t.gameSessionReference}};return(a=await this._featureHandlerService.handleFeature(c.SendGameInviteEvent,s))!=null?a:!1}async sendChannelGameInviteEvent(e,t){var s;return(s=await this._featureHandlerService.handleFeature(c.SendChannelGameInviteEvent,{channelId:t.channelId}))!=null?s:!1}async acceptGameInviteEvent(e,t){const s={inviterProfileId:t.profileId,gameSession:{applicationId:t.gameId.applicationId,gameSpaceId:t.gameId.spaceId,gameSessionId:t.gameSessionReference}},a=await this._featureHandlerService.handleFeature(c.AcceptGameInviteEvent,s);return a&&this.needToCloseOverlay()&&this.dispatch(e,new Gt(_e.GameInviteAccepted)),a!=null?a:!1}async declineGameInviteEvent(e,t){var a;const s={inviterProfileId:t.profileId,gameSession:{applicationId:t.gameId.applicationId,gameSpaceId:t.gameId.spaceId,gameSessionId:t.gameSessionReference}};return(a=await this._featureHandlerService.handleFeature(c.DeclineGameInviteEvent,s))!=null?a:!1}async getCurrentGameInviteEvents(){var e;return(e=await this._featureHandlerService.handleFeatureWithoutPayload(c.GetCurrentGameInviteEvents))!=null?e:[]}async subscribeToGameInviteEvents(e,t){this._gameInviteSubject.subscribe(t.spaceId,t.callback)}async unsubscribeFromGameInviteEvents(e,t){this._gameInviteSubject.unsubscribe(t.spaceId)}async receiveGameInviteNotification(e,t){const s={profileId:t.notification.inviterProfileId,gameId:{applicationId:t.notification.gameSession.applicationId,spaceId:t.notification.gameSession.gameSpaceId},gameSessionReference:t.notification.gameSession.gameSessionId,state:t.notification.state};this.dispatch(e,new aF(s))}async receiveGameInviteEvents(e,t){this._gameInviteSubject.notifyGameInvite(t.gameInvite)}async joinGame(e,t){const s={profileIdToJoin:t.profileId,gameSession:{applicationId:t.gameId.applicationId,gameSpaceId:t.gameId.spaceId,gameSessionId:t.gameSessionReference}},a=await this._featureHandlerService.handleFeature(c.JoinGame,s);return a&&this.needToCloseOverlay()&&this.dispatch(e,new Gt(_e.GameJoined)),a!=null?a:!1}async getGameSession(e,t){const s=await this._featureHandlerService.handleFeatureWithoutPayload(c.GetGameSession);return s==null?void 0:s.response.session}needToCloseOverlay(){return![p.PCWebClient,p.PCLegacyClient,p.PCElectronClient,p.SteamClient].includes(this._runtimeParameters.hostPlatformType)}}Ri([h(Og)],di.prototype,"sendGameInviteEvent",1);Ri([h(JO)],di.prototype,"sendChannelGameInviteEvent",1);Ri([h(YO)],di.prototype,"acceptGameInviteEvent",1);Ri([h(ZO)],di.prototype,"declineGameInviteEvent",1);Ri([h(eF)],di.prototype,"getCurrentGameInviteEvents",1);Ri([h(tF)],di.prototype,"subscribeToGameInviteEvents",1);Ri([h(iF)],di.prototype,"unsubscribeFromGameInviteEvents",1);Ri([h(sF)],di.prototype,"receiveGameInviteNotification",1);Ri([h(aF)],di.prototype,"receiveGameInviteEvents",1);Ri([h(nF)],di.prototype,"joinGame",1);Ri([h(rF)],di.prototype,"getGameSession",1);var Yq=Object.defineProperty,Zq=Object.getOwnPropertyDescriptor,ct=(i,e,t,s)=>{for(var a=s>1?void 0:s?Zq(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Yq(e,t,a),a};class Ye extends z{constructor(e,t,s,a,n,r,o,l,u,v,w,b,I){super(),this._logger=e,this._ubiServicesService=t,this._trackingService=s,this._lifeGuardService=a,this._platformInterface=n,this._featureHandlerService=r,this._cacheService=o,this._metricDefinitions=l,this._pluginsService=u,this._apiFactory=v,this._store=w,this._anonymousTrackingService=b,this._connectServices=I,this._logger=this._logger.createChild("Api.reducer"),this._logger.settings.logCategory=f.api}async requestAvailableMicroApps(e,t){var s,a,n;try{await this.dispatch(e,new tn((s=t.game)==null?void 0:s.spaceId,(a=t.game)==null?void 0:a.applicationId));const r=this.getReadOnlyState(e,M),o=this.getReadOnlyState(e,S);return(t.game===void 0?r.findMicroAppConfigsByGameSpace(o.hostGame.spaceId,null):r.findMicroAppConfigsByGameSpace(t.game.spaceId,J.AppGamePage)).map(u=>({appName:u.appName,meta:u.meta}))}catch(r){const o="Failed to retrieve available micro apps for space: ".concat((n=t.game)==null?void 0:n.spaceId);return this._logger.warn(o,{error:r,errorCode:g.FailedLoadOfMicroappsWarning}),Promise.reject(o)}}async getAvailableMicroApps(e,t){var r,o;const s=this.getReadOnlyState(e,S),a=t.options.game,n=a===void 0?s.hostGame.spaceId:a.spaceId;try{return await this.dispatch(e,new tn((r=t.options.game)==null?void 0:r.spaceId,(o=t.options.game)==null?void 0:o.applicationId)),this.getReadOnlyState(e,M).findMicroAppConfigsByGameSpace(n,t.options.parentAppName).map(v=>({appName:v.appName,meta:v.meta,parentAppName:v.parentAppName,isHidden:v.isHidden}))}catch(l){const u="Failed to retrieve available micro apps for space: ".concat(n," and parentAppName: ").concat(t.options.parentAppName);return this._logger.warn(u,{error:l,errorCode:g.FailedLoadOfMicroappsWarning}),Promise.reject(u)}}async requestIsAppAvailable(e,t){var a;const s=this.getReadOnlyState(e,M);if(((a=s.authenticationApplicationConfig)==null?void 0:a.appName)===t.appName)return!0;try{return await this.dispatch(e,new tn(t.game.spaceId,t.game.applicationId)),!!s.findMicroAppConfig(t.appName,t.parentAppName,t.game.spaceId)}catch(n){const r="Failed to retrieve availability of ".concat(t.appName," in space ").concat(t.game.spaceId);return this._logger.warn(r,{error:n,errorCode:g.FailedAvailablityOfMicroappWarning}),Promise.reject(r)}}async releaseFocus(e,t){const a=this.getReadOnlyState(e,M).getActiveMicroApp(t.appConfig.placement),n={spaceId:t.appConfig.spaceId,appName:t.appConfig.appName,currentMicroAppSpaceId:a==null?void 0:a.spaceId,currentMicroAppName:a==null?void 0:a.appName};if((a==null?void 0:a.spaceId)===t.appConfig.spaceId){const r=this.getReadOnlyState(e,ye);r.currentlyFocusedContainerId===t.appConfig.placement?await this.dispatch(e,new oG(t.direction)):this._logger.debug("Releasing of focus ignored since micro app container is not focused",{containerFocusId:r.currentlyFocusedContainerId,logInfo:n})}else this._logger.debug("Releasing of focus from non active micro app ignored",{logInfo:n})}async reportFatalError(e,t){var r;const s=t.error instanceof Error?t.error:void 0;this._logger.error("Micro application ".concat(t.appConfig.appName," reported fatal error"),{appConfig:t.appConfig,error:s,logSource:t.appConfig.appName,errorCode:g.ApiReportFatalError});const a=t.error instanceof Error?t.error.message:t.error;(r=this._metricDefinitions)==null||r.getMetric(Ae.UAppFatalError).add(1,{appName:t.appConfig.appName});const n={text:a,error:s,appConfig:t.appConfig};await this._featureHandlerService.handleFeature(c.ReportFatalError,n)}async reportShellFatalError(e,t){var a;const s=this.getMutableState(e,Q);s.isAccountLinkingInProgress=!1,await this.dispatch(e,new ji({message:"error.generic"},(a=t.appConfig)==null?void 0:a.placement))}async reportFatalPluginError(e,t){this._logger.warn("Shell plugin ".concat(t.pluginConfig.name," reported fatal error"),{category:f.shellPlugin,...t,errorCode:g.ShellPluginFatalErrorWarning})}async getRevocableUbiServices(e,t){const s=this._lifeGuardService.getApplicationId(t.appConfig);return this._ubiServicesService.getRevocableUbiServices(s)}async getRevocableUbiServicesByApplicationId(e,t){return this._ubiServicesService.getRevocableUbiServices(t.applicationId)}async getConnectServices(){return this._connectServices}async sendDnaEvent(e,t){var s;if(t.eventData){const a=["microAppAppId","microAppId","microAppVersion","version"],n=t.eventData;a.forEach(r=>delete n[r])}if(t.eventName.toLowerCase().startsWith("visitor"))return(s=this._anonymousTrackingService)==null?void 0:s.sendEvent(t.eventName,t.applicationConfig,t.eventData);this._trackingService.sendEvent(t.eventName,t.applicationConfig,t.eventData)}async sendShellDnaEvent(e,t){this._trackingService.sendEvent(t.eventName,t.eventData)}async sendAdobeEvent(e,t){this._featureHandlerService.handleFeature(c.SendAdobeAnalyticData,{eventName:t.eventName,data:t.eventData||{}})}async getCache(e,t){var a;const s=(a=this.getReadOnlyState(e,S).playerSession)==null?void 0:a.profileId;return s?t.shared?this._cacheService.getSharedCache(t.cacheType,s):this._cacheService.getCache(t.cacheType,t.spaceId,s):(this._logger.warn("ProfileId not available when requesting Apollo cache. Not returing a CacheProvider."),Promise.resolve(void 0))}async getImage(e,{imageType:t}){var s;try{const a=await this._featureHandlerService.handleFeature(c.GetImage,new nS({imageType:t}));if(!((s=a==null?void 0:a.response)!=null&&s.isSuccessful))this._logger.warn("Failed to get image. Request timed out",{errorCode:g.FailedToGetImageWarning});else return a.response}catch(a){this._logger.warn("Retrieval of image request failed with error",{error:a,errorCode:g.FailedToGetImageWarning})}}async getApi(e,t){return new Proxy(new eL(this._store,t.appName,t.spaceId,t.applicationId,this._logger,this._pluginsService,this._featureHandlerService,void 0),new mr(this._pluginsService))}}ct([h(ms)],Ye.prototype,"requestAvailableMicroApps",1);ct([h(dO)],Ye.prototype,"getAvailableMicroApps",1);ct([h(Ci)],Ye.prototype,"requestIsAppAvailable",1);ct([h(hO)],Ye.prototype,"releaseFocus",1);ct([h(gO)],Ye.prototype,"reportFatalError",1);ct([h(mO)],Ye.prototype,"reportShellFatalError",1);ct([h(fO)],Ye.prototype,"reportFatalPluginError",1);ct([h(yO)],Ye.prototype,"getRevocableUbiServices",1);ct([h(wg)],Ye.prototype,"getRevocableUbiServicesByApplicationId",1);ct([h(vO)],Ye.prototype,"getConnectServices",1);ct([h(_O)],Ye.prototype,"sendDnaEvent",1);ct([h(hr)],Ye.prototype,"sendShellDnaEvent",1);ct([h(SO)],Ye.prototype,"sendAdobeEvent",1);ct([h(wO)],Ye.prototype,"getCache",1);ct([h(bO)],Ye.prototype,"getImage",1);ct([h(CO)],Ye.prototype,"getApi",1);var ez=Object.defineProperty,tz=Object.getOwnPropertyDescriptor,Un=(i,e,t,s)=>{for(var a=s>1?void 0:s?tz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&ez(e,t,a),a};class Ta extends z{constructor(e,t,s,a,n,r){super(),this._logger=e,this._runtimeParametersService=t,this._versionRedirectionService=s,this._localStorageService=a,this._featureServiceHandler=n,this._pluginService=r,this._logger=this._logger.createChild("AuthenticationApi.reducer"),this._logger.settings.logCategory=f.api}async redirectToThirdPartyAuthenticationPage(e,t){new Pd(this._localStorageService).saveAuthenticationData(t.data,t.callbackParameterName,t.multipleParametersNames);const a=window.location.pathname;this._runtimeParametersService.saveToLocalStorage(),this._versionRedirectionService.saveShellVersion(a),window.location.replace(t.url)}async setFirstPartyAuthenticationToken(e,t){const s={loginData:{token:t.token,platform:t.platformType}};await this._featureServiceHandler.handleFeature(c.FirstPartyLogin,s)}async setAuthenticationError(e,t){var a,n;const s=this.getReadOnlyState(e,S);if([p.Android,p.IOS,p.Mobile,p.MacOS].includes(s.hostPlatformType)){let r=null;return t.errorMessage&&(r={code:((n=(a=t.errorContext)==null?void 0:a.httpStatusCode)==null?void 0:n.toString())||"",message:t.errorMessage}),t.errorContext&&(r=Object.assign(r!=null?r:{},{context:t.errorContext})),this.dispatch(e,new Sg(r))}}async getAuthApi(){return this._pluginService.getApi(ee.AuthenticationApi)}async verifyUserCredentials(e,t){var n,r;const s={email:t.email,password:t.password,profileId:t.profileId},a=await this._featureServiceHandler.handleFeature(c.VerifyUserCredentials,s);return{isSuccess:((n=a==null?void 0:a.response)==null?void 0:n.isSuccess)||!1,errorCode:(r=a==null?void 0:a.response)==null?void 0:r.errorCode}}async getConnectPlatformAuthToken(){var t,s,a,n;let e;try{e=await this._featureServiceHandler.handleFeatureWithoutPayload(c.GetConnectPlatformAuthToken)}catch(r){this._logger.warn("Failed to get connect platform auth token, cause: ".concat(r))}return{platformToken:(s=(t=e==null?void 0:e.response)==null?void 0:t.platformToken)!=null?s:"",platformType:(n=(a=e==null?void 0:e.response)==null?void 0:a.platformType)!=null?n:Fp.Uplay}}}Un([h(ru)],Ta.prototype,"redirectToThirdPartyAuthenticationPage",1);Un([h(nO)],Ta.prototype,"setFirstPartyAuthenticationToken",1);Un([h(rO)],Ta.prototype,"setAuthenticationError",1);Un([h(oO)],Ta.prototype,"getAuthApi",1);Un([h(cO)],Ta.prototype,"verifyUserCredentials",1);Un([h(lO)],Ta.prototype,"getConnectPlatformAuthToken",1);var Uu=(i=>(i.ConfigNotificationPositions="ubiConnect-configNotificationPositions",i))(Uu||{});class Lt extends oe("[Shell] Modal State"){constructor(){super(...arguments),this._isVisible=!1,this._shouldCloseOnClickBackdrop=!0,this._currentMicroApp="",this._loadingSpinner=!1,this._isModalFullView=!1,this._viewportPosition=null,this._onModalClose=null}get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e}set shouldCloseOnClickBackdrop(e){this._shouldCloseOnClickBackdrop=e}get shouldCloseOnClickBackdrop(){return this._shouldCloseOnClickBackdrop}get onModalClose(){return this._onModalClose}set onModalClose(e){this._onModalClose=e}get currentMicroApp(){return this._currentMicroApp}set currentMicroApp(e){this._currentMicroApp=e}get loadingSpinner(){return this._loadingSpinner}set loadingSpinner(e){this._loadingSpinner=e}get isModalFullView(){return this._isModalFullView}set isModalFullView(e){this._isModalFullView=e}get viewportPosition(){return this._viewportPosition}set viewportPosition(e){this._viewportPosition=e}}class lc extends d("[Shell] Unobserve MicroApp Scrollable Container"){constructor(e){super(),this.microAppConfig=e}}var Oo=(i=>(i.FeatureFlags="connect-featureFlags",i))(Oo||{}),sa=(i=>(i.ServiceUrls="ubiConnect-serviceUrls",i.FeedbackConfig="ubiConnect-feedbackConfig",i))(sa||{}),GG=(i=>(i.MetricCategories="connect-metricCategory",i))(GG||{}),iz=Object.defineProperty,sz=Object.getOwnPropertyDescriptor,me=(i,e,t,s)=>{for(var a=s>1?void 0:s?sz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&iz(e,t,a),a};class he extends z{constructor(e,t,s,a,n,r,o,l,u,v,w){super(),this._logger=e,this._platformInterface=t,this._trackingService=s,this._parametersService=a,this._shellConfig=n,this._populationsService=r,this._featureHandlerService=o,this._pluginsService=l,this._lifeguardService=u,this._placementContainerService=v,this._hostCommunicationService=w,this._logger=e.createChild("Application.reducer"),this._logger.settings.logCategory=f.shell}async sendInitialOverlayReadyNotifications(){await this._featureHandlerService.handleFeature(c.ReportAppInformation,{version:"8.86.3"}),await this._featureHandlerService.handleFeatureWithoutPayload(c.OverlayIsReady)}async onShowOverlay(e){const t=this.getMutableState(e,S);return t.isOverlayVisible?!1:(t.isOverlayVisible=!0,this._logger.debug("Showing Overlay"),this._featureHandlerService.handleFeatureWithoutPayload(c.OverlayIsVisible),this.dispatch(e,new Od),!0)}async setNavigationBarVisibility(e,t){const s=this.getMutableState(e,Q);s.isNavigationBarVisible=t.isNavigationBarVisible}async closeOverlay(e,t){const s=this.getMutableState(e,S),a=s.platformType,n=this.getReadOnlyState(e,Q),r=this.getReadOnlyState(e,$e),o=this.getReadOnlyState(e,Lt),l=r.getShellError()===void 0?t.reason:_e.FatalError;this._logger.debug("Closing Overlay",{platform:a,reason:l});const u=[p.PS4Aegir,p.PS4AegirNative,p.PS5Aegir,p.PS5AegirNative,p.XOneAegir,p.XOneAegirNative,p.ScarlettAegir,p.ScarlettAegirNative,p.MacOSAegir,p.MacOSAegirNative].includes(s.hostPlatformType);if([m.PC,m.Luna,m.Steam].includes(a)&&!s.isOverlayVisible||u){u&&(this.dispatch(e,new ar(l)),s.isOverlayVisible=!1),this._platformInterface.closeOverlay();return}if(this.closingNotAllowed(s,n,l)){this._logger.debug("Closing is not allowed, forced account linking in progress",{platform:a,reason:l});return}o.isVisible&&await this.dispatch(e,new qi);const v=this._platformInterface.requiresDeactivation();if(v){const w=await this.dispatch(e,new sn(!0));if(l===_e.User&&!w){this._logger.warn("Closing is cancelled, not able to deactivate microApps",{platform:a,reason:l,errorCode:g.FailedDeactivationOfMicroappWarning});return}this.getMutableState(e,Y).saveAllHistory()}if(t.shouldSendTrackingEvent){this.dispatch(e,new ar(l));const w=q(Ls,this._trackingService.flush()).catch(b=>{this._logger.warn("Error sending final events",{error:b,errorCode:g.FailedDNATrackingEventWarning})});![m.Luna,m.PC,m.Steam].includes(a)&&v&&(await Promise.all(Object.values(B).map(b=>this.setMicroAppSpinnerVisibility(e,new Hi(!0,b)))),await w,await Promise.all(Object.values(B).map(b=>this.setMicroAppSpinnerVisibility(e,new Hi(!1,b)))))}switch(![m.Luna,m.PC,m.Steam].includes(a)&&v&&await this.dispatch(e,new jo),a){case m.Mobile:case m.Android:case m.IOS:case m.PS4:case m.PS5:case m.XONE:case m.Scarlett:case m.ScarlettUWP:case m.PC:case m.Luna:case m.Steam:case m.MacOS:case m.Switch:v&&(s.isOverlayVisible=!1,await this.dispatch(e,new Ka(!1))),await this._platformInterface.closeOverlay();break;default:this._logger.warn("Closing of overlay was requested for unsupported platform.",{platform:a,errorCode:g.ClosingOverlayForUnsupportedPlatformWarning})}}async updateMicroAppContainer(e,t){const s=this.getReadOnlyState(e,M),{placement:a,newContainer:n}=t,r=s.getActiveMicroApp(a);r&&(await this.dispatch(e,new Vr(!1,r)),this._lifeguardService.unmount(r),await this.dispatch(e,new hn(r)),await this.dispatch(e,new lc(r))),n?this._placementContainerService.setMicroAppContainer({placement:a,value:n}):this._placementContainerService.removeMicroAppContainer(a)}async setLayoutMounted(e,t){const s=this.getMutableState(e,Q);s.isLayoutMounted=t.isMounted}async setIsNoConnectionViewVisible(e,t){const s=this.getMutableState(e,Q),{placement:a,isNoConnectionViewVisible:n}=t;s.setIsNoConnectionViewVisible({placement:a,value:n})}async setMicroAppSpinnerVisibility(e,t){const s=this.getMutableState(e,Q),{placement:a,isSpinnerVisible:n}=t;s.setIsMicroAppSpinnerVisible({placement:a,value:n})}async setAccountLinkingInProgress(e,t){const s=this.getMutableState(e,Q);this._logger.debug("Set account linking in progress: ".concat(t.isInProgress)),s.isAccountLinkingInProgress=t.isInProgress,await this.dispatch(e,new Qi)}async resumeOverlay(e){const t=this.getMutableState(e,S),s=this.getMutableState(e,M),a=this.getReadOnlyState(e,Y);t.isOverlayVisible||(this._logger.debug("Resuming overlay"),t.isOverlayVisible=!0),await Promise.all(Es[t.layoutType].map(async n=>{!s.getActiveMicroApp(n)&&a.hasItems(n)&&(await this.dispatch(e,new gs(n))||(this._logger.error("Not able to resume overlay and reactivate micro app in ".concat(n),{errorCode:g.ApplicationResumeOverlayError}),await this.dispatch(e,new ji({message:"error.generic"}))))}))}async loadConfigurationParameters(e){var s,a,n;const t=this.getReadOnlyState(e,S);try{const r=await q(bi,this.getPopulations()),o=await q(bi,this._parametersService.v1.getSpaceParametersWithAuthentication(this._shellConfig.shellCrossPlatformSpaceId,r,[Uu.ConfigNotificationPositions,sa.ServiceUrls,sa.FeedbackConfig,Km.clientRemoteLogsGame]));if(!o){this._logger.warn("Fail to query shell space parameters. Empty response",{category:f.configuration,errorCode:g.FailedQueryShellSpaceParametersWarning});return}const l=this.getNotificationPosition(o,t.hostGame),u=this.getMutableState(e,Q);l&&(u.notificationPosition=l);const v=this.getMutableState(e,Ii),w=(s=o.parameters[sa.ServiceUrls])==null?void 0:s.fields;w&&(v.serviceUrls=w);const b=(a=o.parameters[Km.clientRemoteLogsGame])==null?void 0:a.fields;b&&(v.remoteLogs=b);const I=(n=o.parameters[sa.FeedbackConfig])==null?void 0:n.fields;I&&(u.feedbackButtonUrl=I.feedbackButtonUrl),this.getLegacyClientConfiguration(r,e),this._featureHandlerService.handleFeatureWithoutPayload(c.GetServiceDegradationState).then(R=>{u.showServiceDegradationBanner=(R==null?void 0:R.response.isDegraded)||!1})}catch(r){this._logger.warn("Fail to query shell space parameters",{error:r,errorCode:g.FailedQueryShellSpaceParametersWarning,logCategory:f.configuration})}}async loadFeedbackUrlParameters(e){var s;const t=this.getMutableState(e,Q);if(t.feedbackButtonUrl)return t.feedbackButtonUrl;try{const a=await q(bi,this._parametersService.v1.getSpaceParametersWithoutAuthentication(this._shellConfig.shellCrossPlatformSpaceId,[],[sa.FeedbackConfig]));if(!a){this._logger.warn("Fail to query shell space parameters. Empty response",{category:f.configuration,errorCode:g.FailedQueryShellSpaceParametersWarning});return}const n=this.getMutableState(e,Q),r=(s=a.parameters[sa.FeedbackConfig])==null?void 0:s.fields;if(r)return n.feedbackButtonUrl=r.feedbackButtonUrl,r.feedbackButtonUrl}catch(a){this._logger.warn("Fail to query shell space parameters",{error:a,errorCode:g.FailedQueryShellSpaceParametersWarning,logCategory:f.configuration})}}async reportAppInitializationFailure(e,t){var a;const s=(a=t.error)!=null?a:{message:"error.generic"};return this.dispatch(e,new ji(s,B.main))}async applicationInitializationCompleted(e,t){const s=this.getMutableState(e,Q);s.initializationCompleted=!0,this._logger.info("Application initialization completed")}async getPopulations(){var e,t;try{const s=await this._populationsService.v1.getPopulations([this._shellConfig.shellCrossPlatformSpaceId,this._shellConfig.legacyClientSpaceId]);return(t=(e=s==null?void 0:s.populations)==null?void 0:e.map(a=>"".concat(a.subject,".").concat(a.name)))!=null?t:[]}catch(s){return this._logger.warn("An error occurred while fetching populations. Default populations will be used",{error:s,logCategory:f.configuration}),[]}}async getLegacyClientConfiguration(e,t){var a;const s=this.getReadOnlyState(t,S);if([p.PCLegacyClient,p.SteamClient].includes(s.hostPlatformType))try{const n=await q(bi,this._parametersService.v1.getSpaceParametersWithAuthentication(this._shellConfig.legacyClientSpaceId,e,[Oo.FeatureFlags,GG.MetricCategories])),r=this.getMutableState(t,Ii);if(r.legacyClientParameters=n,n.parameters[Oo.FeatureFlags]){const o=this.getMutableState(t,Q),l=(a=n==null?void 0:n.parameters[Oo.FeatureFlags])==null?void 0:a.fields.connectOldUIDecommissionedCountryAllowList;o.isLegacyUIDecommissioned=Array.isArray(l)?l.includes(s.country.toUpperCase())||l.includes("all"):!1}else this._logger.warn("Failed to get legacy client feature flags. Can't determine beta status.",{category:f.configuration,errorCode:g.FailedDetermineBetaStatusWarning})}catch(n){this._logger.warn("Fail to query legacy client configuration",{error:n,errorCode:g.FailedQueryLegacyClientFeatureParametersWarning,logCategory:f.configuration})}}getNotificationPosition(e,t){var o,l,u;if(!e)return;const s=(o=e.parameters[Uu.ConfigNotificationPositions])==null?void 0:o.fields;if(!s)return;let a;const n=v=>v.spaceId===t.spaceId&&v.applicationId===t.applicationId,r=v=>v.spaceId===t.spaceId;if(Array.isArray(s.overrides)&&(a=(l=s.overrides.find(n))==null?void 0:l.notificationPosition,a||(a=(u=s.overrides.find(r))==null?void 0:u.notificationPosition)),a||(a=s.default),a&&Object.values(ra).includes(a))return a}closingNotAllowed(e,t,s){return!e.isMobileGameOverlay&&t.isAccountLinkingInProgress&&![_e.FatalError,_e.HardwareBack].includes(s)}async updateIsOfflineSession(e,t){const s=this.getMutableState(e,S);return s.isOfflineSession=t.isOfflineSession,this.dispatch(e,new JR(!t.isOfflineSession))}async sessionExpired(e,t){const s=this.getMutableState(e,Q);t.state&&!s.showExpiredSessionBanner&&this.getMutableState(e,S).clearAuthIsDone(),s.showExpiredSessionBanner=t.state}async hideOfflineNotification(e){const t=this.getMutableState(e,Q);t.showOfflineNotification=!1}async apiUpdated(){return this._pluginsService.updateApi(),this._lifeguardService.updateApi()}async notifyContentScrolled(e,t){return this.dispatch(e,new Nl(t.event))}async requestLogout(e){await this.hasActiveGameOrDownload(e)?this.dispatch(e,new un(fs.Logout)):this.dispatch(e,new Ca)}async requestQuit(e){await this.hasActiveGameOrDownload(e)?this.dispatch(e,new un(fs.Quit)):this.dispatch(e,new cg)}async hasActiveGameOrDownload(e){const{hasRunningGames:t}=this.getReadOnlyState(e,zi);return t?!0:this.hasActiveDownload()}async hasActiveDownload(){const e=this._pluginsService.getApi(ee.GameManagementWip);if(e){const t=await e.getDownloadQueue();if(t.length){const s=[aa.DownloadStatus_Completed,aa.DownloadStatus_Cancelled,aa.DownloadStatus_Failure,aa.DownloadStatus_NetworkError,aa.DownloadStatus_Paused];return t.some(a=>a.isActive&&!s.includes(a.status))}}return!1}async logOut(){this._featureHandlerService.handleFeatureWithoutPayload(c.LogOut)}async showShellModal(e,t){const s=this.getMutableState(e,Q);s.activeModal=t.modal}async hideShellModal(e){const t=this.getMutableState(e,Q);t.activeModal=null}async quit(){this._featureHandlerService.handleFeatureWithoutPayload(c.Quit)}async setPendingPatchAvailable(e,t){const s=this.getMutableState(e,Q);s.pendingPatchAvailable=t.available}async restart(e,t){const s={forceQuit:t.forceQuit};return this._featureHandlerService.handleFeature(c.RestartClient,s)}async requestRefreshView(e,t){var a,n;try{await q(Ls,Promise.all([this._trackingService.flush(),this._logger.flushAllTransports()]))}catch(r){this._logger.warn("Fail to flush logging and tracking data within ".concat(Ls,"ms on refresh view"),{errorCode:g.FailedFlushLogTrackingOnRefreshView})}const s={source:(a=t.options)==null?void 0:a.source,reason:(n=t.options)==null?void 0:n.reason};return this._featureHandlerService.handleFeature(c.RefreshView,s)}async switchToOnlineIntent(e){return this._featureHandlerService.handleFeatureWithoutPayload(c.SwitchToOnline)}async showServiceDegradationBanner(e,t){const s=this.getMutableState(e,Q);s.showServiceDegradationBanner=t.isDegraded}}me([h(Qo)],he.prototype,"sendInitialOverlayReadyNotifications",1);me([h(Za)],he.prototype,"onShowOverlay",1);me([h(rg)],he.prototype,"setNavigationBarVisibility",1);me([h(Gt)],he.prototype,"closeOverlay",1);me([h(ng)],he.prototype,"updateMicroAppContainer",1);me([h(qR)],he.prototype,"setLayoutMounted",1);me([h(Kp)],he.prototype,"setIsNoConnectionViewVisible",1);me([h(Hi)],he.prototype,"setMicroAppSpinnerVisibility",1);me([h(VS)],he.prototype,"setAccountLinkingInProgress",1);me([h(zR)],he.prototype,"resumeOverlay",1);me([h(KR)],he.prototype,"loadConfigurationParameters",1);me([h(XR)],he.prototype,"loadFeedbackUrlParameters",1);me([h(Qt)],he.prototype,"reportAppInitializationFailure",1);me([h(Jp)],he.prototype,"applicationInitializationCompleted",1);me([h(YR)],he.prototype,"updateIsOfflineSession",1);me([h(en)],he.prototype,"sessionExpired",1);me([h(ZR)],he.prototype,"hideOfflineNotification",1);me([h(Ur)],he.prototype,"apiUpdated",1);me([h(T6)],he.prototype,"notifyContentScrolled",1);me([h(tD)],he.prototype,"requestLogout",1);me([h(iD)],he.prototype,"requestQuit",1);me([h(Ca)],he.prototype,"logOut",1);me([h(un)],he.prototype,"showShellModal",1);me([h(og)],he.prototype,"hideShellModal",1);me([h(cg)],he.prototype,"quit",1);me([h(sD)],he.prototype,"setPendingPatchAvailable",1);me([h(aD)],he.prototype,"restart",1);me([h(lg)],he.prototype,"requestRefreshView",1);me([h(R6)],he.prototype,"switchToOnlineIntent",1);me([h(eD)],he.prototype,"showServiceDegradationBanner",1);var az=Object.defineProperty,nz=Object.getOwnPropertyDescriptor,Ra=(i,e,t,s)=>{for(var a=s>1?void 0:s?nz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&az(e,t,a),a};class Js extends z{async toggleTooltipVisibility(e,t){var s,a;if(t.isVisible)t.microAppConfig?this.updateCurrentTooltip(e,t.microAppConfig,t.shouldShowTooltipOnAppTileFocus,t.label):this.showTooltipElement(e);else{const n=(a=this.getTileIdByAppName((s=t.microAppConfig)==null?void 0:s.appName))!=null?a:void 0;this.hideTooltip(e,n)}}async applicationListIsScrolling(e){const t=this.getMutableState(e,Ke);t.isTooltipVisible=!1,t.isTooltipPositioned=!1,t.applicationListIsReady=!1}async applicationListIsReady(e){const t=this.getMutableState(e,Ke);t.applicationListIsReady=!0,t.shouldShowTooltipOnAppTileFocus&&this.showTooltipElement(e)}async hideTooltipOnAppTileFocus(e){const t=this.getMutableState(e,Ke);t.shouldShowTooltipOnAppTileFocus=!1}async setTooltipPositioned(e,t){const s=this.getMutableState(e,Ke);s.isTooltipPositioned=t.isPositioned}async showContextMenu(e,t){const s=this.getMutableState(e,Ke);s.visibleContextMenu=t.microAppConfig}async hideContextMenu(e,t){const s=this.getMutableState(e,Ke);s.visibleContextMenu=void 0}updateCurrentTooltip(e,t,s,a){const n=this.getMutableState(e,Ke);n.isTooltipVisible=!1,n.tooltipLabel=a!=null?a:t.meta.label,n.tileId=this.getTileIdByAppName(t.appName),n.shouldShowTooltipOnAppTileFocus=!!s,this.showTooltipElement(e)}showTooltipElement(e){const t=this.getMutableState(e,Ke);t.tileId&&t.applicationListIsReady&&(t.isTooltipVisible=!0)}async hideTooltip(e,t){const s=this.getMutableState(e,Ke);(t||s.tileId)===s.tileId&&(s.isTooltipVisible=!1,s.isTooltipPositioned=!1)}getTileIdByAppName(e){return e?"app-list-".concat(e):""}}Ra([h(Ka)],Js.prototype,"toggleTooltipVisibility",1);Ra([h(yG)],Js.prototype,"applicationListIsScrolling",1);Ra([h(vG)],Js.prototype,"applicationListIsReady",1);Ra([h(_G)],Js.prototype,"hideTooltipOnAppTileFocus",1);Ra([h(Iu)],Js.prototype,"setTooltipPositioned",1);Ra([h(SG)],Js.prototype,"showContextMenu",1);Ra([h(wG)],Js.prototype,"hideContextMenu",1);var rz=Object.defineProperty,oz=Object.getOwnPropertyDescriptor,cz=(i,e,t,s)=>{for(var a=s>1?void 0:s?oz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&rz(e,t,a),a};class Xl extends oe("[Shell] Authentication Retry"){constructor(){super(...arguments),this._authDolphinErrorRetried=!1}get authDolphinErrorRetried(){return this._authDolphinErrorRetried}setAuthDolphinErrorRetried(e){this._authDolphinErrorRetried=e}}cz([P],Xl.prototype,"setAuthDolphinErrorRetried",1);var lz=Object.defineProperty,pz=Object.getOwnPropertyDescriptor,Xi=(i,e,t,s)=>{for(var a=s>1?void 0:s?pz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&lz(e,t,a),a};class Di extends z{constructor(e,t,s,a,n,r,o,l){super(),this._logger=e,this._authenticationStrategy=t,this._runtimeParameters=s,this._trackingService=a,this._sessionProviderService=n,this._featureHandlerService=r,this._runtimeParametersService=o,this._hostCommunicationService=l,this._refreshTimeout=null,this._sessionRefreshInProgress=!1,this._logger=e.createChild("Authentication.reducer"),this._logger.settings.logCategory=f.authentication}async setSessionTimeout(e,t,s=0){var v;this._refreshTimeout&&clearTimeout(this._refreshTimeout);const n=this.getMutableState(e,S).playerSession;if(!n)return;const r=new Date(n.expiration),o=new Date(n.serverTime);let l=(v=t.initialTimeout)!=null?v:r.valueOf()-o.valueOf()-Vo;switch(s){case 0:break;case 1:{l=Ht;break}case 2:{l=Ht*2;break}default:{l=Ht*5;break}}this._logger.debug("Setting session timeout to ".concat(l,"ms and attempt ").concat(s));const u=async w=>{this._refreshTimeout=null;try{const b=this._authenticationStrategy instanceof an?(await this._refreshSession(e,w)).error:await this._authenticationStrategy.handleSessionCloseExpiration(w);if(!b)return;if(b.code===g.Dolphin_5){this._logger.warn("User session has expired",{platform:w.platformType,logCategory:f.authentication,errorCode:g.UserSessionExpiredWarning});const I=await this._sessionProviderService.loginWithHostTicket();if(I){await this.dispatch(e,new en(!1)),this.dispatch(e,new at(I));return}await this.dispatch(e,new en(!0));return}this._logger.warn("Failed to handle session timeout",{error:b,errorCode:g.FailedToHandleSessionTimeoutWarning})}catch(b){this._logger.error("Failed to handle session timeout",{error:b,errorCode:g.FailedToHandleSessionTimeoutWarning})}this.setSessionTimeout(e,t,s+1)};this._refreshTimeout=window.setTimeout(w=>{u(w)},l,n)}async _refreshSession(e,t){var s;return t?(s=window.upn)!=null&&s.enableAuthAppPc?await this.refreshSessionDuringClientWebAuthentication(e,t):await this.refreshSessionDefault(e,t):{}}async refreshSessionDefault(e,t){const s=await this.renewSessionDefault(t);return this.isSessionValid(t.profileId,s.session)&&await this.dispatch(e,new at(s.session)),s}async renewSessionDefault(e,t){try{return{session:await this._sessionProviderService.renewSession(e,t)}}catch(s){const a=await Yo(s,this._runtimeParameters,!0,!0);return this._logger.error(a.errorType,a.errorDetails),{error:a.error}}}async refreshSessionDuringClientWebAuthentication(e,t){if(this._sessionRefreshInProgress)return{};const{isOnline:s}=this.getReadOnlyState(e,S);if(!s)return{error:{code:g.HttpClientNetworkError,message:ge.NetworkError}};this._sessionRefreshInProgress=!0;const{rememberMeTicket:a}=t;let n=await this.renewSessionDefault(t,!0);if(!this.isSessionValid(t.profileId,n.session)&&a)try{n={session:await this._sessionProviderService.renewSessionByRememberMeTicket(t)}}catch(r){const o=await Yo(r,this._runtimeParameters,!0,!0);if(this._logger.error(o.errorType,o.errorDetails),n={error:o.error},r instanceof TypeError)return this._sessionRefreshInProgress=!1,n}return this.isSessionValid(t.profileId,n.session)?await this.dispatch(e,new at(n.session)):Date.parse(t.expiration)<Date.now()&&await this.showRestartModal(e),this._sessionRefreshInProgress=!1,n}isSessionValid(e,t){return!!t&&!!t.sessionId&&e===t.profileId}async showRestartModal(e){const{hasRunningGames:t}=this.getReadOnlyState(e,zi),s=t?fs.RestartWhenRunningGame:fs.Restart;return this.dispatch(e,new un(s))}async clearSessionTimeout(){this._refreshTimeout&&clearTimeout(this._refreshTimeout)}async updateSessionByTicket(e,t){var s;(s=window.upn)!=null&&s.enableAuthAppPc?this._logger.warn("Skip updating session by ticket when enableAuthAppPc is true",{logCategory:f.authentication}):(this._runtimeParameters.ticket=t.ticket,this.dispatch(e,new ug(t.ticket)),this.dispatch(e,new en(!1)))}async setAuthInProgress(e,t){const s=this.getMutableState(e,S);s.authInProgress=t.inProgress}async refreshSession(e,t){var a;const{playerSession:s}=this.getReadOnlyState(e,S);this._authenticationStrategy instanceof an?await this._refreshSession(e,s):await this._authenticationStrategy.refreshSession(s,(a=t.ticket)!=null?a:s==null?void 0:s.ticket)}async ubiTicketRefreshRequest(e){if(this._authenticationStrategy instanceof an){const{playerSession:t,isPlayerSessionValidAfterThirtyMinutes:s}=this.getReadOnlyState(e,S);t&&(s?await this.processUbiTicketRefreshResponse(t):setTimeout(()=>{this.ubiTicketRefreshRequest(e)},Gr))}else this._authenticationStrategy.ubiTicketRefreshRequest()}async processUbiTicketRefreshResponse(e){var o;const{ticket:t,spaceId:s,sessionId:a,profileId:n,expiration:r}=e;await ((o=this._hostCommunicationService)==null?void 0:o.sendNotification(new md({ubiTicket:t,spaceId:s,sessionId:a,profileId:n,expiration:r})))}async hostShutdown(){try{await q(Ls,Promise.all([this._trackingService.flush(),this._logger.flushAllTransports()]))}catch(e){this._logger.warn("Fail to flush logging and tracking data within ".concat(Ls,"ms on host shutdown"),{errorCode:g.FailedFlushLogTrackingOnHostShutdown})}return{isCanceled:!1}}async validateSession(e,t){var o;if(!t.session)return!1;if(!((o=window.upn)!=null&&o.enableAuthAppPc))return!0;const s=this.getReadOnlyState(e,S);let a;try{a=await this._featureHandlerService.handleFeature(c.PassAuthentication,{loginData:t.session,isOfflineSession:s.isOfflineSession,password:t.password,email:t.email})}catch(l){return await this.handleValidateSessionError(e,l),!1}const n=a==null?void 0:a.response.isSuccess;n||await this.handleClientAuthenticationFailure(e,a==null?void 0:a.response.errorCode);const r=a==null?void 0:a.response.ownershipGroup;return r&&await this.overrideOwnershipGroup(e,r,t.session.ticket,s.isOnline),n!=null?n:!1}async handleValidateSessionError(e,t){const s=t instanceof Vc?g.Dolphin_34:g.Dolphin_35;this._logger.error(ge.ValidateLoginSessionError,{error:t,logCategory:f.authentication,errorCode:s}),await this.dispatch(e,new Qt({message:"error.generic",errorCode:s}))}async handleClientAuthenticationFailure(e,t){const s=t===P7?g.Dolphin_31:g.Dolphin_28;this._logger.error(ge.ClientAuthError,{parameters:this._runtimeParameters,logCategory:f.authentication,errorCode:s,message:"".concat(ge.ClientAuthError," (client error code: ").concat(t,")")}),await this.dispatch(e,new Qt({message:"error.generic",errorCode:s}))}async overrideOwnershipGroup(e,t,s,a){const n=DG(la,t);if(n&&(await this.dispatch(e,new Gd(n)),this._runtimeParametersService.overrideParameter("ownershipGroup",n),n===la.Steam&&this._runtimeParameters.platformType===m.PC&&a)){const r=new URL(this._runtimeParameters.fullUrl);r.searchParams.set("platform",m.Steam),r.searchParams.set("ticket",s),r.searchParams.set("ownershipGroup",la.Steam),await this.dispatch(e,new ar(_e.PlatformTypeChanged)),window.location.href=r.href}}async passAuthenticateStats(e,t){var s;await ((s=this._hostCommunicationService)==null?void 0:s.sendNotification(new Yv(t.data)))}async setAuthDolphinErrorRetried(e,t){this.getReadOnlyState(e,Xl).setAuthDolphinErrorRetried(t.retried)}}Xi([h(PD)],Di.prototype,"setSessionTimeout",1);Xi([h(ND)],Di.prototype,"clearSessionTimeout",1);Xi([h(jR)],Di.prototype,"updateSessionByTicket",1);Xi([h(Re)],Di.prototype,"setAuthInProgress",1);Xi([h(ug)],Di.prototype,"refreshSession",1);Xi([h(TD)],Di.prototype,"ubiTicketRefreshRequest",1);Xi([h(RD)],Di.prototype,"hostShutdown",1);Xi([h(DD)],Di.prototype,"validateSession",1);Xi([h(OD)],Di.prototype,"passAuthenticateStats",1);Xi([h(FD)],Di.prototype,"setAuthDolphinErrorRetried",1);var uz=Object.defineProperty,dz=Object.getOwnPropertyDescriptor,Sm=(i,e,t,s)=>{for(var a=s>1?void 0:s?dz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&uz(e,t,a),a};class mt extends oe("Browser View State"){constructor(){super(...arguments),this._browsers=new Map,this._isOpeningBrowserView=!1}get browsers(){return[...this._browsers.values()]}get isAnyBrowserViewVisible(){return this.browsers.some(e=>e.isVisible===!0)}get isOpeningBrowserView(){return this._isOpeningBrowserView}setIsOpeningBrowserView(e){this._isOpeningBrowserView=e}addBrowser(e){this._browsers=new Map(this._browsers.set(e.key,e))}updateBrowser(e){this._browsers=new Map(this._browsers.set(e.key,e))}getBrowserByKey(e){return this._browsers.get(e)}getBrowserById(e){return this.browsers.find(t=>t.browserId===e)}removeBrowser(e){const t=this.getBrowserById(e);t&&this._browsers.delete(t.key)}}Sm([P],mt.prototype,"setIsOpeningBrowserView",1);Sm([P],mt.prototype,"addBrowser",1);Sm([P],mt.prototype,"updateBrowser",1);var hz=Object.defineProperty,gz=Object.getOwnPropertyDescriptor,Nt=(i,e,t,s)=>{for(var a=s>1?void 0:s?gz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&hz(e,t,a),a};const Ef=30;class lt extends z{constructor(e,t,s){super(),this._featureHandlerService=e,this._containerPlacementsService=t,this._hostCommunicationService=s}async browserViewCreate(e,t){const s=this.getMutableState(e,mt);if(s.getBrowserByKey(t.appConfig.appName))return;const n=this._containerPlacementsService.getMicroAppContainer(t.appConfig.placement);if(!n)return Promise.reject("Unable to retirieve microapp container for placement: ".concat(t.appConfig.placement));this.dispatch(e,new uu(t.appConfig,Ef,u=>this.dispatch(e,new fu(u))));const r=this.roundRect(n.getBoundingClientRect()),o=await this._featureHandlerService.handleFeature(c.BrowserViewCreate,{url:t.url,rect:r,cookies:t.cookies}),l=o==null?void 0:o.response.browserId;if(!l)return Promise.reject("browserId was not returned in the response from the feature handler");s.addBrowser({key:t.appConfig.appName,browserId:l,onNavigate:t.onNavigateHandler,onClose:t.onCloseHandler,isVisible:!1})}roundRect(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}}async browserViewDestroy(e,t){const s=await this.getAndVerifyBrowserForMicroapp(e,t.appName);await this._featureHandlerService.handleFeature(c.BrowserViewDestroy,{browserId:s.browserId})}async onNavigate(e,t){const a=this.getReadOnlyState(e,mt).getBrowserById(t.notification.browserId);a&&a.onNavigate(t.notification.url)}async onClosed(e,t){const s=this.getMutableState(e,mt),a=s.getBrowserById(t.notification.browserId);a&&(a.onClose(),s.removeBrowser(t.notification.browserId))}async onMicroappContainerResized(e,t){const s=this.roundRect(t.target.getBoundingClientRect());this.getReadOnlyState(e,mt).browsers.forEach(n=>{this._featureHandlerService.handleFeature(c.BrowserViewResize,{browserId:n.browserId,rect:s})})}async onMicroappDeactivated(e,t){if(this.getReadOnlyState(e,mt).getBrowserByKey(t.appConfig.appName))return this.dispatch(e,new hn(t.appConfig)),this.dispatch(e,new kg(t.appConfig.appName,!1))}async onMicroappActivated(e,t){this.getReadOnlyState(e,mt).getBrowserByKey(t.appConfig.appName)&&this.dispatch(e,new uu(t.appConfig,Ef,n=>this.dispatch(e,new fu(n))))}async onMicroappUnmounted(e,t){const a=this.getReadOnlyState(e,mt).getBrowserByKey(t.appName);if(a)return this.dispatch(e,new Ug(a.browserId))}async browserViewToggleVisibility(e,t){const s=this.getMutableState(e,mt),a=s.getBrowserByKey(t.appName);if(!a)return!1;s.setIsOpeningBrowserView(t.toggle);const n=t.toggle?c.BrowserViewShow:c.BrowserViewHide,r=await this._featureHandlerService.handleFeature(n,{browserId:a.browserId});return r?r.response.browserId!==a.browserId?Promise.reject('Unable to get visibility toggle result due to browser id mismatch. Requested browser id "'.concat(a.browserId,'", but received "').concat(r.response.browserId,'"')):(a.isVisible=r.response.isVisible,s.updateBrowser(a),r.response.isVisible===t.toggle):Promise.reject("Unable to get response from host")}async browserViewSetUrl(e,t){const s=await this.getAndVerifyBrowserForMicroapp(e,t.appName);await this._featureHandlerService.handleFeature(c.BrowserViewSetUrl,{browserId:s.browserId,url:t.url})}async browserViewGetUrl(e,t){const s=await this.getAndVerifyBrowserForMicroapp(e,t.appName),a=await this._featureHandlerService.handleFeature(c.BrowserViewGetUrl,{browserId:s.browserId});return a?a.response.browserId!==s.browserId?Promise.reject('Unable to get browser url due to browser id mismatch. Requested browser id "'.concat(s.browserId,'", but received "').concat(a.response.browserId,'"')):a.response.url:Promise.reject("Unable to get browser url from host")}async browserViewPostMessage(e,t){const s=await this.getAndVerifyBrowserForMicroapp(e,t.appName);await this._featureHandlerService.handleFeature(c.BrowserViewPostMessage,{browserId:s.browserId,message:t.message})}async browserViewOnMessage(e,t){const a=this.getReadOnlyState(e,mt).getBrowserById(t.notification.browserId);a&&a.onMessage&&a.onMessage(t.notification.message)}async browserViewSubscribeToMessage(e,t){const s=await this.getAndVerifyBrowserForMicroapp(e,t.appName);s.onMessage=t.callback}async getAndVerifyBrowserForMicroapp(e,t){const a=this.getReadOnlyState(e,mt).getBrowserByKey(t);return a||Promise.reject("Unable to detect browser view associated with microapp: ".concat(t))}async browserViewAddCookies(e,t){var a;const s=await this.getAndVerifyBrowserForMicroapp(e,t.appName);s&&await ((a=this._hostCommunicationService)==null?void 0:a.sendRequest(new m_({browserId:s.browserId,cookies:t.cookies})))}}Nt([h(xF)],lt.prototype,"browserViewCreate",1);Nt([h(Ug)],lt.prototype,"browserViewDestroy",1);Nt([h(EF)],lt.prototype,"onNavigate",1);Nt([h(UF)],lt.prototype,"onClosed",1);Nt([h(fu)],lt.prototype,"onMicroappContainerResized",1);Nt([h(kF)],lt.prototype,"onMicroappDeactivated",1);Nt([h(WF)],lt.prototype,"onMicroappActivated",1);Nt([h(VF)],lt.prototype,"onMicroappUnmounted",1);Nt([h(kg)],lt.prototype,"browserViewToggleVisibility",1);Nt([h($F)],lt.prototype,"browserViewSetUrl",1);Nt([h(BF)],lt.prototype,"browserViewGetUrl",1);Nt([h(HF)],lt.prototype,"browserViewPostMessage",1);Nt([h(QF)],lt.prototype,"browserViewOnMessage",1);Nt([h(jF)],lt.prototype,"browserViewSubscribeToMessage",1);Nt([h(qF)],lt.prototype,"browserViewAddCookies",1);function pc(i){let e;return i.configServiceToken&&i.bundleOverrides?{token:i.configServiceToken,overrides:i.bundleOverrides}:e}const Uf=[{microAppType:dn.ShellApp,appName:gn.GameLaunch,placement:B.main,bundleUrl:"unknown",manifestUrl:"unknown",spaceId:w7,meta:{iconUrl:"",label:"Game Launch"},parentAppName:null,isHidden:!1,multipleWindowsMode:Ds.forced,multipleWindowsConfig:{mode:Ds.forced},populations:[]},{microAppType:dn.ShellApp,appName:gn.ProductUninstall,placement:B.main,bundleUrl:"unknown",manifestUrl:"unknown",spaceId:b7,meta:{iconUrl:"",label:"Product Uninstall"},parentAppName:null,isHidden:!1,multipleWindowsMode:Ds.forced,multipleWindowsConfig:{mode:Ds.forced},populations:[]}];var mz=Object.defineProperty,fz=Object.getOwnPropertyDescriptor,Jl=(i,e,t,s)=>{for(var a=s>1?void 0:s?fz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&mz(e,t,a),a},Os;const oo=(Os=class extends z{constructor(e,t,s,a,n,r,o,l){super(),this._logger=e,this._appBundleUrlOverrideHelper=t,this._shellConfigService=s,this._lifeGuardService=a,this._featureHandlerService=n,this._runtimeParameters=r,this._pluginsService=o,this._shellConfig=l,this._refreshTimeout=null,this._logger=e.createChild("Configuration.reducer"),this._logger.settings.logCategory=f.configuration}async ensureMicroAppConfigurationsAreLoaded(e,t){var n;const s=this.getReadOnlyState(e,S),a=(n=t.gameSpaceId)!=null?n:s.activeGame.spaceId;try{await q(bi,s.authIsDone)}catch(r){this._logger.error("Micro App Configurations are not loaded because there is no session set",{error:r,gameApplicationId:t.gameApplicationId,gameSpaceId:a,errorCode:g.MicroAppsNotLoadedAuthTimeout});return}await Promise.all([this.loadMicroAppConfigurations(e,a,t.gameApplicationId),this.loadShellMicroAppConfigurations(e)]),await Promise.all([this.loadNativeMicroAppConfigurations(e,a),this.loadGameSpecificNativeMicroAppConfiguration(e,a,t.gameApplicationId)]),this._logger.info("Micro App Configurations are loaded",{gameApplicationId:t.gameApplicationId,gameSpaceId:a})}async getDataFromConfigService(e,t,s){const a=[p.PCLegacyClient,p.SteamClient,p.PCWebClient].includes(e.hostPlatformType);return t===e.shellSpaceId&&a?le(()=>this._shellConfigService.v3.getApplicationConfigurationsBatch(e.playerSessionOrThrow,e.playerLocale,this._shellConfig.applicationIds,e.platformVariant,pc(this._runtimeParameters))).then(n=>n==null?void 0:n[e.shellApplicationId]).then(n=>{var r;if(!n||!((r=n.microApplications)!=null&&r.length)){const o="Micro applications are not defined for space: ".concat(t,", application?: ").concat(s);throw new qa(o)}return n}):le(()=>this._shellConfigService.v3.getApplicationConfigurations(e.playerSessionOrThrow,e.playerLocale,t,s!=null?s:"",e.platformVariant,pc(this._runtimeParameters)).then(n=>{var r;if(!n||!((r=n.microApplications)!=null&&r.length)){const o="Micro applications are not defined for space: ".concat(t,", application?: ").concat(s);throw new qa(o)}return n}))}async loadMicroAppConfigurations(e,t,s){var r;const a=this.getReadOnlyState(e,S),n=this.getMutableState(e,M);if(!(!a.playerSession||n.hasSpaceMicroAppConfig(t)))try{const o=await n.loadedApplicationConfigurations.getOrCreate(t,()=>this.getDataFromConfigService(a,t,s));if(!o||!((r=o.microApplications)!=null&&r.length)){const u="Micro applications are not defined for space: ".concat(t,", application?: ").concat(s);throw new qa(u)}this._logger.debug("Application configuration is loaded for ".concat(t),{...o}),Array.isArray(o.manifests)&&o.manifests.forEach(u=>{this.dispatch(e,new kD(u))});const l=this.makeShellConfigs(e,o);n.createSpaceMicroAppsConfiguration({gameSpaceId:t,microAppConfigs:l}),t===a.hostGame.spaceId&&s===a.hostGame.applicationId&&await this.processMicroAppsConfigsForHostSpace(e,o,l)}catch(o){const l="Failed to load application parameters for space: ".concat(t,", application?: ").concat(s," due to: ").concat(this.getMessage(o));let u=this.getConfigurationErrorCode(e,s);throw Td(o)&&(u=g.FailedFetchMicroAppConfigError),this._logger.error(l,{error:o,gameSpaceId:t,gameApplicationId:s,errorCode:u}),new qa(l,u)}}makeShellConfigs(e,t){const s=this.getReadOnlyState(e,S);let a=this.getMicroAppConfigsFromApplicationConfiguration(e,t);return a=this.filterMicroAppConfigsByNetworkCondition(a,t,s.isOfflineSession),a=this.sortMicroAppConfigs(a),a}async processMicroAppsConfigsForHostSpace(e,t,s){const a=this.getMutableState(e,M),n=this.getMutableState(e,Ii);n.lastUpdate=t.lastUpdate,await this.setRefreshTimeout(e);const r=this._runtimeParameters.microApp;if(this._runtimeParameters.isExclusiveMode){const o=r?[r]:[],l=s.filter(u=>u.preload&&!o.includes(u.appName));a.defaultMicroAppsNames=[],this._logger.debug("Preloading micro applications for host space",{appsToPreload:l}),this._lifeGuardService.loadMicroApps(l),await this.dispatch(e,new mg)}else{const o=t.microApplications.filter(w=>w.default&&w.parents.some(b=>!b.parentAppName)).map(w=>w.appName);a.defaultMicroAppsNames=o,await this.dispatch(e,new QD);const l=a.initialAppsState?Array.from(new Set(Object.values(a.initialAppsState.placements).map(w=>w.appName))):[],u=[J.AppGamerProfile,...l];r&&u.push(r);const v=s.filter(w=>w.preload&&!w.parentAppName&&!u.includes(w.appName));await this.dispatch(e,new Xo(v.filter(w=>w.runtimeAvailabilityCheckRequired))),this._logger.debug("Preloading micro applications for host space",{appsToPreload:v}),a.appsToPreload=v,t.accessMenu&&(this._logger.debug("Setting access menu configuration from host space",{accessMenu:t.accessMenu}),a.accessMenu=t.accessMenu)}}filterMicroAppConfigsByNetworkCondition(e,t,s){const a=t.microApplications.filter(o=>o.availableNetworkCondition!==Xm.OfflineOnly).map(o=>o.spaceId),n=t.microApplications.filter(o=>o.availableNetworkCondition!==Xm.OnlineOnly).map(o=>o.spaceId);return e.filter(o=>s?n.indexOf(o.spaceId)>-1:a.indexOf(o.spaceId)>-1)}getConfigurationErrorCode(e,t){const s=this.getReadOnlyState(e,Q);return s.initializationCompleted?t&&t!==s.appId?g.Jellyfish_003:g.Jellyfish_002:g.Dolphin_29}getMessage(e){let t="";return typeof e=="string"?t=e:e instanceof Error&&(t=e.message),t}async setRefreshTimeout(e){this._refreshTimeout&&clearInterval(this._refreshTimeout);const t=Ht*15;this._refreshTimeout=window.setInterval(s=>{(async a=>{var n,r;try{const o=this.getReadOnlyState(a,S),l=this.getMutableState(a,Ii);if(!o.isOnline)return;if(!o.playerSession){this._logger.error("PlayerSession not defined",{errorCode:g.GetLastUpdatedConfigMissingPlayerSessionError});return}const u=Date.parse(o.playerSession.expiration);if(!u||u<Date.now()){this._logger.error("Session expired skipping getLastUpdateData api call",{errorCode:g.GetLastUpdatedConfigWithExpiredTicketError,expirationDate:o.playerSession.expiration});return}const v=await this._shellConfigService.v3.getLastUpdateData(o.playerSession,o.hostGame.spaceId,o.hostGame.applicationId);if(!v){this._logger.error("Error calling getLastUpdateData",{errorCode:g.GetLastUpdatedConfigFailed});return}(((n=l.lastUpdate)==null?void 0:n.lastUpdateDate)!==v.lastUpdateDate||((r=l.lastUpdate)==null?void 0:r.isMandatory)!==v.isMandatory)&&(l.lastUpdate=v)}catch(o){this._logger.warn("Failed to get configuration last update data",{error:o,errorCode:g.FailedMicroappsConfigurationWarning})}})(s)},t,e)}sortMicroAppConfigs(e){return e.sort((t,s)=>{var r,o;const a=(r=t.order)!=null?r:Number.MAX_SAFE_INTEGER,n=(o=s.order)!=null?o:Number.MAX_SAFE_INTEGER;return a<n?-1:a>n?1:t.appName<s.appName?-1:1})}getMicroAppConfigsFromApplicationConfiguration(e,t){const a=this.getReadOnlyState(e,M).defaultPlacement;return t.microApplications.map(r=>this.buildMicroAppConfigurations(r,a)).reduce((r,o)=>r.concat(o),[])}buildMicroAppConfigurations(e,t){return e.parents.map(s=>{var o,l;const{bundleUrl:a,integrityHashRequired:n}=this._appBundleUrlOverrideHelper.getBundleConfig(e.appName,e.bundleUrl),r=e.manifestUrl&&e.manifestUrl!==""?e.manifestUrl:a.substring(0,a.lastIndexOf("/"))+"/manifest.json";return{appName:e.appName,bundleUrl:a,manifestUrl:r,spaceId:e.spaceId,meta:{iconUrl:e.iconUrl||"",label:(o=e.label)!=null?o:e.appName},preload:e.preload||e.default||!1,integrityHash:n?e.integrityHash:void 0,parentAppName:s.parentAppName||null,order:s.order,defaultPlacement:s.defaultPlacement,allowedPlacements:s.allowedPlacements,placement:s.defaultPlacement||t,multipleWindowsMode:s.multipleWindowsMode,multipleWindowsConfig:s.multipleWindowsConfig,defaultViewMode:s.defaultViewMode,additionalNavigationArguments:s.additionalNavigationArguments,isHidden:s.isHidden,runtimeAvailabilityCheckRequired:e.runtimeAvailabilityCheckRequired,alternativeName:e.alternativeName,availableNetworkCondition:e.availableNetworkCondition,populations:(l=e.populations)!=null?l:[]}})}async loadNativeMicroAppConfigurations(e,t){var s,a;try{const n=await q(Os.nativeMicroAppConfigLoadTimeoutInMs,this._featureHandlerService.handleFeatureWithoutPayload(c.GetNativeMicroApps));if(!n)return;if(this._logger.debug("Native micro applications configuration is loaded",{nativeMicroApps:(s=n.response)==null?void 0:s.nativeMicroApps}),(a=n.response)!=null&&a.nativeMicroApps)this.getMutableState(e,M).addNativeSpaceMicroAppConfigurations({gameSpaceId:t,microAppConfigs:n.response.nativeMicroApps,parentAppName:null});else{const r="Received invalid response when trying to load native micro app configurations";return this._logger.error(r,{errorCode:g.ConfigurationLoadNativeMicroAppConfigurationsError}),Promise.reject(r)}}catch(n){throw this._logger.error("Retrieval of native micro app configurations failed with error",{error:n,errorCode:g.ConfigurationLoadNativeMicroAppConfigurationsError}),new De(this.getMessage(n))}}async loadShellMicroAppConfigurations(e){this.getReadOnlyState(e,S).isDesktopApp&&(this.getMutableState(e,M).createShellAppsConfiguration(Uf),this._logger.debug("Default Shell micro application configuration is loaded",{shellMicroApps:Uf}))}async loadGameSpecificNativeMicroAppConfiguration(e,t,s){var a,n;if(t&&s)try{const r={game:{applicationId:s,spaceId:t}},o=await q(Os.nativeGetGameSpecificMicroAppConfigLoadTimeoutInMs,this._featureHandlerService.handleFeature(c.GetGameSpecificNativeMicroApps,new rS(r)));o&&this._logger.debug("Got game specific native micro applications",{addApplications:(a=o.response)==null?void 0:a.addApplications,removeApplications:(n=o.response)==null?void 0:n.removeApplications}),this.shouldUpdateGameSpecificMicroAppsConfiguration(o)&&this.getMutableState(e,M).updateNativeMicroAppConfigurations({gameSpaceId:t,addApplications:o==null?void 0:o.response.addApplications,removeApplications:o==null?void 0:o.response.removeApplications,parentAppName:J.AppGamePage})}catch(r){if(this._logger.error("Retrieval of game specific native micro app configurations failed with error",{error:r,errorCode:g.ConfigurationLoadGameSpecificNativeAppsError}),r instanceof Vc)return;throw new De(this.getMessage(r))}}shouldUpdateGameSpecificMicroAppsConfiguration(e){var t,s,a,n;return!!e&&(((s=(t=e.response)==null?void 0:t.addApplications)==null?void 0:s.length)>0||((n=(a=e.response)==null?void 0:a.removeApplications)==null?void 0:n.length)>0)}async reloadShell(){this._featureHandlerService.handleFeatureWithoutPayload(c.ReloadClientUI)}async updateData(e,t){const s=this.getMutableState(e,Ii);s.serviceUrls=t.data.serviceUrls,s.remoteLogs=t.data.remoteLogs,this.getMutableState(e,M).initialChildWindowSync({shellConfigs:t.data.shellConfigs,spaceConfigs:t.data.spaceConfigs}),this.getMutableState(e,S).syncState(t.data.runtimeContext);const r=this.getMutableState(e,Q);r.notificationPosition=t.data.notificationPosition;const o=this.getMutableState(e,ws);t.data.games.forEach(l=>o.addGame(l))}async requestPluginsConfiguration(){return this._pluginsService.getPluginsConfiguration()}},Os.nativeMicroAppConfigLoadTimeoutInMs=2e3,Os.nativeGetGameSpecificMicroAppConfigLoadTimeoutInMs=200,Os);Jl([h(tn)],oo.prototype,"ensureMicroAppConfigurationsAreLoaded",1);Jl([h(BO)],oo.prototype,"reloadShell",1);Jl([h(HO)],oo.prototype,"updateData",1);Jl([h(QO)],oo.prototype,"requestPluginsConfiguration",1);let yz=oo;var vz=Object.defineProperty,_z=Object.getOwnPropertyDescriptor,Fe=(i,e,t,s)=>{for(var a=s>1?void 0:s?_z(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&vz(e,t,a),a};class Pe extends z{constructor(e){super(),this._pluginsService=e}async setDebugPanelVisibility(e,t){const s=this.getMutableState(e,te);s.isDebugPanelVisible=t.isDebugPanelVisible}async setDebugPanelInitialTab(e,t){const s=this.getMutableState(e,te),a=s.sectionIndex(t.tabName);s.debugSectionIndex=a===-1?0:a}async removeDebugPanelTab(e,t){this.getMutableState(e,te).removeSection(t.tabName)}async setFocusRefreshToken(e,t){const s=this.getMutableState(e,te);s.focusRefreshKey=t.focusRefreshKey}async toggleFocusGroupNode(e,t){this.getMutableState(e,te).toggleFocusGroup(t.focusId)}async toggleDebugPanelVisibility(e){const t=this.getMutableState(e,te);t.isDebugPanelVisible=!t.isDebugPanelVisible}async setDebugPanelFocus(e,t){const s=this.getMutableState(e,te);s.isDebugPanelFocused=t.isDebugPanelFocused}async processDebugPanelGamepadHotkey(e,t){const s=this.getMutableState(e,te),a=this.getEvent(t,L.RightStickY,$a.ButtonDown);a&&(s.rightStickY=Math.abs(a.value)>.1?a.value:0),this.getEvent(t,L.RightStickY,$a.ButtonUp)&&(s.rightStickY=0),t.events.filter(o=>o.type===$a.ButtonDown).forEach(o=>{s.registerButtonPressForCombo(o.button)}),this.getEvent(t,L.Start,$a.ButtonPress)&&s.isDebugPanelVisible&&localStorage.clear()}getEvent(e,t,s,a){return e.events.find(n=>n.button===t&&n.type===s&&(a?a(n.value):!0))}async pluginLoaded(e,t){this.getMutableState(e,te).addLoadedPlugin(t.pluginConfig)}async addPluginSpyData(e,t){this.getMutableState(e,te).addPluginSpyInfo({config:t.pluginConfig,featureId:t.featureId})}async addPluginHandlerData(e,t){this.getMutableState(e,te).addPluginHandlerInfo({config:t.pluginConfig,featureId:t.featureId})}async addFeatureDispatchHandler(e,t){this.getMutableState(e,te).addFeatureDispatchHandler(t.featureId)}async addFeatureListenerHandler(e,t){this.getMutableState(e,te).addFeatureListenerHandler(t)}async addPluginNotificationData(e,t){this.getMutableState(e,te).addPluginNotificationInfo({config:t.pluginConfig,featureId:t.featureId})}async addPluginApiRegistration(e,t){this.getMutableState(e,te).addRegisteredApi({config:t.pluginConfig,api:t.apiName})}async setIndex(e,t){const s=this.getMutableState(e,te);s.debugSectionIndex=t.index}async filterHostTag(e,t){this.getMutableState(e,te).addFilteredTag(t.tag)}async unfilterHostTag(e,t){this.getMutableState(e,te).removeFilteredTag(t.tag)}async getPartnerInformation(e){const t=this._pluginsService.getApi(ee.PartnerApiV1);if(t){const s=this.getMutableState(e,te),{platform:a,platformAttributes:n}=await t.getPartnerInformation();s.partnerContext={platform:a,platformAttributes:n}}}async setDebugPanelShortcutButtons(e,t){const s=this.getMutableState(e,te);ba(s.shortcutButtons,t.buttons)||(s.shortcutButtons=t.buttons)}async updateDebugFields(e,t){this.getMutableState(e,te).updateDebugField(t.data)}}Fe([h(D6)],Pe.prototype,"setDebugPanelVisibility",1);Fe([h(O6)],Pe.prototype,"setDebugPanelInitialTab",1);Fe([h(F6)],Pe.prototype,"removeDebugPanelTab",1);Fe([h(L6)],Pe.prototype,"setFocusRefreshToken",1);Fe([h(G6)],Pe.prototype,"toggleFocusGroupNode",1);Fe([h(x6)],Pe.prototype,"toggleDebugPanelVisibility",1);Fe([h(E6)],Pe.prototype,"setDebugPanelFocus",1);Fe([h(nD)],Pe.prototype,"processDebugPanelGamepadHotkey",1);Fe([h(rD)],Pe.prototype,"pluginLoaded",1);Fe([h(oD)],Pe.prototype,"addPluginSpyData",1);Fe([h(cD)],Pe.prototype,"addPluginHandlerData",1);Fe([h(uD)],Pe.prototype,"addFeatureDispatchHandler",1);Fe([h(Yp)],Pe.prototype,"addFeatureListenerHandler",1);Fe([h(lD)],Pe.prototype,"addPluginNotificationData",1);Fe([h(pD)],Pe.prototype,"addPluginApiRegistration",1);Fe([h(U6)],Pe.prototype,"setIndex",1);Fe([h(k6)],Pe.prototype,"filterHostTag",1);Fe([h(W6)],Pe.prototype,"unfilterHostTag",1);Fe([h(V6)],Pe.prototype,"getPartnerInformation",1);Fe([h(dD)],Pe.prototype,"setDebugPanelShortcutButtons",1);Fe([h($6)],Pe.prototype,"updateDebugFields",1);var Sz=Object.defineProperty,wz=Object.getOwnPropertyDescriptor,bz=(i,e,t,s)=>{for(var a=s>1?void 0:s?wz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Sz(e,t,a),a};class xG extends z{constructor(e,t){super(),this._logger=e,this._pluginService=t}async loadGameEntitlements(e){var t;try{const s=this._pluginService.getApi(ee.EntitlementApiV1);if(s){const a=this.getMutableState(e,An),n=await s.getOwnerships();n&&n.length&&a.addGameEntitlements(n)}}catch(s){const a=(t=this.getReadOnlyState(e,S).playerSession)==null?void 0:t.profileId;this._logger.warn("Unable to retieve game entitlement information for profile:".concat(a,"."),{profileId:a,errorCode:g.FailedRetrieveEntitlementForProfileWarning})}}}bz([h(IO)],xG.prototype,"loadGameEntitlements",1);var Cz=Object.defineProperty,Iz=Object.getOwnPropertyDescriptor,Yl=(i,e,t,s)=>{for(var a=s>1?void 0:s?Iz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Cz(e,t,a),a};class co extends z{constructor(e,t){super(),this._logger=e,this._featureHandlerService=t,this._logger=e.createChild("Error.reducer"),this._logger.settings.logCategory=f.shell}async setShellError(e,t){const{placement:s,error:a}=t,n=this.getMutableState(e,$e);s?(this._logger.info("Set shell error for ".concat(s),{intentError:a,placement:s}),n.setShellError({value:a,placement:s})):(this._logger.info("Set shell global error",{intentError:t.error}),n.setShellGlobalError(a)),Promise.all([this.dispatch(e,new $t),this.dispatch(e,new Qi),this.dispatch(e,new pm)])}async clearAllShellPlacementError(e){this._logger.info("Clear shell error"),this.getMutableState(e,$e).clearAllShellErrors();const s=this.getReadOnlyState(e,M);Promise.all([this.dispatch(e,new $t),this.dispatch(e,new Qi),this.dispatch(e,new so(s.defaultPlacement))])}async clearShellPlacementError(e,t){try{this._logger.debug("Clear Shell error for placement: ".concat(t.placement)),this.getMutableState(e,$e).clearShellError(t.placement),await Promise.all([this.dispatch(e,new $t),this.dispatch(e,new Qi)])}catch(s){this._logger.error("Failed to clear Shell error for placement: ".concat(t.placement),{error:s,logCategory:f.uncategorized})}}async setRecoveryState(e,t){const s={isRecoveryPageActive:t.options.isRecoveryPageActive,reason:t.options.reason};return this._featureHandlerService.handleFeature(c.SetRecoveryState,s)}}Yl([h(ji)],co.prototype,"setShellError",1);Yl([h(za)],co.prototype,"clearAllShellPlacementError",1);Yl([h(MO)],co.prototype,"clearShellPlacementError",1);Yl([h(ou)],co.prototype,"setRecoveryState",1);class Mz{getDefaultFeatures(){return[c.OverlayIsReady,c.OverlayIsHidden,c.HideOverlay,c.GetFirstPartyBlockedPlayers,c.Navigate,c.LoginResult]}}class Az{getDefaultFeatures(){return[c.GetFeatureSupport,c.UpdateFeatureSupport]}}class EG{getDefaultFeatures(){return[c.ReportFatalError,c.LoginReady,c.LoginFailure,c.LoginResult,c.FirstPartyLogin,c.AddToNavigationHistory,c.Navigate,c.TabNavigate,c.NavigateBack,c.ManageBackButton,c.IsNavigationBackAvailable,c.NavigateDeepLink,c.StreamingJoin,c.StreamingLeave,c.StreamingGetGuestStatus,c.StreamingGuestUpdateStatus,c.StreamingGuestUpdateMetrics]}}class Pz extends EG{getDefaultFeatures(){return super.getDefaultFeatures().concat([c.ScrollTitleBar])}}class Nz extends EG{constructor(e){super(),this._runtimeContextState=e}getDefaultFeatures(){const e=[c.SetTitle,c.ResetTitle,c.GetNativeMicroApps,c.ShowNativePart,c.ShowShellContainer,c.GetGameSpecificNativeMicroApps,c.IsMicroAppAvailable,c.GetTransversalMicroApps,c.GetGameSpecificMicroApps,c.ScrollMicroApp,c.UpdateNavigationBarViewMode,c.GetImage,c.UpdateUbisoftTicket,c.SetCurrentParentAppName,c.GetSecureStorageData,c.SetSecureStorageData,c.DeleteSecureStorageData];return this._runtimeContextState.hostVersion&&P2(this._runtimeContextState.hostVersion,"9.2.8")&&e.push(c.OpenExternalLink),super.getDefaultFeatures().concat(e)}}class kf{getDefaultFeatures(){return[c.SendGameInviteEvent,c.AcceptGameInviteEvent,c.DeclineGameInviteEvent,c.JoinGame,c.SendChannelGameInviteEvent,c.GetCurrentGameInviteEvents,c.RespondToGameInvite,c.UpdateGameSessionInvite,c.GetUserActivity,c.UpdateUserActivity,c.UpdateUbisoftTicket,c.AddToNavigationHistory,c.Navigate,c.NavigateBack,c.IsNavigationBackAvailable,c.NavigateDeepLink,c.SwitchToExclusiveMode,c.ExitExclusiveMode,c.OverlayIsReady,c.OverlayIsVisible,c.OverlayIsHidden,c.ShowOverlay,c.HideOverlay,c.UINotificationAdded,c.UINotificationStateUpdated,c.UINotificationDismissed,c.UpdateFPS,c.GetSettings,c.UpdateSettings,c.StreamingKickGuest,c.StreamingStart,c.StreamingStop,c.StreamingCreateToken,c.StreamingGenerateInviteLink,c.StreamingGetHostStatus,c.StreamingHostUpdateStatus,c.StreamingHostUpdateMetrics,c.StreamingJoin,c.StreamingSetSessionSettings,c.StreamingSetGuestSettings,c.LegacyAddOnStateUpdate,c.LegacyGameDownload,c.LegacyGameUninstall,c.LegacyGameVerify,c.LegacyDisplayReadme,c.LegacyGameLaunch,c.LegacyGameDownloadProgressUpdate,c.LegacyGameDownloadFailedUpdate,c.LegacyGetProducts,c.LegacyGetProduct,c.LegacyGameStateUpdate,c.LegacyGetDownloadProgress,c.LegacyGetGameBranches,c.LegacySwitchGameBranch,c.LegacyUnlockGameBranch,c.LegacyInstallOptionalAddon,c.LegacyUninstallOptionalAddon,c.LegacySwitchDownloadLanguage,c.LegacyGetDownloadLanguages,c.BrowserViewCreate,c.BrowserViewDestroy,c.BrowserViewOnNavigate,c.BrowserViewOnClosed,c.BrowserViewHide,c.BrowserViewResize,c.BrowserViewShow,c.BrowserViewSetUrl,c.BrowserViewGetUrl,c.BrowserViewPostMessage,c.BrowserViewOnMessage,c.LegacyPlayStart,c.LegacyPlayEnd,c.LegacyGetRunningGame,c.LegacyCancelDownload,c.LegacyPauseDownload,c.LegacyResumeDownload,c.LegacySetActiveDownload,c.LegacyDownloadStateUpdate,c.LegacyDownloadLanguageUpdate,c.LegacyOpenGameInstallationFolder,c.LegacyLocateGameInstallationFolder,c.LegacyLocateGameInstallationFolderAfterGameStartFailure,c.LegacyGameInstallationFolderUpdate,c.LegacyDownloadSetPriorityOrder,c.LegacyCreateGameShortcut,c.LegacyProductsAdded,c.LegacyProductsUpdated,c.LegacyInstallerLaunch,c.LegacyInstallerInProgress,c.LegacyInstallerFailed,c.LegacyInstallerCancelled,c.LegacyInstallerCompleted,c.LegacyRetailInstallerCompleted,c.ReloadClientUI,c.NavigateToGamePage,c.LegacyGetDownloadQueue,c.LegacyGetDownloadServiceConnectionStatus,c.LegacyDownloadQueueUpdated,c.LegacyDeleteGameInstallers,c.LogOut,c.Quit,c.LegacyGamePatchInformationUpdate,c.LegacyGetGamesWithPendingPatches,c.LegacyGameDownloadActiveChanged,c.LegacyGameDownloadAdded,c.LegacyGameDownloadConnectionStatusUpdated,c.FocusBrowserWindow,c.GetGameSession,c.OpenScreenshotFolder,c.ResetGameInstallationLocation,c.ResetGameInstallerCacheLocation,c.RestartClient,c.SwitchToOnline,c.OpenProxySettingsDialog,c.ApplySettings,c.SettingsUpdated,c.SelectPathDialog,c.GetUPNUserSettings,c.UpdateUPNUserSettings,c.DontUploadCrashReportsUpdated,c.LegacyActivateFreeGame,c.LegacyActivateProductKey,c.LegacyClientPatchAvailable,c.WindowSetState,c.WindowGetState,c.MonitorWindowStateUpdate,c.GetRemindMeOfSteamLinking,c.SetRemindMeOfSteamLinking,c.UpdatedRemindMeOfSteamLinking,c.GetSecureStorageData,c.SetSecureStorageData,c.DeleteSecureStorageData,c.GetDefaultSettings,c.SetRecoveryState,c.RefreshView,c.GetPartnerInformation,c.PassAuthentication,c.OpenSteamOverlay,c.GetConnectGameStateInfo,c.SwitchGameAutoUpdates,c.SetGameLaunchArguments,c.RefreshUbisoftTicket,c.HostShutdown,c.ReportAppInitialisationFailure,c.ReportAppInformation,c.VerifyUserCredentials,c.LegacyDownloadVerifyGameProgress,c.LegacyDownloadAllocatingDiskProgress,c.StoreCheckoutStarted,c.StoreCheckoutFinished,c.StoreOnCheckoutCancel,c.GetClientInstallationType,c.GetRunningProduct,c.DeeplinkNavigation,c.GetConnectPlatformAuthToken,c.PrepareRefreshView,c.MonitorRunningProductUpdate,c.GetServiceDegradationState,c.SetServiceDegradationState]}}class Tz{getDefaultFeatures(){return[c.NavigateBack,c.NavigateDeepLink,c.UpdateApplicationHeight,c.UpdateApplicationScrollPosition,c.UpdateNavigationHistory,c.ModalOpened,c.ModalClosed,c.ModalBackdropClick,c.ModalViewportPosition,c.SendAdobeAnalyticData]}}class Rz{getDefaultFeatures(){return[c.Quit]}}class Dz{getDefaultHostFeatures(e){var s;const t=this.getFeatureStrategy(e);return(s=t==null?void 0:t.getDefaultFeatures())!=null?s:[]}getFeatureStrategy(e){if(e.platformVariant===gt.Aegir)return new Mz;switch(e.platformType){case m.IOS:case m.Android:case m.Mobile:return e.mobileCompanionAppType===Bi.CompanionApp?new Nz(e):new Pz;case m.PC:return[p.PCElectronClient,p.PCWebClient].includes(e.hostPlatformType)?new Az:new kf;case m.Luna:case m.Steam:return new kf;case m.Web:return e.hostPlatformType===p.WebEmbedded?new Tz:void 0;case m.Scarlett:case m.XONE:return[p.ScarlettUWPWebView2,p.XoneUWPWebView2].includes(e.hostPlatformType)?new Rz:void 0;default:return}}}var Oz=Object.defineProperty,Fz=Object.getOwnPropertyDescriptor,UG=(i,e,t,s)=>{for(var a=s>1?void 0:s?Fz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Oz(e,t,a),a},_n;const wm=(_n=class extends z{constructor(e,t,s,a=new Dz){super(),this._logger=e,this._hostFeatureConfigurationService=t,this._featureHandlerService=s,this._featureStrategyFactory=a}async initializeHostFeatures(e,t){var n;const s=this.getReadOnlyState(e,S);this._hostFeatureConfigurationService.registerFeatureListenersAndHandlers(s);const a=this._featureStrategyFactory.getDefaultHostFeatures(s);a!=null&&a.length&&await this.updateHostFeatures(e,new rc(a));try{const r=await q(_n.requestTimeoutInMs,this._featureHandlerService.handleFeatureWithoutPayload(c.GetFeatureSupport)),o=(n=r==null?void 0:r.response)==null?void 0:n.features;o!=null&&o.length&&await this.updateHostFeatures(e,new rc(o))}catch(r){this._logger.warn("Getting feature support request failed with error",{error:r,errorCode:g.FailedFeatureSupportRequestWarning,logCategory:f.initialization})}}async updateHostFeatures(e,t){const s=this.getMutableState(e,Q);s.hostFeatures=t.features,this.dispatch(e,new Ur)}},_n.requestTimeoutInMs=500,_n);UG([h(wu)],wm.prototype,"initializeHostFeatures",1);UG([h(rc)],wm.prototype,"updateHostFeatures",1);let Lz=wm;var Gz=Object.defineProperty,xz=Object.getOwnPropertyDescriptor,Ez=(i,e,t,s)=>{for(var a=s>1?void 0:s?xz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Gz(e,t,a),a};class kG extends z{constructor(e,t){super(),this._focusSystem=e,this._logger=t,this._logger=t.createChild("FocusSystemReducer.reducer")}async getFocusSystem(e,t){const s=this._focusSystem.cloneFacade(),a=this.getReadOnlyState(e,M),n=async r=>{const o=a.allActiveAppNames;return o.length&&!o.includes(t.appName)?(this._logger.warn("Microapp ".concat(t.appName," try to focus ").concat(r," while inactive")),!1):!0};return s.addBeforeFocusHook(r=>n(r)),s}}Ez([h(zF)],kG.prototype,"getFocusSystem",1);var Uz=Object.defineProperty,kz=Object.getOwnPropertyDescriptor,bm=(i,e,t,s)=>{for(var a=s>1?void 0:s?kz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Uz(e,t,a),a};class Vs extends oe("[Shell] Hot Keys"){constructor(){super(...arguments),this._shellHotKeys=[]}clearAllKeys(){this.clearAllNavigationBarKeys()}clearAllNavigationBarKeys(){this._shellHotKeys=[]}set navigationBarHotKeys(e){this._shellHotKeys=[...e]}get navigationBarHotKeys(){return[...this._shellHotKeys]}removeNavigationBarKeys(e){this._shellHotKeys=this._shellHotKeys.filter(t=>e.indexOf(t)===-1)}}bm([P],Vs.prototype,"clearAllKeys",1);bm([P],Vs.prototype,"clearAllNavigationBarKeys",1);bm([P],Vs.prototype,"removeNavigationBarKeys",1);var Wz=Object.defineProperty,Vz=Object.getOwnPropertyDescriptor,Cm=(i,e,t,s)=>{for(var a=s>1?void 0:s?Vz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Wz(e,t,a),a};class Zl extends z{constructor(e){super(),this._logger=e,this._logger=e.createChild("HotKey.reducer"),this._logger.settings.logCategory=f.input}async setMicroAppHotKeys(e,t){const s=this.getMutableState(e,M);this._logger.debug("Set ".concat(t.appConfig.appName," app hotkey buttons"),{buttons:t.buttons}),s.setMicroAppHotKeys({key:t.appConfig,value:t.buttons})}async setNavigationBarHotKeys(e,t){const s=this.getMutableState(e,Vs);this._logger.debug("Set Shell hotkey buttons",{buttons:t.buttons}),s.navigationBarHotKeys=t.buttons}async removeNavigationBarHotKeys(e,t){this._logger.debug("Remove shell hotkey buttons",{buttons:t.buttons}),this.getMutableState(e,Vs).removeNavigationBarKeys(t.buttons)}}Cm([h(oF)],Zl.prototype,"setMicroAppHotKeys",1);Cm([h(mu)],Zl.prototype,"setNavigationBarHotKeys",1);Cm([h(cF)],Zl.prototype,"removeNavigationBarHotKeys",1);var $z=Object.defineProperty,Bz=Object.getOwnPropertyDescriptor,Im=(i,e,t,s)=>{for(var a=s>1?void 0:s?Bz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&$z(e,t,a),a};class ys extends oe("[Shell] Input Legend"){constructor(){super(...arguments),this._shellItems=[]}clearAllItems(){this._shellItems=[]}get shellItems(){return this._shellItems}set shellItems(e){this._shellItems=e}get globalShellButtons(){return this.filterNonGlobalItems(this._shellItems).map(e=>e.button)}clearNonGlobalShellItems(){this._shellItems=this.filterNonGlobalItems(this._shellItems)}clearGlobalShellItems(){this._shellItems=this.filterGlobalItems(this._shellItems)}filterNonGlobalItems(e){return e.filter(t=>t.isGlobal)}filterGlobalItems(e){return e.filter(t=>!t.isGlobal)}}Im([P],ys.prototype,"clearAllItems",1);Im([P],ys.prototype,"clearNonGlobalShellItems",1);Im([P],ys.prototype,"clearGlobalShellItems",1);var Hz=Object.defineProperty,Qz=Object.getOwnPropertyDescriptor,Mm=(i,e,t,s)=>{for(var a=s>1?void 0:s?Qz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Hz(e,t,a),a};class ep extends z{constructor(e){super(),this._logger=e,this._logger=e.createChild("InputLegend.reducer"),this._logger.settings.logCategory=f.input}async setMicroAppLegendItems(e,t){const s=this.getMutableState(e,M);this._logger.debug("Set ".concat(t.appConfig.appName," app legend items"),{items:t.items}),s.setMicroAppLegend({key:t.appConfig,value:t.items})}async setShellLegendItems(e,t){const s=this.getMutableState(e,ys);this._logger.debug("Set Shell legend items",{items:t.items}),s.clearNonGlobalShellItems();const a=s.shellItems;s.shellItems=[...t.items,...a]}async setGlobalShellLegendItems(e,t){const s=this.getMutableState(e,ys);this._logger.debug("Set global Shell legend items",{items:t.items}),s.clearGlobalShellItems();const a=s.shellItems;s.shellItems=[...a,...t.items]}}Mm([h(lF)],ep.prototype,"setMicroAppLegendItems",1);Mm([h(pF)],ep.prototype,"setShellLegendItems",1);Mm([h(uF)],ep.prototype,"setGlobalShellLegendItems",1);var jz=Object.defineProperty,qz=Object.getOwnPropertyDescriptor,Am=(i,e,t,s)=>{for(var a=s>1?void 0:s?qz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&jz(e,t,a),a};class ls extends oe("InteractionsState"){constructor(){super(...arguments),this._storeKey="Shell_Interactions",this._interactions=[],this._userId=void 0}get storeKey(){return this._storeKey}get interactions(){return this._interactions}get userId(){return this._userId}set userId(e){this._userId=e}setInteraction(e){this._interactions=[e,...this._interactions.filter(t=>t.key!==e.key)]}clearInteraction(e){this._interactions=this._interactions.filter(t=>t.key!==e)}clearAllInteractions(){this._interactions=[]}}Am([P],ls.prototype,"setInteraction",1);Am([P],ls.prototype,"clearInteraction",1);Am([P],ls.prototype,"clearAllInteractions",1);var zz=Object.defineProperty,Kz=Object.getOwnPropertyDescriptor,tp=(i,e,t,s)=>{for(var a=s>1?void 0:s?Kz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&zz(e,t,a),a};class lo extends z{constructor(e,t){super(),this._logger=e,this._localStorageService=t,this._logger=this._logger.createChild("Interactions.reducer"),this._logger.settings.logCategory=f.shell}async loadInteractions(e,t){if(!t.userId){this._logger.warn("userId is not defined, aborting load of interactions",{errorCode:g.FailedLoadUserIdWarning});return}const s=this.getMutableState(e,ls),a=this.getAllReleventKeys(e,t.userId),n=t.userId;a.length&&a.forEach(r=>{const o=this._localStorageService.getValue(r);s.setInteraction({key:r.replace("".concat(this.generateUserSpecificKey(e,n),"_"),""),value:this.parseValue(o)})}),s.userId=t.userId}async registerInteraction(e,t){var n;const s=this.getMutableState(e,ls),a=(n=t.value)!=null?n:!0;if(!this.isStoreReady(s)){this._logger.warn("Cannot register interaction for ".concat(t.key," before interactions are loaded"),{key:t.key,value:a,errorCode:g.FailedInteractionRegistrationWarning});return}this._localStorageService.setValue(this.generateUserSpecificKey(e,s.userId,t.key),JSON.stringify(a)),s.setInteraction({key:t.key,value:a})}async clearInteraction(e,t){const s=this.getMutableState(e,ls);if(!this.isStoreReady(s)){this._logger.warn("Cannot clear interaction for ".concat(t.key," before interactions are loaded"),{key:t.key,errorCode:g.FailedInteractionClearingWarning});return}this._localStorageService.deleteValue(this.generateUserSpecificKey(e,s.userId,t.key)),s.clearInteraction(t.key)}async clearAllInteractions(e){const t=this.getMutableState(e,ls);if(!this.isStoreReady(t)){this._logger.warn("Cannot clear interactions before interactions are loaded",{errorCode:g.FailedInteractionClearingWarning});return}this.getAllReleventKeys(e,t.userId).forEach(a=>{this._localStorageService.deleteValue(this.generateUserSpecificKey(e,t.userId,a))}),t.clearAllInteractions()}generateUserSpecificKey(e,t,s){const a=this.getReadOnlyState(e,ls);return s?"".concat(a.storeKey,"_").concat(t,"_").concat(s):"".concat(a.storeKey,"_").concat(t)}isStoreReady(e){return!!e.userId}getAllReleventKeys(e,t){return this._localStorageService.getKeys(s=>s.includes(this.generateUserSpecificKey(e,t)))}parseValue(e){try{return JSON.parse(e)}catch(t){return e}}}tp([h(AO)],lo.prototype,"loadInteractions",1);tp([h(N7)],lo.prototype,"registerInteraction",1);tp([h(T7)],lo.prototype,"clearInteraction",1);tp([h(R7)],lo.prototype,"clearAllInteractions",1);var Xz=Object.defineProperty,Jz=Object.getOwnPropertyDescriptor,Yz=(i,e,t,s)=>{for(var a=s>1?void 0:s?Jz(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Xz(e,t,a),a};class WG extends z{async updateBreakpoint(e,t){const s=this.getMutableState(e,ao);s.breakpoint!==t.breakpoint&&(s.breakpoint=t.breakpoint)}}Yz([h(VO)],WG.prototype,"updateBreakpoint",1);var Zz=Object.defineProperty,eK=Object.getOwnPropertyDescriptor,tK=(i,e,t,s)=>{for(var a=s>1?void 0:s?eK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Zz(e,t,a),a};class Ei extends oe("[Shell] Shortcuts"){constructor(){super(...arguments),this._backButtonShortcutData=null,this._exitButtonShortcutData=null,this._backButtonShortcut=null,this._exitButtonShortcut=null}get backButtonShortcutData(){return this._backButtonShortcutData}set backButtonShortcutData(e){this._backButtonShortcutData=e}get exitButtonShortcutData(){return this._exitButtonShortcutData}set exitButtonShortcutData(e){this._exitButtonShortcutData=e}get exitButtonShortcut(){return this._exitButtonShortcut}set exitButtonShortcut(e){this._exitButtonShortcut=e}get backButtonShortcut(){return this._backButtonShortcut}set backButtonShortcut(e){this._backButtonShortcut=e}clearAllShortcutData(){this.backButtonShortcutData=null,this.exitButtonShortcutData=null,this._backButtonShortcut=null,this._exitButtonShortcut=null}}tK([P],Ei.prototype,"clearAllShortcutData",1);class iK extends It{async redirectToThirdPartyAuthenticationPage(e,t,s){const a=Array.isArray(t)?new ru(e,s,void 0,t):new ru(e,s,t,void 0);return this.validateDispose(this,"redirectToThirdPartyAuthenticationPage",{url:e,callbackParameters:t,data:s}).then(()=>this._store.dispatchIntent(a))}setUserSession(e,t,s){if(this._logger.info("".concat(this._appConfig.appName,": Set user session call"),{logCategory:f.authentication}),e==null){const a="Cannot set empty session.";throw this._logger.warn(a,{errorCode:g.CannotSetEmptySessionWarning}),new De(a)}return this.validateDispose(this,"setUserSession",{sessionId:e.sessionId}).then(()=>this._store.dispatchIntent(new at(e,t,s)))}setOfflineSession(e,t,s){if(this._logger.info("".concat(this._appConfig.appName,": Set offline session call"),{logCategory:f.authentication}),e==null){const a="Cannot set empty session.";throw this._logger.warn(a,{errorCode:g.CannotSetEmptySessionWarning}),new De(a)}return this.validateDispose(this,"setOfflineSession",{sessionId:e.sessionId}).then(()=>this._store.dispatchIntent(new qc(e,t,s)))}async setAccountLinkingInProgress(e){return this.validateDispose(this,"setAccountLinkingInProgress").then(()=>this._store.dispatchIntent(new VS(e)))}setFirstPartyAuthenticationToken(e,t){if(!(e!=null&&e.length)){const s="First party authentication token is missing.";throw this._logger.warn(s,{errorCode:g.FirstPartyAuthenticationTokenMissingWarning}),new De(s)}return this.validateDispose(this,"setFirstPartyAuthenticationToken",{token:e,platformType:t}).then(()=>this._store.dispatchIntent(new nO(e,t)))}async setAuthenticationError(e,t){return this.validateDispose(this,"setAuthenticationError").then(()=>this._store.dispatchIntent(new rO(e,t)))}async verifyUserCredentials(e){if(this._logger.info("".concat(this._appConfig.appName,": Verify user credentials call"),{logCategory:f.authentication}),!(e!=null&&e.email)||!(e!=null&&e.password)||!(e!=null&&e.profileId)){const t="Cannot verify invalid credentials.";return this._logger.warn(t,{errorCode:g.FailedUserCredentialsVerificationWarning}),{isSuccess:!1,errorCode:Ep.InvalidCredentialFormat}}return this.validateDispose(this,"verifyUserCredentials").then(()=>this._store.dispatchIntent(new cO(e.email,e.password,e.profileId)))}async getConnectPlatformAuthToken(){return this.validateDispose(this,"getConnectPlatformAuthToken").then(()=>this._store.dispatchIntent(new lO))}}var sK=Object.defineProperty,aK=Object.getOwnPropertyDescriptor,pt=(i,e,t,s)=>{for(var a=s>1?void 0:s?aK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&sK(e,t,a),a};const nK=20*1e3;var Sn;const Ze=(Sn=class extends z{constructor(e,t,s,a,n,r,o,l,u,v,w){super(),this._logger=e,this._lifeGuardService=t,this._localStorageService=s,this._shellConfigService=a,this._appBundleUrlOverrideHelper=n,this._runtimeParameters=r,this._featureHandlerService=o,this._localizationService=l,this._metricDefinitions=u,this._shellConfig=v,this._httpClient=w,this._logger=e.createChild("MicroApps.reducer"),this._logger.settings.logCategory=f.microAppLifecycle}async activateMicroApp(e,t){var x,F,V;const s=t.microAppConfig,{placement:a,appName:n}=s;this._logger.info("Activating microApp ".concat(n," in ").concat(a));const r=this.getMutableState(e,S),o=this.getMutableState(e,M),l=Es[r.layoutType].length>1?xs.sideView:(x=s.defaultViewMode)!=null?x:xs.sideView;await this.dispatch(e,new vl(l));const u=this.getMutableState(e,M),v=u.getMicroAppStateData(s);((F=u.getActiveMicroApp(a))==null?void 0:F.appName)!==n&&(await this.dispatch(e,new _l),await this.dispatch(e,new Gg(s)),u.resetMicroAppStateData(s),u.setMicroAppActiveGame({key:s,value:t.navigationContext.game})),o.setActivatingMicroApp({placement:s.placement,value:s});const w=s.additionalNavigationArguments?{...t.navigationContext,applicationData:{...s.additionalNavigationArguments,...Object.assign({},t.navigationContext.applicationData)}}:t.navigationContext,{isActive:b,error:I}=await this._lifeGuardService.activate(s,w),R=this.getMutableState(e,Y);if(t.direction===ci.backwards?(this._logger.debug("Update navigation history on app back activation",{logCategory:f.navigationHistory}),R.onMicroAppBackActivation({value:w,placement:a})):(this._logger.debug("Update navigation history on app activation",{logCategory:f.navigationHistory}),R.onMicroAppActivation({value:w,placement:a})),b?(this.dispatch(e,new $t),u.setActiveMicroApp({placement:a,value:s}),a===u.defaultPlacement&&(r.defaultMicroApp=s,u.isTopLevelAppBySpaceId(s.spaceId,r.hostGame.spaceId)&&(u.lastActiveTopLevelAppSpaceId=s.spaceId)),this._logger.info("MicroApp ".concat(n," successfully activated in ").concat(a)),s.preload!==!0&&await this.enforceMountedMicroAppLimit(e,s),this.dispatch(e,new WF(s))):(u.setMicroAppStateData({key:s,value:v}),this._logger.error("Failed to activate MicroApp ".concat(n," in ").concat(a),{errorCode:g.MicroAppsActivateMicroAppError,error:I}),(V=this._metricDefinitions)==null||V.getMetric(Ae.UAppInitializationError).add(1,{appName:n,errorCode:ca.ActivationFailed}),t.showGenericErrorOrThrow&&await this.dispatch(e,new ji({message:"error.generic"},s.placement))),u.setActivatingMicroApp({placement:a,value:void 0}),!t.showGenericErrorOrThrow&&I)throw I;return b}async enforceMountedMicroAppLimit(e,t){const s=this.getMutableState(e,M);s.removeFromMounted(t),s.addToMounted(t);const n=s.dynamicallyMountedMicroApps.filter(r=>r.placement===t.placement);if(n.length>Sn.locMaxActiveMicroApps){this._logger.debug("Mounted microApps limit exceeded for placement: ".concat(t.placement),{mountedAppsCount:n.length});const r=n.shift();r!==void 0&&(await this._lifeGuardService.unmount(r),s.removeFromMounted(r),this.dispatch(e,new VF(r.appName)),this.dispatch(e,new hn(r)),this.dispatch(e,new lc(r)))}}async deactivateAllMicroApps(e,t){const s=this.getMutableState(e,S),a=this.getMutableState(e,M);return this._logger.info("Deactivating all microApps"),(await Promise.all(Es[s.layoutType].map(r=>{const o=a.getActiveMicroApp(r);return o?this.dispatch(e,new Vr(t.shouldSaveStateToNavigationHistory,o)):Promise.resolve(!0)}))).every(r=>r===!0)}async deactivateMicroApp(e,t){var l,u,v,w;const s=this.getMutableState(e,S),a=this.getReadOnlyState(e,M),{placement:n,appName:r}=t.microApp;this._logger.info("Deactivating microApp ".concat(r," in ").concat(n));const o=t.microApp;if(o===void 0||!this._lifeGuardService.hasLifeGuard(o))return this._logger.warn("MicroApp ".concat(r," is not active or does not have lifeguard"),{errorCode:g.MicroappNotActiveWarning}),!0;try{const b=await this._lifeGuardService.requestDeactivation(o,t.deactivateRequest);if(!((l=b.shouldDeactivate)!=null?l:!0)||b.confirmationRequired&&!await this.dispatch(e,new qD(b.reason)))return!1;if(((u=s.focusedMicroApp)==null?void 0:u.appName)===o.appName&&await this.dispatch(e,new Ko(o)),t.shouldSaveStateToNavigationHistory){const R=this.getMutableState(e,Y);if(b.applicationData){const x={appName:o.appName,game:s.activeGame,applicationData:b.applicationData,parentAppName:o.parentAppName};R.replaceCurrentItem({placement:n,value:x})}}}catch(b){this._logger.warn("An error occurred while confirming deactivation for ".concat(r," in ").concat(n,". Will try to deactivate micro app despite error."),{error:b,errorCode:g.FailedDeactivationMicroappWarning}),(v=this._metricDefinitions)==null||v.getMetric(Ae.UAppInitializationError).add(1,{appName:r,errorCode:ca.BeforeDeactivate})}return await this._lifeGuardService.deactivate(o),this._logger.info("MicroApp ".concat(r," in ").concat(n," was deactivated")),n===((w=s.focusedMicroApp)==null?void 0:w.placement)&&await this.dispatch(e,new lr(null)),a.setActiveMicroApp({placement:n,value:void 0}),n===a.defaultPlacement&&(s.defaultMicroApp=void 0),await this.dispatch(e,new kF(o)),!0}async showDeactivateConfirmationDialog(e,t){return this._logger.debug("Showing deactivate confirmation dialog",{reason:t.reason}),confirm("Please confirm. ".concat(t.reason))}async focusMicroApp(e,t){const{shellMicroAppConfig:s}=t;this._logger.debug("Focus micro app ".concat(s.appName),{logCategory:f.focus}),this.getReadOnlyState(e,M).microAppSupportsFocusSystemSingleInstance(s.appName)||await this.dispatch(e,new aG);const r=await this._lifeGuardService.focus(s);return r&&await this.dispatch(e,new jp(s)),r}async blurMicroApp(e,t){var n;this._logger.debug("Blur micro app ".concat(t.shellMicroAppConfig.appName),{logCategory:f.focus});const s=t.shellMicroAppConfig.placement,a=await this._lifeGuardService.blur(t.shellMicroAppConfig);return a&&((n=this.getReadOnlyState(e,S).focusedMicroApp)==null?void 0:n.placement)===s&&await this.dispatch(e,new jp(void 0)),a}async blurFocusedMicroApp(e){const{focusedMicroApp:t}=this.getReadOnlyState(e,S);t&&await this.dispatch(e,new Ko(t))}async loadAuthenticationMicroApp(e,t){this._logger.info("Loading authentication microApp configuration",{logCategory:f.authentication});const s=this.getMutableState(e,M);let a=s.authenticationApplicationConfig;const n=new Pd(this._localStorageService);await this.dispatch(e,new rg(!1));const r=n.retrieveAuthenticationRedirectData(),o=n.retrieveCallbackParameterValue(window.location),l={...t.authData};if(r&&Object.assign(l,{preThirdPartyAuthenticationRedirectData:r}),o)Object.assign(l,{authenticationCallbackParameterValue:o});else{const b=n.retrieveMultipleCallbackParametersValues(window.location);b&&Object.assign(l,{...b})}t.additionalData&&Object.assign(l,{microAppParams:t.additionalData});const u=this.getMutableState(e,S);if(await this.dispatch(e,new nr),!a){let b;try{[p.PCLegacyClient,p.SteamClient,p.PCWebClient].includes(u.hostPlatformType)?b=await this.getAuthAppOrThrow(u):b=await q(nK,le(()=>this._shellConfigService.v3.getAuthenticationApplication(this._runtimeParameters.hostSpaceId,this._runtimeParameters.hostAppId,pc(this._runtimeParameters)))),this._logger.debug("Loaded authentication microApp configuration",{authApp:b,logCategory:f.authentication}),(!b||b.isEnabled===!1)&&this.throwAuthAppIsNotAvailable("Authentication microApp not configured or enabled"),b.manifestUrl&&this.dispatch(e,new su([b.manifestUrl])),b.bundleUrl=this._appBundleUrlOverrideHelper.getBundleConfig(b.appName,b.bundleUrl).bundleUrl,s.updateAuthenticationApplicationConfig(b),a=s.authenticationApplicationConfig,s.apiFactory.registerApi(b.spaceId,iK)}catch(I){return await this.handleAuthenticationMicroAppLoadError(e,"Failed to load authentication microApp",g.MicroAppsLoadAuthenticationMicroAppError,I),!1}}if(!a)return await this.handleAuthenticationMicroAppLoadError(e,"Failed to get authentication microApp configuration",g.MicroAppsLoadAuthenticationMicroAppConfigError),!1;s.setNavigationInProgress({placement:a.placement,value:a.appName});const v={appName:a.appName,game:u.hostGame,applicationData:l,parentAppName:a.parentAppName},w=a.bundleUrl;try{let b;if(await le(async()=>{b=await this.dispatch(e,new bl(a,v,void 0,!1))}),await this.dispatch(e,new so(a.placement)),!b)return await this.handleAuthenticationMicroAppLoadError(e,"Failed to activate authentication microApp from ".concat(w),g.MicroAppsActivateAuthenticationMicroappError,void 0,w),!1}catch(b){return await this.handleAuthenticationMicroAppLoadError(e,"An error occurred while activating authentication microApp from ".concat(w),g.MicroAppsActivatingAuthenticationMicroappError,b,w),!1}finally{s.setNavigationInProgress({placement:a.placement,value:void 0}),await this.dispatch(e,new vg)}return!0}async cacheAuthAppConfigForOffline(e){try{this._logger.info("Cache authentication microApp config",{logCategory:f.authentication});const t=this.getMutableState(e,S),s=await this.getAuthAppOrThrow(t);(!s||s.isEnabled===!1)&&this.throwAuthAppIsNotAvailable("Authentication microApp not configured or enabled");const{manifestUrl:a,bundleUrl:n,appName:r}=s;a&&await this.dispatch(e,new su([a]));const o=this._appBundleUrlOverrideHelper.getBundleConfig(r,n).bundleUrl;try{await this._httpClient.getRaw(o)}catch(l){this.throwAuthAppIsNotAvailable("Failed to get authentication microApp bundle error: ".concat(jn(l)))}this._logger.info("Cached authentication microApp config",{logCategory:f.authentication})}catch(t){this._logger.error("Failed to cache authentication microApp config",{logCategory:f.authentication,errorCode:g.CacheAuthenticationMicroAppConfigError,error:t,errorMessage:jn(t)})}}async handleAuthenticationMicroAppLoadError(e,t,s,a,n){var o;this._logger.error(t,{logCategory:f.authentication,errorCode:s,error:a});const r=await this.getDolphinErrorCode(e,n);(o=window.upn)!=null&&o.enableAuthAppPc&&r===g.Dolphin_32?await this.dispatch(e,new Qt({message:"error.generic",errorCode:g.Dolphin_32})):(await this.reportAppInitialisationFailure(e,t,r,a),await this.dispatch(e,new ji({message:"error.generic"})))}async getDolphinErrorCode(e,t){let s=!1;try{t&&(s=await this.dispatch(e,new VD(t,{ignoreSearch:!0})))}catch(a){this._logger.error("Failed to check if authentication microApp is cached",{logCategory:f.authentication,error:a})}return s?g.Dolphin_37:g.Dolphin_32}async reportAppInitialisationFailure(e,t,s,a){const n=this.getReadOnlyState(e,S),r={environment:n.environment,country:n.country,isOnline:n.isOnline,platform:n.platformType,isStandalone:n.isStandalone,message:t},o={message:"".concat(this.getLocalizedText("error.generic"),"\n#").concat(s),errorCode:s,customData:r};if(a){const l=typeof a=="string"?a:a.message;o.error=l,r.error=l}await this._featureHandlerService.handleFeature(c.ReportAppInitialisationFailure,o)}async getAuthAppOrThrow(e){let t;try{t=await le(()=>this._shellConfigService.v3.getAuthenticationApplicationBatch(this._shellConfig.applicationIds,pc(this._runtimeParameters)))}catch(s){this.throwAuthAppIsNotAvailable("Get authentication microApp batch error: ".concat(jn(s)))}return t||this.throwAuthAppIsNotAvailable("Authentication microApps not configured"),t[e.shellApplicationId]}throwAuthAppIsNotAvailable(e){const t="Authentication microApp is not available, cause: ".concat(jn(e));throw this._logger.warn(t,{logCategory:f.authentication,errorCode:g.AuthenticationMicroappNotAvailableWarning}),new De(t)}getLocalizedText(e){return this._localizationService.formatMessage({id:e})}async unmountAllMicroApps(e){this._logger.info("Unmounting all microApps"),await this.dispatch(e,new sn),this.getMutableState(e,ys).clearAllItems(),this.getMutableState(e,Vs).clearAllKeys(),this.getMutableState(e,Ei).clearAllShortcutData(),await this._lifeGuardService.unmountAll();const n=this.getMutableState(e,M);n.clearAllMicroAppData(),n.removeAllFromMounted(),n.wipeConfigData(),this.getMutableState(e,S).wipeDefaultMicroapp(),n.dynamicallyMountedMicroApps.forEach(l=>{this.dispatch(e,new hn(l)),this.dispatch(e,new lc(l))})}async scrollActiveMicroAppContent(e,t){const a=this.getMutableState(e,M).getActiveMicroApp(t.placement);return a?this._lifeGuardService.scrollAppContent(a,t.options):(this._logger.warn("Unable to scroll micro app content in ".concat(t.placement,", since active micro app is not defined"),{scrollOptions:t.options,errorCode:g.ActiveMicroappNotDefinedWarning}),!1)}async verifyAvailableMicroApps(e,t){const{appsToPreload:s}=this.getReadOnlyState(e,M),a=this.getReadOnlyState(e,S),n=[];s.forEach(o=>{o.runtimeAvailabilityCheckRequired&&n.push(o)}),await this.dispatch(e,new Xo(n));const r=[];await Promise.all(n.map(async o=>{const l={appName:o.appName,game:a.hostGame,applicationData:o.additionalNavigationArguments,parentAppName:o.parentAppName};await this.dispatch(e,new XD(o,l))||r.push(o)})),await this.dispatch(e,new Xo(r))}async checkAppIsAvailable(e,t){const s=t.microAppConfig,a=s.additionalNavigationArguments?{...t.navigationContext,applicationData:Object.assign(s.additionalNavigationArguments,t.navigationContext.applicationData)}:t.navigationContext;return this._lifeGuardService.appIsAvailable(s,a)}async setNonAvailableMicroApps(e,t){const s=this.getMutableState(e,M);s.nonAvailableMicroApps=t.nonAvailableMicroApps}async getLegacyParentAppNameIntent(e,t){const s=this.getReadOnlyState(e,M),a=[null,J.AppGamePage];return[J.AppAuth,J.AppAuthentication].includes(t.microAppName)?null:(await this.dispatch(e,new tn(t.game.spaceId,t.game.applicationId)),a.find(n=>s.findMicroAppConfig(t.microAppName,n,t.game.spaceId)))}async enableFocusSystemSingleInstanceForMicroApp(e,t){const s=this.getMutableState(e,M);s.supportsFocusSystemSingleInstance.includes(t.appName)||(s.supportsFocusSystemSingleInstance=[...s.supportsFocusSystemSingleInstance,t.appName])}},Sn.locMaxActiveMicroApps=2,Sn);pt([h(bl)],Ze.prototype,"activateMicroApp",1);pt([h(sn)],Ze.prototype,"deactivateAllMicroApps",1);pt([h(Vr)],Ze.prototype,"deactivateMicroApp",1);pt([h(qD)],Ze.prototype,"showDeactivateConfirmationDialog",1);pt([h(jD)],Ze.prototype,"focusMicroApp",1);pt([h(Ko)],Ze.prototype,"blurMicroApp",1);pt([h(Mn)],Ze.prototype,"blurFocusedMicroApp",1);pt([h(zD)],Ze.prototype,"loadAuthenticationMicroApp",1);pt([h(fg)],Ze.prototype,"cacheAuthAppConfigForOffline",1);pt([h(No)],Ze.prototype,"unmountAllMicroApps",1);pt([h(KD)],Ze.prototype,"scrollActiveMicroAppContent",1);pt([h(mg)],Ze.prototype,"verifyAvailableMicroApps",1);pt([h(XD)],Ze.prototype,"checkAppIsAvailable",1);pt([h(Xo)],Ze.prototype,"setNonAvailableMicroApps",1);pt([h(Xe)],Ze.prototype,"getLegacyParentAppNameIntent",1);pt([h(JD)],Ze.prototype,"enableFocusSystemSingleInstanceForMicroApp",1);let rK=Ze;var oK=Object.defineProperty,cK=Object.getOwnPropertyDescriptor,si=(i,e,t,s)=>{for(var a=s>1?void 0:s?cK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&oK(e,t,a),a};let rt=class extends K{onBackdropClicked(e){e.target===this.$refs.modalBackdrop&&this.$dispatch(new $g)}shouldApplyFullViewStyle(){return this.isModalFullView&&this.breakpoint<yi.Small}get classList(){return["modal-backdrop",{"platform-console":IG.includes(this.platformType),"modal-opened":this.isModalVisible,"standalone-mode":this.isStandalone,"focus-active":this.isFocusSystemActive},bG[this.orientation],CG[this.platformType],Xs[this.navigationMethod],Mu[this.viewportMode]]}get modalWrapperId(){var t;const e=(t=this.currentMicroAppName)!=null?t:"shell";return"".concat(e,"-modal")}get modalClassList(){const e=["modal"];return this.shouldApplyFullViewStyle()&&e.push("modal-full-view"),this.viewportPosition&&e.push("use-viewport-position"),e}get cssVars(){return this.viewportPosition&&!this.shouldApplyFullViewStyle()?{"--viewport-height":"".concat(this.viewportPosition.height,"px"),"--viewport-top":"".concat(this.viewportPosition.top,"px")}:{"--viewport-height":"100vh","--viewport-top":"0"}}};rt.ModalId="shell-modal-id";si([C(Lt,"currentMicroApp")],rt.prototype,"currentMicroAppName",2);si([C(Lt,"isVisible")],rt.prototype,"isModalVisible",2);si([C(Lt,"isModalFullView")],rt.prototype,"isModalFullView",2);si([C(Lt,"viewportPosition")],rt.prototype,"viewportPosition",2);si([C(S,"platformType")],rt.prototype,"platformType",2);si([C(S,"isStandalone")],rt.prototype,"isStandalone",2);si([C(S,"orientation")],rt.prototype,"orientation",2);si([C(Lt,"loadingSpinner")],rt.prototype,"isSpinnerVisible",2);si([C(S,"navigationMethod")],rt.prototype,"navigationMethod",2);si([C(ye,"isFocusSystemActive")],rt.prototype,"isFocusSystemActive",2);si([C(it,"viewportMode")],rt.prototype,"viewportMode",2);si([C(ao,"breakpoint")],rt.prototype,"breakpoint",2);rt=si([j({components:{"upn-spinner":Ol}})],rt);var lK=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("transition",{attrs:{name:"modal"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:i.isModalVisible,expression:"isModalVisible"}],ref:"modalBackdrop",class:i.classList,on:{click:i.onBackdropClicked}},[t("div",{staticClass:"modal-viewport",style:i.cssVars},[t("div",{class:i.modalClassList,attrs:{role:"dialog"}},[t("div",{ref:"modalContent",staticClass:"modal-wrapper",attrs:{id:i.modalWrapperId}},[t("div",{attrs:{"data-e2e":"shell-modal-window"+(i.isModalVisible?"-shown":"-hidden"),id:"shell-modal-id"}})])])]),i.isSpinnerVisible?t("upn-spinner"):i._e()],1)])},pK=[];const Wf={};var uK=Z(rt,lK,pK,!1,dK,"de17ec8a",null,null);function dK(i){for(let e in Wf)this[e]=Wf[e]}const VG=function(){return uK.exports}();var hK=Object.defineProperty,gK=Object.getOwnPropertyDescriptor,ip=(i,e,t,s)=>{for(var a=s>1?void 0:s?gK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&hK(e,t,a),a};class po extends z{constructor(e,t){super(),this._logger=e,this._featureHandlerService=t,this._logger=e.createChild("Modal.reducer"),this._logger.settings.logCategory=f.shell}async showModal(e,t){var n,r,o;const s=this.getMutableState(e,Lt);if(s.isVisible)return null;this._logger.info("Show Shell Modal"),s.isVisible=!0,s.currentMicroApp=t.appName,((n=t.config)==null?void 0:n.shouldCloseOnClickBackdrop)!==void 0&&(s.shouldCloseOnClickBackdrop=t.config.shouldCloseOnClickBackdrop),((r=t.config)==null?void 0:r.isModalFullView)!==void 0&&(s.isModalFullView=t.config.isModalFullView),(o=t.config)!=null&&o.onModalClose&&(s.onModalClose=t.config.onModalClose);const a=document.getElementById(VG.ModalId);return a&&(a.innerHTML=""),this._featureHandlerService.handleFeature(c.ModalOpened,{fullview:s.isModalFullView}),a}async onBackdropClicked(e,t){const{shouldCloseOnClickBackdrop:s}=this.getMutableState(e,Lt);(typeof s=="function"?s():s)&&this.dispatch(e,new qi)}async updateModalViewportPosition(e,t){const s=this.getMutableState(e,Lt),a=t.viewportPosition.viewportTop-t.viewportPosition.shellTop;s.viewportPosition={top:Math.max(0,a),height:t.viewportPosition.viewportHeight+Math.min(0,a)}}async hideModal(e,t){const s=this.getMutableState(e,Lt);if(s.isVisible&&(this._logger.info("Close Shell Modal"),this._featureHandlerService.handleFeatureWithoutPayload(c.ModalClosed)),s.isVisible=!1,s.isModalFullView=!1,s.onModalClose)try{s.onModalClose()}catch(a){this._logger.warn("Error executing close callback on modal",{error:a,errorCode:g.FailedCloseCallbackModalWarning})}finally{s.onModalClose=null}}}ip([h(qr)],po.prototype,"showModal",1);ip([h($g)],po.prototype,"onBackdropClicked",1);ip([h(KF)],po.prototype,"updateModalViewportPosition",1);ip([h(qi)],po.prototype,"hideModal",1);var mK=Object.defineProperty,fK=Object.getOwnPropertyDescriptor,yK=(i,e,t,s)=>{for(var a=s>1?void 0:s?fK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&mK(e,t,a),a};class $G extends z{async setCurrentlyFocusedTile(e,t){const s=this.getMutableState(e,hm);s.currentlyFocusedTileId=t.focusableId}}yK([h(dm)],$G.prototype,"setCurrentlyFocusedTile",1);var vK=Object.defineProperty,_K=Object.getOwnPropertyDescriptor,Da=(i,e,t,s)=>{for(var a=s>1?void 0:s?_K(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&vK(e,t,a),a};class Ys extends z{constructor(e,t){super(),this._logger=e,this._featureHandlerService=t,this._logger=e.createChild("NavigationHistory.reducer"),this._logger.settings.logCategory=f.navigationHistory}async saveToNavigationHistory(e,t){const s=this.getMutableState(e,Y);return this._logger.debug("Add ".concat(t.appConfig.appName," to ").concat(t.appConfig.placement," navigation history stack"),{navigationContext:t.navigationContext}),s.addToStack({value:t.navigationContext,placement:t.appConfig.placement}),this.dispatch(e,new $t)}async clearNavigationHistory(e){const t=this.getMutableState(e,Y);return this._logger.debug("Clear all navigation history",{}),t.clearHistory(),this.dispatch(e,new $t)}async pushToNavigationHistoryQueue(e,t){const s=this.getMutableState(e,Y);this._logger.debug("Push ".concat(t.appConfig.appName," to ").concat(t.appConfig.placement," navigation history queue"),{navigationContext:t.navigationContext}),s.pushItemToHistoryQueue({value:t.navigationContext,placement:t.appConfig.placement})}async pushNavigationHistoryQueueToStack(e){const t=this.getMutableState(e,Y);return this._logger.debug("Push all navigation history queue to stack",{}),t.pushHistoryQueueToStack(),this.dispatch(e,new $t)}async pushHistoryState(e,t){const s=this.getMutableState(e,Y);return this._logger.debug("Push ".concat(t.appConfig.appName," to ").concat(t.appConfig.placement," navigation history stack"),{navigationContext:t.navigationContext}),s.pushItem({value:t.navigationContext,placement:t.appConfig.placement}),this._featureHandlerService.handleFeature(c.UpdateNavigationHistory,{appName:t.appConfig.appName,applicationData:t.navigationContext.applicationData,type:"push"}),this.dispatch(e,new $t)}async replaceHistoryState(e,t){const s=this.getMutableState(e,Y);return this._logger.debug("Replace current item in ".concat(t.appConfig.placement," navigation history stack"),{oldItem:s.currentItem,newItem:t.navigationContext}),s.replaceCurrentItem({value:t.navigationContext,placement:t.appConfig.placement}),this._featureHandlerService.handleFeature(c.UpdateNavigationHistory,{appName:t.appConfig.appName,applicationData:t.navigationContext.applicationData,type:"replace"}),this.dispatch(e,new $t)}async clearPlacementNavigationHistory(e,t){return this.getMutableState(e,Y).clearPlacementHistory(t.placement),this.dispatch(e,new $t)}}Da([h(yg)],Ys.prototype,"saveToNavigationHistory",1);Da([h(Jo)],Ys.prototype,"clearNavigationHistory",1);Da([h(ZD)],Ys.prototype,"pushToNavigationHistoryQueue",1);Da([h(vg)],Ys.prototype,"pushNavigationHistoryQueueToStack",1);Da([h(YD)],Ys.prototype,"pushHistoryState",1);Da([h(eO)],Ys.prototype,"replaceHistoryState",1);Da([h(tO)],Ys.prototype,"clearPlacementNavigationHistory",1);var ni;(i=>{i.SupportedNotificationTypes=[O.GameInvite,O.FriendInGame,O.FriendOnline,O.PlayAvailable,O.GamePatchAvailable,O.DownloadCompleted,O.OverlayStart,O.GameCustom,O.FriendRequest,O.ScreenshotSaved,O.ChatMessage,O.GroupInvite,O.SharePlayInviteFailed,O.SharePlayTimeOutSessionReminder,O.SharePlaySessionEnded,O.Achievement],i.SupportedDesktopNotificationTypes=[O.GameInvite,O.FriendInGame,O.FriendOnline,O.PlayAvailable,O.DownloadCompleted,O.FriendRequest,O.ChatMessage,O.GroupInvite],i.AlwaysShownNotifications=[O.OverlayStart,O.GameCustom,O.SharePlayInviteFailed,O.SharePlayTimeOutSessionReminder,O.SharePlaySessionEnded],i.NotificationsSettingsEnabledMap={[O.GameInvite]:"gameInviteEnabled",[O.FriendInGame]:"friendGameEnabled",[O.FriendOnline]:"friendOnlineEnabled",[O.PlayAvailable]:"playAvailableEnabled",[O.GamePatchAvailable]:"gamePatchAvailableEnabled",[O.DownloadCompleted]:"downloadCompleteEnabled",[O.FriendRequest]:"friendRequestEnabled",[O.ScreenshotSaved]:"screenshotsEnabled",[O.ChatMessage]:"chatEnabled",[O.GroupInvite]:"groupInviteEnabled",[O.Achievement]:"desktopAchievementsEnabled"},i.isSupportedType=e=>i.SupportedNotificationTypes.includes(e),i.isSupportedDesktopNotification=e=>i.SupportedDesktopNotificationTypes.includes(e.type),i.canBeDisabled=e=>!i.AlwaysShownNotifications.includes(e),i.makeTypeChecker=e=>function(t){return t.type===e}})(ni||(ni={}));var SK=Object.defineProperty,wK=Object.getOwnPropertyDescriptor,kn=(i,e,t,s)=>{for(var a=s>1?void 0:s?wK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&SK(e,t,a),a};class Oa extends z{constructor(e,t,s,a,n){super(),this._logger=e,this._featureHandlerService=t,this._featureFlagsService=s,this._features=a,this._desktopNotificationService=n,this._logger=e.createChild("PcClientNotification.reducer"),this._logger.settings.logCategory=f.hostCommunication}async addNotification(e,{notification:t}){var a;const s=this.getMutableState(e,Ft);if(ni.isSupportedType(t.type)){const n=t.type;try{const r=this.convertToOverlayNotification(n,t);if(!this.isNotificationValidInContext(e,t))return;const l=this.getReadOnlyState(e,Wi).activity===hs.Busy,u=ni.canBeDisabled(n);if(l&&u||!this.isNotificationTypeEnabled(e,r.type)||!this.isFeatureFlagEnabled(r.type))return;s.pushNotification(r),!this.getReadOnlyState(e,zi).hasRunningGames&&ni.isSupportedDesktopNotification(r)&&((a=this._desktopNotificationService)==null||a.triggerNotification(r))}catch(r){this._logger.warn("Failed to handle PcClient notification",{error:r,errorCode:g.FailedHandlingLegacyClientNotificationWarning})}}else this._logger.warn("Received unsupported notification type from PC Client: ".concat(t.type),{errorCode:g.UnsupportedLegacyClientNotificationWarning})}isNotificationValidInContext(e,t){if(t.type===O.ChatMessage||t.type===O.GroupInvite){const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,M),n=a.getActiveMicroApp(a.defaultPlacement),r=n==null?void 0:n.appName,o=a.findTopLevelMicroAppConfigByName(J.AppChat,s.hostGame.spaceId);return r!==J.AppChat&&!!o}return!0}isFeatureFlagEnabled(e){return!(e===O.Achievement&&!this._featureFlagsService.isFeatureEnabled(this._features,fa.AchievementNotification))}isNotificationTypeEnabled(e,t){const s=this.getMutableState(e,Ft),a=this.getReadOnlyState(e,zi),n=s.notificationsEnabledSettings;let r=!0;if(n&&ni.canBeDisabled(t)){let o=!1;a.hasRunningGames?o=n.inGameEnabled:o=n.sysTrayEnabled!==void 0?n.sysTrayEnabled:!0;const l=ni.NotificationsSettingsEnabledMap[t],u=!!n[l];r=o&&u}return r}convertToOverlayNotification(e,t){try{return{id:t.id,type:e,state:t.state,timestamp:t.timestamp,payload:JSON.parse(t.json)}}catch(s){const a=s;throw new Error("Error parsing json payload for PC client notification. Type: ".concat(e,", Error: ").concat(a.toString()," "))}}async updateNotification(e,t){this.getMutableState(e,Ft).updateNotification({id:t.id,state:t.state})}async dismissedNotification(e,t){this.getMutableState(e,Ft).dismissNotification(t.id)}async sendGameInviteNotificationActionToClient(e,t){const s={gameInviteId:t.inviteId,response:t.accepted,source:"NOTIFICATION"},a=await this._featureHandlerService.handleFeature(c.RespondToGameInvite,s);t.accepted&&(a!=null&&a.response.isSuccessful)&&this.dispatch(e,new Gt(_e.GameInviteAccepted))}async updatePcClientNotificationSettings(e,{settings:t}){const s=this.getMutableState(e,Ft);if(s.notificationsEnabledSettings=t,!t.inGameEnabled)s.clearNotifications();else{const a=ni.SupportedNotificationTypes.filter(n=>{if(ni.canBeDisabled(n)){const r=ni.NotificationsSettingsEnabledMap[n];return!t[r]}return!1});s.clearNotifications(a)}}async notificationRedirect(e){const s=this.getReadOnlyState(e,Ft).notifications.find(a=>a.type===O.Achievement);if(s){const a=this.getReadOnlyState(e,S),n=await this.dispatch(e,new Xe(J.Challenges,a.activeGame));this.dispatch(e,new Be({appName:J.Challenges,parentAppName:n!=null?n:null,applicationData:{context:"achievement",challenge:s.id},game:a.activeGame}))}}}kn([h(kL)],Oa.prototype,"addNotification",1);kn([h(WL)],Oa.prototype,"updateNotification",1);kn([h(Ul)],Oa.prototype,"dismissedNotification",1);kn([h(VL)],Oa.prototype,"sendGameInviteNotificationActionToClient",1);kn([h($L)],Oa.prototype,"updatePcClientNotificationSettings",1);kn([h(BL)],Oa.prototype,"notificationRedirect",1);class uo extends oe("PcClientFpsState"){constructor(){super(...arguments),this._fps=0,this._enabled=!1}get fps(){return this._fps}set fps(e){this._fps=e}get isEnabled(){return this._enabled}set isEnabled(e){this._enabled=e}}var bK=Object.defineProperty,CK=Object.getOwnPropertyDescriptor,IK=(i,e,t,s)=>{for(var a=s>1?void 0:s?CK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&bK(e,t,a),a};class BG extends z{async updateFps(e,t){const s=this.getMutableState(e,uo);s.fps=t.fps}}IK([h(YL)],BG.prototype,"updateFps",1);var MK=Object.defineProperty,AK=Object.getOwnPropertyDescriptor,HG=(i,e,t,s)=>{for(var a=s>1?void 0:s?AK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&MK(e,t,a),a};class Pm extends z{constructor(e){super(),this._featureHandlerService=e}async onUpdateSettingsMessage(e,t){this.updateSettings(e,t.data)}async loadSettings(e,t){const s=await this._featureHandlerService.handleFeatureWithoutPayload(c.GetSettings);s!=null&&s.response&&this.updateSettings(e,s==null?void 0:s.response.settings)}updateSettings(e,t){this.dispatch(e,new $L(t.notifications));const s=this.getMutableState(e,uo);s.isEnabled=t.overlay.fpsEnabled}}HG([h(bu)],Pm.prototype,"onUpdateSettingsMessage",1);HG([h(JL)],Pm.prototype,"loadSettings",1);var PK=Object.defineProperty,NK=Object.getOwnPropertyDescriptor,Wn=(i,e,t,s)=>{for(var a=s>1?void 0:s?NK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&PK(e,t,a),a};class Fa extends z{constructor(e,t,s){super(),this._playerNotificationSubject=e,this._logger=t,this._playerNotificationWebSocketService=s,this._logger=this._logger.createChild("PlayerNotification.reducer"),this._logger.settings.logCategory=f.playerNotification,this._playerNotificationWebSocketService.addMessageHandler(a=>{const n=a.data&&JSON.parse(a.data);this._logger.debug("Incoming Player Notification:",{notification:n}),n!=null&&n.notificationType&&(n!=null&&n.content)?this._playerNotificationSubject.notifyPlayerNotificationReceived(n):this._logger.warn("The received message is not valid",{eventData:a.data,errorCode:g.ReceivedInvalidPlayerNotificationWarning})})}async openConnection(){try{await q(bi,this._playerNotificationWebSocketService.openConnectionForSession())}catch(e){this._logger.warn("Error happened while opening Player Notification connection",{error:e,errorCode:g.FailedOpeningPlayerNotificationWarning})}}async openPlayerNotificationConnection(){await this.openConnection()}async closePlayerNotificationConnection(){try{await q(bi,this._playerNotificationWebSocketService.closeConnection("overlay.close"))}catch(e){this._logger.warn("Error closing websocket",{error:e,errorCode:g.FailedClosingWebsocketWarning})}}async updatePlayerNotificationConnection(e,t){var s;try{const a=this.getMutableState(e,da),n=t.config.notificationTypes.filter(u=>a.spaceDependentNotificationTypes.indexOf(u)<0),r=((s=t.config.spaceIndependentNotificationTypes)==null?void 0:s.filter(u=>a.spaceIndependentNotificationTypes.indexOf(u)<0))||[],o=t.config.spaceIds.filter(u=>a.spaceIds.indexOf(u)<0);if(a.addConfigForSubscriber({subscriberId:t.subscriberId,config:t.config}),!n.length&&!o.length&&!r.length)return;if(!this.getReadOnlyState(e,S).playerSession){this._logger.debug("No session yet, updated notification types and spaces will be applied once the PNOT connection is created",{});return}this._playerNotificationWebSocketService.updateConnection()}catch(a){this._logger.warn("Error happened while updating Player Notification connection",{error:a,errorCode:g.FailedUpdatingPlayerNotificationConnectionWarning})}}async subscribeToPlayerNotification(e,t){const s=this.getMutableState(e,da),a=n=>{var u;const r=s.getConfigForSubscriber(t.subscriberId),o=(r==null?void 0:r.spaceIds.includes(n.spaceId))&&(r==null?void 0:r.notificationTypes.includes(n.notificationType)),l=(u=r==null?void 0:r.spaceIndependentNotificationTypes)==null?void 0:u.includes(n.notificationType);if(o||l)return t.callback(n)};s.callbackToActualCallbackMap.set(t.callback,a),this._playerNotificationSubject.subscribe(a)}async unsubscribeFromPlayerNotification(e,t){const a=this.getMutableState(e,da).callbackToActualCallbackMap.get(t.callback);a&&this._playerNotificationSubject.unsubscribe(a)}async renewPlayerNotificationWebSocketConnection(e){let t=Promise.resolve();const s=this.getReadOnlyState(e,oa);return s.playerNotificationsConnectionState.status===Vi.Closed?t=this.dispatch(e,new yl):s.playerNotificationsConnectionState.status===Vi.RetryNext&&(t=this._playerNotificationWebSocketService.getOpenDeferred()),t}}Wn([h(yl)],Fa.prototype,"openPlayerNotificationConnection",1);Wn([h(jo)],Fa.prototype,"closePlayerNotificationConnection",1);Wn([h(pr)],Fa.prototype,"updatePlayerNotificationConnection",1);Wn([h(ur)],Fa.prototype,"subscribeToPlayerNotification",1);Wn([h(pg)],Fa.prototype,"unsubscribeFromPlayerNotification",1);Wn([h(ID)],Fa.prototype,"renewPlayerNotificationWebSocketConnection",1);var TK=Object.defineProperty,RK=Object.getOwnPropertyDescriptor,ho=(i,e,t,s)=>{for(var a=s>1?void 0:s?RK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&TK(e,t,a),a},wn;const Vn=(wn=class extends z{constructor(e,t,s){super(),this._resizeObserverService=e,this._placementContainersService=t,this._shellSpaceId=s,this._mainBreakpoints=bo(yi),this._sideBreakpoints=bo(o2),this._navBarBreakpoints=bo(c2)}async observeResizeOnMicroAppContainer(e,t){const s=this.getMicroAppContainer(e,t.appConfig);let a=t.enumVariable?bo(t.enumVariable):void 0;if(!a)switch(t.appConfig.placement){case B.side:a=this._sideBreakpoints;break;case B.accessEnd:a=this._navBarBreakpoints;break;case B.main:default:a=this._mainBreakpoints}return s?(this._resizeObserverService.observeElement(s,t.appConfig.spaceId,{breakpoints:a,callback:t.callback}),!0):!1}async observeResizeByFrequencyOnMicroAppContainer(e,t){const s=this.getMicroAppContainer(e,t.appConfig);return s?(this._resizeObserverService.observeElement(s,t.appConfig.spaceId,{frequency:t.frequency,callback:t.callback}),!0):!1}async unobserveResizeOnMicroAppContainer(e,t){const s=this.getMicroAppContainer(e,t.appConfig);return s?(this._resizeObserverService.unobserveElement(s,t.appConfig.spaceId),!0):!1}async observeResizeOnShellContainer(e,t){const s=this.getShellContainer();return s?(this._resizeObserverService.observeElement(s,this._shellSpaceId,{breakpoints:this._mainBreakpoints,callback:t.callback}),!0):!1}async unobserveResizeOnShellContainer(){const e=this.getShellContainer();return e?(this._resizeObserverService.unobserveElement(e,this._shellSpaceId),!0):!1}getShellContainer(){return document.getElementById(wn.shellContainerId)}getMicroAppContainer(e,t){return this._placementContainersService.getMicroAppContainer(t.placement)}},wn.shellContainerId="focus-system-root",wn);ho([h(pu)],Vn.prototype,"observeResizeOnMicroAppContainer",1);ho([h(uu)],Vn.prototype,"observeResizeByFrequencyOnMicroAppContainer",1);ho([h(hn)],Vn.prototype,"unobserveResizeOnMicroAppContainer",1);ho([h($O)],Vn.prototype,"observeResizeOnShellContainer",1);ho([h(xW)],Vn.prototype,"unobserveResizeOnShellContainer",1);let DK=Vn;function QG(i,e,t){const s=i.allowedPlacements?i.allowedPlacements.filter(a=>t.includes(a)):t;return i.defaultPlacement&&s.includes(i.defaultPlacement)?i.defaultPlacement:s.includes(e)?e:null}class jG extends d("[Switch Micro App] Switch Micro App"){constructor(e,t,s){var a,n,r;super(),this.navigationContext=e,this.microAppConfig=t,this.forceReactivation=(a=s==null?void 0:s.forceReactivation)!=null?a:!1,this.saveOnDeactivation=(n=s==null?void 0:s.saveOnDeactivation)!=null?n:!0,this.direction=(r=s==null?void 0:s.direction)!=null?r:ci.forwards,this.callerMicroAppName=s==null?void 0:s.callerMicroAppName,this.trackingData=s==null?void 0:s.trackingData}}var OK=Object.defineProperty,FK=Object.getOwnPropertyDescriptor,Ji=(i,e,t,s)=>{for(var a=s>1?void 0:s?FK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&OK(e,t,a),a};class Oi extends z{constructor(e,t,s,a){super(),this._runtimeParameters=t,this._featureHandlerService=s,this._kinderGarden=a,this._logger=e.createChild("Router.reducer"),this._logger.settings.logCategory=f.navigation}async navigateToDefaultMicroApp(e){var r;this._logger.info("Navigating to default micro app");const t=this.getReadOnlyState(e,S),s=this.getMutableState(e,M),a=(r=t.activeGame)!=null?r:t.hostGame,n=await this.getAllInitialApps(e);if(this._runtimeParameters.isExclusiveMode){const o=n.placements[s.defaultPlacement],l=o?{appName:o.appName,parentAppName:o.parentAppName,game:a,applicationData:o.appName===this._runtimeParameters.microApp?this._runtimeParameters.microAppParams:void 0}:void 0;await this.dispatch(e,new Fd(l))}else{for(const o of Object.values(n.placements)){if(!o)continue;const{appName:l,parentAppName:u}=o,v=new bl(o,{appName:l,parentAppName:u,game:a,applicationData:l===this._runtimeParameters.microApp?this._runtimeParameters.microAppParams:void 0});s.setNavigationInProgress({placement:o.placement,value:l});const w=this.getFocusPlacement(s,o);await this.dispatch(e,v).then(b=>{b&&w&&this.dispatch(e,new so(w))}).finally(()=>s.setNavigationInProgress({placement:o.placement,value:void 0}))}if(n.popup){const{appName:o,parentAppName:l}=n.popup;await this.navigateToNewWindow({appName:o,parentAppName:l,game:a,applicationData:o===this._runtimeParameters.microApp?this._runtimeParameters.microAppParams:void 0},t.isChild,n.popup)}}}getFocusPlacement(e,t){if(e.getActiveMicroApp(B.modal))return B.modal;if(t.placement===e.defaultPlacement)return e.defaultPlacement}async getAllInitialApps(e){var u;const t=this.getReadOnlyState(e,S),s=this.getMutableState(e,M);if(s.initialAppsState)return s.initialAppsState;const a=(u=t.activeGame)!=null?u:t.hostGame,n=await this.getAllInitialAppNames(e,a,s.defaultMicroAppsNames),r={};let o;for(const v of n){const w=await this.getLegacyParentAppName(e,v,a);let b=s.findMicroAppConfig(v,w,a.spaceId);if(!b){this._logger.warn("Initial micro app is not available for top level application: ".concat(v,", game: ").concat(a.spaceId),{appName:v,gameId:a.spaceId,errorCode:g.InitialMicroappUnavailableWarning});continue}if(this.isPopupAllowed(b)&&this.isPopupForced(b)){o||(o=b);continue}const I=Es[t.layoutType],R=QG(b,s.defaultPlacement,I);if(!R){this._logger.warn("Configured placement ".concat(R," is not available for initial top level micro app ").concat(v),{appName:v,config:b,targetPlacement:R,errorCode:g.ConfiguredPlacementUnavailableForMicroappWarning});continue}b.placement!==R&&(b={...b,placement:R}),r[b.placement]||(r[b.placement]=b)}this._logger.debug("Got Initial apps placement map",{initialAppsPlacement:r,popup:o});const l={placements:r,popup:o};return s.initialAppsState=l,l}async getAllInitialAppNames(e,t,s){let a=s;const n=this._runtimeParameters.microApp;return n&&(a=await this.setMicroAppAsFirstInitialApp(e,n,t,a)),a}async setMicroAppAsFirstInitialApp(e,t,s,a){const n=[...a],r=n.findIndex(u=>u===t);r>=0&&n.splice(r,1);const o=await this.getLegacyParentAppName(e,t,s);return await this.dispatch(e,new Ci(t,s,o))&&n.unshift(t),n}async getLegacyParentAppName(e,t,s){const a=await this.dispatch(e,new Xe(t,s));return a===void 0&&this._logger.warn("Not able to find parent micro app for ".concat(t),{game:s,errorCode:g.UnavailableParentMicroappWarning}),a||null}async isNavigateBackAvailable(e,t){let a=this.getMutableState(e,Y).getLastItem(t.placement);return a===void 0&&(a=await this.getFallbackNavigationContextToNavigateBackTo(e)),!!a}async navigateBack(e,t){this._logger.debug("Navigating back on placement: ".concat(t.placement));const s=this.getMutableState(e,Y);let a=s.getLastItem(t.placement);if(a===void 0&&(a=await this.getFallbackNavigationContextToNavigateBackTo(e),a===void 0))return this.getReadOnlyState(e,S).isOnMobile&&await this.dispatch(e,new Gt(_e.HardwareBack)),!0;const n=await this.dispatch(e,new Be(a,{direction:ci.backwards}));return n&&(s.removeLastItem(t.placement),await this.dispatch(e,new $t)),this._featureHandlerService.handleFeature(c.UpdateNavigationHistory,{type:"back",applicationData:a.applicationData,appName:a.appName}),this._logger.debug("Back navigation for ".concat(t.placement," is successful: ").concat(n)),n}async tryNavigateBack(e){const t=this.getReadOnlyState(e,Lt);return t.isVisible?(typeof t.shouldCloseOnClickBackdrop=="function"?t.shouldCloseOnClickBackdrop():t.shouldCloseOnClickBackdrop)?this.dispatch(e,new qi):!1:this.getReadOnlyState(e,M).getActiveMicroApp(B.modal)?this.getReadOnlyState(e,Y).getLastItem(B.modal)?this.dispatch(e,new gs(B.modal)):this.dispatch(e,new $r(jr.Navigation)):this.dispatch(e,new gs(B.main))}async getFallbackNavigationContextToNavigateBackTo(e){var w,b;const t=this.getReadOnlyState(e,S),s=this.getReadOnlyState(e,M),a=s.defaultPlacement,n=(w=s.getActiveMicroApp(a))==null?void 0:w.appName,r=s.authenticationApplicationConfig;if(!t.initialSessionSet)return n===(r==null?void 0:r.appName)||!(r!=null&&r.appName)?void 0:{appName:r.appName,game:t.activeGame,parentAppName:r.parentAppName};const l=(await this.getAllInitialApps(e)).placements[a],u=l==null?void 0:l.appName,v=l==null?void 0:l.parentAppName;if(!(n===((b=s.authenticationApplicationConfig)==null?void 0:b.appName)||v===void 0||u===void 0||n===u))return{appName:u,game:t.activeGame,parentAppName:v}}async navigateParentToMicroApp(e,t){return this._kinderGarden.requestParentNavigation(t.navigationContext)}async getTargetMicroappConfig(e,t){var l;const s=this.getReadOnlyState(e,mt),a=this.getReadOnlyState(e,ao),n=this.getReadOnlyState(e,M),r=(l=n.getActiveMicroApp(B.side))==null?void 0:l.appName;if(s.isOpeningBrowserView&&a.isResolutionSmallerThanFHD&&t.appName===r){this._logger.info("Navigation to sidebar app ".concat(t.appName," is blocked because browser view app is open."),{navigationContext:t});return}try{if(!await this.dispatch(e,new Ci(t.appName,t.game,t.parentAppName)))return}catch(u){this._logger.info("Error thrown checking availability of ".concat(t.appName," config for ").concat(t.game.spaceId,". Bypassing availability check."),{navigationContext:t,error:u})}const o=n.findMicroAppConfig(t.appName,t.parentAppName,t.game.spaceId);if(o)return o}shouldNavigateToNewWindow(e,t,s){return!t&&this.isPopupAllowed(s)&&(e.isPopup||this.isPopupForced(s))}shouldBeProcessedByParent(e,t,s){var a;return!(!t.isChild||e.appName===((a=s.getActiveMicroApp(B.main))==null?void 0:a.appName)||e.appName===t.childId)}isPopupForced(e){var t;return((t=e.multipleWindowsConfig)==null?void 0:t.mode)===Ds.forced||e.multipleWindowsMode===Ds.forced}async navigateToMicroApp(e,t){var l;const s=this.getReadOnlyState(e,S),{navigationContext:a,options:n}=t;this._logger.info("Navigating to microApp ".concat(a.appName),{navigationContext:a});const r=await this.getTargetMicroappConfig(e,a);if(!r)return this._logger.warn("Requested micro app is not available",{appName:a.appName,gameId:t.navigationContext.game.spaceId,errorCode:g.RequestedMicroappUnavailable}),!1;await this.dispatch(e,new qi);const o=this.getReadOnlyState(e,M);return n!=null&&n.shouldFocusWindow&&this._featureHandlerService.handleFeature(c.FocusBrowserWindow,{childId:s.childId}),this.shouldNavigateToNewWindow(a,s.isChild,r)?this.navigateToNewWindow(a,s.isChild,r):this.shouldBeProcessedByParent(a,s,o)?this.dispatch(e,new uO(a)):(((l=t.options)==null?void 0:l.direction)===ci.forwards&&this._featureHandlerService.handleFeature(c.UpdateNavigationHistory,{type:"push",applicationData:a.applicationData,appName:a.appName}),this.dispatch(e,new jG(t.navigationContext,r,t.options)))}async navigateToLogin(e,t){this._logger.debug("Navigate to login micro app",{data:t.authData,logCategory:f.authentication}),await this.dispatch(e,new Re(!1));const s=await this.dispatch(e,new zD(t.authData,t.additionalData));return await this.dispatch(e,new Za),s?await this._featureHandlerService.handleFeatureWithoutPayload(c.LoginReady):await this._featureHandlerService.handleFeatureWithoutPayload(c.LoginFailure),s}async navigateToNewWindow(e,t,s){if(this._logger.info("Handle navigation to ".concat(s.appName," as a new window"),{logCategory:f.navigation}),t)return this._kinderGarden.requestNewChildFromHost(e);const a=await this._kinderGarden.createChildFromConfig(s);return a?this._kinderGarden.requestChildNavigation(a,e):!1}isPopupAllowed(e){var s;const t=((s=e.multipleWindowsConfig)==null?void 0:s.mode)!==Ds.prohibited&&e.multipleWindowsMode!==Ds.prohibited;return this._runtimeParameters.isStandalone&&[m.PC,m.Steam].includes(this._runtimeParameters.platformType)&&t}async closeMicroAppModal(e,t){const s=this.getReadOnlyState(e,M),a=s.getActivatingMicroApp(B.modal);if(a)return this._logger.debug("Already activating in Modal placement: ".concat(a==null?void 0:a.appName),{logCategory:f.api}),Promise.reject("App activation in modal placement already in progress");const n=s.getActiveMicroApp(B.modal);if(n&&!await this.dispatch(e,new Vr(!1,n,t.closeReason&&{reason:mV(t.closeReason)})))return!1;this.getReadOnlyState(e,$e).getShellError(B.modal)&&await this.dispatch(e,new MO(B.modal));const o=this.getReadOnlyState(e,Y);return(o.currentItem(B.modal)||o.getLastItem(B.modal))&&await this.dispatch(e,new tO(B.modal)),await this.dispatch(e,new um),!0}windowOpen(e){try{return!!window.open(e)}catch(t){return this._logger.warn("Failed opening url using window.open",{logCategory:f.navigation,errorCode:g.FailedOpenExternalLinkWithWindowOpen}),!1}}async openExternalLink(e,t){const{data:s}=t,a=this.getReadOnlyState(e,S);switch(a.platformType){case m.Web:return this.windowOpen(s.url);case m.Steam:case m.PC:{if(a.isStandalone)return this.windowOpen(s.url);const n={parentAppName:null,appName:J.WebBrowser,applicationData:{url:s.url},game:a.hostGame};return await this.dispatch(e,new Ci(n.appName,n.game,n.parentAppName))?await this.dispatch(e,new Be(n)):!1}case m.Android:case m.IOS:case m.Mobile:{const n=await this._featureHandlerService.handleFeature(c.OpenExternalLink,{url:s.url});return n?n.response.isSuccessful:this.windowOpen(s.url)}default:return this._logger.warn("Failed opening url: Platform ".concat(a.platformType," not supported"),{logCategory:f.navigation,errorCode:g.FailedOpenExternalLinkPlatformNotSupported}),!1}}}Ji([h(HD)],Oi.prototype,"navigateToDefaultMicroApp",1);Ji([h(QD)],Oi.prototype,"getAllInitialApps",1);Ji([h(iO)],Oi.prototype,"isNavigateBackAvailable",1);Ji([h(gs)],Oi.prototype,"navigateBack",1);Ji([h(nu)],Oi.prototype,"tryNavigateBack",1);Ji([h(uO)],Oi.prototype,"navigateParentToMicroApp",1);Ji([h(Be)],Oi.prototype,"navigateToMicroApp",1);Ji([h(Ai)],Oi.prototype,"navigateToLogin",1);Ji([h($r)],Oi.prototype,"closeMicroAppModal",1);Ji([h(sO)],Oi.prototype,"openExternalLink",1);var LK=Object.defineProperty,GK=Object.getOwnPropertyDescriptor,xK=(i,e,t,s)=>{for(var a=s>1?void 0:s?GK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&LK(e,t,a),a};class qG extends z{constructor(e,t,s){super(),this._trackingService=t,this._featureHandlerService=s,this._logger=e.createChild("InternalNavigationReducer.reducer"),this._logger.settings.logCategory=f.navigation}async switchMicroApp(e,t){const{navigationContext:s}=t,a=this.getReadOnlyState(e,S),n=this.getReadOnlyState(e,M),r=this.getTargetPlacement(e,t);if(!this.isNavigationValid(e,s.appName,r)||!r)return!1;if(!this.isNavigationNeeded(e,t,r)){const l=n.getActiveMicroApp(r);return await this.preparePlacement(e,s.appName,r,l),!0}const o=await this.doMicroAppSwitch(e,r,t);return await this.dispatch(e,new vg),this.handleAdditionalFeatures(a.isChild,s),o}async preparePlacement(e,t,s,a){await this.closeModalAppIfNeeded(e,t),await this.dispatch(e,new qi),this.isSingleInstanceAndSamePlacement(e,s,t,a)||this.dispatch(e,new so(s))}isNavigationNeeded(e,t,s){if(t.forceReactivation)return!0;const n=this.getReadOnlyState(e,Y).currentItem(s);return!n||this.getReadOnlyState(e,S).activeGame.spaceId!==t.navigationContext.game.spaceId?!0:!zn(n,t.navigationContext)}async closeModalAppIfNeeded(e,t){const a=this.getReadOnlyState(e,M).getActiveMicroApp(B.modal);a&&a.appName!==t&&await this.dispatch(e,new $r(jr.Navigation))}isNavigationValid(e,t,s){if(!s)return this._logger.warn("Configured placement ".concat(s," is not available for ").concat(t),{appName:t,targetPlacement:s,errorCode:g.ConfiguredPlacementUnavailableForMicroappWarning}),!1;if(this.isActivating(e,t))return this._logger.debug("The micro application ".concat(t," activation is already in progress for placement ").concat(s,"."),{appName:t,targetPlacement:s}),!1;if(!this.isValidExclusiveCase(e,t,s))return this._logger.warn("App switch is not allowed in exclusive mode for micro application ".concat(t," and placement ").concat(s,"."),{appName:t,targetPlacement:s,errorCode:g.MicroappSwitchUnavailableExclusiveModeWarning}),!1;const n=this.getReadOnlyState(e,M).navigatingMicroApp(s);return n!==void 0?(this._logger.debug("Navigation to ".concat(t," is not possible for placement ").concat(s,", because navigation to ").concat(n," is in progress"),{appName:t,targetPlacement:s,navigatingMicroApp:n}),!1):!0}handleAdditionalFeatures(e,t){this._featureHandlerService.handleFeature(c.SetCurrentParentAppName,{parentAppName:t.parentAppName,microAppName:t.appName,game:t.game,applicationData:t.applicationData})}isActivating(e,t){const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,M);return!!Es[s.layoutType].find(o=>{const l=a.getActivatingMicroApp(o);return(l==null?void 0:l.appName)===t})}isValidExclusiveCase(e,t,s){const a=this.getReadOnlyState(e,S),n=this.getReadOnlyState(e,M);if(a.isExclusiveMode){const r=n.getActiveMicroApp(s);if(r&&r.appName!==t)return!1}return!0}getTargetPlacement(e,t){const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,M),n=Es[s.layoutType];return n.find(l=>{const u=a.getActiveMicroApp(l);return(u==null?void 0:u.appName)===t.microAppConfig.appName})||QG(t.microAppConfig,a.defaultPlacement,n)}async doMicroAppSwitch(e,t,s){const a=this.getReadOnlyState(e,S),n=this.getMutableState(e,M);this._logger.debug("Set navigation in progress to ".concat(s.navigationContext.appName," for ").concat(t," ")),n.setNavigationInProgress({placement:t,value:s.navigationContext.appName});let r=s.microAppConfig;r.placement!==t&&(r={...r,placement:t});const o=a.activeGame,l=n.getActiveMicroApp(t);await this.deactivateCurrentMicroapp(e,s,t,l),a.playerSession&&await this.dispatch(e,new Hp(s.navigationContext.game,r,s.callerMicroAppName));let u=!1;try{u=await this.dispatch(e,new bl(r,s.navigationContext,s.direction))}catch(v){this._logger.warn("An error occurred when on activation of microapp during the navigation",{error:v,errorCode:g.FailedActivationOfMicroappWarning})}return this.logTrackingEvent(u,s,l),u?(await this.clearShellError(e,t),await this.preparePlacement(e,s.navigationContext.appName,t,l)):a.playerSession&&await this.dispatch(e,new Hp(o,r)),this._logger.debug("Navigation is no longer in progress for ".concat(t)),n.setNavigationInProgress({placement:t,value:void 0}),u}logTrackingEvent(e,t,s){this._trackingService.sendEvent(e?"shellNav":"shellNavError",{uiOnFocusCreatedDate:new Date,microAppName:t.microAppConfig.appName,inputSource:(s==null?void 0:s.appName)||t.callerMicroAppName||"DEFAULT",inputButton:t.trackingData})}isSingleInstanceAndSamePlacement(e,t,s,a){if(!a)return!1;const n=this.getMutableState(e,M),r=this.getReadOnlyState(e,ye),o=s===a.appName,l=n.microAppSupportsFocusSystemSingleInstance(s);return o&&l&&r.currentlyFocusedContainerId===t}async clearShellError(e,t){this.getReadOnlyState(e,$e).getShellError(t)&&await this.dispatch(e,new za)}async deactivateCurrentMicroapp(e,t,s,a){const n=a!==void 0&&a.spaceId!==t.microAppConfig.spaceId,r=t.forceReactivation||n,o=t.saveOnDeactivation&&t.direction===ci.forwards&&(n||!t.forceReactivation);if(r&&!(a?await this.dispatch(e,new Vr(o,a,{reason:Qn.Navigation})):!0)){this._logger.debug("Navigation is no longer in progress for ".concat(s)),this.getReadOnlyState(e,M).setNavigationInProgress({placement:s,value:void 0});const v="Failed to deactivate ".concat(a==null?void 0:a.appName);throw this._logger.warn(v,{errorCode:g.FailedDeactivationOfMicroappWarning}),new De(v)}}}xK([h(jG)],qG.prototype,"switchMicroApp",1);class EK extends Ss(Qs.CacheOpaqueRequestsNotification){constructor(e){super(),this.cacheOpaqueRequests=e}}class UK extends Ss(Qs.RegisterCacheDefinitionsNotification){constructor(e){super(),this.definitions=e}}class kK extends Ss(Qs.UnRegisterCacheDefinitionsNotification){constructor(e){super(),this.definitions=e}}class Ap extends Ss(Qs.RegisterManifestNotification){constructor(e){super(),this.manifest=e}}class WK extends Ss(Qs.ResetDataNotification){}class VK extends Fc(Md.LogMessage){constructor(e,t,s){super(),this.logLevel=e,this.message=t,this.details=s}}class $K extends Ss(Qs.SetOffline){constructor(e){super(),this.offline=e}}class BK extends Ss(Qs.UpdateUserSessionDataNotification){constructor(e,t){super(),this.sessionId=e,this.profileId=t}}var HK=Object.defineProperty,QK=Object.getOwnPropertyDescriptor,Nm=(i,e,t,s)=>{for(var a=s>1?void 0:s?QK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&HK(e,t,a),a};class Ui extends oe("ServiceWorkerState"){constructor(e,t,s){super(),this._cacheOpaqueResponse=t,this._wipeCacheOnVersion=s,this._definitions=[],this._manifestsMap=new Map,this._wipeCachedData=e.wipeCacheData||!1,this._noServiceWorker=e.noServiceWorker||!1}get cacheOpaqueResponse(){return this._cacheOpaqueResponse}get wipeCacheOnVersion(){return this._wipeCacheOnVersion}get wipeCachedData(){return this._wipeCachedData}get noServiceWorker(){return this._noServiceWorker}set noServiceWorker(e){this._noServiceWorker=e}get cacheDefinitions(){return this._definitions}addDefinitions(e){this._definitions=this._definitions.concat(e)}removeDefinitions(e){e.forEach(t=>{const s=this._definitions.findIndex(a=>a.url===t.url&&a.scope===t.scope&&a.cachingStrategy===t.cachingStrategy);s>=0&&this._definitions.splice(s,1)})}get manifests(){return Array.from(this._manifestsMap.values()).filter(ft)}get loadedManifests(){return Array.from(this._manifestsMap.keys())}addManifest(e){this._manifestsMap.set(e.url,e.manifest)}}Nm([P],Ui.prototype,"addDefinitions",1);Nm([P],Ui.prototype,"removeDefinitions",1);Nm([P],Ui.prototype,"addManifest",1);function zG(i){return i.indexOf("://")>0||i.indexOf("//")===0}function jK(i){if(i=typeof i=="string"?i:i.href,!zG(i))throw new Error("Invalid URL. URL must be absolute.");return new URL(i.substring(0,i.lastIndexOf("/"))+"/")}var qK=Object.defineProperty,zK=Object.getOwnPropertyDescriptor,hi=(i,e,t,s)=>{for(var a=s>1?void 0:s?zK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&qK(e,t,a),a};const Vf="shellWipeCacheOnVersion";class ai extends z{constructor(e,t,s,a,n){super(),this._logger=e,this._httpClient=s,this._localStorageService=a,this._swLogger=this._logger.createChild("ServiceWorker"),this._swLogger.settings.logCategory=f.serviceWorker,this._logger=this._logger.createChild("ServiceWorker.reducer"),this._logger.settings.logCategory=f.serviceWorker,this._workerCommunicationService=n!=null?n:new Wc(this._swLogger,new Wo(this._swLogger,t))}async updateSessionUserMapping(e,t){this._logger.debug("UpdateSessionUserMappingIntent"),this._workerCommunicationService.sendNotification(new BK(t.sessionId,t.profileId))}async registerCacheDefinitions(e,t){this._logger.debug("RegisterCacheDefinitionsIntent",{details:t.definitions}),this._workerCommunicationService.sendNotification(new UK(t.definitions)),this.getMutableState(e,Ui).addDefinitions(t.definitions)}async unRegisterCacheDefinitions(e,t){this._logger.debug("UnRegisterCacheDefinitionsIntent",{details:t.definitions}),this._workerCommunicationService.sendNotification(new kK(t.definitions)),this.getMutableState(e,Ui).removeDefinitions(t.definitions)}async initializeServiceWorker(e){const t=this.getMutableState(e,Ui);t.noServiceWorker=!Wo.isAvailable(),t.noServiceWorker?this._logger.info("Service Worker is not available",{logCategory:f.initialization}):(this._logger.info("Initializing Service Worker",{logCategory:f.initialization}),this._workerCommunicationService.registerNotificationListener(GS,s=>{this._logger.debug("Notification from service worker",{notification:s}),this.dispatch(e,new ED)}),this._workerCommunicationService.registerNotificationListener(VK,s=>{switch(this._logger.debug("Log entry from service worker",{notification:s}),s.logLevel){case Te.Debug:{this._swLogger.debug(s.message,s.details);break}case Te.Error:{this._swLogger.error(s.message,s.details);break}case Te.Warning:{this._swLogger.warn(s.message,s.details);break}case Te.Info:{this._swLogger.info(s.message,s.details);break}}})),await this.dispatch(e,new UD),t.wipeCachedData&&await this.dispatch(e,new iu),await this.dispatch(e,new au(t.cacheOpaqueResponse))}async onControllerChange(e){this._logger.debug("ControllerChangeIntent");const s=this.getReadOnlyState(e,S).playerSession;s&&s.sessionId&&s.profileId&&this.dispatch(e,new qo(s.sessionId,s.profileId));const a=this.getReadOnlyState(e,Ui),n=a.cacheDefinitions;n.length>0&&this.dispatch(e,new In(n));const r=a.manifests;r.length>0&&r.forEach(o=>{this._workerCommunicationService.sendNotification(new Ap(o))}),this.dispatch(e,new au(a.cacheOpaqueResponse))}async wipeCachedData(){this._logger.debug("WipeCacheDataIntent");const e=await caches.keys();await Promise.all(e.map(t=>{caches.delete(t)})),this._workerCommunicationService.sendNotification(new WK)}async cacheOpaqueRequest(e,t){await this._workerCommunicationService.sendNotification(new EK(t.cacheOpaqueRequests))}async wipeCachedDataOnVersion(e){this._logger.debug("WipeCacheDataOnVersionIntent"),this.getReadOnlyState(e,Ui).wipeCacheOnVersion==="8.86.3"&&this._localStorageService.getValue(Vf)!=="8.86.3"&&(await this.dispatch(e,new iu),this._localStorageService.setValue(Vf,"8.86.3"))}async loadManifests(e,t){const s=this.getMutableState(e,Ui);if(this._logger.debug("LoadManifestIntent",{urls:t.manifestUrls,serviceWorkerDisabled:s.noServiceWorker}),s.noServiceWorker)return;const a=s.loadedManifests,n=t.manifestUrls.filter(r=>!a.includes(r));for(const r of n)try{const o=await this._httpClient.getJson(r);if(!this.validateManifest(o)){this._logger.warn("Incorrect manifest",{url:r,errorCode:g.ManifestIcorrectFormatWarning}),s.addManifest({url:r,manifest:void 0});continue}const l=jK(r);o.entries.forEach(u=>{zG(u.url)||(u.url=new URL(l.pathname+u.url,l).href)}),this._logger.debug("registering manifest",{manifest:o}),await this._workerCommunicationService.sendNotification(new Ap(o)),s.addManifest({url:r,manifest:o})}catch(o){if(o instanceof iS&&o.response.status===404){s.addManifest({url:r,manifest:void 0});continue}this._logger.warn("Error loading manifest",{error:o,errorCode:g.FailedLoadingManifestWarning})}}validateManifest(e){return!(!e||!e.name||!e.version||!e.entries||!Array.isArray(e.entries))}async setOffline(e,t){this._workerCommunicationService.sendNotification(new $K(t.offline))}async registerManifest(e,t){this._workerCommunicationService.sendNotification(new Ap(t.manifest))}async checkDataIsCached(e,t){const s=await caches.match(t.url,t.options);return(s==null?void 0:s.ok)||!1}}hi([h(qo)],ai.prototype,"updateSessionUserMapping",1);hi([h(In)],ai.prototype,"registerCacheDefinitions",1);hi([h(wl)],ai.prototype,"unRegisterCacheDefinitions",1);hi([h(xD)],ai.prototype,"initializeServiceWorker",1);hi([h(ED)],ai.prototype,"onControllerChange",1);hi([h(iu)],ai.prototype,"wipeCachedData",1);hi([h(au)],ai.prototype,"cacheOpaqueRequest",1);hi([h(UD)],ai.prototype,"wipeCachedDataOnVersion",1);hi([h(su)],ai.prototype,"loadManifests",1);hi([h(WD)],ai.prototype,"setOffline",1);hi([h(kD)],ai.prototype,"registerManifest",1);hi([h(VD)],ai.prototype,"checkDataIsCached",1);function $f(i){switch(i){case"up":return fo.UP;case"down":return fo.DOWN;case"left":return fo.LEFT;case"right":return fo.RIGHT}}var KK=Object.defineProperty,XK=Object.getOwnPropertyDescriptor,Ee=(i,e,t,s)=>{for(var a=s>1?void 0:s?XK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&KK(e,t,a),a};class Le extends z{constructor(e,t){super(),this._focusSystem=t,this._logger=e.createChild("ShellFocus.reducer"),this._logger.settings.logCategory=f.focus}async navigateFromNavigationBar(e,t){const s=t.microAppConfig.appName,n=this.getReadOnlyState(e,S).hostGame,r=t.microAppConfig.parentAppName,o=this.getReadOnlyState(e,M);if(this._logger.info("Navigation from navigation bar to microApp ".concat(s),{logCategory:f.navigation}),!o.hasNavigatedToDefaultMicroApps){this._logger.warn("Unable to navigate to microApp ".concat(s," from navigation bar, because navigation to default microapps is not completed"),{logCategory:f.navigation});return}try{if(await this.dispatch(e,new Ci(s,n,r))){const u={section:Id.accessMenu,button:s,contextParent:null};await this.dispatch(e,new Be({appName:s,game:n,isPopup:t.isPopup,parentAppName:r},{direction:ci.forwards,forceReactivation:!0,trackingData:t.inputButton||u,callerMicroAppName:"ShellFocusReducer.navigateFromNavigationBar"}))||await this.dispatch(e,new pm)}}catch(l){this._logger.warn("Failed to navigate to app: ".concat(s," from navigation bar"),{error:l,logCategory:f.navigation,errorCode:g.FailedNavigationToMicroappFromAccessbarWarning})}}async moveContainerFocus(e,t){const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,Lt);if(s.isChild||a.isVisible)return;let r=!1,o=!1;t.direction&&(r=await this.dispatch(e,new cG(t.direction)),r&&(await this.dispatch(e,new ss(!0)),o=await this.dispatch(e,new pG(t.direction)),o||await this.dispatch(e,new ss(!1))),this._logger.debug("Moved container focus in direction: ".concat(t.direction),{direction:t.direction,canMoveFocus:r,success:o}))}async canMoveContainerFocusInDirection(e,t){return!this.getReadOnlyState(e,ye).isContainerNavigationInProgress&&this._focusSystem.canMoveInDirection($f(t.direction))}async moveContainerFocusInDirection(e,t){let s=!0;const a=this.getReadOnlyState(e,ye);this._focusSystem.setFocusMode(Rt.PASSIVE),a.isFocusSystemActive||this.dispatch(e,new us(Rt.PASSIVE));try{this._focusSystem.moveFocusInDirection($f(t.direction))}catch(n){this._logger.debug("Unable to move focus in direction ".concat(t.direction),{direction:t.direction,error:n}),s=!1}finally{this._focusSystem.setFocusMode(Rt.ACTIVE),await this.dispatch(e,new ss(!1))}return s}async canMoveFocusInOrder(e,t){return!this.getReadOnlyState(e,ye).isContainerNavigationInProgress&&this._focusSystem.canMoveInOrder(t.order)}async moveFocusInOrder(e,t){let s=!0;const a=this.getReadOnlyState(e,ye);this._focusSystem.setFocusMode(Rt.PASSIVE),a.isFocusSystemActive||this.dispatch(e,new us(Rt.PASSIVE));try{const n=await this._focusSystem.findFocusInOrder(t.order);n?(await this._focusSystem.focus(n),s=!0):(this._logger.debug("Focus system did not find a suitable focus ".concat(t.order,", the browser will pick the appropriate one"),{order:t.order}),s=!1)}catch(n){this._logger.debug("Unable to move focus in order ".concat(t.order),{direction:t.order,error:n}),s=!1}finally{this._focusSystem.setFocusMode(Rt.ACTIVE),await this.dispatch(e,new ss(!1))}return s}async focusPlacement(e,t){const s=this.getReadOnlyState(e,ye);if(this._logger.debug("Focusing placement ".concat(t.placement)),s.isContainerNavigationInProgress)return;const a=s.getFocusableContainerId(t.placement);if(!a){this._logger.warn("Trying to focus unregistered placement container",{placement:t.placement,logCategory:f.focus,errorCode:g.FailedFocusUnregisteredPlacementContainerWarning});return}this.dispatch(e,new ss(!0)),await this.dispatch(e,new ha(a)),await this.dispatch(e,new ss(!1))}async moveFocusToContainerWithId(e,t){const s=t.focusId;try{const{isFocusSystemActive:a}=this.getReadOnlyState(e,ye);return a||await this.dispatch(e,new us),await this._focusSystem.isFocusable(s)?await this._focusSystem.focus(s):await this._focusSystem.tryFocus(s),this._logger.debug("Moved container focus on ".concat(s)),!0}catch(a){return this._logger.warn("Unable to move focus to container",{error:a,containerFocusId:s,errorCode:g.UnableToMoveFocusToContainerWarning}),!1}}async focusMicroAppInContainer(e,t){const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,M),n=this.getMutableState(e,ye),{placement:r}=t,o=n.getFocusableContainerId(r);n.currentlyFocusedContainerId=o||null;const l=s.focusedMicroApp;l&&l.placement!==r&&this.dispatch(e,new Mn);const u=a.getActiveMicroApp(r),v=u==null?void 0:u.spaceId;if(u&&v){let w=!1;try{w=await this.dispatch(e,new jD(u)),w||this._logger.warn("Unable to focus ".concat(u.appName," in ").concat(r," container"),{appSpaceId:v})}catch(b){this._logger.warn("Failed to focus ".concat(u.appName," in ").concat(r," container"),{error:b,activeMicroAppSpaceId:v,logCategory:f.uncategorized,errorCode:g.FailedFocusMicroappInContainerWarning})}finally{w||await this.dispatch(e,new um)}}await this.dispatch(e,new ss(!1))}async focusNavigationBarContainer(e){await this.dispatch(e,new ha(on.appListFocusId))}async setPreviousContainer(e,t){const s=this.getMutableState(e,ye);s.previouslyFocusedContainerId=t.focusableId}async focusPreviousContainer(e){const t=this.getMutableState(e,ye),a=this.getReadOnlyState(e,S).isChild;let n=null;const{isFocusSystemActive:r}=this.getReadOnlyState(e,ye);if(r||await this.dispatch(e,new us(Rt.PASSIVE)),t.previouslyFocusedContainerId?n=t.previouslyFocusedContainerId:!a&&t.currentlyFocusedContainerId!==on.appListFocusId&&(n=on.appListFocusId),n!==null){this._focusSystem.setFocusMode(Rt.ACTIVE);const o=await this.dispatch(e,new ha(n));return t.previouslyFocusedContainerId=null,o}else return!1}async registerFocusableContainer(e,t){const{container:s,focusableId:a,placement:n}=t;return this._logger.debug("Register focusable container ".concat(n),{focusableId:a}),await this.dispatch(e,new ng(s,n)),this.getMutableState(e,ye).registerFocusableContainer({placement:n,value:a})}async blurShell(e){this.getMutableState(e,ys).clearNonGlobalShellItems(),await this.dispatch(e,new rG)}async activateShellFocusSystem(e,t){const s=this.getMutableState(e,ye),a=t.focusMode;if(!s.isFocusSystemActive){this._focusSystem.setFocusMode(a),this._focusSystem.enable();const n=this._focusSystem.getElement(li.GroupId);n==null||n.classList.add("focus-active"),s.isFocusSystemActive=!0}}async deactivateShellFocusSystem(e){const t=this.getMutableState(e,ye);if(t.currentlyFocusedContainerId&&t.currentlyFocusedContainerId!==this._focusSystem.getActiveTarget()&&await this._focusSystem.focus(t.currentlyFocusedContainerId),t.isFocusSystemActive){this._focusSystem.setFocusMode(Rt.SHORTCUTS_ONLY),this._focusSystem.disable(),t.isFocusSystemActive=!1;const s=this._focusSystem.getElement(li.GroupId);s==null||s.classList.remove("focus-active")}}async notifyShortcutsUpdated(e,t){const s=this.getReadOnlyState(e,S),a=this.getReadOnlyState(e,M);let n=t.shortcuts;s.focusedMicroApp&&!a.microAppSupportsFocusSystemSingleInstance(s.focusedMicroApp.appName)&&(n=n.filter(o=>o.isGlobal));const r=n.map(o=>{var l;return{button:o.button,label:(l=o.text)!=null?l:"",isGlobal:o.isGlobal}});await this.dispatch(e,new pF(r))}async notifyGlobalShortcutsUpdated(e,t){const s=t.shortcuts.map(a=>{var n;return{button:a.button,label:(n=a.text)!=null?n:"",isGlobal:a.isGlobal}});await this.dispatch(e,new uF(s))}async setCurrentlyFocusedContainer(e,t){const s=this.getMutableState(e,ye);s.currentlyFocusedContainerId=t.focusableId}async setContainerNavigationInProgressStatus(e,t){const s=this.getMutableState(e,ye);s.isContainerNavigationInProgress=t.isNavigationInProgress}}Ee([h(rn)],Le.prototype,"navigateFromNavigationBar",1);Ee([h(oG)],Le.prototype,"moveContainerFocus",1);Ee([h(cG)],Le.prototype,"canMoveContainerFocusInDirection",1);Ee([h(pG)],Le.prototype,"moveContainerFocusInDirection",1);Ee([h(lG)],Le.prototype,"canMoveFocusInOrder",1);Ee([h(uG)],Le.prototype,"moveFocusInOrder",1);Ee([h(so)],Le.prototype,"focusPlacement",1);Ee([h(ha)],Le.prototype,"moveFocusToContainerWithId",1);Ee([h(Ro)],Le.prototype,"focusMicroAppInContainer",1);Ee([h(pm)],Le.prototype,"focusNavigationBarContainer",1);Ee([h(gG)],Le.prototype,"setPreviousContainer",1);Ee([h(um)],Le.prototype,"focusPreviousContainer",1);Ee([h(dG)],Le.prototype,"registerFocusableContainer",1);Ee([h(aG)],Le.prototype,"blurShell",1);Ee([h(us)],Le.prototype,"activateShellFocusSystem",1);Ee([h(rG)],Le.prototype,"deactivateShellFocusSystem",1);Ee([h(lm)],Le.prototype,"notifyShortcutsUpdated",1);Ee([h(nG)],Le.prototype,"notifyGlobalShortcutsUpdated",1);Ee([h(hG)],Le.prototype,"setCurrentlyFocusedContainer",1);Ee([h(ss)],Le.prototype,"setContainerNavigationInProgressStatus",1);var is=(i=>(i.GlobalInputLegendItem="Global Input Legend Item",i.HotKey="Hot Key",i))(is||{}),JK=Object.defineProperty,YK=Object.getOwnPropertyDescriptor,Tm=(i,e,t,s)=>{for(var a=s>1?void 0:s?YK(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&JK(e,t,a),a};class sp extends z{constructor(e,t,s){super(),this._focusSystem=e,this._localizationService=t,this._featureHandlerService=s}async manageBackButtonShortcut(e){this.calculateBackButtonShortcutData(e),this.registerBackButtonShortcut(e),this.notifyMangeBackButtonToHost(e)}calculateBackButtonShortcutData(e){var r;const t=this.getReadOnlyState(e,Dt),s=this.getMutableState(e,Ei),a=this.getReadOnlyState(e,$e),n=this.getReadOnlyState(e,S);if(a.getShellError())s.backButtonShortcutData&&n.completelyOffline&&(s.backButtonShortcutData=null);else if(t.selectedComponentType)(r=s.backButtonShortcutData)!=null&&r.handler&&(s.backButtonShortcutData=this.shouldRemoveBackButtonShortcutWhenComponentIsSelected(n.platformType,t.selectedComponentType)?null:{...s.backButtonShortcutData,handler:void 0});else{const o=this.getReadOnlyState(e,Y),u=this.getReadOnlyState(e,M).defaultPlacement;o.hasItems(u)?s.backButtonShortcutData?s.backButtonShortcutData.handler||(s.backButtonShortcutData={...s.backButtonShortcutData,handler:()=>this.navigateBack(e,u)}):s.backButtonShortcutData={type:is.GlobalInputLegendItem,handler:()=>this.navigateBack(e,u)}:s.backButtonShortcutData&&(s.backButtonShortcutData=null)}}registerBackButtonShortcut(e){const t=this.getMutableState(e,Ei),s=this.getReadOnlyState(e,S);if(s.hostPlatformType===p.WebEmbedded)return;const a=t.backButtonShortcutData,n=s.shouldRevertExitAndBackButton?oi.Y:oi.B;if(a){const r=this.createShortcut(a,n,this._localizationService.translate("legend.label.back"));t.backButtonShortcut=r,this.registerGlobalShortcut(e,r,a)}else t.backButtonShortcut=null,this.unregisterGlobalShortcut(e,n)}registerExitButtonShortcut(e){const t=this.getMutableState(e,Ei);if(this.getReadOnlyState(e,S).hostPlatformType===p.WebEmbedded)return;const a=this.getExitButton(e),n=t.exitButtonShortcutData;if(n){const r=this.createShortcut(n,a,this._localizationService.translate("legend.label.exit"));t.exitButtonShortcut=r,this.registerGlobalShortcut(e,r,n)}else t.exitButtonShortcut=null,this.unregisterGlobalShortcut(e,a)}notifyMangeBackButtonToHost(e){const t=this.getReadOnlyState(e,Y),a=this.getReadOnlyState(e,M).defaultPlacement;this._featureHandlerService.handleFeature(c.ManageBackButton,{isBackButtonAvailable:t.hasItems(a)})}createShortcut(e,t,s){const a=e.type!==is.HotKey?s:void 0;return{button:t,text:a,isGlobal:!0}}async registerGlobalShortcut(e,t,s){if(this.getReadOnlyState(e,S).hostPlatformType===p.WebEmbedded)return;const n=this.manageShortcutDefinitions(t,s);this._focusSystem.registerShortcuts(li.GroupId,n),await this.notifyGlobalShortcutUpdate(e)}async unregisterGlobalShortcut(e,t){const s={};s[t]={handler:()=>{}},this._focusSystem.unregisterShortcuts(li.GroupId,s),await this.notifyGlobalShortcutUpdate(e)}manageShortcutDefinitions(e,t){const s={};return e&&t&&(s[e.button]={text:e.text,handler:t!=null&&t.handler?t.handler:()=>{}}),s}async notifyGlobalShortcutUpdate(e){const t=[],s=this.getReadOnlyState(e,Ei),{backButtonShortcut:a,exitButtonShortcut:n}=s;a&&t.push(a),n&&t.push(n),await this.dispatch(e,new nG(t))}shouldRemoveBackButtonShortcutWhenComponentIsSelected(e,t){return Ba.includes(e)&&t===pa.textInput}async manageExitButtonShortcut(e){this.calculateExitButtonShortcut(e),this.registerExitButtonShortcut(e)}calculateExitButtonShortcut(e){var r;const t=this.getReadOnlyState(e,S);if(t.layoutType!==_t.default)return;const s=this.getReadOnlyState(e,Dt),a=this.getMutableState(e,Ei);if(this.getReadOnlyState(e,$e).getShellError())a.exitButtonShortcutData?a.exitButtonShortcutData={...a.exitButtonShortcutData,handler:()=>this.closeOverlay(e,_e.FatalError)}:this.createExitButtonShortcut(e,_e.FatalError);else if(s.selectedComponentType)(r=a.exitButtonShortcutData)!=null&&r.handler&&(a.exitButtonShortcutData=this.shouldRemoveExitButtonShortcutWhenComponentIsSelected(e,s.selectedComponentType)?null:{...a.exitButtonShortcutData,handler:void 0});else{const o=this.getReadOnlyState(e,Q);a.exitButtonShortcutData?o.isAccountLinkingInProgress&&t.isOnline?a.exitButtonShortcutData=null:a.exitButtonShortcutData={...a.exitButtonShortcutData,handler:()=>this.closeOverlay(e,_e.User)}:this.createExitButtonShortcut(e,_e.User)}}shouldRemoveExitButtonShortcutWhenComponentIsSelected(e,t){const s=this.getReadOnlyState(e,S);return Ba.includes(s.platformType)&&t===pa.contextMenu}async createExitButtonShortcut(e,t){const s=this.getReadOnlyState(e,S),a=this.getMutableState(e,Ei),n=Ba.includes(s.platformType)&&s.inputDeviceType===D.keyboard;a.exitButtonShortcutData={type:n?is.HotKey:is.GlobalInputLegendItem,handler:Ba.includes(s.platformType)?()=>this.closeOverlay(e,t):void 0},n&&await this.dispatch(e,new mu([this.getExitButton(e)]))}async manageExitButtonShortcutForInputDeviceType(e){await this.calculateExitButtonShortcutForInputDeviceType(e),this.registerExitButtonShortcut(e)}async calculateExitButtonShortcutForInputDeviceType(e){if(this.getReadOnlyState(e,S).layoutType!==_t.default)return;const s=this.getMutableState(e,Ei),a=this.getExitButton(e);s.exitButtonShortcutData&&(this.getReadOnlyState(e,S).inputDeviceType===D.keyboard?s.exitButtonShortcutData.type!==is.HotKey&&(await this.dispatch(e,new mu([a])),s.exitButtonShortcutData={...s.exitButtonShortcutData,type:is.HotKey}):s.exitButtonShortcutData.type!==is.GlobalInputLegendItem&&(await this.dispatch(e,new cF([a])),s.exitButtonShortcutData={...s.exitButtonShortcutData,type:is.GlobalInputLegendItem}))}getExitButton(e){return this.getReadOnlyState(e,S).shouldRevertExitAndBackButton?oi.B:oi.Y}navigateBack(e,t){this.dispatch(e,new gs(t))}closeOverlay(e,t){this.dispatch(e,new Gt(t))}}Tm([h($t)],sp.prototype,"manageBackButtonShortcut",1);Tm([h(Qi)],sp.prototype,"manageExitButtonShortcut",1);Tm([h(hD)],sp.prototype,"manageExitButtonShortcutForInputDeviceType",1);class Co{constructor(){this._subject=new Fr,this._subscribers=new Map}subscribe(e,t){const s=this.createObserver(t);this.setSubscription(e,s)}createObserver(e){return{next:t=>{e(t)}}}setSubscription(e,t){var a;this._subscribers.has(e)&&((a=this._subscribers.get(e))==null||a.subscription.unsubscribe(),this._subscribers.delete(e));const s=this._subject.subscribe(t);this._subscribers.set(e,{observer:t,subscription:s})}unsubscribe(e){var t;this._subscribers.has(e)&&((t=this._subscribers.get(e))==null||t.subscription.unsubscribe(),this._subscribers.delete(e))}notify(e){this._subject.next(e)}}class ap extends oe("StreamingWidgetState"){constructor(){super(...arguments),this._isEnabled=!1,this._guests=[],this._sessionStartTime=0,this._sessionLimit=void 0}get isEnabled(){return this._isEnabled}set isEnabled(e){this._isEnabled=e}get guests(){return this._guests}set guests(e){this._guests=e}get sessionStartTime(){return this._sessionStartTime}set sessionStartTime(e){this._sessionStartTime=e}get sessionLimit(){return this._sessionLimit}set sessionLimit(e){this._sessionLimit=e}}var ZK=Object.defineProperty,eX=Object.getOwnPropertyDescriptor,Me=(i,e,t,s)=>{for(var a=s>1?void 0:s?eX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&ZK(e,t,a),a};class be extends z{constructor(e,t,s){super(),this._logger=e,this._featureHandlerService=t,this._avatarsService=s,this._streamingHostStatusSubject=new Co,this._streamingHostMetricsSubject=new Co,this._streamingGuestStatusSubject=new Co,this._streamingGuestMetricsSubject=new Co,this._streamingTimeoutInMs=5e3,this._logger=e.createChild("StreamingReducer.reducer"),this._logger.settings.logCategory=f.streaming}async startStreaming(){var e,t;try{const s=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeatureWithoutPayload(c.StreamingStart));if(!((e=s==null?void 0:s.response)!=null&&e.isSuccessful))return Promise.reject((t=s==null?void 0:s.response)==null?void 0:t.error)}catch(s){return Promise.reject(s)}}async stopStreaming(){var e,t;try{const s=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeatureWithoutPayload(c.StreamingStop));if(!((e=s==null?void 0:s.response)!=null&&e.isSuccessful))return Promise.reject((t=s==null?void 0:s.response)==null?void 0:t.error)}catch(s){return Promise.reject(s)}}async createToken(e,t){try{const s=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeature(c.StreamingCreateToken,t));return(s==null?void 0:s.response.token)||""}catch(s){return Promise.reject(s)}}async generateInviteLinkStreaming(e,t){try{const s=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeature(c.StreamingGenerateInviteLink,t));return(s==null?void 0:s.response.link)||""}catch(s){return Promise.reject(s)}}async getStreamingHostStatus(){try{const e=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeatureWithoutPayload(c.StreamingGetHostStatus));return e==null?void 0:e.response}catch(e){return Promise.reject(e)}}async kickGuestStreaming(e,t){var s,a;try{const n=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeature(c.StreamingKickGuest,t));if(!((s=n==null?void 0:n.response)!=null&&s.isSuccessful))return Promise.reject((a=n==null?void 0:n.response)==null?void 0:a.error)}catch(n){return Promise.reject(n)}}async setStreamingGuestSettings(e,t){var s,a;try{const n=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeature(c.StreamingSetGuestSettings,{guestId:t.guestId,settings:{permissions:{gamepad:t.settings.permissions.gamepad,keyboard:t.settings.permissions.keyboard,mouse:t.settings.permissions.mouse,immersive:t.settings.permissions.immersive}}}));if(!((s=n==null?void 0:n.response)!=null&&s.isSuccessful))return Promise.reject((a=n==null?void 0:n.response)==null?void 0:a.error)}catch(n){return Promise.reject(n)}}async setStreamingSessionSettings(e,t){var s,a;try{const n=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeature(c.StreamingSetSessionSettings,{settings:{bitrateMbps:t.settings.bitrateMbps,resolution:t.settings.resolution,fps:t.settings.fps}}));if(!((s=n==null?void 0:n.response)!=null&&s.isSuccessful))return Promise.reject((a=n==null?void 0:n.response)==null?void 0:a.error)}catch(n){return Promise.reject(n)}}async subscribeToStreamingHostStatusUpdate(e,t){this._streamingHostStatusSubject.subscribe(t.spaceId,t.callback)}async unsubscribeFromStreamingHostStatusUpdate(e,t){this._streamingHostStatusSubject.unsubscribe(t.spaceId)}async receiveStreamingHostStatusUpdateIntent(e,t){this._streamingHostStatusSubject.notify(t.streamingHostStatus);const{guests:s,maxSessionDuration:a,state:n}=t.streamingHostStatus,r=this.getReadOnlyState(e,S),{profileId:o}=r,l=s.length>0&&s.every(w=>w.profileId!==o),u=n===l2.Running&&l,v=this.getMutableState(e,ap);v.isEnabled=u,u?(v.guests=s,v.sessionLimit=a,s.length>0&&v.sessionStartTime===0&&(v.sessionStartTime=s[0].connectedTimestamp)):(v.guests=[],v.sessionLimit=void 0,v.sessionStartTime=0)}async subscribeToStreamingHostMetricsUpdate(e,t){this._streamingHostMetricsSubject.subscribe(t.spaceId,t.callback)}async unsubscribeFromStreamingHostMetricsUpdate(e,t){this._streamingHostMetricsSubject.unsubscribe(t.spaceId)}async receiveStreamingHostMetricsUpdate(e,t){this._streamingHostMetricsSubject.notify(t.streamingHostMetrics)}async joinStreaming(e,t){var s,a;try{const n=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeature(c.StreamingJoin,t));if(!((s=n==null?void 0:n.response)!=null&&s.isSuccessful))return Promise.reject((a=n==null?void 0:n.response)==null?void 0:a.error)}catch(n){return Promise.reject(n)}}async leaveStreaming(){var e,t;try{const s=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeatureWithoutPayload(c.StreamingLeave));if(!((e=s==null?void 0:s.response)!=null&&e.isSuccessful))return Promise.reject((t=s==null?void 0:s.response)==null?void 0:t.error)}catch(s){return Promise.reject(s)}}async getStreamingGuestStatus(){try{const e=await q(this._streamingTimeoutInMs,this._featureHandlerService.handleFeatureWithoutPayload(c.StreamingGetGuestStatus));return e==null?void 0:e.response}catch(e){return Promise.reject(e)}}async subscribeToStreamingGuestStatusUpdate(e,t){this._streamingGuestStatusSubject.subscribe(t.spaceId,t.callback)}async unsubscribeFromStreamingGuestStatusUpdate(e,t){this._streamingGuestStatusSubject.unsubscribe(t.spaceId)}async receiveStreamingGuestStatusUpdateIntent(e,t){this._streamingGuestStatusSubject.notify(t.streamingGuestStatus)}async subscribeToStreamingGuestMetricsUpdate(e,t){this._streamingGuestMetricsSubject.subscribe(t.spaceId,t.callback)}async unsubscribeFromStreamingGuestMetricsUpdate(e,t){this._streamingGuestMetricsSubject.unsubscribe(t.spaceId)}async receiveStreamingGuestMetricsUpdate(e,t){this._streamingGuestMetricsSubject.notify(t.streamingGuestMetrics)}async getGuestsAvatars(e,t){try{const{avatars:s}=await q(bi,this._avatarsService.v1.getPlayersAvatar(t.guestsProfileIds));return t.guestsProfileIds.map(n=>{const r=s.find(o=>o.profileId===n);return r?r.imageVariations[0].url:(this._logger.warn("Failed to fetch streaming guest avatar for profileId ".concat(n)),"")})}catch(s){return this._logger.warn("Failed to fetch guests avatars",{error:s,errorCode:g.FailedFetchStreamingGuestsAvatarsError}),[]}}}Me([h(fF)],be.prototype,"startStreaming",1);Me([h(yF)],be.prototype,"stopStreaming",1);Me([h(vF)],be.prototype,"createToken",1);Me([h(_F)],be.prototype,"generateInviteLinkStreaming",1);Me([h(dF)],be.prototype,"getStreamingHostStatus",1);Me([h(hF)],be.prototype,"kickGuestStreaming",1);Me([h(gF)],be.prototype,"setStreamingGuestSettings",1);Me([h(mF)],be.prototype,"setStreamingSessionSettings",1);Me([h(SF)],be.prototype,"subscribeToStreamingHostStatusUpdate",1);Me([h(Fg)],be.prototype,"unsubscribeFromStreamingHostStatusUpdate",1);Me([h(wF)],be.prototype,"receiveStreamingHostStatusUpdateIntent",1);Me([h(bF)],be.prototype,"subscribeToStreamingHostMetricsUpdate",1);Me([h(IF)],be.prototype,"unsubscribeFromStreamingHostMetricsUpdate",1);Me([h(CF)],be.prototype,"receiveStreamingHostMetricsUpdate",1);Me([h(OF)],be.prototype,"joinStreaming",1);Me([h(FF)],be.prototype,"leaveStreaming",1);Me([h(DF)],be.prototype,"getStreamingGuestStatus",1);Me([h(MF)],be.prototype,"subscribeToStreamingGuestStatusUpdate",1);Me([h(PF)],be.prototype,"unsubscribeFromStreamingGuestStatusUpdate",1);Me([h(AF)],be.prototype,"receiveStreamingGuestStatusUpdateIntent",1);Me([h(NF)],be.prototype,"subscribeToStreamingGuestMetricsUpdate",1);Me([h(RF)],be.prototype,"unsubscribeFromStreamingGuestMetricsUpdate",1);Me([h(TF)],be.prototype,"receiveStreamingGuestMetricsUpdate",1);Me([h(gV)],be.prototype,"getGuestsAvatars",1);var tX=Object.defineProperty,iX=Object.getOwnPropertyDescriptor,np=(i,e,t,s)=>{for(var a=s>1?void 0:s?iX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&tX(e,t,a),a};class go extends z{constructor(e){super(),this._featureHandlerService=e,this._previousDeltaYValue=0}async setTitleBarTitle(e,t){this.getMutableState(e,M).setMicroAppTitle({key:t.appConfig,value:t.title}),t.title!==void 0?await this._featureHandlerService.handleFeature(c.SetTitle,{titleName:t.title,gameName:this.getGameName(e)}):await this._featureHandlerService.handleFeatureWithoutPayload(c.ResetTitle)}async resetTitleBarTitleToAppLabel(e,t){var a;const s=(a=t.appConfig.meta.label)!=null?a:"";return this.setTitleBarTitle(e,new Lg(t.appConfig,s))}async setSubtitleBarTitle(e,t){this.getMutableState(e,M).setMicroAppSubtitle({key:t.appConfig,value:t.subtitle})}getGameName(e){const{activeGame:t}=this.getReadOnlyState(e,S),s=this.getReadOnlyState(e,ws),a=s==null?void 0:s.getGame(t.spaceId);return a==null?void 0:a.name}async scrollTitleBar(e,t){const{event:{deltaY:s}}=t,a=document.getElementById("title-bar");if(a){const n=a.clientHeight,r="margin 500ms ease-in-out";s<this._previousDeltaYValue?(a.style.marginTop="0rem",a.style.transition=r):s<n?(a.style.marginTop=-s+"rem",a.style.transition=r):s>=n&&(a.style.marginTop=-n+"rem",a.style.transition=r),this._previousDeltaYValue=s}}}np([h(Lg)],go.prototype,"setTitleBarTitle",1);np([h(Gg)],go.prototype,"resetTitleBarTitleToAppLabel",1);np([h(LF)],go.prototype,"setSubtitleBarTitle",1);np([h(Nl)],go.prototype,"scrollTitleBar",1);var sX=Object.defineProperty,aX=Object.getOwnPropertyDescriptor,La=(i,e,t,s)=>{for(var a=s>1?void 0:s?aX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&sX(e,t,a),a};class Zs extends z{constructor(e,t,s,a,n){super(),this._featureHandlerService=e,this._economyService=t,this._avatarsService=s,this._pluginsService=a,this._logger=n}async loadUserActivityStatus(e){const t=await this._featureHandlerService.handleFeatureWithoutPayload(c.GetUserActivity);t!=null&&t.response&&this.dispatch(e,new bg(t.response.userActivityStatus))}async updateUserActivityStatus(e,{newActivityStatus:t}){const s=this.getMutableState(e,Wi);if(s.activity=t,t===hs.Busy){const a=this.getMutableState(e,Ft),n=ni.SupportedNotificationTypes.filter(r=>ni.canBeDisabled(r));a.clearNotifications(n)}}async observeUserSubscriptionStatus(e){var t;this._userSubscriptionObserver||(this._userSubscriptionObserver=await ((t=this._pluginsService.getApi(ee.UbisoftPlusApiV1))==null?void 0:t.observeSubscriptionStatusChange(s=>{const a=this.getMutableState(e,Wi);a.isSubscribed=(s==null?void 0:s.isActiveSubscriber)===!0},{onError:s=>{this._logger.warn("Unable to get user subscription status.",{error:s,logCategory:f.shell,errorCode:g.FailedFetchSubscriptionStatusWarning})}})))}async unobserveUserSubscriptionStatus(e){var t;this._userSubscriptionObserver&&await ((t=this._pluginsService.getApi(ee.UbisoftPlusApiV1))==null?void 0:t.unobserveSubscriptionStatusChange(this._userSubscriptionObserver))}async updateUserWalletStatus(e){var t;try{const s=await ((t=this._pluginsService.getApi(ee.StoreApiV1))==null?void 0:t.getWallet())||IS,a=this.getMutableState(e,Wi);a.walletStatus=s}catch(s){this._logger.warn("Unable to get user wallet status.",{error:s,logCategory:f.shell,errorCode:g.FailedFetchWalletStatusWarning})}}async loadUserLevel(e){const s=this.getReadOnlyState(e,S).profileId;if(s!==void 0)try{const a=await this._economyService.v1.getMetaProgression(s),n=this.getMutableState(e,Wi);n.level=a.level}catch(a){this._logger.warn("Failed to retrieve profile meta progression for profile ".concat(s),{error:a,logCategory:f.shell})}}async loadUserAvatar(e){var a,n;const s=(a=this.getReadOnlyState(e,S).playerSession)==null?void 0:a.userId;if(s!==void 0)try{const r=await this._avatarsService.v1.getPlayerAvatar(s),o=r.imageVariations.find(u=>u.width===146),l=this.getMutableState(e,Wi);l.avatarUrl=(n=o==null?void 0:o.url)!=null?n:r.imageVariations[0].url}catch(r){this._logger.warn("Failed to retrieve profile avatar for profile ".concat(s),{error:r,logCategory:f.shell})}}}La([h(TO)],Zs.prototype,"loadUserActivityStatus",1);La([h(bg)],Zs.prototype,"updateUserActivityStatus",1);La([h(RO)],Zs.prototype,"observeUserSubscriptionStatus",1);La([h(DO)],Zs.prototype,"unobserveUserSubscriptionStatus",1);La([h(cu)],Zs.prototype,"updateUserWalletStatus",1);La([h(OO)],Zs.prototype,"loadUserLevel",1);La([h(lu)],Zs.prototype,"loadUserAvatar",1);var nX=Object.defineProperty,rX=Object.getOwnPropertyDescriptor,$n=(i,e,t,s)=>{for(var a=s>1?void 0:s?rX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&nX(e,t,a),a};class Ga extends z{constructor(e){super(),this._featureHandlerService=e}async setViewportMode(e,t){const s=this.getMutableState(e,it);return s.viewportMode=t.mode,!0}async SetNavigationBarViewMode(e,t){if(this.getMutableState(e,it).navigationBarViewMode===t.mode)return!0;const a=await this._featureHandlerService.handleFeature(c.UpdateNavigationBarViewMode,{mode:t.mode}),n=(a==null?void 0:a.response.isSuccessful)===!0;if(n){const r=this.getMutableState(e,it);r.navigationBarViewMode=t.mode}return n}async SetTitleBarViewMode(e,t){const s=this.getMutableState(e,it);return s.titleBarViewMode=t.mode,!0}async resetToDefaultNavigationUIVisibility(e){const s=this.getReadOnlyState(e,S).hostPlatformType===p.WebEmbedded?Ja.hidden:Ja.expanded;this.dispatch(e,new hg(s)),this.dispatch(e,new dg(sS.visible))}async setSidebarViewMode(e,t){const s=this.getMutableState(e,it);return s.sidebarViewMode=t.mode,s.sidebarViewMode}async setSidebarViewState(e,t){const s=this.getMutableState(e,it);return s.sidebarViewMode=aS.manual,s.sidebarViewState=t.state,s.sidebarViewState}}$n([h(vl)],Ga.prototype,"setViewportMode",1);$n([h(dg)],Ga.prototype,"SetNavigationBarViewMode",1);$n([h(hg)],Ga.prototype,"SetTitleBarViewMode",1);$n([h(_l)],Ga.prototype,"resetToDefaultNavigationUIVisibility",1);$n([h(LD)],Ga.prototype,"setSidebarViewMode",1);$n([h(GD)],Ga.prototype,"setSidebarViewState",1);var oX=Object.defineProperty,cX=Object.getOwnPropertyDescriptor,lX=(i,e,t,s)=>{for(var a=s>1?void 0:s?cX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&oX(e,t,a),a};class KG extends z{constructor(e,t){super(),this._logger=e,this._pluginService=t,this._logger=e.createChild("WebEmbedderReducer.reducer"),this._logger.settings.logCategory=f.shell}async unobserveMicroAppScrollableContainerIntent(e,t){var s;(s=this._pluginService.getApi(ee.WebEmbedderApiV1))==null||s.unobserveMainScrollableContainer(t.microAppConfig.appName)}}lX([h(lc)],KG.prototype,"unobserveMicroAppScrollableContainerIntent",1);var pX=Object.defineProperty,uX=Object.getOwnPropertyDescriptor,Rm=(i,e,t,s)=>{for(var a=s>1?void 0:s?uX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&pX(e,t,a),a};class rp extends z{constructor(e,t){super(),this._logger=e,this._featureHandlerService=t,this._logger=e.createChild("WindowFrame.reducer"),this._logger.settings.logCategory=f.shell}async updateWindowState(e,t){const s=this.getMutableState(e,Q);s.windowState!==t.state&&(s.windowState=t.state)}async loadWindowState(e,t){var s,a;if((s=window.upn)!=null&&s.showWindowControls)try{const n=await this._featureHandlerService.handleFeatureWithoutPayload(c.WindowGetState),r=(a=n==null?void 0:n.response)==null?void 0:a.state;r?this.updateWindowState(e,new oc(r)):this._logger.warn("Loading window state response contained invalid state",{state:r,errorCode:g.WindowFrameUnableToGetStateWarning})}catch(n){this._logger.warn("Loading window state request failed with error",{error:n,errorCode:g.WindowFrameUnableToGetStateWarning})}}async setWindowState(e,t){var s;try{const a=await this._featureHandlerService.handleFeature(c.WindowSetState,{state:t.state}),n=(s=a==null?void 0:a.response)==null?void 0:s.newState;n?this.updateWindowState(e,new oc(n)):this._logger.warn("Setting window state response contained invalid state",{state:n,errorCode:g.WindowFrameUnableToSetStateWarning})}catch(a){this._logger.warn("Setting window state request failed with error",{error:a,errorCode:g.WindowFrameUnableToSetStateWarning})}}}Rm([h(oc)],rp.prototype,"updateWindowState",1);Rm([h(eG)],rp.prototype,"loadWindowState",1);Rm([h(Cu)],rp.prototype,"setWindowState",1);class dX{static create(e){var t;return{reducers:[new he(e.logger,e.platformInterface,e.trackingService,e.ubiServicesService.ubiServices.parametersService,e.shellConfig,e.ubiServicesService.ubiServices.populationsService,e.featureHandlerService,e.pluginsService,e.lifeGuardService,e.placementContainersService,e.hostCommunicationService),new rK(e.logger,e.lifeGuardService,e.localStorageService,e.shellConfigService,e.appBundleUrlOverrideHelper,e.runtimeParameters,e.featureHandlerService,e.localizationService,e.metricDefinitions,e.shellConfig,e.httpClientFactory.getBasicHttpClient()),new Ye(e.logger,e.ubiServicesService,e.trackingService,e.lifeGuardService,e.platformInterface,e.featureHandlerService,e.cacheService,e.metricDefinitions,e.pluginsService,e.apiFactory,e.store,e.anonymousTrackingService,e.connectServices),new Ta(e.logger,e.runtimeParameterService,new VR(e.localStorageService),e.localStorageService,e.featureHandlerService,e.pluginsService),new Di(e.logger,e.authenticationStrategy,e.runtimeParameters,e.trackingService,e.sessionProviderService,e.featureHandlerService,e.runtimeParameterService,e.hostCommunicationService),new Oi(e.logger,e.runtimeParameters,e.featureHandlerService,e.kinderGarden),new qG(e.logger,e.trackingService,e.featureHandlerService),new yz(e.logger,e.appBundleUrlOverrideHelper,e.shellConfigService,e.lifeGuardService,e.featureHandlerService,e.runtimeParameters,e.pluginsService,e.shellConfig),new Ys(e.logger,e.featureHandlerService),new Le(e.logger,e.focusSystemService.focusSystem),new sp(e.focusSystemService.focusSystem,e.localizationService,e.featureHandlerService),new go(e.featureHandlerService),new ep(e.logger),new Zl(e.logger),new Fa(e.playerNotificationSubject,e.logger,e.playerNotificationWebSocketService),new be(e.logger,e.featureHandlerService,e.ubiServicesService.ubiServices.avatarsService),new di(e.gameInvitesSubject,e.featureHandlerService,e.runtimeParameters),new FG(e.logger,e.connectServices.gamesService),new OG(e.logger,e.ubiServicesService.ubiServices.gamesPlayedService,e.connectServices.gamesService,e.featureHandlerService),new Pe(e.pluginsService),new Oa(e.logger,e.featureHandlerService,e.featureFlagsService,e.features,e.desktopNotificationService),new BG,new Pm(e.featureHandlerService),new Zs(e.featureHandlerService,e.connectServices.economyService,e.ubiServicesService.ubiServices.avatarsService,e.pluginsService,e.logger),new co(e.logger,e.featureHandlerService),new $G,new Lz(e.logger,e.hostFeatureConfigurationService,e.featureHandlerService),new ai(e.logger,e.runtimeParameters,e.httpClientFactory.getBasicHttpClient(),e.localStorageService),new Ga(e.featureHandlerService),new Js,new WG,new DK(e.resizeObserverService,e.placementContainersService,e.shellConfig.shellSpaceId),new Na(e.logger,e.ubiServicesService.ubiServices.spacesService,e.featureHandlerService,e.kinderGarden),new zl(e.featureHandlerService,e.pluginsService),new xG(e.logger,e.pluginsService),new po(e.logger,e.featureHandlerService),new Kl(e.logger,e.featureHandlerService),new lt(e.featureHandlerService,e.placementContainersService,e.hostCommunicationService),new lo(e.logger,e.localStorageService),new kG(e.focusSystemService.focusSystem,e.logger),new rp(e.logger,e.featureHandlerService),new KG(e.logger,e.pluginsService),new _m(e.runtimeParameters,e.authenticationTokenProvider)],states:[new Q(e.shellConfig.shellApplicationId),new te(e.runtimeParameterService.parameterConfig,e.runtimeParameters,{platformInterface:e.platformInterface.name,authenticationStrategy:e.authenticationStrategy.name}),new M(e.apiFactory,e.runtimeParameters.hostSpaceId),new ys,new Vs,new Y,new da(e.shellConfig.shellCrossPlatformSpaceId),new ws,new zi,new Ei,new Ft,new uo,new ap,new Wi,new Ii,new $e,new hm,new Ke,new Ui(e.runtimeParameters,(t=e.runtimeParameters.cacheOpaqueRequests)!=null?t:!1,e.runtimeParameters.wipeCacheOnVersion),new ye,new it,new ao,new cs,new An,new zr,new Lt,new mt,new ls,new RL(e.runtimeParameters),new cc,new Xl]}}}const Bf=[p.PCLegacyClient,p.PCLegacyOverlay,p.Luna,p.SteamOverlay,p.SteamClient,p.PS4Aegir,p.PS4AegirNative,p.PS5Aegir,p.PS5AegirNative,p.XOneAegir,p.XOneAegirNative,p.ScarlettAegir,p.ScarlettAegirNative,p.MacOSAegir,p.MacOSAegirNative];class hX{constructor(e){this._all=e}async dispatch(){return this._all.runtimeParameters.childId?this.initializeChildWindow(this._all.runtimeParameters.childId):this.initializeMainWindow()}async initializeChildWindow(e){this._all.kinderGarden.registerSelfAsChild(e),await this._all.store.dispatchIntent(new Re(!1)),await this._all.store.dispatchIntent(new wu),Bf.includes(this._all.runtimeParameters.hostPlatformType)&&this._all.store.dispatchIntent(new Qo),await this._all.store.dispatchIntent(new Jp),this._all.performanceMeter.mark.childInitialized()}async initializeMainWindow(){await this.shouldInitialize()&&(this._all.kinderGarden.registerSelfAsHost(),await this.preAuth(),await this.auth()),await this._all.store.dispatchIntent(new Jp),this._all.performanceMeter.mark.shellInitialized()}async shouldInitialize(){return this._all.runtimeParameters.hostPlatformType===p.WebEmbedded&&!this._all.trackingService?(this._all.logger.error("Transport service must be for embedded context"),this._all.store.dispatchIntent(new ji({message:"error.generic"})),!1):this._all.runtimeParameters.configurationCorrupted?(this._all.logger.error("Configuration is corrupted"),this._all.store.dispatchIntent(new ji({message:"error.generic"})),!1):!0}async preAuth(){this._all.store.dispatchIntent(new Re(!0)),await this._all.store.dispatchIntent(new xD),this._all.performanceMeter.mark.serviceWorkerInitialized(),await this._all.store.dispatchIntent(new wu),this._all.performanceMeter.mark.hostFeaturesInitialized(),[p.PCLegacyOverlay,p.Luna,p.SteamOverlay].includes(this._all.runtimeParameters.hostPlatformType)?(await this._all.store.dispatchIntent(new Gt(_e.User,!1)),this._all.store.dispatchIntent(new JL),this._all.store.dispatchIntent(new TO)):await this._all.store.dispatchIntent(new Od),Bf.includes(this._all.runtimeParameters.hostPlatformType)&&this._all.store.dispatchIntent(new Qo),[p.PCLegacyClient,p.SteamClient].includes(this._all.runtimeParameters.hostPlatformType)&&this._all.store.dispatchIntent(new PL)}async auth(){var t;const e=await this._all.store.dispatchIntent(new xd);return this._all.performanceMeter.mark.authenticationProcessed(),await this.postAuth(e),(t=window.upn)!=null&&t.enableAuthAppPc&&e instanceof Ai?await this._all.store.dispatchIntent(new Ud(e)):await this._all.store.dispatchIntent(e),this._all.performanceMeter.mark.postAuthActionDone(),this._all.store.dispatchIntent(new Re(!1))}async postAuth(e){const t=this.tryGetSession(e);t!=null&&t.sessionId&&await this._all.store.dispatchIntent(new Dd(t)),t!=null&&t.clientIpCountry&&!this._all.store.getReadonlyState(S).country&&await this._all.store.dispatchIntent(new nr(t.clientIpCountry))}tryGetSession(e){var t;if(e instanceof Ai)return(t=e.authData)==null?void 0:t.session;if(e instanceof at)return e.session}}var ku=(i=>(i.CacheKillSwitchConfig="ubiConnect-configCache",i))(ku||{});class gX{async getCacheConfiguration(e,t,s){try{return(await q(bi,s.v1.getSpaceParametersWithoutAuthentication(t.shellSpaceId,[],[ku.CacheKillSwitchConfig]))).parameters[ku.CacheKillSwitchConfig].fields}catch(a){e.warn("Fail to query configuration service configuration",{error:a,logCategory:f.configuration,errorCode:g.FailedQueryConfigurationServiceWarning})}return{useConfigService:!1,noServiceWorker:!1,wipeCacheData:!1,wipeCacheOnVersion:"",cacheOpaqueResponse:!1}}async updateRuntimeParamteresWithCacheConfiguration(e,t,s,a){var r;const n=await this.getCacheConfiguration(t,s,a);t.debug("Cache Configuration",{...n,logCategory:f.initialization}),e.noServiceWorker===void 0&&(e.noServiceWorker=n.noServiceWorker),e.wipeCacheData===void 0&&(e.wipeCacheData=n.wipeCacheData),n.cacheOpaqueResponse||(n.cacheOpaqueResponse=!1),e.cacheOpaqueRequests=(r=e.cacheOpaqueRequests)!=null?r:n.cacheOpaqueResponse,e.wipeCacheOnVersion===void 0&&(e.wipeCacheOnVersion=n.wipeCacheOnVersion)}}function mX(i){i.childId||[p.PCWebOverlay,p.SteamOverlay,p.PCLegacyOverlay,p.PCElectronOverlay,p.Luna].includes(i.hostPlatformType)&&(document.title=document.title+" Overlay")}const dt=class dt{static getLogRules(e){return e?[{level:[Te.Info,Te.Warning,Te.Error],transport:[Wt.persistentQueue]}]:dt.baseLogRules}static getConfig(e){return{applicationQueueId:"Shell-App",rules:dt.getLogRules(e),settings:{logCategory:f.shell},useDebugMode:!1,enableTraceLogs:!1,consoleColorScheme:{All:{textColor:"#ececec",backgroundColor:"#2143bf"},Trace:{textColor:"#2143bf",backgroundColor:"#00e4e4"},Debug:{textColor:"#ececec",backgroundColor:"#6376ba"}},maskedFields:["ticket","token","email","password","sessionKey","rememberMeTicket","Authorization","fullUrl"]}}static getChildLogger(e){const t=new Jm("Shell",dt.getConfig(!0));return t.settings.context={childId:e},t.addCustomTransport(cr,new cr,ds.ParentRemoteLogTransport),t.addRule({level:"All",transport:ds.ParentRemoteLogTransport}),t}static getMainWindowLogger(e,t,s){const a=new Jm("Shell",dt.getConfig(!1));e&&a.replaceDefaultTransport(Wt.console,p2);const{config:n}=a.getDefaultTransport(ir);return n.httpClientFactory=t,n.environment=s.ubiservicesEnvironment,n.endpoint=s.ubiservicesApiBaseUrl,n.queueLimitCount=s.loggerConfig.batchSize,n.outputInterval=s.loggerConfig.timeInterval,a.addRule({level:"All",transport:Wt.remoteLogger}),a.debug("Remote logs transport is pre-configured",{...n,logCategory:f.initialization}),a}static createPerformanceLogger(e,t){const s=e.createChild("Performance");s.clearTagChain(),s.settings.logCategory=f.performance;const a=t?[ds.ParentRemoteLogTransport]:[Wt.remoteLogger];return s.setRules([{level:"All",transport:a}]),s}static getShellLogging(e,t,s,a){if(dt.logging)return dt.logging;const n=e.childId?dt.getChildLogger(e.childId):dt.getMainWindowLogger(e.decoratedConsoleLog===!0,t,s),r=dt.createPerformanceLogger(n,e.childId!==void 0);a.rootPerformanceLogger=r;const o=new YF({context:{applicationName:"shell",applicationId:s.shellApplicationId,applicationBuildId:"8.86.3",spaceId:s.shellSpaceId},timeOffset:0,logger:r.createChild("shell"),predefinedMarksMap:_i,preexistingMarks:{...window.__performanceMarks},transportProvider:a,trackedMetrics:[{name:"shell-main",startMark:_i.mainStart,endMark:_i.mainEnd,recurring:!1},{name:"shell-initiation",startMark:_i.jsCreated,endMark:_i.shellInitialized,recurring:!1}]});return dt.logging={logger:n,performanceLogger:r,performanceMeter:o},dt.logging}};dt.baseLogRules=[{level:[Te.Info,Te.Warning,Te.Error],transport:[Wt.persistentQueue,Wt.console]},{level:[Te.Debug],logCategory:[f.performance,f.hostCommunication,f.initialization,f.authentication],transport:Wt.persistentQueue}],dt.devLogRules=[{level:[Te.Info,Te.Warning,Te.Error],transport:[Wt.persistentQueue]},{level:[Te.Debug],logCategory:[f.performance,f.hostCommunication,f.initialization,f.authentication],transport:Wt.persistentQueue},{level:"All",transport:Wt.console}];let Wu=dt;function fX(i,e,t,s){const a=!!i.childId||![p.PCWebClient,p.PCLegacyClient,p.PCElectronClient,p.SteamClient].includes(i.hostPlatformType);s.watchState(S,"runtimeContext",(n,r)=>{e.runtimeContextContentHasChanged(n,r)&&e.notifyRuntimeContextUpdate(n,a)}),s.watchState(S,"playerSession",n=>{n&&t.updateConnection()})}var Fo=(i=>(i.AddBadge="add-badge",i.AddFriend="add-friend",i.AddFriends="add-friends",i.AddGame="add-game",i.Add="add",i.AngleDown="angle-down",i.AngleLeft="angle-left",i.AngleRight="angle-right",i.AngleUp="angle-up",i.Anniversary="anniversary",i.ArrowLeft="arrow-left",i.ArrowRight="arrow-right",i.Away="away",i.Badges="badges",i.Block="block",i.Calendar="calendar",i.Camera="camera",i.CartBuy="cart-buy",i.CartSell="cart-sell",i.Cart="cart",i.ChallengeReward="challenge-reward",i.Chat="chat",i.Checkmark="checkmark",i.Close="close",i.Cloud="cloud",i.CollapseIn="collapse-in",i.CollapseOut="collapse-out",i.Console="console",i.ContextMenuVertical="context-menu-vertical",i.Copy="copy",i.Crown="crown",i.Currency="currency",i.Desktop="desktop",i.Discount="discount",i.DoNotDisturb="do-not-disturb",i.Download="download",i.Edit="edit",i.Email="email",i.EmptyBadgeSlot="empty-badge-slot",i.Error="error",i.ExternalLink="external-link",i.Favorite="favorite",i.Feed="feed",i.Feedback="feedback",i.Filters="filters",i.Folder="folder",i.Forward="forward",i.FriendRequestSent="friend-request-sent",i.Friend="friend",i.Friends="friends",i.Games="games",i.GiveLove="give-love",i.GiveUsFeedback="give-us-feedback",i.HamburgerMenu="hamburger-menu",i.Hide="hide",i.Home="home",i.Hourglass="hourglass",i.InCommon="in-common",i.Information="information",i.Internet="internet",i.Interrogation="interrogation",i.Leaderboard="leaderboard",i.LevelUp="level-up",i.LightningBolt="lightning-bolt",i.List="list",i.Lock="lock",i.LockedBadge="locked-badge",i.Login="login",i.Logout="logout",i.Maximize="maximize",i.Microphone="microphone",i.Minimize="minimize",i.Minus="minus",i.NewChat="new-chat",i.NoInternet="no-internet",i.NotificationOff="notification-off",i.Notification="notification",i.Partnership="partnership",i.Pc="pc",i.Pictures="pictures",i.PlatformsOwned="platforms-owned",i.Platforms="platforms",i.Play="play",i.ProgressionConsoleTag="progression-console-tag",i.ProgressionMobileTag="progression-mobile-tag",i.Progression="progression",i.Protection="protection",i.Rearward="rearward",i.Refresh="refresh",i.Restore="restore",i.Rewards="rewards",i.RoundCheckmark="round-checkmark",i.RoundWrong="round-wrong",i.Search="search",i.SecurityError="security-error",i.SecurityTick="security-tick",i.SecurityWarning="security-warning",i.Send="send",i.Settings="settings",i.Share="share",i.Show="show",i.SmartIntel="smart-intel",i.Social="social",i.Sort="sort",i.SoundDown="sound-down",i.SoundOff="sound-off",i.SoundUp="sound-up",i.StarPlayers="star-players",i.Star="star",i.Statistics="statistics",i.Support="support",i.ThumbsDown="thumbs-down",i.ThumbsUp="thumbs-up",i.TileMedium="tile-medium",i.Tips="tips",i.Unlock="unlock",i.Upload="upload",i.Warning="warning",i.Xp="xp",i.Browser="browser",i.Challenges="challenges",i.ContextMenuHorizontal="context-menu-horizontal",i.Diamond="diamond",i.Discord="discord",i.Facebook="facebook",i.FullscreenOff="fullscreen-off",i.Fullscreen="fullscreen",i.Instagram="instagram",i.Key="key",i.KeyboardA="keyboard-a",i.KeyboardArrowDown="keyboard-arrow-down",i.KeyboardArrowLeft="keyboard-arrow-left",i.KeyboardArrowRight="keyboard-arrow-right",i.KeyboardArrowUp="keyboard-arrow-up",i.KeyboardBackspace="keyboard-backspace",i.KeyboardC="keyboard-c",i.KeyboardCtrl="keyboard-ctrl",i.KeyboardD="keyboard-d",i.KeyboardE="keyboard-e",i.KeyboardEnter="keyboard-enter",i.KeyboardEscape="keyboard-escape",i.KeyboardF="keyboard-f",i.KeyboardF2="keyboard-f2",i.KeyboardG="keyboard-g",i.KeyboardJ="keyboard-j",i.KeyboardK="keyboard-k",i.KeyboardL="keyboard-l",i.KeyboardQ="keyboard-q",i.KeyboardR="keyboard-r",i.KeyboardS="keyboard-s",i.KeyboardShift="keyboard-shift",i.KeyboardSpace="keyboard-space",i.KeyboardT="keyboard-t",i.KeyboardTab="keyboard-tab",i.KeyboardV="keyboard-v",i.KeyboardW="keyboard-w",i.KeyboardX="keyboard-x",i.LunaAlt="luna-alt",i.LunaLogo="luna-logo",i.Luna="luna",i.Mobile="mobile",i.MouseLeftClick="mouse-left-click",i.MouseScrollClick="mouse-scroll-click",i.NintendoSwitch="nintendo-switch",i.Offline="offline",i.Online="online",i.PadButtonDown="pad-button-down",i.PadButtonLeft="pad-button-left",i.PadButtonRight="pad-button-right",i.PadButtonUp="pad-button-up",i.Pause="pause",i.Playstation="playstation",i.PsLogo="ps-logo",i.PsNetwork="ps-network",i.PsStickLAllDirection="ps-stick-l-all-direction",i.Ps4L1="ps4-l1",i.Ps4L2="ps4-l2",i.Ps4L3="ps4-l3",i.Ps4R1="ps4-r1",i.Ps4R2="ps4-r2",i.Ps4R3="ps4-r3",i.Ps4Circle="ps4-circle",i.Ps4LeftStickScroll="ps4-left-stick-scroll",i.Ps4Options="ps4-options",i.Ps4Rectangle="ps4-rectangle",i.Ps4RightStickScroll="ps4-right-stick-scroll",i.Ps4Scroll="ps4-scroll",i.Ps4Share="ps4-share",i.Ps4Touchpad="ps4-touchpad",i.Ps4Triangle="ps4-triangle",i.Ps4X="ps4-x",i.Ps5Options="ps5-options",i.RewardRarity="reward-rarity",i.SpecialChallengeLeft="special-challenge-left",i.SpecialChallengeRight="special-challenge-right",i.StadiaL1="stadia-l1",i.StadiaL2="stadia-l2",i.StadiaL3="stadia-l3",i.StadiaR1="stadia-r1",i.StadiaR2="stadia-r2",i.StadiaR3="stadia-r3",i.StadiaA="stadia-a",i.StadiaAssistant="stadia-assistant",i.StadiaB="stadia-b",i.StadiaCapture="stadia-capture",i.StadiaG="stadia-g",i.StadiaLeftStickScroll="stadia-left-stick-scroll",i.StadiaMenu="stadia-menu",i.StadiaOption="stadia-option",i.StadiaPadDown="stadia-pad-down",i.StadiaPadLeft="stadia-pad-left",i.StadiaPadRight="stadia-pad-right",i.StadiaPadUp="stadia-pad-up",i.StadiaRightStickScroll="stadia-right-stick-scroll",i.StadiaScroll="stadia-scroll",i.StadiaX="stadia-x",i.StadiaY="stadia-y",i.Stadia="stadia",i.Steam="steam",i.SwitchL="switch-l",i.SwitchLs="switch-ls",i.SwitchR="switch-r",i.SwitchRs="switch-rs",i.SwitchZl="switch-zl",i.SwitchZr="switch-zr",i.SwitchA="switch-a",i.SwitchB="switch-b",i.SwitchMinusButton="switch-minus-button",i.SwitchPadDown="switch-pad-down",i.SwitchPadLeft="switch-pad-left",i.SwitchPadRight="switch-pad-right",i.SwitchPadUp="switch-pad-up",i.SwitchPlusButton="switch-plus-button",i.SwitchX="switch-x",i.SwitchY="switch-y",i.TileSmall="tile-small",i.Trash="trash",i.Twitch="twitch",i.UbisoftPlus="ubisoft-plus",i.Unit="unit",i.X="x",i.XboxLb="xbox-lb",i.XboxLs="xbox-ls",i.XboxLt="xbox-lt",i.XboxRb="xbox-rb",i.XboxRs="xbox-rs",i.XboxRt="xbox-rt",i.XboxA="xbox-a",i.XboxB="xbox-b",i.XboxLeftStickScroll="xbox-left-stick-scroll",i.XboxMenu="xbox-menu",i.XboxRightStickScroll="xbox-right-stick-scroll",i.XboxScroll="xbox-scroll",i.XboxShare="xbox-share",i.XboxStickLAllDirection="xbox-stick-l-all-direction",i.XboxView="xbox-view",i.XboxX="xbox-x",i.XboxY="xbox-y",i.Xbox="xbox",i))(Fo||{}),XG=(i=>(i.Outline="outline",i.Solid="solid",i))(XG||{}),yX=Object.defineProperty,vX=Object.getOwnPropertyDescriptor,JG=(i,e,t,s)=>{for(var a=s>1?void 0:s?vX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&yX(e,t,a),a};let uc=class extends K{};JG([W({required:!0})],uc.prototype,"environment",2);uc=JG([j],uc);var _X=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"environment-tag"},[t("p",{class:"environment-tag-version "+i.environment},[i._v(i._s(i.environment))])])},SX=[];const Hf={};var wX=Z(uc,_X,SX,!1,bX,"69181df1",null,null);function bX(i){for(let e in Hf)this[e]=Hf[e]}const CX=function(){return wX.exports}();var IX=Object.defineProperty,MX=Object.getOwnPropertyDescriptor,AX=(i,e,t,s)=>{for(var a=s>1?void 0:s?MX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&IX(e,t,a),a};let Vu=class extends K{};Vu=AX([j],Vu);var PX=function(){var i=this,e=i.$createElement;return i._self._c,i._m(0)},NX=[function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"secure-client"},[t("div",{staticClass:"container"},[t("div",{staticClass:"secure-mode"},[i._v("Secure Mode")]),t("div",{staticClass:"on"},[i._v("ON")])])])}];const Qf={};var TX=Z(Vu,PX,NX,!1,RX,null,null,null);function RX(i){for(let e in Qf)this[e]=Qf[e]}const DX=function(){return TX.exports}();var OX=Object.defineProperty,FX=Object.getOwnPropertyDescriptor,op=(i,e,t,s)=>{for(var a=s>1?void 0:s?FX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&OX(e,t,a),a};let fn=class extends K{constructor(){super(...arguments),this.IconName=Fo,this.IconType=XG}get maximizeRestoreIcon(){return this.windowState===ns.Maximize?Fo.Restore:Fo.Maximize}beforeCreate(){this.$dispatch(new eG)}get isVisible(){var e;return!!((e=window.upn)!=null&&e.showWindowControls)}closeWindow(){window.close()}minimizeWindow(){this.$dispatch(new Cu(ns.Minimize))}maximizeRestoreWindow(){const e=this.windowState===ns.Maximize?ns.Restore:ns.Maximize;this.$dispatch(new Cu(e))}get secureModeVisible(){var e;return!!((e=window.upn)!=null&&e.secureMode)}get isTaggedEnvironment(){return[ie.Uat,ie.Dev].includes(this.environment)}};op([C(Q,"windowState")],fn.prototype,"windowState",2);op([C(S,"environment")],fn.prototype,"environment",2);op([W({type:Boolean,required:!1,default:!1})],fn.prototype,"isEnvironmentTagVisible",2);fn=op([j({components:{"upn-icon":Bc,"secure-client":DX,"environment-tag":CX}})],fn);var LX=function(){var i=this,e=i.$createElement,t=i._self._c||e;return i.isVisible?t("div",{staticClass:"window-title-bar"},[t("div",{staticClass:"draggable-area"}),t("div",{staticClass:"title-bar-content"},[i.isTaggedEnvironment&&i.isEnvironmentTagVisible?t("environment-tag",{attrs:{environment:i.environment}}):i._e(),i.secureModeVisible?t("secure-client"):i._e()],1),t("div",{staticClass:"window-controls-container"},[t("div",{staticClass:"icon minimize-icon",attrs:{"data-e2e":"minimize-icon"},on:{click:i.minimizeWindow}},[t("upn-icon",{attrs:{name:i.IconName.Minimize,type:i.IconType.Outline}})],1),t("div",{staticClass:"icon maximize-icon",attrs:{"data-e2e":"maximize-icon"},on:{click:i.maximizeRestoreWindow}},[t("upn-icon",{attrs:{name:i.maximizeRestoreIcon,type:i.IconType.Outline}})],1),t("div",{staticClass:"icon close-icon",attrs:{"data-e2e":"close-icon"},on:{click:i.closeWindow}},[t("upn-icon",{attrs:{name:i.IconName.Close,type:i.IconType.Outline}})],1)])]):i._e()},GX=[];const jf={};var xX=Z(fn,LX,GX,!1,EX,"345f71a0",null,null);function EX(i){for(let e in jf)this[e]=jf[e]}const UX=function(){return xX.exports}();var kX=Object.defineProperty,WX=Object.getOwnPropertyDescriptor,Fi=(i,e,t,s)=>{for(var a=s>1?void 0:s?WX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&kX(e,t,a),a};let zt=class extends K{constructor(){super(...arguments),this.top=0,this.left=0,this._appListRect=null,this._tooltipRect=null}onLabelChange(){this._tooltipRect=null}onTooltipVisibleChange(){this.showTooltipOnActiveTile()}onTileIdChange(){this.showTooltipOnActiveTile()}clearAppList(){this._appListRect=null}mounted(){window.addEventListener("resize",this.clearAppList)}beforeDestroy(){window.removeEventListener("resize",this.clearAppList)}get shouldShowTooltip(){return this.visible&&this.positioned}showTooltipOnActiveTile(){if(!(this.tileId&&this.applicationListIsReady))return;const i=document.getElementById("app-list"),e=document.getElementById(this.tileId);!i||!e||this.$nextTick(()=>{this._appListRect||(this._appListRect=i.getBoundingClientRect()),this.$dispatch(new Iu(!1)),this.updatePosition(e.getBoundingClientRect(),this._appListRect)})}updatePosition(i,e){const t=this.$el;if(!i||!e||!t)return;this._tooltipRect||(this._tooltipRect=t.getBoundingClientRect());const s=(i.height-this._tooltipRect.height)/2;this.elementEntirelyWithinContainerVertically(i,e)&&(this.left=this.calculateTooltipLeftOffset(i),this.top=i.top+s,this.$dispatch(new Iu(!0)))}elementEntirelyWithinContainerVertically(i,e){return i.top>0&&e.bottom>=i.bottom&&e.top<=i.top}calculateTooltipLeftOffset(i){const e=getComputedStyle(document.documentElement).fontSize,t=this.remToPX(2,e),s=this.remToPX(8,e);let a=i.right+s;return this.navigationMethod===E.directional&&(a=a+t),Math.round(a)}remToPX(i,e){return i*(e?parseFloat(e):1)}};Fi([C(Ke,"tooltipLabel")],zt.prototype,"label",2);Fi([C(Ke,"isTooltipVisible")],zt.prototype,"visible",2);Fi([C(Ke,"isTooltipPositioned")],zt.prototype,"positioned",2);Fi([C(S,"isMobileGameOverlay")],zt.prototype,"isMobileGameOverlay",2);Fi([C(S,"navigationMethod")],zt.prototype,"navigationMethod",2);Fi([C(Ke,"tileId")],zt.prototype,"tileId",2);Fi([C(Ke,"applicationListIsReady")],zt.prototype,"applicationListIsReady",2);Fi([Mt("label")],zt.prototype,"onLabelChange",1);Fi([Mt("visible")],zt.prototype,"onTooltipVisibleChange",1);Fi([Mt("tileId")],zt.prototype,"onTileIdChange",1);zt=Fi([j],zt);var VX=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"tooltip",class:{visible:i.shouldShowTooltip},style:{left:i.left+"px",top:i.top+"px"},attrs:{"data-e2e":"tooltip","data-e2e-state":i.shouldShowTooltip?"visible":"hidden",id:"tooltip"}},[t("span",{staticClass:"tooltip-label",attrs:{"data-e2e":"tooltip-label"}},[i._v(i._s(i.label))])])},$X=[];const qf={};var BX=Z(zt,VX,$X,!1,HX,"d23681d4",null,null);function HX(i){for(let e in qf)this[e]=qf[e]}const QX=function(){return BX.exports}();var jX=Object.defineProperty,qX=Object.getOwnPropertyDescriptor,Li=(i,e,t,s)=>{for(var a=s>1?void 0:s?qX(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&jX(e,t,a),a};const zX=5;let Kt=class extends K{constructor(){super(...arguments),this.icons={gamepad:{name:Fs.Games,type:Mo.Outline},timer:{name:Fs.Away,type:Mo.Outline},close:{name:Fs.Close,type:Mo.Outline}},this.secondsToDisplayLeft=0,this._timerIntervalId=0}get styles(){return{"--min-height":"".concat(this.minHeight,"rem")}}get showOpenOverlayCTA(){return!!this.$slots.actions||this.notification.type===O.Achievement}get timerSeconds(){const e=this.secondsToDisplayLeft%60>>0;return(e>=10?"":"0")+e}get timerMinutes(){return(this.secondsToDisplayLeft/60>>0).toFixed(0)}mounted(){this.startTimer()}startTimer(){this.stopTimer(),this.secondsToDisplay>0&&(this.secondsToDisplayLeft=this.secondsToDisplay,this._timerIntervalId=window.setInterval(()=>{this.secondsToDisplayLeft--,this.secondsToDisplayLeft<=0&&(this.$emit("timerDone"),clearInterval(this._timerIntervalId),this.dismissNotification())},1e3))}stopTimer(){this._timerIntervalId&&clearInterval(this._timerIntervalId)}dismissNotification(){this.$dispatch(new Ul(this.notification.id))}onClose(){this.$emit("close"),this.dismissNotification()}};Li([C(S,"isOverlayVisible")],Kt.prototype,"isOverlayVisible",2);Li([W({type:Object,required:!0})],Kt.prototype,"notification",2);Li([W({type:Number,default:121})],Kt.prototype,"minHeight",2);Li([W({type:String})],Kt.prototype,"avatar",2);Li([W({type:String})],Kt.prototype,"image",2);Li([W({type:String})],Kt.prototype,"iconName",2);Li([W({type:String})],Kt.prototype,"message",2);Li([W({type:Number,required:!0,default:zX})],Kt.prototype,"secondsToDisplay",2);Li([W({type:Boolean,default:!1})],Kt.prototype,"showTimer",2);Li([W({type:String})],Kt.prototype,"description",2);Kt=Li([j({components:{"upn-avatar":MS,"upn-picture":CS,"upn-icon":Bc}})],Kt);var KX=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"notification-content-holder",style:i.styles,attrs:{"data-notification-type":"standard"}},[i._t("content",[t("div",{staticClass:"section header"},[i._t("header",[t("div",{staticClass:"header-left"},[i._t("logo",[t("upn-icon",{staticClass:"icon",attrs:{name:i.icons.gamepad.name,type:i.icons.gamepad.type}}),t("div",{staticClass:"ubi-connect-logo-image"})])],2),t("div",{staticClass:"header-right"},[i._t("header-right",[i.secondsToDisplay>0&&i.showTimer?t("div",{staticClass:"timer"},[t("upn-icon",{staticClass:"icon",attrs:{name:i.icons.timer.name,type:i.icons.timer.type}}),i._v(" "+i._s(i.timerMinutes)+":"+i._s(i.timerSeconds)+" ")],1):t("div",{staticClass:"close-section"},[i.secondsToDisplay>0&&i.secondsToDisplayLeft<=5?t("div",{staticClass:"time-left-dots"},i._l(4,function(s){return t("div",{key:s,class:["time-left-dot","dot-"+s,5-i.secondsToDisplayLeft>=s?"fade":""]})}),0):i._e(),i.isOverlayVisible?t("upn-icon",{staticClass:"close-icon",attrs:{"data-notification-button":"close",name:i.icons.close.name,type:i.icons.close.type},nativeOn:{click:function(s){return i.onClose(s)}}}):i._e()],1)])],2)])],2),t("div",{staticClass:"section body"},[i._t("body",[t("div",{staticClass:"message-info"},[i.avatar?t("upn-avatar",{staticClass:"friend-avatar",attrs:{src:i.avatar,color:"#005DB2"}}):i.image?t("upn-picture",{staticClass:"product-image",attrs:{src:i.image,color:"#005DB2"}}):i.iconName?t("upn-icon",{staticClass:"message-icon",attrs:{name:i.iconName}}):i._e(),i.message||i.description?t("div",{staticClass:"message-block"},[i.message?t("div",{staticClass:"message truncate-overflow"},[i._v(" "+i._s(i.message)+" ")]):i._e(),i.description?t("div",{staticClass:"description truncate-overflow"},[i._v(" "+i._s(i.description)+" ")]):i._e()]):i._e()],1)])],2),i.showOpenOverlayCTA?t("div",{staticClass:"section actions"},[i.isOverlayVisible?i._t("actions"):t("div",{staticClass:"open-overlay-shortcut"},[i._v("Shift + F2")])],2):i._e()])],2)},XX=[];const zf={};var JX=Z(Kt,KX,XX,!1,YX,"552d9408",null,null);function YX(i){for(let e in zf)this[e]=zf[e]}const cp=function(){return JX.exports}();var ZX=Object.defineProperty,eJ=Object.getOwnPropertyDescriptor,YG=(i,e,t,s)=>{for(var a=s>1?void 0:s?eJ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&ZX(e,t,a),a};let dc=class extends K{onAction(e){this.$dispatch(new VL(e,this.notification.payload.myGameInviteId)),this.dismiss()}dismiss(){this.$dispatch(new Ul(this.notification.id))}get shouldShowAcceptButton(){return this.notification.payload.myCanJoin}};YG([W({type:Object,required:!0})],dc.prototype,"notification",2);dc=YG([j({components:{"upn-notification":cp,"upn-button":Ki}})],dc);var tJ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("upn-notification",{staticClass:"notification-game-invite",attrs:{avatar:i.notification.payload.myFriendAvatarUrl,message:i.$formatMessage({id:"message.friendGameInvite"},{username:i.notification.payload.myFriendName}),description:i.notification.payload.myGameName,"seconds-to-display":i.notification.payload.myTTL,notification:i.notification,"data-notification-type":"game-invite","show-timer":""},scopedSlots:i._u([{key:"actions",fn:function(){return[i.shouldShowAcceptButton?t("upn-button",{attrs:{"data-notification-button":"accept",isFocusable:!1,type:"primary-affirmative"},on:{trigger:function(s){return i.onAction(!0)}}},[i._v(i._s(i.$formatMessage({id:"button.accept"})))]):i._e(),t("upn-button",{attrs:{"data-notification-button":"decline",isFocusable:!1,type:"tertiary-destructive"},on:{trigger:function(s){return i.onAction(!1)}}},[i._v(i._s(i.$formatMessage({id:"button.decline"})))])]},proxy:!0}])})},iJ=[];const Kf={};var sJ=Z(dc,tJ,iJ,!1,aJ,"02983eea",null,null);function aJ(i){for(let e in Kf)this[e]=Kf[e]}const nJ=function(){return sJ.exports}();var rJ=Object.defineProperty,oJ=Object.getOwnPropertyDescriptor,ZG=(i,e,t,s)=>{for(var a=s>1?void 0:s?oJ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&rJ(e,t,a),a};let hc=class extends K{};ZG([W({type:Object,required:!0})],hc.prototype,"notification",2);hc=ZG([j({components:{"upn-notification":cp}})],hc);var cJ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("upn-notification",{staticClass:"notification-group-invite",attrs:{"data-notification-type":"group-invite",avatar:i.notification.payload.myInviterAvatarUrl,message:this.$formatMessage({id:"message.groupInvite"},{group:i.notification.payload.myGroupName}),notification:i.notification}})},lJ=[];const Xf={};var pJ=Z(hc,cJ,lJ,!1,uJ,"7f016428",null,null);function uJ(i){for(let e in Xf)this[e]=Xf[e]}const dJ=function(){return pJ.exports}();var hJ=Object.defineProperty,gJ=Object.getOwnPropertyDescriptor,ex=(i,e,t,s)=>{for(var a=s>1?void 0:s?gJ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&hJ(e,t,a),a};let gc=class extends K{};ex([W({type:Object,required:!0})],gc.prototype,"notification",2);gc=ex([j({components:{"upn-notification":cp,"upn-button":Ki}})],gc);var mJ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("upn-notification",{staticClass:"notification-achievement",attrs:{notification:i.notification,message:i.notification.payload.myName,description:i.notification.payload.myDescription,image:i.notification.payload.myImageUrl,secondsToDisplay:5,"data-notification-type":"achievement"}})},fJ=[];const Jf={};var yJ=Z(gc,mJ,fJ,!1,vJ,"78fcd2d1",null,null);function vJ(i){for(let e in Jf)this[e]=Jf[e]}const _J=function(){return yJ.exports}();var SJ=Object.defineProperty,wJ=Object.getOwnPropertyDescriptor,tx=(i,e,t,s)=>{for(var a=s>1?void 0:s?wJ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&SJ(e,t,a),a};const bJ={[O.GameInvite]:"upn-notification-game-invite",[O.GroupInvite]:"upn-notification-group-invite",[O.Achievement]:"upn-notification-achievement"};let mc=class extends K{get customContentComponentName(){return bJ[this.notification.type]}get genericNotificationData(){const{notification:i}=this;switch(i.type){case O.FriendInGame:return{message:this.$formatMessage({id:"message.friendPlaying"},{game:i.payload.myGameName,username:i.payload.myFriendName}),avatarUrl:i.payload.myFriendAvatarUrl};case O.FriendOnline:return{message:this.$formatMessage({id:"message.friendOnline"},{username:i.payload.myFriendName}),avatarUrl:i.payload.myFriendAvatarUrl};case O.PlayAvailable:return{message:this.$formatMessage({id:"message.gameReadyToPlay"},{game:i.payload.myGameName}),imageUrl:i.payload.myArtUrl};case O.GamePatchAvailable:return{message:this.$formatMessage({id:"message.gameUpdateAvailable"},{game:i.payload.myGameName}),imageUrl:i.payload.myArtUrl};case O.DownloadCompleted:return{message:this.$formatMessage({id:"message.downloadComplete"},{game:i.payload.myGameName}),imageUrl:i.payload.myArtUrl};case O.OverlayStart:return{message:this.$formatMessage({id:"message.overlayShortcut"})};case O.GameCustom:return{message:i.payload.myText,secondsToDisplay:i.payload.myIsPermanent?0:void 0};case O.ScreenshotSaved:return{message:this.$formatMessage({id:"message.screenshotSaved"})};case O.FriendRequest:return{message:this.$formatMessage({id:"message.friendInvite"},{username:i.payload.myFriendName}),imageUrl:i.payload.myFriendAvatarUrl};case O.ChatMessage:return{message:i.payload.myFriendName,description:i.payload.myMessage,imageUrl:i.payload.myFriendAvatarUrl};case O.SharePlayInviteFailed:return{message:this.$formatMessage({id:"message.sharePlayInviteFailed"}),iconName:Fs.Warning};case O.SharePlayTimeOutSessionReminder:{const e=Math.round(i.payload.myRemainingTime/60);return{message:this.$formatMessage({id:"message.sharePlayRemainingMinutes"},{time:e}),iconName:Fs.Hourglass}}case O.SharePlaySessionEnded:return{message:this.$formatMessage({id:"message.sharePlaySessionEnded"}),iconName:Fs.Warning};default:return null}}};tx([W({type:Object,required:!0})],mc.prototype,"notification",2);mc=tx([j({components:{"upn-notification":cp,"upn-notification-game-invite":nJ,"upn-notification-group-invite":dJ,"upn-notification-achievement":_J}})],mc);var CJ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"notification-container"},[t("div",{staticClass:"black-fadein-background"}),i.customContentComponentName?t(i.customContentComponentName,{tag:"component",staticClass:"notification-content",attrs:{notification:i.notification}}):i.genericNotificationData?t("upn-notification",{attrs:{notification:i.notification,"seconds-to-display":i.genericNotificationData.secondsToDisplay,message:i.genericNotificationData.message,description:i.genericNotificationData.description,image:i.genericNotificationData.imageUrl,avatar:i.genericNotificationData.avatarUrl,iconName:i.genericNotificationData.iconName}}):i._e()],1)},IJ=[];const Yf={};var MJ=Z(mc,CJ,IJ,!1,AJ,"4f9f2857",null,null);function AJ(i){for(let e in Yf)this[e]=Yf[e]}const PJ=function(){return MJ.exports}();var NJ=Object.defineProperty,TJ=Object.getOwnPropertyDescriptor,xa=(i,e,t,s)=>{for(var a=s>1?void 0:s?TJ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&NJ(e,t,a),a};const Zf={[ra.topRight]:"top-right",[ra.topLeft]:"top-left",[ra.bottomRight]:"bottom-right",[ra.bottomLeft]:"bottom-left"};let vs=class extends K{get stackGroups(){const i={generic:[],invites:[],permanent:[]};return this.allNotifications.filter(t=>t.state!==tr.Expired).forEach(t=>{t.type===O.GameInvite?i.invites.push(t):t.type===O.GameCustom&&t.payload.myIsPermanent?i.permanent.push(t):i.generic.push(t)}),i}get notificationsToDisplay(){if(this.isExclusiveMode)return[];const i=4,e=[],t=(s,a)=>{if(s.length){const n=i-e.length;e.push(...s.slice(0,Math.min(n,a,s.length)))}};return t(this.stackGroups.generic,1),t(this.stackGroups.invites,3),e.unshift(...this.stackGroups.permanent),e.filter(s=>s)}get hasNotificationsToDisplay(){return this.notificationsToDisplay.length>0}get classList(){return[this.isOverlayVisible?Zf[ra.topRight]:Zf[this.notificationPosition],this.isStreamingWidgetVisible?"streaming-widget-visible":""]}get isStreamingWidgetVisible(){const i=this.isOverlayVisible&&this.viewportMode===xs.fullView;return this.isStreamingWidgetEnabled&&!i}};xa([C(Ft,"notifications")],vs.prototype,"allNotifications",2);xa([C(Q,"notificationPosition")],vs.prototype,"notificationPosition",2);xa([C(S,"isOverlayVisible")],vs.prototype,"isOverlayVisible",2);xa([C(S,"isExclusiveMode")],vs.prototype,"isExclusiveMode",2);xa([C(it,"viewportMode")],vs.prototype,"viewportMode",2);xa([C(ap,"isEnabled")],vs.prototype,"isStreamingWidgetEnabled",2);vs=xa([j({components:{"upn-notification":PJ}})],vs);var RJ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return i.hasNotificationsToDisplay?t("div",{staticClass:"notifications-stack",class:i.classList},i._l(i.notificationsToDisplay,function(s){return t("div",{key:s.id},[t("upn-notification",{attrs:{notification:s}})],1)}),0):i._e()},DJ=[];const ey={};var OJ=Z(vs,RJ,DJ,!1,FJ,"1ece4b49",null,null);function FJ(i){for(let e in ey)this[e]=ey[e]}const LJ=function(){return OJ.exports}();var $u=(i=>(i.navigationBarVisible="--navigation-bar-visible",i.orientationModeIsLandscape="--orientation-mode-is-landscape",i))($u||{}),ty={},ix,iy=N2;ix=ty.createRoot=iy.createRoot,ty.hydrateRoot=iy.hydrateRoot;function GJ({children:i,parentId:e}){const t=Gl().focusSystem;return A.jsx(u2.Provider,{value:t,children:A.jsx(d2.Provider,{value:e,children:i})})}var sx={exports:{}};(function(i){(function(){var e={}.hasOwnProperty;function t(){for(var n="",r=0;r<arguments.length;r++){var o=arguments[r];o&&(n=a(n,s(o)))}return n}function s(n){if(typeof n=="string"||typeof n=="number")return n;if(typeof n!="object")return"";if(Array.isArray(n))return t.apply(null,n);if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]"))return n.toString();var r="";for(var o in n)e.call(n,o)&&n[o]&&(r=a(r,o));return r}function a(n,r){return r?n?n+" "+r:n+r:n}i.exports?(t.default=t,i.exports=t):window.classNames=t})()})(sx);var xJ=sx.exports;const st=DS(xJ);function EJ(i){return new Proxy({},{get:()=>{throw new Error("'".concat(i,"' is not initialized"))}})}const ax=U.createContext(EJ("Bridge API Context provider"));function Sa(){return U.useContext(ax)}function Lo({id:i,defaultMessage:e,values:t}){const s=Sa().localizationService;return A.jsx(A.Fragment,{children:s.formatMessage({id:i,defaultMessage:e},t)})}function UJ(i){const e=Sa().focusSystem,[t,s]=U.useState(e.isFocused(i));return U.useEffect(()=>{const a=e.onFocusChanged(()=>{s(e.isFocused(i))});return()=>{a()}},[i,e]),t}function kJ(){const i=U.useRef(null),[e,t]=U.useState(!1);return U.useEffect(()=>{var n,r;const s=()=>{t(!0)},a=()=>{t(!1)};return(n=i.current)==null||n.addEventListener("mouseenter",s),(r=i.current)==null||r.addEventListener("mouseleave",a),()=>{var o,l;(o=i.current)==null||o.removeEventListener("mouseenter",s),(l=i.current)==null||l.removeEventListener("mouseleave",a)}},[]),{ref:i,isHovered:e}}function WJ(i){const[e,t]=U.useState(void 0);return Sa().shellApi.observeRuntimeContext(s=>{ba(e,s[i])||t(s[i])}),e}const Dm=i=>!!(i!=null&&i.playable&&!(i!=null&&i.isActiveDownload)&&!(i!=null&&i.hasPendingPatch)&&!(i!=null&&i.running)),Om=i=>i.hasPendingPatch&&!i.isActiveDownload&&!i.running;function Ea(i,e){e===void 0&&(e={});var t=e.insertAt;if(!(!i||typeof document>"u")){var s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",t==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=i:a.appendChild(document.createTextNode(i))}}var VJ=".PlayIcon-module_playIcon__DXFVf {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n}\n.PlayIcon-module_playIcon__DXFVf .PlayIcon-module_circle__aWV-E {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 32rem;\n  height: 32rem;\n  border-radius: 50%;\n  background-color: #006ef5;\n}",sy={playIcon:"PlayIcon-module_playIcon__DXFVf",circle:"PlayIcon-module_circle__aWV-E"};Ea(VJ);function $J(){return A.jsx("div",{role:"img",className:sy.playIcon,children:A.jsx("div",{className:sy.circle,children:A.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:A.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.82 1.016a1.17 1.17 0 0 1 1.193.05l7.584 4.958a1.167 1.167 0 0 1 0 1.952l-7.584 4.959a1.167 1.167 0 0 1-1.805-.977V2.042c0-.429.235-.823.612-1.026m.555 10.942L11.958 7 4.375 2.042z",fill:"#F2F2F2"})})})})}var BJ=".UpdateIcon-module_updateIcon__iKTJH {\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n}\n.UpdateIcon-module_updateIcon__iKTJH .UpdateIcon-module_circle__HLE2q {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 32rem;\n  height: 32rem;\n  border-radius: 50%;\n  background-color: #2d8657;\n}",ay={updateIcon:"UpdateIcon-module_updateIcon__iKTJH",circle:"UpdateIcon-module_circle__HLE2q"};Ea(BJ);function HJ(){return A.jsx("div",{role:"img",className:ay.updateIcon,children:A.jsx("div",{className:ay.circle,children:A.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:A.jsx("path",{d:"M3.4 4.178a4.57 4.57 0 0 1 3.666-1.845c2.534 0 4.6 2.083 4.6 4.667s-2.066 4.667-4.6 4.667c-1.7 0-3.189-.936-3.986-2.334h2.17a.583.583 0 1 0 0-1.166h-3.5a.583.583 0 0 0-.583.583v3.5a.583.583 0 0 0 1.166 0v-1.914a5.74 5.74 0 0 0 4.733 2.497c3.192 0 5.767-2.618 5.767-5.833s-2.575-5.833-5.767-5.833a5.74 5.74 0 0 0-4.599 2.311.583.583 0 1 0 .934.7",fill:"#F2F2F2"})})})})}var QJ=".ActionTile-module_actionTile__EMG4N {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  border-radius: inherit;\n  background: rgba(0, 0, 0, 0.6);\n  box-shadow: inset 0 0 5px #000;\n}\n.ActionTile-module_actionTile__EMG4N:hover {\n  cursor: pointer;\n}",jJ={actionTile:"ActionTile-module_actionTile__EMG4N"};Ea(QJ);function qJ({className:i,game:e}){var a;const t=(a=Sa().shellApi.quickLaunchApi)==null?void 0:a.v1,s=U.useCallback(n=>{if(n.stopPropagation(),Dm(e)){t==null||t.launchPlayableGame(e);return}if(Om(e)){t==null||t.updateGame(e);return}t==null||t.navigateToProductDetails(e)},[e,t]);return A.jsxs("div",{"data-e2e":"ql-action-tile",role:"button",onClick:s,className:st(i,jJ.actionTile),children:[!e.hasPendingPatch&&A.jsx($J,{}),e.hasPendingPatch&&A.jsx(HJ,{})]})}var zJ=".Tooltip-module_tooltip__OWd4e {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  font-size: var(--font-size-small);\n  padding: 8rem;\n  height: 50rem;\n  max-width: 184rem;\n  border-radius: 4px;\n  background-color: #333333;\n  color: #f2f2f2;\n  z-index: 10000;\n  visibility: hidden;\n}\n.Tooltip-module_tooltip__OWd4e.Tooltip-module_isVisible__a5-b7 {\n  visibility: visible;\n  box-shadow: 0 0 24rem rgba(0, 0, 0, 0.08), 0 16rem 16rem rgba(0, 0, 0, 0.16);\n}",ny={tooltip:"Tooltip-module_tooltip__OWd4e",isVisible:"Tooltip-module_isVisible__a5-b7"};Ea(zJ);function KJ({children:i}){const[e,t]=U.useState(null);return U.useEffect(()=>{const s="ql-tooltip-root";let a=document.getElementById(s);return a||(a=document.createElement("div"),a.setAttribute("id",s),document.body.appendChild(a)),t(a),()=>{const n=document.getElementById(s);n&&document.body.removeChild(n)}},[]),e?T2.createPortal(i,e):null}function XJ({targetRef:i,children:e,offsetLeft:t=0,isVisible:s=!1}){const[a,n]=U.useState({top:-1e3,left:-1e3}),r=U.createRef();return U.useEffect(()=>{if(!i.current||!r.current||!s)return;const o=i.current.getBoundingClientRect();n({top:o.top+o.height/2-r.current.clientHeight/2,left:o.right+t})},[i.current,r.current,t,s]),A.jsx(KJ,{children:A.jsx("div",{"data-e2e":"ql-tooltip-container",ref:r,className:st(ny.tooltip,{[ny.isVisible]:s}),style:{position:"absolute",top:a.top,left:a.left},children:e})})}var JJ='.GameItem-module_gameContainer__Od0qP {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  border-radius: 8px;\n}\n.focus-active .navigation-method-directional .GameItem-module_gameContainer__Od0qP.focus {\n  box-shadow: inset 0 0 0 2px #3da2ff;\n}\n.focus-active .navigation-method-directional .GameItem-module_gameContainer__Od0qP.focus:active {\n  background-color: #333333;\n}\n.focus-active .navigation-method-directional .GameItem-module_gameContainer__Od0qP.focus .GameItem-module_actionTile__07SHA {\n  display: block;\n}\n.GameItem-module_gameContainer__Od0qP:hover {\n  background-color: rgba(242, 242, 242, 0.1019607843);\n  cursor: pointer;\n}\n.GameItem-module_gameContainer__Od0qP:hover .GameItem-module_actionTile__07SHA {\n  display: block;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_actionTile__07SHA {\n  display: none;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameIconContainer__v7w2k {\n  padding: 8rem;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameIconContainer__v7w2k:hover {\n  background-color: rgba(242, 242, 242, 0.1019607843);\n  border-radius: 4px;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameIconContainer__v7w2k .GameItem-module_gameIcon__rVgdF {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 0 0 1px #242424;\n  border-radius: 4px;\n  transition: margin none;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameIconContainer__v7w2k .GameItem-module_gameIcon__rVgdF .GameItem-module_icon__to9xo {\n  width: 40rem;\n  height: 40rem;\n  min-width: 40rem;\n  min-height: 40rem;\n  border-radius: 4px;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameIconContainer__v7w2k .GameItem-module_gameIcon__rVgdF .GameItem-module_icon__to9xo.GameItem-module_fallbackIcon__x5ppU {\n  background-color: #242424;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: var(--font-size-medium);\n  font-weight: 700;\n  color: #f2f2f2;\n}\n.GameItem-module_gameContainer__Od0qP.GameItem-module_hasPendingPatch__URQu7 .GameItem-module_gameInfo__MvQB3 .GameItem-module_gameName__Odwz3 {\n  -webkit-line-clamp: 1;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameInfo__MvQB3 {\n  padding: 8rem;\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  justify-content: center;\n  height: 56rem;\n  border-radius: 8px;\n  line-height: 21rem;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameInfo__MvQB3:hover {\n  background-color: rgba(242, 242, 242, 0.1019607843);\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameInfo__MvQB3 .GameItem-module_gameName__Odwz3 {\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameInfo__MvQB3 .GameItem-module_running__kIzwN {\n  font-size: var(--font-size-x-small);\n  color: #b5b5b5;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameInfo__MvQB3 .GameItem-module_updatesAvailable__x6zrH {\n  position: relative;\n  font-size: var(--font-size-x-small);\n  color: #3da2ff;\n  padding-left: 16rem;\n  line-height: 18rem;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameInfo__MvQB3 .GameItem-module_updatesAvailable__x6zrH::before {\n  position: absolute;\n  top: 4rem;\n  left: 0;\n  width: 8rem;\n  height: 8rem;\n  border-radius: 100%;\n  background-color: #006ef5;\n  content: "";\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameInfo__MvQB3 .GameItem-module_updatesAvailable__x6zrH.GameItem-module_patchDismissed__ocz2s {\n  color: #b5b5b5;\n  padding-left: 0;\n}\n.GameItem-module_gameContainer__Od0qP .GameItem-module_gameInfo__MvQB3 .GameItem-module_updatesAvailable__x6zrH.GameItem-module_patchDismissed__ocz2s:before {\n  width: 0;\n  content: none;\n}\n.GameItem-module_gameContainer__Od0qP.GameItem-module_isCompact__-iEtC {\n  justify-content: center;\n}\n.GameItem-module_gameContainer__Od0qP.GameItem-module_isCompact__-iEtC::before {\n  content: "";\n  padding-top: 100%;\n}\n.GameItem-module_gameContainer__Od0qP.GameItem-module_isCompact__-iEtC .GameItem-module_gameIconContainer__v7w2k {\n  padding: 0;\n}\n.GameItem-module_gameContainer__Od0qP.GameItem-module_isCompact__-iEtC .GameItem-module_gameIconContainer__v7w2k .GameItem-module_gameIcon__rVgdF {\n  margin-right: 0;\n}\n.GameItem-module_gameContainer__Od0qP.GameItem-module_isCompact__-iEtC.GameItem-module_hasPendingPatch__URQu7 .GameItem-module_gameItem__NTDoj::after {\n  position: absolute;\n  top: -4rem;\n  left: calc(100% - 4rem);\n  width: 8rem;\n  height: 8rem;\n  border-radius: 100%;\n  background-color: #006ef5;\n  content: "";\n}',Ne={gameContainer:"GameItem-module_gameContainer__Od0qP",actionTile:"GameItem-module_actionTile__07SHA",gameIconContainer:"GameItem-module_gameIconContainer__v7w2k",gameIcon:"GameItem-module_gameIcon__rVgdF",icon:"GameItem-module_icon__to9xo",fallbackIcon:"GameItem-module_fallbackIcon__x5ppU",hasPendingPatch:"GameItem-module_hasPendingPatch__URQu7",gameInfo:"GameItem-module_gameInfo__MvQB3",gameName:"GameItem-module_gameName__Odwz3",running:"GameItem-module_running__kIzwN",updatesAvailable:"GameItem-module_updatesAvailable__x6zrH",patchDismissed:"GameItem-module_patchDismissed__ocz2s",isCompact:"GameItem-module_isCompact__-iEtC",gameItem:"GameItem-module_gameItem__NTDoj"};Ea(JJ);const Pp={updatable:"quicklaunch.update",launchable:"quicklaunch.launch",shortcut:"quicklaunch.details"},YJ={"quicklaunch.update":"Update","quicklaunch.launch":"Launch","quicklaunch.details":"Details"};function ry(i,e=!1){return Om(i)?Pp.updatable:Dm(i)?Pp.launchable:e?Pp.shortcut:""}function oy(i){return YJ[i]||i}function ZJ({game:i,isCompact:e,disableActions:t=!1}){var V,ce,Ue;const s=(V=Sa().shellApi.quickLaunchApi)==null?void 0:V.v1,a="ql-item-".concat(i.spaceId),n=Sa().localizationService.formatMessage,r=(ce=WJ("navigationMethod"))!=null?ce:E.mouse,o=(Ue=i==null?void 0:i.name)!=null?Ue:i.fallbackName,l=i==null?void 0:i.logoUrl,u=UJ(a)&&r===E.directional,{ref:v,isHovered:w}=kJ(),b=Dm(i)&&!t,I=Om(i)&&!t,R=!t&&ry(i),x=U.useCallback(()=>{if(e||u){if(b){s==null||s.launchPlayableGame(i);return}if(I){s==null||s.updateGame(i);return}}s==null||s.navigateToProductDetails(i)},[i,e,u,b,s]),F=U.useMemo(()=>{const ke=ry(i,!0);return{[L.A]:{text:n({id:ke,defaultMessage:oy(ke)}),handler:x}}},[i,n,x]);return o?A.jsx(h2,{focusableRef:v,id:a,shortcuts:F,children:A.jsxs("div",{"data-e2e":"ql-item",role:"button",ref:v,onClick:x,className:st(Ne.gameContainer,{[Ne.isCompact]:e,[Ne.hasPendingPatch]:i.hasPendingPatch&&i.patchDismissed!==!0,border:"1px solid gold"}),children:[A.jsx("div",{className:st(Ne.gameIconContainer),children:A.jsxs("div",{className:st(Ne.gameIcon),children:[l?A.jsx("img",{"data-e2e":"ql-logo",crossOrigin:"anonymous",className:Ne.icon,src:l,alt:o}):A.jsx("div",{"data-e2e":"ql-logo-fallback",className:st(Ne.icon,Ne.fallbackIcon),children:o[0]}),(b||I)&&A.jsx(qJ,{className:Ne.actionTile,game:i})]})}),!e&&A.jsxs("div",{className:Ne.gameInfo,children:[A.jsx("div",{className:Ne.gameName,children:o}),I&&A.jsx("div",{className:st(Ne.updatesAvailable,{[Ne.patchDismissed]:i.patchDismissed}),children:A.jsx(Lo,{id:"quicklaunch.update.available",defaultMessage:"Update available"})}),i.running&&A.jsx("div",{className:Ne.running,children:A.jsx(Lo,{id:"quicklaunch.running",defaultMessage:"Running..."})})]}),e&&A.jsx(XJ,{targetRef:v,offsetLeft:16,isVisible:w||u,children:A.jsxs("span",{role:"tooltip",children:[R&&A.jsx(Lo,{id:R,defaultMessage:oy(R)})," ",o]})})]})}):null}function eY(){var s;const i=(s=Sa().shellApi.quickLaunchApi)==null?void 0:s.v1,[e,t]=U.useState(null);return U.useEffect(()=>{if(!i)return;const a=i.getLastPlayedGames();t(a);const n=o=>{t(o)},r=i==null?void 0:i.observeLastPlayedGames(n);return()=>{r.unsubscribe()}},[i]),e}var tY=".QuickLaunch-module_quickLaunch__cMz7r {\n  font-size: var(--font-size-small);\n}\n.QuickLaunch-module_quickLaunch__cMz7r .QuickLaunch-module_title__ctL-a {\n  font-weight: 700;\n  padding: 4rem 0 16rem;\n}\n.QuickLaunch-module_quickLaunch__cMz7r.QuickLaunch-module_isCompact__UlGTl {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}",cn={quickLaunch:"QuickLaunch-module_quickLaunch__cMz7r",title:"QuickLaunch-module_title__ctL-a",isCompact:"QuickLaunch-module_isCompact__UlGTl"};Ea(tY);var iY="@keyframes Skeleton-module_skeletonAnimation__FYoAJ {\n  0% {\n    background-position: 200%;\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n  100% {\n    background-position: -100%;\n    opacity: 1;\n  }\n}\n.Skeleton-module_skeleton__-VV98 {\n  animation: Skeleton-module_skeletonAnimation__FYoAJ 3s linear infinite;\n  background: linear-gradient(120deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.15) 25%, 50%, rgba(255, 255, 255, 0.225) 75%, rgba(255, 255, 255, 0.225));\n}",sY={skeleton:"Skeleton-module_skeleton__-VV98",skeletonAnimation:"Skeleton-module_skeletonAnimation__FYoAJ"};Ea(iY);function Bu({className:i,width:e,height:t}){return A.jsx("div",{style:{minWidth:e,minHeight:t},className:st(i,sY.skeleton)})}function Np({isCompact:i}){return A.jsxs("div",{"data-e2e":"ql-game-skeleton",className:st(Ne.gameContainer,{[Ne.isCompact]:i}),children:[A.jsx("div",{className:Ne.gameIconContainer,children:A.jsx("div",{className:Ne.gameIcon,children:A.jsx(Bu,{className:Ne.icon})})}),!i&&A.jsx("div",{"data-e2e":"ql-game-info-skeleton",className:Ne.gameInfo,children:A.jsx(Bu,{width:75,height:16,className:Ne.gameName})})]})}function aY({isCompact:i}){return A.jsxs("div",{"data-e2e":"ql-container-skeleton",className:st(cn.quickLaunch,{[cn.isCompact]:i}),children:[!i&&A.jsx("div",{"data-e2e":"ql-title-skeleton",className:cn.title,children:A.jsx(Bu,{width:150,height:24})}),A.jsx(Np,{isCompact:i}),A.jsx(Np,{isCompact:i}),A.jsx(Np,{isCompact:i})]})}const Fie=({isCompact:i=!1})=>{const e=eY(),t=!!(e!=null&&e.some(s=>s.running));return A.jsx(A.Fragment,{children:e===null?A.jsx(aY,{isCompact:i}):A.jsx(A.Fragment,{children:e.length>0&&A.jsx(NS,{id:"ql-group",children:A.jsxs("div",{"data-e2e":"ql-container",className:st(cn.quickLaunch,{[cn.isCompact]:i}),children:[!i&&A.jsx("div",{"data-e2e":"ql-title",className:cn.title,children:A.jsx(Lo,{id:"quicklaunch.header",defaultMessage:"Quick Launch"})}),e.map(s=>A.jsx(ZJ,{game:s,isCompact:i,disableActions:t},s.spaceId))]})})})})};function nY({children:i}){const e=qg(),t=Gl(),s=Mi(S,"shellCrossPlatformSpaceId"),a=Mi(S,"shellApplicationId"),[n,r]=U.useState(null);return U.useEffect(()=>{(async()=>{const l=await e(new CO("shell-react-bridge-".concat(s),s,a));r({shellApi:l,logger:t.logger,focusSystem:t.focusSystem,localizationService:t.localizationService,localStorageService:t.localStorageService})})()},[e,t,s,a]),n?A.jsx(ax.Provider,{value:n,children:i}):null}const rY=(i,e,t)=>class extends OS.Component{constructor(a){super(a),this.state={...a}}static getDerivedStateFromProps(a,n){return{...a}}render(){var r;const{"":a,...n}=this.state;return A.jsx(nY,{children:A.jsx(g2,{colorMode:m2.Dark,deviceScaling:f2.Desktop,themeDOMTarget:document.getElementById(e),cssPrefix:"uds-",noFocusSystem:!0,children:A.jsx(GJ,{parentId:(r=t==null?void 0:t.focusParentId)!=null?r:li.GroupId,children:A.jsx(i,{...n})})})})}},Tp=new Map,oY=K.extend({name:"ReactInVueComp",props:{component:{type:[Object,Function],required:!0},options:{type:Object}},render(i){return i("div",{ref:"react",domProps:{id:this.$data.uuid}})},data(){return{uuid:qt.newId(),refToReactContainer:null}},methods:{getNodeToRender(i){var t;const e=A.jsx(U.StrictMode,{children:i});return(t=this.$props.options)!=null&&t.disableStrictMode?i:e},mountReactComponent(i){const e=rY(i,this.uuid,this.$props.options);this.refToReactContainer=e;const t=ix(this.$refs.react),s=this.getNodeToRender(A.jsx(e,{...this.$attrs}));t.render(s),Tp.set(this.uuid,t)}},mounted(){this.mountReactComponent(this.$props.component)},beforeDestroy(){const i=Tp.get(this.uuid);i&&i.unmount()},inheritAttrs:!1,watch:{component(i){this.mountReactComponent(i)},$attrs:{handler(){const i=Tp.get(this.uuid),e=this.refToReactContainer;if(i&&e){const t=this.getNodeToRender(A.jsx(e,{...this.$attrs}));i.render(t)}},deep:!0}}});function cy(i,e){return{components:{ReactWrapper:oY},inheritAttrs:!1,render(t){return t("react-wrapper",{props:{component:i,options:e},attrs:this.$attrs,on:this.$listeners},this.$slots.default)}}}var cY=Object.defineProperty,lY=Object.getOwnPropertyDescriptor,Fm=(i,e,t,s)=>{for(var a=s>1?void 0:s?lY(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&cY(e,t,a),a};let vr=class extends K{};Fm([C(uo,"isEnabled")],vr.prototype,"isEnabled",2);Fm([C(uo,"fps")],vr.prototype,"fps",2);vr=Fm([j],vr);var pY=function(){var i=this,e=i.$createElement,t=i._self._c||e;return i.isEnabled?t("div",{staticClass:"fps-counter"},[t("div",{staticClass:"number"},[i._v(i._s(i.fps?i.fps:"\\_()_/"))])]):i._e()},uY=[];const ly={};var dY=Z(vr,pY,uY,!1,hY,"204e7a46",null,null);function hY(i){for(let e in ly)this[e]=ly[e]}const gY=function(){return dY.exports}(),mY=i=>{const e=U.useRef(null),t=U.useRef(null),s=U.useRef([]),[a,n]=U.useState(!1),r=U.useCallback(o=>{let l=0;return o.forEach(u=>{var v;return l+=(v=u==null?void 0:u.scrollWidth)!=null?v:0}),l},[]);return U.useLayoutEffect(()=>{var w,b,I,R,x;s.current=s.current.slice(0,i.length);const o=r(s.current),l=Math.max(5,i.length*2);(w=t.current)==null||w.style.setProperty("--legend-items-width","".concat(o,"px")),(b=t.current)==null||b.style.setProperty("--scroll-duration","".concat(l,"s"));const u=(R=(I=e.current)==null?void 0:I.clientWidth)!=null?R:0;(x=t.current)==null||x.style.setProperty("--legend-container-width","".concat(u,"px"));const v=o>u;v&&a||n(v)},[i]),{containerRef:e,stripRef:t,legendItemsRef:s,isOverflowing:a}},fY="_inputLegend_1mg91_8",yY="_inputLegendStrip_1mg91_25",vY="_centerItems_1mg91_32",_Y="_overflow_1mg91_35",SY="_scroll_1mg91_1",wY="_legendItem_1mg91_38",bY="_iconContainer_1mg91_51",CY="_legendLabel_1mg91_62",IY="_compact_1mg91_68",MY="_modalVisible_1mg91_71",Zi={inputLegend:fY,"client-view-container":"_client-view-container_1mg91_19",inputLegendStrip:yY,centerItems:vY,overflow:_Y,scroll:SY,legendItem:wY,iconContainer:bY,legendLabel:CY,compact:IY,modalVisible:MY},AY=({isVisible:i,isModalVisible:e,isCompact:t,isCentered:s,items:a})=>{const{containerRef:n,legendItemsRef:r,stripRef:o,isOverflowing:l}=mY(a),u=U.useMemo(()=>st(Zi.inputLegend,{[Zi.compact]:t,[Zi.modalVisible]:e}),[t,e]),v=U.useMemo(()=>st(Zi.inputLegendStrip,{[Zi.centerItems]:s,[Zi.overflow]:l}),[s,l]);return A.jsx("div",{"data-e2e":"input-legend",className:u,ref:n,hidden:!i,children:A.jsx("div",{"data-e2e":"input-legend-strip",className:v,ref:o,children:a.map((w,b)=>A.jsxs("div",{className:Zi.legendItem,"data-e2e":"button-legend-".concat(w.button.toLocaleLowerCase()),ref:I=>r.current[b]=I,children:[A.jsx("div",{"data-e2e":"icon-legend-".concat(w.button.toLocaleLowerCase()),className:Zi.iconContainer,children:w.icon}),A.jsx("span",{className:Zi.legendLabel,children:w.label})]},w.button))})})},PY=U.memo(AY),NY=()=>{const i=Mi(S,"inputDeviceType"),[e]=U.useState({}),[t,s]=U.useState(null);return U.useEffect(()=>{const a=async()=>{switch(i){case D.keyboard:return(await G(()=>import("./InputLegendButtonIconMapKeyboard-47298d24.js"),["assets/InputLegendButtonIconMapKeyboard-47298d24.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/Warning-84e5e473.js"])).InputLegendButtonIconMapKeyboard;case D.xbox:return(await G(()=>import("./InputLegendButtonIconMapXbox-7a205042.js"),["assets/InputLegendButtonIconMapXbox-7a205042.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/Warning-84e5e473.js"])).InputLegendButtonIconMapXbox;case D.playstation:return(await G(()=>import("./InputLegendButtonIconMapPlayStation-9e36c362.js"),["assets/InputLegendButtonIconMapPlayStation-9e36c362.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/Warning-84e5e473.js"])).InputLegendButtonIconMapPlayStation;case D.nintendo:return(await G(()=>import("./InputLegendButtonIconMapNintendo-53a80b80.js"),["assets/InputLegendButtonIconMapNintendo-53a80b80.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/Warning-84e5e473.js"])).InputLegendButtonIconMapNintendo;default:return null}};(async()=>{const r=e[i];if(r)s(r);else{const o=await a();e[i]=o,s(o)}})()},[i]),t},py=[oi.A,oi.B,oi.Y],TY=(i,e)=>{e.forEach(t=>{i.has(t.button)||i.set(t.button,t)})},RY=i=>{i.sort((e,t)=>py.indexOf(e.button)<py.indexOf(t.button)?-1:1)},DY=()=>{const[i,e]=U.useState([]),t=Mi(ys,"shellItems"),s=Mi(Vs,"navigationBarHotKeys"),a=Mi(S,"focusedMicroApp"),{microAppStateDataGetter:n,getAllMicroAppStateData:r}=$i(M,v=>({microAppStateDataGetter:v.microAppStateDataGetter,getAllMicroAppStateData:v.getAllMicroAppStateData})),o=U.useMemo(()=>{const v=a?n(a):{hotKeys:[],legendItems:[]},w=new Set([...s].concat(v.hotKeys||[]));return{legendItems:[...v.legendItems],hotKeys:w}},[r,s]);U.useEffect(()=>{const v=new Map;(o.legendItems||[]).forEach(I=>v.set(I.button,I)),TY(v,t);const w=Array.from(v.values());RY(w);const b=w.filter(I=>!o.hotKeys.has(I.button));e(I=>ba(I,b)?I:[...b])},[o,t]);const l=NY();return U.useMemo(()=>i.map(v=>({button:v.button,label:v.label,icon:l?l[v.button]:void 0})),[i,l])},OY=[m.MacOS,m.Luna,m.PC,m.Steam,m.Web],FY=[p.PCLegacyClient,p.PCWebClient,p.SteamClient];function LY({children:i}){const e=DY(),{platformType:t,isOnMobile:s,navigationMethod:a,hostPlatformType:n}=$i(S,x=>({platformType:x.platformType,isOnMobile:x.isOnMobile,navigationMethod:x.navigationMethod,hostPlatformType:x.hostPlatformType})),{getActivatingMicroApp:r,getActiveMicroApp:o}=$i(M,x=>({getActivatingMicroApp:x.getActivatingMicroApp,getActiveMicroApp:x.getActiveMicroApp})),{getShellError:l}=$i($e,x=>({getShellError:x.getShellError})),{allActiveAppNames:u}=$i(M,x=>({allActiveAppNames:x.allActiveAppNames})),v=U.useMemo(()=>!!r(B.modal)||!!o(B.modal)||!!l(B.modal),[u]),w=Mi(Lt,"isVisible")||v,b=U.useMemo(()=>OY.includes(t),[t]),I=U.useMemo(()=>FY.includes(n),[n]),R=U.useMemo(()=>s||a!==E.directional?!1:e.length>0,[s,a,e]);return i({isVisible:R,isModalVisible:w,isCompact:b,isCentered:I,items:e})}const GY=()=>A.jsx(LY,{children:i=>A.jsx(PY,{...i})});var xY=Object.defineProperty,EY=Object.getOwnPropertyDescriptor,UY=(i,e,t,s)=>{for(var a=s>1?void 0:s?EY(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&xY(e,t,a),a};let Hu=class extends K{};Hu=UY([j],Hu);var kY=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("svg",{staticClass:"no-connection-image",attrs:{width:"200",height:"200",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-e2e":"image-no-connection"}},[t("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M90.4953 101.22H91.7784V99.9369C91.7784 99.6346 91.8985 99.3446 92.1123 99.1308C92.326 98.917 92.616 98.7969 92.9184 98.7969C93.2207 98.7969 93.5107 98.917 93.7244 99.1308C93.9382 99.3446 94.0583 99.6346 94.0583 99.9369V101.22H95.3414C95.6438 101.22 95.9337 101.34 96.1475 101.554C96.3613 101.768 96.4814 102.058 96.4814 102.36C96.4814 102.662 96.3613 102.952 96.1475 103.166C95.9337 103.38 95.6438 103.5 95.3414 103.5H94.0583V104.783C94.0583 105.085 93.9382 105.375 93.7244 105.589C93.5107 105.803 93.2207 105.923 92.9184 105.923C92.616 105.923 92.326 105.803 92.1123 105.589C91.8985 105.375 91.7784 105.085 91.7784 104.783V103.5H90.4953C90.1929 103.5 89.903 103.38 89.6892 103.166C89.4754 102.952 89.3553 102.662 89.3553 102.36C89.3553 102.058 89.4754 101.768 89.6892 101.554C89.903 101.34 90.1929 101.22 90.4953 101.22ZM114.514 55.8415H115.797V54.5585C115.797 54.2561 115.917 53.9662 116.131 53.7524C116.344 53.5386 116.634 53.4185 116.937 53.4185C117.239 53.4185 117.529 53.5386 117.743 53.7524C117.957 53.9662 118.077 54.2561 118.077 54.5585V55.8415H119.36C119.662 55.8415 119.952 55.9616 120.166 56.1754C120.38 56.3892 120.5 56.6792 120.5 56.9815C120.5 57.2839 120.38 57.5738 120.166 57.7876C119.952 58.0014 119.662 58.1215 119.36 58.1215H118.077V59.4046C118.077 59.707 117.957 59.9969 117.743 60.2107C117.529 60.4245 117.239 60.5446 116.937 60.5446C116.634 60.5446 116.344 60.4245 116.131 60.2107C115.917 59.9969 115.797 59.707 115.797 59.4046V58.1123H114.514C114.211 58.1123 113.921 57.9922 113.708 57.7784C113.494 57.5646 113.374 57.2747 113.374 56.9723C113.374 56.67 113.494 56.38 113.708 56.1662C113.921 55.9524 114.211 55.8323 114.514 55.8323V55.8415ZM81.5968 2.41385H82.8799V1.14C82.8799 0.837653 83 0.54769 83.2138 0.333898C83.4276 0.120107 83.7175 0 84.0199 0C84.3222 0 84.6122 0.120107 84.826 0.333898C85.0398 0.54769 85.1599 0.837653 85.1599 1.14V2.41385H86.4337C86.7361 2.41385 87.026 2.53395 87.2398 2.74774C87.4536 2.96154 87.5737 3.2515 87.5737 3.55385C87.5737 3.85619 87.4536 4.14616 87.2398 4.35995C87.026 4.57374 86.7361 4.69385 86.4337 4.69385H85.1507V5.97692C85.1507 6.27927 85.0305 6.56923 84.8167 6.78303C84.603 6.99682 84.313 7.11692 84.0107 7.11692C83.7083 7.11692 83.4183 6.99682 83.2045 6.78303C82.9908 6.56923 82.8706 6.27927 82.8706 5.97692V4.69385H81.5968C81.2945 4.69385 81.0045 4.57374 80.7907 4.35995C80.5769 4.14616 80.4568 3.85619 80.4568 3.55385C80.4568 3.2515 80.5769 2.96154 80.7907 2.74774C81.0045 2.53395 81.2945 2.41385 81.5968 2.41385ZM16.0399 13.1308H17.323V11.8477C17.323 11.5453 17.4431 11.2554 17.6569 11.0416C17.8706 10.8278 18.1606 10.7077 18.463 10.7077C18.7653 10.7077 19.0553 10.8278 19.2691 11.0416C19.4828 11.2554 19.603 11.5453 19.603 11.8477V13.1308H20.886C21.1884 13.1308 21.4783 13.2509 21.6921 13.4647C21.9059 13.6785 22.026 13.9684 22.026 14.2708C22.026 14.5731 21.9059 14.8631 21.6921 15.0769C21.4783 15.2907 21.1884 15.4108 20.886 15.4108H19.5937V16.6938C19.5937 16.9962 19.4736 17.2862 19.2598 17.5C19.046 17.7137 18.7561 17.8338 18.4537 17.8338C18.1514 17.8338 17.8614 17.7137 17.6476 17.5C17.4338 17.2862 17.3137 16.9962 17.3137 16.6938V15.4015H16.0399C15.7375 15.4015 15.4476 15.2814 15.2338 15.0676C15.02 14.8538 14.8999 14.5639 14.8999 14.2615C14.8999 13.9592 15.02 13.6692 15.2338 13.4554C15.4476 13.2416 15.7375 13.1215 16.0399 13.1215V13.1308ZM104.808 60C104.808 84.4705 84.9705 104.308 60.5 104.308C36.0295 104.308 16.1923 84.4705 16.1923 60C16.1923 35.5295 36.0295 15.6923 60.5 15.6923C84.9705 15.6923 104.808 35.5295 104.808 60ZM104.808 117.295C104.808 115.8 84.9708 114.462 60.5 114.462C36.0292 114.462 16.1923 115.8 16.1923 117.295C16.1923 118.791 36.0292 120 60.5 120C84.9708 120 104.808 118.791 104.808 117.295ZM2.92308 47.6538H1.64V47.6446C1.33765 47.6446 1.04769 47.7647 0.833898 47.9785C0.620107 48.1923 0.5 48.4823 0.5 48.7846C0.5 49.087 0.620107 49.3769 0.833898 49.5907C1.04769 49.8045 1.33765 49.9246 1.64 49.9246H2.92308V51.2262C2.92308 51.5285 3.04318 51.8185 3.25698 52.0323C3.47077 52.246 3.76073 52.3662 4.06308 52.3662C4.36542 52.3662 4.65539 52.246 4.86918 52.0323C5.08297 51.8185 5.20308 51.5285 5.20308 51.2262V49.9338H6.48615C6.7885 49.9338 7.07846 49.8137 7.29226 49.5999C7.50605 49.3862 7.62615 49.0962 7.62615 48.7938C7.62615 48.4915 7.50605 48.2015 7.29226 47.9877C7.07846 47.7739 6.7885 47.6538 6.48615 47.6538H5.20308V46.3708C5.20308 46.0684 5.08297 45.7785 4.86918 45.5647C4.65539 45.3509 4.36542 45.2308 4.06308 45.2308C3.76073 45.2308 3.47077 45.3509 3.25698 45.5647C3.04318 45.7785 2.92308 46.0684 2.92308 46.3708V47.6538Z",fill:"#333333"}}),t("path",{attrs:{d:"M79.2314 43.5314C79.8563 42.9066 79.8563 41.8935 79.2314 41.2687C78.6066 40.6438 77.5935 40.6438 76.9687 41.2687L41.7687 76.4687C41.1438 77.0935 41.1438 78.1066 41.7687 78.7314C42.3935 79.3563 43.4066 79.3563 44.0314 78.7314L79.2314 43.5314Z",fill:"#B5B5B5"}}),t("path",{attrs:{d:"M60.5001 44.4C63.6215 44.4 66.4868 44.9757 69.005 45.8383L65.1224 49.7209C63.6795 49.3954 62.1311 49.2 60.5001 49.2C52.9981 49.2 47.2471 53.3331 45.4477 55.2449C44.5393 56.2101 43.0204 56.2562 42.0552 55.3477C41.09 54.4393 41.0439 52.9204 41.9524 51.9552C44.4196 49.3337 51.362 44.4 60.5001 44.4Z",fill:"#B5B5B5"}}),t("path",{attrs:{d:"M49.2856 59.0242C50.8637 57.5896 54.5907 54.4206 60.4431 54.4001L51.83 63.0133C50.9187 63.3961 49.8269 63.1875 49.1242 62.4145C48.2326 61.4337 48.3049 59.9158 49.2856 59.0242Z",fill:"#B5B5B5"}}),t("path",{attrs:{d:"M69.1473 57.0097L65.6496 60.5074C66.8978 61.1823 67.8363 61.9856 68.4856 62.5759C69.4664 63.4675 70.9843 63.3952 71.8759 62.4145C72.7675 61.4337 72.6953 59.9158 71.7145 59.0242C71.1416 58.5034 70.2855 57.754 69.1473 57.0097Z",fill:"#B5B5B5"}}),t("path",{attrs:{d:"M60.5566 65.6004L55.7004 70.4566C55.7307 73.0815 57.868 75.2 60.5001 75.2C63.151 75.2 65.3001 73.051 65.3001 70.4C65.3001 67.7679 63.1815 65.6307 60.5566 65.6004Z",fill:"#B5B5B5"}}),t("path",{attrs:{d:"M76.4484 49.7086L73.0062 53.1507C74.1576 53.933 75.0248 54.6844 75.5524 55.2449C76.4608 56.2101 77.9797 56.2562 78.9449 55.3477C79.9102 54.4393 79.9562 52.9204 79.0477 51.9552C78.4408 51.3103 77.563 50.5255 76.4484 49.7086Z",fill:"#B5B5B5"}})])},WY=[];const uy={};var VY=Z(Hu,kY,WY,!1,$Y,null,null,null);function $Y(i){for(let e in uy)this[e]=uy[e]}const nx=function(){return VY.exports}();var BY=Object.defineProperty,HY=Object.getOwnPropertyDescriptor,lp=(i,e,t,s)=>{for(var a=s>1?void 0:s?HY(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&BY(e,t,a),a};let _s=class extends K{get hasErrorCode(){return this.error.errorCode!==void 0&&!this.error.errorCode.includes("Jellyfish")}mounted(){var i;this.hasErrorCode&&(this.logger.error("Fatal shell error. Root cause is :".concat(this.error.errorCode),{errorCode:"BSOD-".concat(this.error.errorCode),error:this.error.message,code:this.error.errorCode}),(i=this.metricDefinitions)==null||i.getMetric(Ae.Bsod).add(1,{errorCode:this.error.errorCode}),this.$dispatch(new ou({isRecoveryPageActive:!0,reason:this.error.errorCode})))}beforeDestroy(){this.hasErrorCode&&this.$dispatch(new ou({isRecoveryPageActive:!1}))}};lp([W({required:!0})],_s.prototype,"error",2);lp([Yt("$logger")],_s.prototype,"logger",2);lp([Yt("$metricDefinitions")],_s.prototype,"metricDefinitions",2);_s=lp([j],_s);var QY=Object.defineProperty,jY=Object.getOwnPropertyDescriptor,As=(i,e,t,s)=>{for(var a=s>1?void 0:s?jY(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&QY(e,t,a),a};const qY="https://www.ubisoft.com/help";let Pi=class extends We(_s){constructor(){super(),this.IconName=Fs,this.inProgress=!1,this.parentId=li.GroupId,this.focusId="auth-dolphin-view"}async logout(){this.$dispatch(new Ca)}async tryAgain(){this.inProgress=!0,await this.$dispatch(new FD(!0)),this.error.errorCode===g.Dolphin_32&&await this.$dispatch(new Ud),this.inProgress=!1}get errorMessage(){return this.$formatMessage({id:"error.unableToConnect"},{errorCode:this.error.errorCode})}get selectLabel(){return this.$formatMessage({id:"legend.label.select"})}get classList(){const e=[Xs[this.navigationMethod]];return this.isFocusSystemActive&&e.push("focus-active"),e}navigateToHelp(){window.open(qY)}mounted(){const e={environment:this.environment,country:this.country,isOnline:this.isOnline,platform:this.platformType,isStandalone:this.isStandalone,isRetry:this.authDolphinErrorRetried};this.$dispatch(new OD({isSuccess:!1,errorCode:this.error.errorCode,customData:e}))}};As([C(Xl,"authDolphinErrorRetried")],Pi.prototype,"authDolphinErrorRetried",2);As([C(S,"environment")],Pi.prototype,"environment",2);As([C(S,"country")],Pi.prototype,"country",2);As([C(S,"isOnline")],Pi.prototype,"isOnline",2);As([C(S,"platformType")],Pi.prototype,"platformType",2);As([C(S,"isStandalone")],Pi.prototype,"isStandalone",2);As([C(S,"navigationMethod")],Pi.prototype,"navigationMethod",2);As([C(ye,"isFocusSystemActive")],Pi.prototype,"isFocusSystemActive",2);Pi=As([j({components:{"empty-state":Lr,"no-connection-image":nx,"upn-button":Ki,"upn-focus-group":Hs}})],Pi);var zY=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"auth-dolphin-error"},[t("upn-focus-group",{attrs:{parentId:i.parentId,focusId:i.focusId}},[t("empty-state",{class:i.classList,attrs:{type:"app","data-e2e":"error-message"},scopedSlots:i._u([{key:"asset",fn:function(){return[t("no-connection-image")]},proxy:!0},{key:"title",fn:function(){return[t("h2",[i._v(i._s(i.$formatMessage({id:"title.unableToConnect"})))])]},proxy:!0},{key:"message",fn:function(){return[t("div",[i._v(i._s(i.errorMessage))]),t("div",[i._v(i._s(i.$formatMessage({id:"message.restartClient"})))])]},proxy:!0},{key:"button",fn:function(){return[t("div",{staticClass:"buttons"},[t("upn-button",{attrs:{action:i.logout,disabled:i.inProgress,shortcutLabel:i.selectLabel,type:"secondary-main"}},[i._v(i._s(i.$formatMessage({id:"button.restart"}))+" ")]),t("upn-button",{attrs:{action:i.tryAgain,disabled:i.inProgress,shortcutLabel:i.selectLabel}},[i._v(i._s(i.$formatMessage({id:"button.tryAgain"}))+" ")])],1),t("div",{staticClass:"auth-dolphin-error__footer"},[t("div",[i._v(i._s(i.$formatMessage({id:"message.helpLink"})))]),t("upn-button",{attrs:{action:i.navigateToHelp,shortcutLabel:i.selectLabel,type:"tertiary-main",icon:i.IconName.ExternalLink,iconPosition:"right"}},[i._v(" "+i._s(i.$formatMessage({id:"button.helpLink"}))+" ")])],1)]},proxy:!0}])})],1)],1)},KY=[];const dy={};var XY=Z(Pi,zY,KY,!1,JY,"4fe241b4",null,null);function JY(i){for(let e in dy)this[e]=dy[e]}const YY=function(){return XY.exports}();var ZY=Object.defineProperty,eZ=Object.getOwnPropertyDescriptor,rx=(i,e,t,s)=>{for(var a=s>1?void 0:s?eZ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&ZY(e,t,a),a};let fc=class extends K{mounted(){this.feedbackButtonUrl||this.$dispatch(new XR)}goToSendFeedbackUrl(){this.feedbackButtonUrl&&window.open(this.feedbackButtonUrl)}get selectLabel(){return this.$formatMessage({id:"legend.label.select"})}};rx([C(Q,"feedbackButtonUrl")],fc.prototype,"feedbackButtonUrl",2);fc=rx([j({components:{"upn-button":Ki}})],fc);var tZ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("upn-button",{staticClass:"button-proceed",attrs:{type:"primary-affirmative",action:i.goToSendFeedbackUrl,shortcutLabel:i.selectLabel,disabled:!i.feedbackButtonUrl}},[i._v(i._s(i.$formatMessage({id:"button.giveUsFeedback",defaultMessage:"Give us feedback"}))+" ")])},iZ=[];const hy={};var sZ=Z(fc,tZ,iZ,!1,aZ,null,null,null);function aZ(i){for(let e in hy)this[e]=hy[e]}const Lm=function(){return sZ.exports}();var nZ=Object.defineProperty,rZ=Object.getOwnPropertyDescriptor,oZ=(i,e,t,s)=>{for(var a=s>1?void 0:s?rZ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&nZ(e,t,a),a};let Qu=class extends K{};Qu=oZ([j],Qu);var cZ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("svg",{attrs:{width:"250",height:"250",viewBox:"0 0 250 250",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M125 238.461C175.981 238.461 217.308 241.25 217.308 244.365C217.308 247.481 175.981 250 125 250C74.0193 250 32.6924 247.481 32.6924 244.365C32.6924 241.25 74.0193 238.461 125 238.461Z",fill:"#2B2B2B"}}),t("path",{attrs:{d:"M125 217.308C175.98 217.308 217.308 175.98 217.308 125C217.308 74.0199 175.98 32.6924 125 32.6924C74.0199 32.6924 32.6924 74.0199 32.6924 125C32.6924 175.98 74.0199 217.308 125 217.308Z",fill:"#2B2B2B"}}),t("path",{attrs:{d:"M187.49 210.875H190.163V208.202C190.163 207.572 190.414 206.968 190.859 206.523C191.305 206.077 191.909 205.827 192.538 205.827C193.168 205.827 193.772 206.077 194.218 206.523C194.663 206.968 194.913 207.572 194.913 208.202V210.875H197.587C198.216 210.875 198.821 211.125 199.266 211.571C199.711 212.016 199.962 212.62 199.962 213.25C199.962 213.88 199.711 214.484 199.266 214.929C198.821 215.375 198.216 215.625 197.587 215.625H194.913V218.298C194.913 218.928 194.663 219.532 194.218 219.977C193.772 220.423 193.168 220.673 192.538 220.673C191.909 220.673 191.305 220.423 190.859 219.977C190.414 219.532 190.163 218.928 190.163 218.298V215.625H187.49C186.861 215.625 186.256 215.375 185.811 214.929C185.366 214.484 185.115 213.88 185.115 213.25C185.115 212.62 185.366 212.016 185.811 211.571C186.256 211.125 186.861 210.875 187.49 210.875ZM237.529 116.337H240.202V113.663C240.202 113.034 240.452 112.429 240.898 111.984C241.343 111.539 241.947 111.288 242.577 111.288C243.207 111.288 243.811 111.539 244.256 111.984C244.702 112.429 244.952 113.034 244.952 113.663V116.337H247.625C248.255 116.337 248.859 116.587 249.304 117.032C249.75 117.478 250 118.082 250 118.712C250 119.341 249.75 119.946 249.304 120.391C248.859 120.836 248.255 121.087 247.625 121.087H244.952V123.76C244.952 124.39 244.702 124.994 244.256 125.439C243.811 125.884 243.207 126.135 242.577 126.135C241.947 126.135 241.343 125.884 240.898 125.439C240.452 124.994 240.202 124.39 240.202 123.76V121.067H237.529C236.899 121.067 236.295 120.817 235.849 120.372C235.404 119.926 235.154 119.322 235.154 118.692C235.154 118.062 235.404 117.458 235.849 117.013C236.295 116.568 236.899 116.317 237.529 116.317V116.337ZM168.952 5.02885H171.625V2.375C171.625 1.74511 171.875 1.14102 172.321 0.695622C172.766 0.250223 173.37 0 174 0C174.63 0 175.234 0.250223 175.679 0.695622C176.125 1.14102 176.375 1.74511 176.375 2.375V5.02885H179.029C179.659 5.02885 180.263 5.27907 180.708 5.72447C181.154 6.16987 181.404 6.77396 181.404 7.40385C181.404 8.03374 181.154 8.63783 180.708 9.08323C180.263 9.52862 179.659 9.77885 179.029 9.77885H176.356V12.4519C176.356 13.0818 176.106 13.6859 175.66 14.1313C175.215 14.5767 174.611 14.8269 173.981 14.8269C173.351 14.8269 172.747 14.5767 172.301 14.1313C171.856 13.6859 171.606 13.0818 171.606 12.4519V9.77885H168.952C168.322 9.77885 167.718 9.52862 167.273 9.08323C166.827 8.63783 166.577 8.03374 166.577 7.40385C166.577 6.77396 166.827 6.16987 167.273 5.72447C167.718 5.27907 168.322 5.02885 168.952 5.02885ZM32.375 27.3558H35.0481V24.6827C35.0481 24.0528 35.2983 23.4487 35.7437 23.0033C36.1891 22.5579 36.7932 22.3077 37.4231 22.3077C38.053 22.3077 38.6571 22.5579 39.1025 23.0033C39.5479 23.4487 39.7981 24.0528 39.7981 24.6827V27.3558H42.4712C43.1011 27.3558 43.7052 27.606 44.1506 28.0514C44.596 28.4968 44.8462 29.1009 44.8462 29.7308C44.8462 30.3607 44.596 30.9648 44.1506 31.4102C43.7052 31.8556 43.1011 32.1058 42.4712 32.1058H39.7789V34.7788C39.7789 35.4087 39.5287 36.0128 39.0833 36.4582C38.6379 36.9036 38.0338 37.1538 37.4039 37.1538C36.774 37.1538 36.1699 36.9036 35.7245 36.4582C35.2791 36.0128 35.0289 35.4087 35.0289 34.7788V32.0865H32.375C31.7451 32.0865 31.1411 31.8363 30.6957 31.3909C30.2503 30.9455 30 30.3414 30 29.7115C30 29.0817 30.2503 28.4776 30.6957 28.0322C31.1411 27.5868 31.7451 27.3365 32.375 27.3365V27.3558Z",fill:"#2B2B2B"}}),t("path",{attrs:{d:"M2.375 99.2785H5.04808V96.6055C5.04808 95.9756 5.2983 95.3715 5.7437 94.9261C6.1891 94.4807 6.79319 94.2305 7.42308 94.2305C8.05297 94.2305 8.65706 94.4807 9.10246 94.9261C9.54785 95.3715 9.79808 95.9756 9.79808 96.6055V99.2785H12.4712C13.101 99.2785 13.7051 99.5288 14.1505 99.9742C14.5959 100.42 14.8462 101.024 14.8462 101.654C14.8462 102.283 14.5959 102.888 14.1505 103.333C13.7051 103.778 13.101 104.029 12.4712 104.029H9.79808V106.721C9.79808 107.351 9.54785 107.955 9.10246 108.4C8.65706 108.846 8.05297 109.096 7.42308 109.096C6.79319 109.096 6.1891 108.846 5.7437 108.4C5.2983 107.955 5.04808 107.351 5.04808 106.721V104.009H2.375C1.74511 104.009 1.14102 103.759 0.695621 103.314C0.250222 102.868 0 102.264 0 101.634C0 101.004 0.250222 100.4 0.695621 99.9549C1.14102 99.5095 1.74511 99.2593 2.375 99.2593V99.2785Z",fill:"#2B2B2B"}}),t("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M125 164.663C146.906 164.663 164.663 146.906 164.663 125C164.663 103.094 146.906 85.3365 125 85.3365C103.094 85.3365 85.3365 103.094 85.3365 125C85.3365 146.906 103.094 164.663 125 164.663ZM125 171.875C150.888 171.875 171.875 150.888 171.875 125C171.875 99.1117 150.888 78.125 125 78.125C99.1117 78.125 78.125 99.1117 78.125 125C78.125 150.888 99.1117 171.875 125 171.875Z",fill:"#A8A8A8"}}),t("rect",{attrs:{x:"119.592",y:"103.365",width:"10.8173",height:"28.8462",rx:"5.40865",fill:"#A8A8A8"}}),t("rect",{attrs:{x:"119.592",y:"137.62",width:"10.8173",height:"10.8173",rx:"5.40865",fill:"#A8A8A8"}})])},lZ=[];const gy={};var pZ=Z(Qu,cZ,lZ,!1,uZ,null,null,null);function uZ(i){for(let e in gy)this[e]=gy[e]}const pp=function(){return pZ.exports}();var dZ=Object.defineProperty,hZ=Object.getOwnPropertyDescriptor,mo=(i,e,t,s)=>{for(var a=s>1?void 0:s?hZ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&dZ(e,t,a),a};let wa=class extends We(_s){constructor(){super(...arguments),this.inProgress=!1}getLocalizedText(e){return this.$formatMessage({id:e})}async logout(){this.$dispatch(new Ca)}async tryAgain(){this.inProgress=!0,this.logger.error("Restart from error view",{errorCode:g.Dolphin_24,error:this.error.message,code:this.error.errorCode}),await this.$dispatch(new lg({source:M7,reason:this.error.errorCode})),this.inProgress=!1}get showRestartButton(){var e;return!!((e=this.error.errorCode)!=null&&e.includes("Jellyfish"))}getErrorText(){return this.getLocalizedText(this.error.message)+(this.error.errorCode?" (Error ".concat(this.error.errorCode,")"):"")}get showSwitchToStandard(){return[p.PCLegacyClient,p.SteamClient].includes(this.hostPlatformType)&&!this.isLegacyUIDecommissioned}get selectLabel(){return this.$formatMessage({id:"legend.label.select"})}get classList(){const e=[Xs[this.navigationMethod]];return this.isFocusSystemActive&&e.push("focus-active"),e}};mo([C(S,"navigationMethod")],wa.prototype,"navigationMethod",2);mo([C(ye,"isFocusSystemActive")],wa.prototype,"isFocusSystemActive",2);mo([C(S,"hostPlatformType")],wa.prototype,"hostPlatformType",2);mo([C(Q,"isLegacyUIDecommissioned")],wa.prototype,"isLegacyUIDecommissioned",2);wa=mo([j({components:{"empty-state":Lr,"error-image":pp,"upn-button":Ki,"feedback-button":Lm}})],wa);var gZ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",[t("empty-state",{class:i.classList,attrs:{type:"app","data-e2e":"error-message"},scopedSlots:i._u([{key:"asset",fn:function(){return[t("error-image")]},proxy:!0},{key:"message",fn:function(){return[i._v(i._s(i.getErrorText())+" ")]},proxy:!0},{key:"button",fn:function(){return[i.showRestartButton?t("div",{staticClass:"buttons"},[t("upn-button",{staticClass:"button-cancel",attrs:{action:i.logout,disabled:i.inProgress,shortcutLabel:i.selectLabel}},[i._v(i._s(i.getLocalizedText("button.restart"))+" ")])],1):i.hasErrorCode?t("div",{staticClass:"buttons"},[t("upn-button",{staticClass:"button-cancel",attrs:{action:i.tryAgain,disabled:i.inProgress,shortcutLabel:i.selectLabel}},[i._v(i._s(i.getLocalizedText("button.tryAgain"))+" ")]),t("feedback-button")],1):i._e()]},proxy:!0}])})],1)},mZ=[];const my={};var fZ=Z(wa,gZ,mZ,!1,yZ,"8b8b79ee",null,null);function yZ(i){for(let e in my)this[e]=my[e]}const vZ=function(){return fZ.exports}();var _Z=Object.defineProperty,SZ=Object.getOwnPropertyDescriptor,ox=(i,e,t,s)=>{for(var a=s>1?void 0:s?SZ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&_Z(e,t,a),a};let yc=class extends K{goToSupportUrl(){/^[a-zA-Z]{2}-[a-zA-Z]{2}$/.test(this.playerLocale)?window.open("https://www.ubisoft.com/".concat(this.playerLocale,"/help/account/faq/account-security")):window.open("https://www.ubisoft.com/en-us/help/account/faq/account-security")}get selectLabel(){return this.$formatMessage({id:"legend.label.select"})}};ox([C(S,"playerLocale")],yc.prototype,"playerLocale",2);yc=ox([j({components:{"upn-button":Ki}})],yc);var wZ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("upn-button",{staticClass:"button-cancel",attrs:{type:"primary-affirmative",action:i.goToSupportUrl,shortcutLabel:i.selectLabel}},[i._v(i._s(this.$formatMessage({id:"profile.menu.support",defaultMessage:"Support"}))+" ")])},bZ=[];const fy={};var CZ=Z(yc,wZ,bZ,!1,IZ,null,null,null);function IZ(i){for(let e in fy)this[e]=fy[e]}const cx=function(){return CZ.exports}();var MZ=Object.defineProperty,AZ=Object.getOwnPropertyDescriptor,Gm=(i,e,t,s)=>{for(var a=s>1?void 0:s?AZ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&MZ(e,t,a),a};let _r=class extends We(_s){constructor(){super(),this.inProgress=!1,this.parentId=li.GroupId,this.focusId="login-error-view"}getLocalizedText(e,t){return this.$formatMessage({id:e,defaultMessage:t})}async restart(){return this.inProgress=!0,this.logger.error("Restart from error view",{errorCode:g.Dolphin_24,error:this.error.message,code:this.error.errorCode}),this.logger.flushAllTransports().finally(()=>{this.$dispatch(new Ca),this.inProgress=!1})}getMessage(){return this.getLocalizedText("error.login")+(this.error.errorCode?" (Error ".concat(this.error.errorCode,")"):"")}get selectLabel(){return this.$formatMessage({id:"legend.label.select"})}get classList(){const e=[Xs[this.navigationMethod]];return this.isFocusSystemActive&&e.push("focus-active"),e}};Gm([C(S,"navigationMethod")],_r.prototype,"navigationMethod",2);Gm([C(ye,"isFocusSystemActive")],_r.prototype,"isFocusSystemActive",2);_r=Gm([j({components:{"empty-state":Lr,"error-image":pp,"upn-button":Ki,"feedback-button":Lm,"support-button":cx,"upn-focus-group":Hs}})],_r);var PZ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",[t("upn-focus-group",{attrs:{parentId:i.parentId,focusId:i.focusId}},[t("empty-state",{class:i.classList,attrs:{type:"app","data-e2e":"error-message"},scopedSlots:i._u([{key:"asset",fn:function(){return[t("error-image")]},proxy:!0},{key:"message",fn:function(){return[i._v(" "+i._s(i.getMessage())+" ")]},proxy:!0},{key:"button",fn:function(){return[t("div",{staticClass:"buttons"},[t("upn-button",{staticClass:"button-cancel",attrs:{action:i.restart,disabled:i.inProgress,shortcutLabel:i.selectLabel}},[i._v(i._s(i.getLocalizedText("button.restart"))+" ")]),t("support-button"),t("feedback-button")],1)]},proxy:!0}])})],1)],1)},NZ=[];const yy={};var TZ=Z(_r,PZ,NZ,!1,RZ,"00d5e042",null,null);function RZ(i){for(let e in yy)this[e]=yy[e]}const DZ=function(){return TZ.exports}();var OZ=Object.defineProperty,FZ=Object.getOwnPropertyDescriptor,xm=(i,e,t,s)=>{for(var a=s>1?void 0:s?FZ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&OZ(e,t,a),a};let Sr=class extends We(_s){constructor(){super(),this.inProgress=!1,this.parentId=li.GroupId,this.focusId="network-error-view"}getLocalizedText(e,t){return this.$formatMessage({id:e,defaultMessage:t})}async tryAgain(){var e,t;this.inProgress=!0,this.error.errorCode===g.FailedFetchAuthenticationError?((e=this.metricDefinitions)==null||e.getMetric(Ae.ShellAuthenticationFetchRetry).add(1),await this.$dispatch(new xd)):this.error.errorCode===g.FailedFetchMicroAppConfigError?((t=this.metricDefinitions)==null||t.getMetric(Ae.ShellMicroappconfigFetchRetry).add(1),await this.$dispatch(new Ed)):await this.logger.flushAllTransports().finally(()=>{this.$dispatch(new Ca)}),this.inProgress=!1}getMessage(){return this.getLocalizedText("error.network")}get selectLabel(){return this.$formatMessage({id:"legend.label.select"})}get classList(){const e=[Xs[this.navigationMethod]];return this.isFocusSystemActive&&e.push("focus-active"),e}};xm([C(S,"navigationMethod")],Sr.prototype,"navigationMethod",2);xm([C(ye,"isFocusSystemActive")],Sr.prototype,"isFocusSystemActive",2);Sr=xm([j({components:{"empty-state":Lr,"error-image":pp,"upn-button":Ki,"feedback-button":Lm,"support-button":cx,"upn-focus-group":Hs}})],Sr);var LZ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",[t("upn-focus-group",{attrs:{parentId:i.parentId,focusId:i.focusId}},[t("empty-state",{class:i.classList,attrs:{type:"app","data-e2e":"error-message"},scopedSlots:i._u([{key:"asset",fn:function(){return[t("error-image")]},proxy:!0},{key:"message",fn:function(){return[i._v(" "+i._s(i.getMessage())+" ")]},proxy:!0},{key:"button",fn:function(){return[t("div",{staticClass:"buttons"},[t("upn-button",{staticClass:"button-cancel",attrs:{action:i.tryAgain,disabled:i.inProgress,shortcutLabel:i.selectLabel}},[i._v(i._s(i.getLocalizedText("button.tryAgain"))+" ")]),t("support-button"),t("feedback-button")],1)]},proxy:!0}])})],1)],1)},GZ=[];const vy={};var xZ=Z(Sr,LZ,GZ,!1,EZ,"05128280",null,null);function EZ(i){for(let e in vy)this[e]=vy[e]}const UZ=function(){return xZ.exports}(),kZ="micro-app-modal-group",WZ="modal",VZ={[B.main]:B.main,[B.side]:B.side,[B.accessEnd]:B.accessEnd,[B.modal]:WZ},_y=i=>VZ[i];var $Z=Object.defineProperty,BZ=Object.getOwnPropertyDescriptor,gi=(i,e,t,s)=>{for(var a=s>1?void 0:s?BZ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&$Z(e,t,a),a};let xt=class extends K{constructor(){super(),this.retryMessage=this.$formatMessage({id:"button.retry",defaultMessage:"Retry"}),this.closeMessage=this.$formatMessage({id:"button.close",defaultMessage:"Close"}),this.parentId=this.isInModal?kZ:li.GroupId,this.focusId="no-connection-view-".concat(this.placement),this.buttonFocusId="no-connection-retry-button-".concat(this.placement)}reloadWhenOnline(e,t){!t&&e&&this.retry()}async mounted(){await this.moveFocusToCurrentContainer(),this.isInModal&&await this.$dispatch(new gG(on.appListFocusId)),await this.focusSystem.setFocusable(_y(this.placement),!1),this.focusRetryButton()}async beforeDestroy(){await this.focusSystem.setFocusable(_y(this.placement),!0)}async moveFocusToCurrentContainer(){await this.$dispatch(new us(Rt.PASSIVE)),await this.$dispatch(new Mn),await this.$dispatch(new ha(this.focusId)),this.focusSystem.setFocusMode(Rt.ACTIVE)}focusRetryButton(){if(this.isInModal){const e=this.focusSystem.whenFocusValid(()=>{this.focusSystem.focus(this.buttonFocusId),e()})}else this.focusSystem.focus(this.buttonFocusId)}retry(){var t;const e=this.getActiveMicroApp(this.placement);if(e){const s=e.appName,a=(t=this.activeGame)!=null?t:this.hostGame,n=e.parentAppName;this.$dispatch(new Be({appName:s,game:a,parentAppName:n},{direction:ci.forwards,forceReactivation:!0,callerMicroAppName:"NoConnectionView.retry"}))}}async closeModal(){await this.$dispatch(new $r(jr.Shortcut))}get isInModal(){return this.placement===B.modal}get classList(){return[{"focus-active":this.isFocusSystemActive},Xs[this.navigationMethod],this.placement]}};gi([W({required:!0})],xt.prototype,"placement",2);gi([C(S,"activeGame")],xt.prototype,"activeGame",2);gi([C(S,"hostGame")],xt.prototype,"hostGame",2);gi([C(S,"isOnline")],xt.prototype,"isOnline",2);gi([C(M,"getActiveMicroApp")],xt.prototype,"getActiveMicroApp",2);gi([C(S,"navigationMethod")],xt.prototype,"navigationMethod",2);gi([C(ye,"isFocusSystemActive")],xt.prototype,"isFocusSystemActive",2);gi([Yt("$focusSystem")],xt.prototype,"focusSystem",2);gi([Mt("isOnline")],xt.prototype,"reloadWhenOnline",1);gi([_()],xt.prototype,"retry",1);gi([_()],xt.prototype,"closeModal",1);xt=gi([j({components:{"empty-state":Lr,"upn-button":Ki,"upn-text":y2,"no-connection-image":nx,"upn-focus-group":Hs}})],xt);var HZ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("upn-focus-group",{attrs:{parentId:i.parentId,focusId:i.focusId}},[t("empty-state",{staticClass:"no-connection",class:i.classList,attrs:{"data-e2e":"failed-to-load-bundle"},scopedSlots:i._u([{key:"asset",fn:function(){return[t("no-connection-image")]},proxy:!0},{key:"title",fn:function(){return[t("h3",{attrs:{"data-e2e":"message-no-connection"}},[i._v(" "+i._s(i.$formatMessage({id:"error.noConnection",defaultMessage:"No Connection"}))+" ")])]},proxy:!0},{key:"message",fn:function(){return[i._v(i._s(i.$formatMessage({id:"message.reconnect",defaultMessage:"Please check your internet connection while we try to reconnect you."})))]},proxy:!0},{key:"button",fn:function(){return[t("div",{staticClass:"no-connection-buttons",attrs:{"data-e2e":"no-connection-button"}},[t("upn-button",{staticClass:"button-retry",attrs:{focusId:i.buttonFocusId,action:i.retry,shortcutLabel:i.retryMessage,disabled:!1,"data-e2e":"button-retry"}},[i._v(i._s(i.retryMessage))]),i.isInModal?t("upn-button",{staticClass:"button-close",attrs:{action:i.closeModal,shortcutLabel:i.closeMessage,disabled:!1}},[i._v(i._s(i.closeMessage))]):i._e()],1)]},proxy:!0}])})],1)},QZ=[];const Sy={};var jZ=Z(xt,HZ,QZ,!1,qZ,null,null,null);function qZ(i){for(let e in Sy)this[e]=Sy[e]}const zZ=function(){return jZ.exports}();var KZ=Object.defineProperty,XZ=Object.getOwnPropertyDescriptor,ut=(i,e,t,s)=>{for(var a=s>1?void 0:s?XZ(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&KZ(e,t,a),a};const JZ=B.main;let Qe=class extends We($c){constructor(){super(...arguments),this._unsubscribeFromFocusChangedEvent=null}get error(){return this.getShellError(this.placement)}get isNoConnectionVisible(){return this.isNoConnectionViewVisible(this.placement)}get isSpinnerVisible(){return this.isMicroAppSpinnerVisible(this.placement)}get showLoginError(){var n;const e=(n=this.error)==null?void 0:n.errorCode,t=[g.Dolphin_14,g.Dolphin_15,g.Dolphin_16,g.Dolphin_17,g.Dolphin_32].includes(e),s=String(e).startsWith("dolphin-"),a=e===g.Jellyfish_005;return(s||a)&&!t}get showNetworkError(){var e,t;return((e=this.error)==null?void 0:e.errorCode)===g.FailedFetchAuthenticationError||((t=this.error)==null?void 0:t.errorCode)===g.FailedFetchMicroAppConfigError}get showAuthDolphinError(){var e;return((e=this.error)==null?void 0:e.errorCode)===g.Dolphin_32}get ariaBusyState(){if(!(!this.getActiveMicroApp(this.placement)&&!this.getNavigatingMicroApp(this.placement)))return String(!!this.getNavigatingMicroApp(this.placement))}get spinnerVisibleFlag(){return this.isSpinnerVisible?"spinner-visible":"spinner-hidden"}onIsFocusableChanged(){this.focusId&&this.$focusSystem.setFocusable(this.focusId,this.isFocusable)}mounted(){this.focusId&&(this.$dispatch(new dG(this.focusId,this.appContainer,this.placement)),this._unsubscribeFromFocusChangedEvent=this.$focusSystem.onFocusChanged(this.focusSystemFocusChanged))}beforeDestroy(){this._unsubscribeFromFocusChangedEvent&&this._unsubscribeFromFocusChangedEvent(),this.$dispatch(new ng(null,this.placement))}async onFocusChange(e){this.logger.debug("MicroAppView got focused: ".concat(e),{logCategory:f.focus}),e&&await this.$dispatch(new Ro(this.placement))}focusSystemFocusChanged(e,t){const s=this.focusId,a=e.includes(s),n=t.includes(s),r=this.$focusSystem.hasInnerFocus(s);if(!a&&r){this.$dispatch(new Ro(this.placement));return}const o=this.getActiveMicroApp(this.placement);if(o){if(a&&!n){this.$dispatch(new Ko(o));return}n&&a&&this.$dispatch(new kr(o))}if(this.isFocused&&n&&!this.focusedMicroApp){this.$dispatch(new Ro(this.placement));return}}get cssVars(){return{"--custom-micro-app-background-color":this.backgroundColor}}};ut([W({type:String,required:!1,default:()=>li.GroupId})],Qe.prototype,"parentId",2);ut([W({type:String,required:!1,default:JZ})],Qe.prototype,"focusId",2);ut([W({required:!0})],Qe.prototype,"placement",2);ut([W({required:!1})],Qe.prototype,"backgroundColor",2);ut([Dl()],Qe.prototype,"appContainer",2);ut([Yt("$logger")],Qe.prototype,"logger",2);ut([C(S,"isMobileGameOverlay")],Qe.prototype,"isMobileGameOverlay",2);ut([C(M,"getActiveMicroApp")],Qe.prototype,"getActiveMicroApp",2);ut([C(M,"navigatingMicroApp")],Qe.prototype,"getNavigatingMicroApp",2);ut([C(Q,"isMicroAppSpinnerVisible")],Qe.prototype,"isMicroAppSpinnerVisible",2);ut([C(Q,"isNoConnectionViewVisible")],Qe.prototype,"isNoConnectionViewVisible",2);ut([C(S,"focusedMicroApp")],Qe.prototype,"focusedMicroApp",2);ut([C($e,"getShellError")],Qe.prototype,"getShellError",2);ut([Mt("isFocused")],Qe.prototype,"onFocusChange",1);ut([_()],Qe.prototype,"focusSystemFocusChanged",1);Qe=ut([j({components:{"spinner-ubi-logo":Ol,error:vZ,"login-error":DZ,"network-error":UZ,"no-connection":zZ,"auth-dolphin-error":YY}})],Qe);var YZ=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"micro-app-root"},[t("div",{directives:[{name:"show",rawName:"v-show",value:i.error===void 0,expression:"error === undefined"}],staticClass:"micro-app"},[t("div",{ref:"appContainer",staticClass:"app-container",class:{"is-mobile-game-overlay":i.isMobileGameOverlay,"custom-background-color":i.backgroundColor!==void 0},style:i.cssVars,attrs:{"data-e2e":"app-container","aria-live":"polite","aria-busy":i.ariaBusyState}},[t("div",{directives:[{name:"show",rawName:"v-show",value:i.isSpinnerVisible,expression:"isSpinnerVisible"}],staticClass:"spinner-logo-container",attrs:{"data-e2e":"spinner","data-e2e-state":i.isSpinnerVisible?"visible":"hidden"}},[t("spinner-ubi-logo")],1),i.isNoConnectionVisible?t("no-connection",{attrs:{placement:i.placement,"data-e2e":"no-connection-view-main"}}):i._e()],1)]),i.error!==void 0?i._t("error",[i.showNetworkError?t("network-error",{staticClass:"error",attrs:{error:i.error,"data-e2e":"error"}}):i.showLoginError?t("login-error",{staticClass:"error",attrs:{error:i.error,"data-e2e":"error"}}):i.showAuthDolphinError?t("auth-dolphin-error",{staticClass:"error",attrs:{error:i.error,"data-e2e":"error"}}):t("error",{staticClass:"error",attrs:{error:i.error,"data-e2e":"error"}})],{error:i.error}):i._e()],2)},ZZ=[];const wy={};var eee=Z(Qe,YZ,ZZ,!1,tee,"95409538",null,null);function tee(i){for(let e in wy)this[e]=wy[e]}const iee=function(){return eee.exports}();var see=Object.defineProperty,aee=Object.getOwnPropertyDescriptor,Em=(i,e,t,s)=>{for(var a=s>1?void 0:s?aee(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&see(e,t,a),a};let wr=class extends K{};Em([W({required:!0})],wr.prototype,"isLandscape",2);Em([C(S,"initialSessionSet")],wr.prototype,"initialSessionSet",2);wr=Em([j({components:{AppListComponent:on}})],wr);const nee=window.__publicPath+"assets/ubisoft_swirl_logo-63d171d0.svg";var ree=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"simple-navigation-bar",class:{"orientation-portrait":!i.isLandscape}},[t("div",{staticClass:"main-container"},[t("div",{staticClass:"bar"},[i._m(0),i.initialSessionSet?t("AppListComponent"):i._e()],1)])])},oee=[function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"logo-container"},[t("div",{staticClass:"keyart-image"}),t("img",{staticClass:"logo",attrs:{"data-e2e":"logo",src:nee,alt:"Ubisoft Logo"}})])}];const by={};var cee=Z(wr,ree,oee,!1,lee,"6440513e",null,null);function lee(i){for(let e in by)this[e]=by[e]}const pee=function(){return cee.exports}();var uee=Object.defineProperty,dee=Object.getOwnPropertyDescriptor,up=(i,e,t,s)=>{for(var a=s>1?void 0:s?dee(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&uee(e,t,a),a};const hee=()=>G(()=>import("./FullNavigationBar.view-1f7a8d5a.js"),["assets/FullNavigationBar.view-1f7a8d5a.js","assets/promotabs-4b6fe12f.js","assets/vendor-ff46a377.js","assets/upn-vendor-bf1ed58d.js","assets/FullNavigationBar.view-5e7d9f14.css"]);let yn=class extends K{constructor(){super(...arguments),this.focusGroupId="nav-bar",this.parentGroupId=li.GroupId,this.layout=AS.VERTICAL_LIST}get shouldShowFullNavigationBar(){return this.isNavigationBarVisible&&this.layoutType===_t.pcClient}};up([W({required:!0})],yn.prototype,"isLandscape",2);up([C(Q,"isNavigationBarVisible")],yn.prototype,"isNavigationBarVisible",2);up([C(S,"layoutType")],yn.prototype,"layoutType",2);yn=up([j({components:{"simple-navigation-bar":pee,"full-navigation-bar":hee,"upn-focus-group":Hs}})],yn);var gee=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("upn-focus-group",{attrs:{parentId:i.parentGroupId,focusId:i.focusGroupId,layout:i.layout,isScrollable:""}},[i.shouldShowFullNavigationBar?t("full-navigation-bar",{attrs:{isLandscape:i.isLandscape}}):i.isNavigationBarVisible?t("simple-navigation-bar",{attrs:{isLandscape:i.isLandscape}}):i._e()],1)},mee=[];const Cy={};var fee=Z(yn,gee,mee,!1,yee,null,null,null);function yee(i){for(let e in Cy)this[e]=Cy[e]}const vee=function(){return fee.exports}(),_ee=i=>{const e=qg(),t=Mi($e,"getShellError"),s=U.useCallback(()=>{e(new Gt(t()?_e.FatalError:_e.User))},[e,t]),a=U.useCallback(()=>{e(new gs(i))},[i,e]);return{closeOverlay:s,navigateBack:a}},See=[m.PC,m.Luna,m.Steam,m.Mobile,m.Android,m.IOS,m.Web,m.MacOS],wee=[m.Mobile,m.Android,m.IOS],bee=[m.Luna,m.PC,m.Steam,m.MacOS],Cee={[m.Android]:"layoutPortable",[m.Mobile]:"layoutPortable",[m.IOS]:"layoutPortable",[m.PS4]:"layoutConsole",[m.PS5]:"layoutConsole",[m.PC]:"layoutDesktop",[m.Web]:"layoutDesktop",[m.Scarlett]:"layoutConsole",[m.ScarlettUWP]:"layoutConsole",[m.XONE]:"layoutConsole",[m.Luna]:"layoutDesktop",[m.Steam]:"layoutDesktop",[m.MacOS]:"layoutDesktop",[m.Switch]:"layoutConsole"},Iee="_titleBar_1ivjt_44",Mee="_titleBarCollapsed_1ivjt_73",Aee="_divider_1ivjt_73",Pee="_titleBarHeader_1ivjt_76",Nee="_title_1ivjt_44",Tee="_icon_1ivjt_79",Ree="_titleBarHidden_1ivjt_83",Dee="_titleBarFloating_1ivjt_87",Oee="_titleBarExpanded_1ivjt_102",Fee="_backIcon_1ivjt_112",Lee="_gameName_1ivjt_174",ri={titleBar:Iee,titleBarCollapsed:Mee,divider:Aee,titleBarHeader:Pee,title:Nee,icon:Tee,titleBarHidden:Ree,titleBarFloating:Dee,titleBarExpanded:Oee,backIcon:Fee,gameName:Lee},Gee=(i,e)=>U.useMemo(()=>{let t="";switch(e){case Ja.collapsed:t=ri.titleBarCollapsed;break;case Ja.hidden:t=ri.titleBarHidden;break;case Ja.floating:t=ri.titleBarFloating;break;default:t=ri.titleBarExpanded}return st([ri.titleBar,Cee[i],t])},[e,i]),xee=(i,e,t)=>{const{isTopLevelAppBySpaceId:s,getActiveMicroApp:a,allActiveAppNames:n}=$i(M,V=>({isTopLevelAppBySpaceId:V.isTopLevelAppBySpaceId,getActiveMicroApp:V.getActiveMicroApp,allActiveAppNames:V.allActiveAppNames})),{hasItems:r,stacks:o}=$i(Y,V=>({hasItems:V.hasItems,stacks:V.stacks})),{hostGame:l,platformType:u,isMobileGameOverlay:v}=$i(S,V=>({hostGame:V.hostGame,platformType:V.platformType,isMobileGameOverlay:V.isMobileGameOverlay})),w=Mi(Q,"showOfflineNotification"),b=U.useMemo(()=>{const V=a(i);return!V||V.appName===J.AppAuthentication?!1:!s(V.spaceId,l.spaceId)&&e!==""},[i,e,n]),I=U.useMemo(()=>r(i)&&See.includes(u),[i,u,o]),R=U.useMemo(()=>I&&(b||!!e),[I,e,b]),x=U.useMemo(()=>(v||bee.includes(u))&&!t,[v,u,t]),F=U.useMemo(()=>w&&!wee.includes(u),[w]);return{showBackButton:I,showSeparator:R,showGameName:b,showCloseButton:x,showOfflineNotification:F}};function Eee({shouldHideCloseButton:i,children:e}){const{localizationService:t}=Gl(),{defaultPlacement:s,getActiveMicroApp:a,microAppStateDataGetter:n,getAllMicroAppStateData:r,allActiveAppNames:o}=$i(M,ce=>({defaultPlacement:ce.defaultPlacement,getActiveMicroApp:ce.getActiveMicroApp,microAppStateDataGetter:ce.microAppStateDataGetter,getAllMicroAppStateData:ce.getAllMicroAppStateData,allActiveAppNames:ce.allActiveAppNames})),{activeGame:l,platformType:u}=$i(S,ce=>({activeGame:ce.activeGame,platformType:ce.platformType})),v=Mi(it,"titleBarViewMode"),w=Mi(ws,"getGame"),b=U.useMemo(()=>{var Ue;const ce=w(l.spaceId);return(Ue=ce==null?void 0:ce.name)!=null?Ue:""},[l,o]),I=U.useMemo(()=>{const ce=a(s);return ce?n(ce).title:""},[s,r,o]),R=xee(s,I,i),x=_ee(s),F=Gee(u,v),V={[oi.A]:{text:t.formatMessage({id:"legend.label.select"})}};return e({layout:R,title:I,gameName:b,defaultPlacement:s,buttonActions:x,buttonShortcuts:V,className:F})}var lx={},px={};const Uee=U;function kee(i){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const t in i)if(t!=="default"){const s=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,s.get?s:{enumerable:!0,get:()=>i[t]})}}return e.default=i,Object.freeze(e)}const Iy=kee(Uee),Wee=i=>Iy.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48",...i},Iy.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M31.897 1.569a2 2 0 0 1 .034 2.828L12.795 24l19.136 19.603a2 2 0 1 1-2.862 2.794l-20.5-21a2 2 0 0 1 0-2.794l20.5-21a2 2 0 0 1 2.828-.034",clipRule:"evenodd"}));px.SvgAngleLeft=Wee;(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});const e=px;i.AngleLeft=e.SvgAngleLeft})(lx);var ux={},dx={};const Vee=U;function $ee(i){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const t in i)if(t!=="default"){const s=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,s.get?s:{enumerable:!0,get:()=>i[t]})}}return e.default=i,Object.freeze(e)}const My=$ee(Vee),Bee=i=>My.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48",...i},My.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M7.586 7.586a2 2 0 0 1 2.828 0L24 21.172 37.586 7.586a2 2 0 1 1 2.828 2.828L26.828 24l13.586 13.586a2 2 0 1 1-2.828 2.828L24 26.828 10.414 40.414a2 2 0 1 1-2.828-2.828L21.172 24 7.586 10.414a2 2 0 0 1 0-2.828",clipRule:"evenodd"}));dx.SvgClose=Bee;(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});const e=dx;i.Close=e.SvgClose})(ux);var hx={},gx={};const Hee=U;function Qee(i){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const t in i)if(t!=="default"){const s=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,s.get?s:{enumerable:!0,get:()=>i[t]})}}return e.default=i,Object.freeze(e)}const Io=Qee(Hee),jee=i=>Io.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:48,height:48,fill:"none",viewBox:"0 0 48 48",...i},Io.createElement("path",{fill:"currentColor",d:"M47.414 3.414A2 2 0 1 0 44.586.586l-44 44a2 2 0 1 0 2.828 2.828zM24 5.5c3.59 0 6.903.63 9.84 1.588L30.61 10.32A27.4 27.4 0 0 0 24 9.5c-9.718 0-17.155 5.333-19.544 7.87a2 2 0 1 1-2.912-2.74C4.489 11.5 12.918 5.5 24 5.5M10.655 23.52c1.826-1.66 5.903-5.12 12.242-5.488l-5.624 5.624c-1.76.92-3.062 2.037-3.928 2.824a2 2 0 1 1-2.69-2.96M34.086 20.985l-2.913 2.913c1.536.87 2.69 1.863 3.482 2.582a2 2 0 1 0 2.69-2.96c-.728-.662-1.814-1.61-3.26-2.535"}),Io.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M24.07 31 18 37.07A6 6 0 1 0 24.07 31M24 40a3 3 0 1 0 0-6 3 3 0 0 0 0 6",clipRule:"evenodd"}),Io.createElement("path",{fill:"currentColor",d:"m43.22 11.851-2.868 2.868c1.428.985 2.514 1.931 3.192 2.652a2 2 0 1 0 2.912-2.742c-.744-.79-1.838-1.764-3.236-2.778"}));gx.SvgNoInternet=jee;(function(i){Object.defineProperty(i,Symbol.toStringTag,{value:"Module"});const e=gx;i.NoInternet=e.SvgNoInternet})(hx);const qee="_bannerContainer_1l07a_8",zee={bannerContainer:qee},Kee=({children:i})=>A.jsx("div",{className:zee.bannerContainer,children:i}),Xee="_offlineBanner_hokmy_1",Jee={offlineBanner:Xee};function Yee({children:i}){const e=qg(),{localizationService:t}=Gl(),s=()=>{(async()=>await e(new ZR))()},a={[oi.A]:{text:t.formatMessage({id:"legend.label.select"})}},n=t.formatMessage({id:"message.noInternetConnection"});return i({onDismiss:s,shortcuts:a,offlineLabel:n})}const Zee=()=>{const i={icon:A.jsx(hx.NoInternet,{}),className:Jee.offlineBanner};return A.jsx(Yee,{children:({onDismiss:e,shortcuts:t,offlineLabel:s})=>A.jsx(Kee,{children:A.jsx(v2,{...i,onDismiss:e,dismissButtonProps:{tag:"a",title:"",focusableProps:{shortcuts:t}},children:s})})})},ete=U.memo(Zee),tte=({shortcuts:i,...e})=>{const t={...e,tag:"a",title:"",variant:"tertiary",size:"lg"};return A.jsx(_2,{...t,focusableProps:{shortcuts:i}})},Ay=U.memo(tte),ite="back-icon",ste="close-icon",ate=({layout:i,title:e,gameName:t,buttonActions:s,buttonShortcuts:a,className:n})=>A.jsxs(A.Fragment,{children:[A.jsxs("div",{className:n,children:[i.showBackButton&&A.jsx(Ay,{className:st(ri.icon,ri.backIcon),testId:ite,onClick:s.navigateBack,shortcuts:a,children:A.jsx(lx.AngleLeft,{})}),i.showSeparator&&A.jsx("div",{className:ri.divider}),A.jsxs("div",{"data-header-title":e,className:ri.titleBarHeader,children:[i.showGameName&&A.jsx("div",{className:ri.gameName,children:A.jsx("span",{"data-e2e":"game-name-shell",children:t})}),A.jsx("div",{className:ri.title,children:A.jsx("span",{"data-e2e":"title-shell",children:e})})]}),i.showCloseButton&&A.jsx(Ay,{className:st(ri.icon),testId:ste,onClick:s.closeOverlay,shortcuts:a,children:A.jsx(ux.Close,{})})]}),i.showOfflineNotification&&A.jsx(ete,{})]}),nte=({shouldHideCloseButton:i})=>A.jsx(NS,{id:"title-bar",children:A.jsx("div",{"data-e2e":"title-bar-section",children:A.jsx(Eee,{shouldHideCloseButton:i,children:e=>A.jsx(ate,{...e})})})});var rte=Object.defineProperty,ote=Object.getOwnPropertyDescriptor,mx=(i,e,t,s)=>{for(var a=s>1?void 0:s?ote(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&rte(e,t,a),a};let vc=class extends K{async mounted(){this.$dispatch(new qR(!0))}};mx([C($e,"getShellError")],vc.prototype,"getShellError",2);vc=mx([j],vc);var cte=Object.defineProperty,lte=Object.getOwnPropertyDescriptor,Se=(i,e,t,s)=>{for(var a=s>1?void 0:s?lte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&cte(e,t,a),a};const pte=()=>G(()=>import("./DebugPanel.view-76d74dd6.js"),["assets/DebugPanel.view-76d74dd6.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/Teleport.component-74b619f7.js","assets/DebugPanel.view-0fe96d8d.css"]),ute=()=>G(()=>import("./StreamingWidget.view-0600f9c4.js"),["assets/StreamingWidget.view-0600f9c4.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/StreamingWidget.view-9eb4fa7b.css"]);let fe=class extends We(vc){get isPlacementFilled(){if(this.initialLoadComplete)return!0;{const e=this.getActiveMicroApp(this.defaultPlacement),t=this.getShellError(this.defaultPlacement)!==void 0||!!e;return t&&(this.initialLoadComplete=!0),t}}get isTitleBarVisible(){return this.isPlacementFilled&&!this.isOnMobileCompanionApp}get isMicroAppSpinnerVisible(){return this.microAppSpinnerVisibility(B.main)}get isMicroAppContainerFocusable(){var t;const e=(t=this.getActiveMicroApp(this.defaultPlacement))==null?void 0:t.appName;return e?!this.supportsFocusSystemSingleInstance(e):!0}get styles(){return{[$u.navigationBarVisible]:this.isNavigationBarVisible?"1":"0",[$u.orientationModeIsLandscape]:this.orientation===vt.LandscapePrimary||this.orientation===vt.LandscapeSecondary?"1":"0"}}get classList(){const e={"standalone-mode":this.isStandalone,"uwp-app":this.isUWP,"xone-xdk":this.xOneSdk===Op.XDK,"platform-console":IG.includes(this.platformType)};return[this.isFocusSystemActive?"focus-active":"",this.isOverlayVisible?"overlay-visible":"overlay-hidden",this.isNavigationBarVisible?"navigation-bar-visible":"navigation-bar-hidden",e,this.viewportModeClass,bG[this.orientation],CG[this.platformType],fQ[this.inputDeviceType],Xs[this.navigationMethod],yQ[this.theme],...this.isOnTabletWithLandscapeMode?["tablet-landscape"]:[]]}get showNavigationBar(){return!this.isOnMobile&&!this.isChild&&!this.isExclusiveMode}onClickOutside(e){[m.Luna,m.PC,m.Steam].includes(this.platformType)&&this.$dispatch(new Gt(this.getShellError()?_e.FatalError:_e.User))}get isLandscape(){return this.orientation===vt.LandscapePrimary||this.orientation===vt.LandscapeSecondary}get isOnTabletWithLandscapeMode(){return this.deviceType===Vt.Tablet&&this.isLandscape}get isOnMobileCompanionApp(){return this.isOnMobile&&this.isStandalone}isForcedFullView(){return this.platformType===m.MacOS||this.isOnMobile&&(this.isStandalone||!this.isOnTabletWithLandscapeMode)}get shouldShowOverlayOutsideArea(){return!this.isForcedFullView()&&this.viewportMode!==xs.fullView}get viewportModeClass(){return this.isForcedFullView()?Mu[xs.fullView]:Mu[this.viewportMode]}async mounted(){this.logger.info("Overlay view is mounted",{logCategory:f.shell})}};Se([C(it,"viewportMode")],fe.prototype,"viewportMode",2);Se([C(Q,"isNavigationBarVisible")],fe.prototype,"isNavigationBarVisible",2);Se([C(Q,"isMicroAppSpinnerVisible")],fe.prototype,"microAppSpinnerVisibility",2);Se([C(M,"getActiveMicroApp")],fe.prototype,"getActiveMicroApp",2);Se([C(M,"defaultPlacement")],fe.prototype,"defaultPlacement",2);Se([C(M,"microAppSupportsFocusSystemSingleInstance")],fe.prototype,"supportsFocusSystemSingleInstance",2);Se([C(S,"orientation")],fe.prototype,"orientation",2);Se([C(S,"platformType")],fe.prototype,"platformType",2);Se([C(S,"isUWP")],fe.prototype,"isUWP",2);Se([C(S,"shouldRevertExitAndBackButton")],fe.prototype,"shouldRevertExitAndBackButton",2);Se([C(S,"inputDeviceType")],fe.prototype,"inputDeviceType",2);Se([C(S,"navigationMethod")],fe.prototype,"navigationMethod",2);Se([C(S,"theme")],fe.prototype,"theme",2);Se([C(S,"isStandalone")],fe.prototype,"isStandalone",2);Se([C(S,"isExclusiveMode")],fe.prototype,"isExclusiveMode",2);Se([C(S,"isOverlayVisible")],fe.prototype,"isOverlayVisible",2);Se([C(S,"xOneSdk")],fe.prototype,"xOneSdk",2);Se([C(te,"isDebugPanelVisible")],fe.prototype,"isDebugPanelVisible",2);Se([C(S,"isChild")],fe.prototype,"isChild",2);Se([C(S,"deviceType")],fe.prototype,"deviceType",2);Se([C(S,"isOnMobile")],fe.prototype,"isOnMobile",2);Se([C(ap,"isEnabled")],fe.prototype,"isStreamingWidgetEnabled",2);Se([C(ye,"isFocusSystemActive")],fe.prototype,"isFocusSystemActive",2);Se([Yt("$logger")],fe.prototype,"logger",2);Se([Yt("$focusSystem")],fe.prototype,"focusSystem",2);Se([W({default:!1})],fe.prototype,"initialLoadComplete",2);fe=Se([j({components:{"title-bar":cy(nte),"micro-app":iee,"input-legend":cy(GY),"navigation-bar":vee,tooltip:QX,notification:LJ,"debug-panel":pte,"fps-counter":gY,"streaming-widget":ute,"upn-focus-group":Hs}})],fe);var dte=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"shell-container",class:i.classList,style:i.styles,attrs:{"data-e2e":i.viewportModeClass}},[i.showNavigationBar?t("div",{directives:[{name:"show",rawName:"v-show",value:i.isOverlayVisible,expression:"isOverlayVisible"}],staticClass:"navigation-bar-section",attrs:{"data-e2e":"navigation-bar-section"}},[t("navigation-bar",{attrs:{isLandscape:i.isLandscape}})],1):i._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:i.isOverlayVisible,expression:"isOverlayVisible"}],staticClass:"micro-app-section"},[i.isOnMobileCompanionApp?i._e():t("title-bar",{directives:[{name:"show",rawName:"v-show",value:i.isTitleBarVisible,expression:"isTitleBarVisible"}]}),t("micro-app",{attrs:{placement:"main","data-e2e":"main-container",isFocusable:i.isMicroAppContainerFocusable,isFocusGroup:!i.isMicroAppContainerFocusable}}),i.isOnMobile?i._e():t("input-legend")],1),i.shouldShowOverlayOutsideArea?t("div",{staticClass:"shell-container-outside-area",on:{click:i.onClickOutside}}):i._e(),t("notification"),i.isOverlayVisible&&i.isDebugPanelVisible?t("debug-panel"):i._e(),i.isOverlayVisible?i._e():t("fps-counter"),i.isStreamingWidgetEnabled?t("streaming-widget"):i._e(),t("tooltip")],1)},hte=[];const Py={};var gte=Z(fe,dte,hte,!1,mte,"924c2f98",null,null);function mte(i){for(let e in Py)this[e]=Py[e]}const fte=function(){return gte.exports}();var ga=(i=>(i.Horizontal="horizontalModal",i.Vertical="verticalModal",i))(ga||{}),yte=Object.defineProperty,vte=Object.getOwnPropertyDescriptor,Bn=(i,e,t,s)=>{for(var a=s>1?void 0:s?vte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&yte(e,t,a),a},fx=(i=>(i.Accepted="accepted",i.Cancelled="cancelled",i))(fx||{});let $s=class extends We(S2){cancel(){this.close({status:"cancelled"})}accept(){this.close({status:"accepted"})}legendLabel(){return this.$formatMessage({id:"legend.label.select"})}get classList(){return["shell-modal",{vertical:this.alignment===ga.Vertical,horizontal:this.alignment===ga.Horizontal}]}get showIcon(){return this.alignment===ga.Vertical}};Bn([W({type:String,default:""})],$s.prototype,"headerText",2);Bn([W({type:String,default:""})],$s.prototype,"bodyText",2);Bn([W({type:String,default:""})],$s.prototype,"buttonProceedText",2);Bn([W({type:String,default:""})],$s.prototype,"buttonCancelText",2);Bn([W({type:String,default:ga.Vertical})],$s.prototype,"alignment",2);$s=Bn([j({components:{"upn-button":Ki,"error-image":pp}})],$s);var _te=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("modal-container",{class:i.classList,attrs:{"data-e2e":"shell-modal"}},[i.showIcon?t("div",{staticClass:"icon"},[t("error-image",{staticClass:"image"})],1):i._e(),i.headerText?t("div",{staticClass:"text header-text",attrs:{"data-e2e":"header-text"}},[i._v(" "+i._s(i.headerText)+" ")]):i._e(),i.bodyText?t("div",{staticClass:"text",attrs:{"data-e2e":"body-text"}},[i._v(" "+i._s(i.bodyText)+" ")]):i._e(),t("div",{staticClass:"choices"},[i.buttonCancelText?t("upn-button",{attrs:{type:"tertiary-dismissive",size:"small","data-e2e":"button-cancel",shortcutLabel:i.legendLabel()},on:{trigger:i.cancel}},[i._v(" "+i._s(i.buttonCancelText)+" ")]):i._e(),i.buttonProceedText?t("upn-button",{attrs:{type:"primary-main",size:"small","data-e2e":"button-continue",shortcutLabel:i.legendLabel()},on:{trigger:i.accept}},[i._v(" "+i._s(i.buttonProceedText))]):i._e()],1)])},Ste=[];const Ny={};var wte=Z($s,_te,Ste,!1,bte,"6dc6ca56",null,null);function bte(i){for(let e in Ny)this[e]=Ny[e]}const Cte=function(){return wte.exports}();var Ite=Object.defineProperty,Mte=Object.getOwnPropertyDescriptor,Ua=(i,e,t,s)=>{for(var a=s>1?void 0:s?Mte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Ite(e,t,a),a};let jt=class extends K{show(i){this.$nextTick(()=>{(async()=>await this.$dispatch(new qr("shell",{onModalClose:i.completionCallback,shouldCloseOnClickBackdrop:i.shouldCloseOnClickBackdrop})).then(async e=>{if(!e)return;const t=this._showModal(this,Cte,{headerText:this.headerText,bodyText:this.bodyText,buttonCancelText:this.buttonCancelText,buttonProceedText:this.buttonProceedText,alignment:this.alignment},e);await this.$dispatch(new Mn),await this.$dispatch(new us),(await t.result).status===fx.Accepted?i.acceptedCallback&&i.acceptedCallback():i.cancelledCallback&&i.cancelledCallback(),this.$dispatch(new qi)}))()})}};Ua([Yt("$showModal")],jt.prototype,"_showModal",2);Ua([W({type:String,default:""})],jt.prototype,"headerText",2);Ua([W({type:String,default:""})],jt.prototype,"bodyText",2);Ua([W({type:String,default:""})],jt.prototype,"buttonProceedText",2);Ua([W({type:String,default:""})],jt.prototype,"buttonCancelText",2);Ua([W({type:String,default:ga.Vertical})],jt.prototype,"alignment",2);jt=Ua([j({components:{ShellModal:jt},template:"<shell-modal></shell-modal>"})],jt);var Ate=Object.defineProperty,Pte=Object.getOwnPropertyDescriptor,Nte=(i,e,t,s)=>{for(var a=s>1?void 0:s?Pte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Ate(e,t,a),a};let ju=class extends We(jt){mounted(){this.show({shouldCloseOnClickBackdrop:!0,acceptedCallback:()=>this.$dispatch(new Ca),completionCallback:()=>this.$dispatch(new og)})}};ju=Nte([j],ju);var Tte=Object.defineProperty,Rte=Object.getOwnPropertyDescriptor,Dte=(i,e,t,s)=>{for(var a=s>1?void 0:s?Rte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Tte(e,t,a),a};let qu=class extends We(jt){mounted(){this.show({shouldCloseOnClickBackdrop:!0,acceptedCallback:()=>this.$dispatch(new cg),completionCallback:()=>this.$dispatch(new og)})}};qu=Dte([j],qu);var Ote=Object.defineProperty,Fte=Object.getOwnPropertyDescriptor,Lte=(i,e,t,s)=>{for(var a=s>1?void 0:s?Fte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Ote(e,t,a),a};let zu=class extends We(jt){mounted(){this.show({shouldCloseOnClickBackdrop:!1,acceptedCallback:this.reload})}async reload(){await this.$dispatch(new BO)}};zu=Lte([j],zu);var Gte=Object.defineProperty,xte=Object.getOwnPropertyDescriptor,Ete=(i,e,t,s)=>{for(var a=s>1?void 0:s?xte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Gte(e,t,a),a};let Ku=class extends We(jt){mounted(){this.show({shouldCloseOnClickBackdrop:!1,acceptedCallback:this.restart})}async restart(){await this.$dispatch(new aD(!0))}};Ku=Ete([j],Ku);var Ute=Object.defineProperty,kte=Object.getOwnPropertyDescriptor,dp=(i,e,t,s)=>{for(var a=s>1?void 0:s?kte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Ute(e,t,a),a};let vn=class extends K{constructor(){super(...arguments),this.restartVisible=!1,this.ModalTypes=fs,this.ShellModalAlignment=ga}onLastUpdateDataChanged(e,t){!e||!t||e!=null&&e.isMandatory&&(this.activeModal=fs.Reload)}};dp([C(Q,"activeModal")],vn.prototype,"activeModal",2);dp([C(Ii,"lastUpdate")],vn.prototype,"lastUpdateData",2);dp([Mt("lastUpdateData",{immediate:!0})],vn.prototype,"onLastUpdateDataChanged",1);vn=dp([j({components:{"log-out-modal":ju,"reload-modal":zu,"quit-modal":qu,"restart-modal":Ku}})],vn);var Wte=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{attrs:{id:"shell-modals"}},[i.activeModal===i.ModalTypes.Logout?t("log-out-modal",{attrs:{bodyText:i.$formatMessage({id:"beta.confirmLogout",defaultMessage:"Logging out will pause any ongoing downloads, are you sure you want to log out?"}),buttonProceedText:i.$formatMessage({id:"button.logOut",defaultMessage:"Log out"}),buttonCancelText:i.$formatMessage({id:"button.cancel",defaultMessage:"Cancel"})}}):i._e(),i.activeModal===i.ModalTypes.Quit?t("quit-modal",{attrs:{bodyText:i.$formatMessage({id:"beta.confirmQuit",defaultMessage:"Quitting will pause any ongoing downloads and close Ubisoft Connect app, are you sure you want to quit?"}),buttonProceedText:i.$formatMessage({id:"button.quit",defaultMessage:"Quit"}),buttonCancelText:i.$formatMessage({id:"button.cancel",defaultMessage:"Cancel"})}}):i._e(),i.activeModal===i.ModalTypes.Reload?t("reload-modal",{attrs:{bodyText:i.$formatMessage({id:"shell.reloadShell",defaultMessage:"The Ubisoft Connect application needs to be updated, please click 'Confirm' to continue"}),buttonProceedText:i.$formatMessage({id:"button.reload",defaultMessage:"Confirm"})}}):i._e(),i.activeModal===i.ModalTypes.Restart?t("restart-modal",{attrs:{headerText:i.$formatMessage({id:"title.sessionTimedOut",defaultMessage:"Session timed out"}),bodyText:i.$formatMessage({id:"message.updateSessionFailed",defaultMessage:"Sorry, you need to restart Ubisoft Connect PC. Your current downloads will be paused after closing."}),buttonProceedText:i.$formatMessage({id:"button.restart",defaultMessage:"Restart"}),alignment:i.ShellModalAlignment.Horizontal}}):i._e(),i.activeModal===i.ModalTypes.RestartWhenRunningGame?t("restart-modal",{attrs:{headerText:i.$formatMessage({id:"title.sessionTimedOut",defaultMessage:"Session timed out"}),bodyText:i.$formatMessage({id:"message.restartWhenGameRunning",defaultMessage:"Sorry, closing Ubisoft PC while game runs may have unforeseen effects on your game. Please ensure you exit your game before you do. You'll need to restart Ubisoft Connect PC."}),buttonProceedText:i.$formatMessage({id:"button.restart",defaultMessage:"Restart"}),alignment:i.ShellModalAlignment.Horizontal}}):i._e()],1)},Vte=[];const Ty={};var $te=Z(vn,Wte,Vte,!1,Bte,null,null,null);function Bte(i){for(let e in Ty)this[e]=Ty[e]}const Hte=function(){return $te.exports}();var Qte=Object.defineProperty,jte=Object.getOwnPropertyDescriptor,Ps=(i,e,t,s)=>{for(var a=s>1?void 0:s?jte(e,t):e,n=i.length-1,r;n>=0;n--)(r=i[n])&&(a=(s?r(e,t,a):r(a))||a);return s&&a&&Qte(e,t,a),a};const qte=()=>G(()=>import("./Child.view-468ef788.js"),["assets/Child.view-468ef788.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/TitleBarButton.component-a88de081.js","assets/TitleBarButton-72ae4626.css","assets/Child.view-89ec0a3e.css"]),zte=()=>G(()=>import("./Client.view-56a9dc95.js"),["assets/Client.view-56a9dc95.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/Teleport.component-74b619f7.js","assets/TitleBarButton.component-a88de081.js","assets/TitleBarButton-72ae4626.css","assets/Client.view-4c2b7bc6.css"]),Kte=()=>G(()=>import("./Authentication.view-73d0f703.js"),["assets/Authentication.view-73d0f703.js","assets/vendor-ff46a377.js","assets/Child.view-468ef788.js","assets/upn-vendor-bf1ed58d.js","assets/TitleBarButton.component-a88de081.js","assets/TitleBarButton-72ae4626.css","assets/Child.view-89ec0a3e.css"]),Xte=()=>G(()=>import("./DebugPanel.view-76d74dd6.js"),["assets/DebugPanel.view-76d74dd6.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js","assets/Teleport.component-74b619f7.js","assets/DebugPanel.view-0fe96d8d.css"]),Ry="data-e2e-selected-component";let Ni=class extends K{get shouldShowOverlay(){return this.layoutType===_t.default}get shouldShowClient(){return this.layoutType===_t.pcClient&&this.isUserLoggedIn()}get shouldShowAuthentication(){return this.layoutType===_t.pcClient&&!this.isUserLoggedIn()&&!this.authInProgress}get shouldShowChild(){return this.layoutType===_t.child}get shouldShowModals(){return!this.shouldShowOverlay||this.isOverlayVisible}isUserLoggedIn(){return!!this.playerSession}onSelectedComponentTypeChange(){const e=this.$el;this.selectedComponentType?e.setAttribute(Ry,this.$e2eFormat(this.selectedComponentType)):e.removeAttribute(Ry)}};Ps([C(S,"layoutType")],Ni.prototype,"layoutType",2);Ps([C(S,"playerSession")],Ni.prototype,"playerSession",2);Ps([C(S,"isOverlayVisible")],Ni.prototype,"isOverlayVisible",2);Ps([C(S,"authInProgress")],Ni.prototype,"authInProgress",2);Ps([C(Dt,"selectedComponentType")],Ni.prototype,"selectedComponentType",2);Ps([C(te,"isDebugPanelVisible")],Ni.prototype,"isDebugPanelVisible",2);Ps([C(S,"navigationMethod")],Ni.prototype,"navigationMethod",2);Ps([Mt("selectedComponentType")],Ni.prototype,"onSelectedComponentTypeChange",1);Ni=Ps([j({components:{"child-view":qte,"client-view":zte,"overlay-view":fte,"authentication-view":Kte,"modal-view":VG,"debug-panel":Xte,"shell-modals":Hte,"spinner-ubi-logo":Ol,"window-title-bar":UX}})],Ni);var Jte=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{ref:"mainView",staticClass:"main-view",attrs:{id:"main-view"}},[t("window-title-bar",{attrs:{isEnvironmentTagVisible:i.shouldShowAuthentication}}),i.shouldShowOverlay?t("overlay-view"):i.shouldShowClient?t("client-view"):i.shouldShowChild?t("child-view"):i.shouldShowAuthentication?t("authentication-view"):t("div",[t("div",{staticClass:"spinner-logo-container",attrs:{"data-e2e":"spinner"}},[t("spinner-ubi-logo")],1)]),i.shouldShowModals?t("modal-view"):i._e(),t("shell-modals"),!i.shouldShowOverlay&&i.isDebugPanelVisible?t("debug-panel"):i._e()],1)},Yte=[];const Dy={};var Zte=Z(Ni,Jte,Yte,!1,eie,"528b58ae",null,null);function eie(i){for(let e in Dy)this[e]=Dy[e]}const tie=function(){return Zte.exports}();class Rp{static useVuex(){K.use(R2)}static async configureVue(e){K.config.productionTip=!1,K.use(w2),K.component("upn-icon",Bc),K.mixin({beforeCreate(){this.$e2eFormat=t=>t?"".concat(t).toLowerCase().replace(" ","-"):"missing-value",this.config=e}}),K.use(D2)}static async mountMainVue(e){const t=new Promise(n=>{const r=e.store.watchState(Q,"isLayoutMounted",o=>{o&&(n(),r())})}),s=new b2(K),a=new K({el:e.appElement,render:n=>n(tie),store:e.store,provide:{$focusSystem:e.focusSystemService.focusSystem,$logger:e.logger,$showModal:s.showModal,$localStorageService:e.localStorageService,$metricDefinitions:e.metricDefinitions}});return e.localizationService.formatMessage=a.$formatMessage,p$(e),t}}class _c{static async startApplication(e){var s,a;if(new VR(new Ym).redirectIfRequired(location))return;const t=await _c.createDependencies(e);if(t){_c.processStashedLogs(t.logger),this.maskHistory(t.runtimeParameters.maskedUrl),t.logger.info("Starting the application",{logCategory:f.initialization});try{const n=await this.initializeApplication(t);n.logger.info("Dispatching initial intents",{logCategory:f.initialization}),await new hX(n).dispatch(),t.performanceMeter.mark.mainEnd(),t.performanceMeter.mark.startupDone(),t.logger.info("Application is ready",{logCategory:f.initialization}),(s=t.metricDefinitions)==null||s.getMetric(Ae.ShellInitializationSuccess).add(1)}catch(n){const r=n;(a=t.metricDefinitions)==null||a.getMetric(Ae.ShellInitializationFailure).add(1),t.logger.error("Application start failed",{error:r,logCategory:f.initialization,errorCode:g.ApplicationStartFailed}),"showError"in window&&showError(r),t.performanceMeter.mark.mainError()}}}static async initializeApplication(e){var n;Rp.useVuex();const t=new n6;e.hostCommunicationService=await t.create(e.logger,e.runtimeParameters),e.pcClientCommunication=await t.getPcClientCommunicationServiceWrapper(e.runtimeParameters,e.logger,e.hostCommunicationService);const s=new Dq(e);li.GroupId=s.focusSystemService.rootGroupId,s.runtimeParameters=s.runtimeParameterService.getRuntimeParameters(),mX(s.runtimeParameters),FW.initialize(s.lifeGuardService),await Rp.configureVue(s.shellConfig),s.performanceMeter.mark.vueConfigured();const a=s.runtimeParameterService.getVisitorId(s.logger);if(s.logger.info("visitor id: ".concat(a),{logCategory:f.initialization}),new gX().updateRuntimeParamteresWithCacheConfiguration(s.runtimeParameters,s.logger,s.shellConfig,s.ubiServicesService.ubiServices.parametersService),s.performanceMeter.mark.gotCacheConfiguration(),s.runtimeParameters.playerLocale=await Tg.initializeLocalization(s.runtimeParameters.playerLocale,s.logger,s.httpClientFactory.getUbiHttpClient()),s.performanceMeter.mark.localizationLoaded(),await s.store.initialize([],[],[dX.create(s),W7.create(s),t7.create(s.inputAggregator,s.logger,s.focusSystemService.focusSystem),v6.create(s.features),()=>OU(s)]),s.performanceMeter.mark.storeInitialized(),await s.pluginsService.initializePlugins(),s.performanceMeter.mark.builtinPluginsLoaded(),s.performanceMeter.mark.pluginsLoaded(),s.inputAggregator.start(),s.focusSystemService.initializeListeners(),await s.store.dispatchIntent(new Qi),s.store.dispatchIntent(new $O(r=>{s==null||s.store.dispatchIntent(new VO(r.breakpoint))})),await Rp.mountMainVue(s),(n=document.getElementById("preload-spinner"))==null||n.remove(),s.performanceMeter.mark.mainViewMounted(),fX(s.runtimeParameters,s.runtimeRxService,s.playerNotificationWebSocketService,s.store),s.globalStylesService=new HU(s.logger,s.runtimeParameters,s.store),this.loadDevHooks(s.store,s.hostCommunicationService,s.pluginsService,s.kinderGarden,s.logger,e.pcClientCommunication),GW.switchIconsIfNeeded(s.runtimeParameters),s.runtimeParameters.hostPlatformType===p.PCElectronClient&&s.hostCommunicationService){const r=s.logger.getCustomTransport(cr,ds.DesktopAppLogTransport);r.communicationService=s.hostCommunicationService}return s.runtimeParameters.childId&&!window.opener&&(s.logger.warn(wi.NoParentWindow,{childId:s.runtimeParameters.childId,logCategory:f.initialization,errorCode:g.NoParentWindowWarning}),s.performanceMeter.mark.shellInitialized(),window.close()),s}static async createDependencies(e){const t=new Ym,s=new wU(t),{parameters:a,errors:n}=s.loadRuntimeParameters(),r=new LS({local:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.ubi.com",logger:{logSource:"Uplay Next Shell",batchSize:1e3,timeInterval:{max:15e3,min:1e3}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}},dev:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.ubi.com",logger:{logSource:"Uplay Next Shell",batchSize:400,timeInterval:{max:3e5,min:6e4}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}},uat:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.ubi.com",logger:{logSource:"Uplay Next Shell",batchSize:400,timeInterval:{max:3e5,min:6e4}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}},cert:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.ubi.com",logger:{logSource:"Uplay Next Shell",batchSize:400,timeInterval:{max:3e5,min:6e4}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}},prod:{ids:{WW:{legacyClientSpaceId:"e17be87d-2996-4f3b-97c4-19bb2dae2933",overlay:{shellCrossPlatformSpaceId:"ec66c7e2-7b44-471c-a3ab-9d1da48153c3",shellPlatformSpecificIds:{ps4:{applicationId:"fb28ccda-ffe7-478f-8676-b048090e6082",spaceId:"7908ca11-685e-4112-853c-282abbcf54e4"},ps5:{applicationId:"3d8f1c42-b6dd-4492-affc-0ab5ff3130ac",spaceId:"c5a8f8c4-58fc-4c9d-bec4-6eb0798844ff"},pc:{applicationId:"83564d31-7cd7-4bc0-a763-6524e78d1a7f",spaceId:"abda351c-f251-4a70-8fb1-32bd42089262"},web:{applicationId:"99f58b32-1fe6-4efc-942f-143ce779fac2",spaceId:"45910dd2-7d8e-4da1-81e1-8be4ac9c628a"},mobile:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},android:{applicationId:"b6fd1777-1768-4c35-89bc-5c0ef8e780bf",spaceId:"7f25c6d2-678f-477e-843c-e178bb69a9a0"},ios:{applicationId:"6228f992-e472-4623-a168-486f07f27bb6",spaceId:"2878aee3-3d0a-43a8-9b5f-bec8a1ec1cc3"},scarlett:{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},"scarlett-uwp":{applicationId:"21edfd16-0e32-49ab-b6db-3d10566996f0",spaceId:"2899613b-27ff-49d3-b03d-e2a144bdbea8"},xone:{applicationId:"83aa7f68-481e-4ff9-bba3-54acd35786d0",spaceId:"fd222e81-91df-41dd-b5d4-f472dafda64d"},luna:{applicationId:"1f3b8ce8-f38f-4f39-89ca-a39885bf60cb",spaceId:"86d2dd47-e68c-48e0-ac97-e4e1937ca428"},steam:{applicationId:"d1c666c8-51bb-42c8-8b76-1e224f451176",spaceId:"f1dd9676-792b-461f-9cdb-7e106f169cfe"},macos:{applicationId:"192ef5b0-f83d-4229-9670-5b96c4f2938a",spaceId:"758aa331-7580-4786-8821-3b6375a9e194"},switch:{applicationId:"fbdbd14d-3712-46e5-b140-5fbcfddbff98",spaceId:"1b2292d4-b676-4f59-ad1e-22d5d1bcf4a9"}}},client:{shellCrossPlatformSpaceId:"c0c90be4-e5d0-4733-ab62-41f91a696480",shellPlatformSpecificIds:{pc:{applicationId:"20adeb9c-6dad-404e-af1e-b12b4594e86e",spaceId:"0a706b37-4b88-4437-b8f4-4ed2458c9518"},steam:{applicationId:"bc9ea544-8372-4456-8063-ec8c17651b54",spaceId:"9ab4a673-6a27-4d98-a838-0501b673500c"}}}},CN:{legacyClientSpaceId:"7c764ff0-fe22-4f81-8783-07d97540539f",overlay:{shellCrossPlatformSpaceId:"42086bfd-1121-43f0-b3fb-9780fd7b30d0",shellPlatformSpecificIds:{pc:{applicationId:"a6add1e4-45d0-40a8-a7bb-e26a69b946e1",spaceId:"88b9e23b-1874-44d5-bd15-def6a2a2abec"}}},client:{}}},apiBaseUrl:"https://{env}public-ubiservices.{domain}",logger:{logSource:"Uplay Next Shell",batchSize:400,timeInterval:{max:3e5,min:6e4}},statistics:{maxEventSize:2048,maxRequestSize:8192,queueLimitCount:100,outputInterval:{min:3e4,max:35e3},retry:{count:3,interval:1e4,recoverOnNewEvent:!0}}}}[a.environment],a.platformType,a.environment,a.region,a.isStandalone,a.bundleEnvironment),o=new o6,l=new nU,u=new aU(r.shellApplicationId,l,a.ubiMockScenario),v=new f6,w=Wu.getShellLogging(a,u,r,v);w.logger.debug("Runtime parameters loaded",{runtimeParameters:a,isDevBuild:!1,loggerRules:w.logger.getRules(),logCategory:f.initialization}),n.forEach(ce=>w.logger.error("Runtime parameters configuration error",{error:ce,logCategory:f.initialization,errorCode:g.LoadRuntimeParametersError})),w.logger.debug("ShellConfig is ready",{shellConfig:{legacyClientSpaceId:r.legacyClientSpaceId,crossPlatformSpaceId:r.shellCrossPlatformSpaceId,applicationId:r.shellApplicationId,spaceId:r.shellSpaceId},logCategory:f.initialization});const b={applicationId:r.shellApplicationId,endpoint:r.ubiservicesApiBaseUrl},I=new IU(b,u,a.region),R=new UU(b,u.getAuthenticatedUbiHttpClient());w.logger.info("Creating application instance",{logCategory:f.initialization});const x=new kU(I.ubiServices.parametersService,r.shellCrossPlatformSpaceId,w.logger),F=await x.getFeatures(fa),V=await this.createTelemetrySDK(x,F,r,a,w.logger);return{...w,microAppLifeCycle:o,ubiServicesService:I,runtimeParameterService:s,shellConfig:r,httpClientFactory:u,connectServices:R.connectServices,localStorageService:t,runtimeParameters:a,featureFlagsService:x,features:F,metricDefinitions:V==null?void 0:V.metricsDefinitions,telemetrySDK:V==null?void 0:V.sdk,lazyStore:l,appElement:this.getElementByIdOrThrow(e.appElementId,w.logger),focusSystemRootElement:this.getElementByIdOrThrow(e.focusSystemRootElementId,w.logger),focusSystemRootGroupElement:this.getElementByIdOrThrow(e.focusSystemShellGroupElementId,w.logger),performanceMeterTransportsProvider:v}}static maskHistory(e){window.history&&window.history.replaceState({path:e},"",e),window.history.pushState({path:e},"",e),window.history.pushState({path:e},"",e)}static getElementByIdOrThrow(e,t){const s=document.getElementById(e);if(!s){const a="Missing #".concat(e," element mount point in DOM.");throw t.error(a,{logCategory:f.initialization,errorCode:g.MissingMicroappMountInDOMWarning}),new De(a)}return s}static async createTelemetrySDK(e,t,s,a,n){if(!Br(a)&&e.isFeatureEnabled(t,fa.metrics))try{return(await le(()=>G(()=>import("./TelemetrySDKCreator-aa3073da.js"),["assets/TelemetrySDKCreator-aa3073da.js","assets/InMemoryExporter-27dc8dc0.js","assets/upn-vendor-bf1ed58d.js","assets/vendor-ff46a377.js"]))).createTelemetryPackage(s.applicationName)}catch(r){n.error("Non-critical subsystem unavailable, Telemetry. ".concat(r instanceof Error?r.message:""));return}}static async loadDevHooks(e,t,s,a,n,r){}static processStashedLogs(e){if(window.localStorage===void 0)return;const t="shell_log_stash";try{const s=window.localStorage.getItem(t);if(!s)return;const a=JSON.parse(s);Array.isArray(a)&&a.forEach(n=>{e.error((n==null?void 0:n.message)||"Unidentified stashed log",{logCategory:f.initialization,error:n==null?void 0:n.stack,errorCode:(n==null?void 0:n.errorCode)||g.Dolphin_20})})}finally{window.localStorage.removeItem(t)}}}window.__addPerformanceMark(_i.jsCreated);iie();async function iie(){await PW(),window.__addPerformanceMark(_i.polyfillsSetupDone),window.__addPerformanceMark(_i.mainStart),_c.startApplication({appElementId:"app",focusSystemRootElementId:"focus-system-root",focusSystemShellGroupElementId:"focus-system-shell-group"})}export{vZ as $,Q as A,Xs as B,Ii as C,cy as D,g as E,li as F,ws as G,p as H,GY as I,vee as J,iee as K,yW as L,rie as M,Y as N,Lt as O,KO as P,_t as Q,EO as R,gn as S,ZR as T,uie as U,it as V,UX as W,Mt as X,ye as Y,GD as Z,kZ as _,sie as __vite_legacy_guard,Mg as a,Yt as a0,$r as a1,jr as a2,WZ as a3,en as a4,R6 as a5,sD as a6,aD as a7,qg as a8,Gl as a9,us as aA,Mn as aB,ha as aC,JZ as aD,$6 as aE,pn as aF,k6 as aG,W6 as aH,oa as aI,gV as aJ,ap as aK,nL as aL,mj as aM,Ke as aN,Nu as aO,on as aP,CX as aQ,Fie as aR,CO as aS,zF as aT,fa as aU,y6 as aV,nee as aW,eD as aa,hx as ab,Kee as ac,zi as ad,Wi as ae,Xe as af,Be as ag,qR as ah,ys as ai,ao as aj,mt as ak,E6 as al,te as am,G6 as an,L6 as ao,st as ap,as as aq,we as ar,fi as as,q6 as at,D6 as au,U6 as av,F6 as aw,V6 as ax,FW as ay,x6 as az,LO as b,aW as c,xO as d,tW as e,He as f,bi as g,GG as h,f as i,S as j,ty as k,W as l,M as m,$e as n,See as o,wee as p,bee as q,SW as r,Cg as s,J as t,gs as u,Gt as v,_e as w,Cee as x,Z as y,vc as z};